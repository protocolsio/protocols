{"id":40314,"title":"CUT&Tag Data Processing and Analysis Tutorial","title_html":"<p>CUT&amp;Tag Data Processing and Analysis Tutorial<\/p>","image":{"source":"https:\/\/s3.amazonaws.com\/protocols-files\/public\/dc9cd4c53a1d8402112dade227f044fef5ce68005dc6abefaa0d66c259c96a73\/cg8cbb8dp.png","placeholder":"https:\/\/s3.amazonaws.com\/protocols-files\/public\/dc9cd4c53a1d8402112dade227f044fef5ce68005dc6abefaa0d66c259c96a73\/cg8cbb8dp.png"},"doi":null,"doi_status":0,"uri":"cut-amp-tag-data-processing-and-analysis-tutorial-bjk2kkye","type_id":1,"template_id":5,"published_on":1597246844,"parent_protocols":[],"parent_collections":[],"cited_protocols":[],"version_id":0,"created_on":1597183732,"categories":null,"creator":{"name":"Ye Zheng","affiliation":"Fred Hutchinson Cancer Research Center","affiliations":[{"affiliation":"Fred Hutchinson Cancer Research Center","url":"","is_default":1}],"username":"ye-zheng","note":null,"link":"https:\/\/yezhengstat.github.io\/CUTTag_tutorial\/","image":{"source":"https:\/\/s3.amazonaws.com\/protocols-files\/public\/dc9cd4c53a1d8402112dade227f044fef5ce68005dc6abefaa0d66c259c96a73\/cg9ybb8dp.jpg","placeholder":"https:\/\/s3.amazonaws.com\/protocols-files\/public\/dc9cd4c53a1d8402112dade227f044fef5ce68005dc6abefaa0d66c259c96a73\/cg9ybb8dp.jpg"},"badges":[{"id":2,"image":{"source":"\/img\/badges\/bronze.svg","placeholder":"\/img\/badges\/bronze.svg"},"name":"Author"}],"verified":0,"is_verified_user":false,"research_interests":null,"blocked_by_you":false,"blocked_you":false,"hide_following":false},"journal":null,"journal_name":null,"journal_link":null,"article_citation":null,"public":1,"has_versions":0,"link":"https:\/\/yezhengstat.github.io\/CUTTag_tutorial\/","total_collections":0,"number_of_steps":38,"authors":[{"name":"Ye Zheng","affiliation":"Fred Hutchinson Cancer Research Center","affiliations":[],"username":"ye-zheng","note":null,"link":null,"image":{"source":"https:\/\/s3.amazonaws.com\/protocols-files\/public\/dc9cd4c53a1d8402112dade227f044fef5ce68005dc6abefaa0d66c259c96a73\/cg9ybb8dp.jpg","placeholder":"https:\/\/s3.amazonaws.com\/protocols-files\/public\/dc9cd4c53a1d8402112dade227f044fef5ce68005dc6abefaa0d66c259c96a73\/cg9ybb8dp.jpg"},"badges":[],"verified":1,"is_verified_user":true,"research_interests":null,"blocked_by_you":false,"blocked_you":false,"hide_following":false},{"name":"Kami Ahmad","affiliation":"Fred Hutchinson Cancer Research Center","affiliations":[],"username":"kami-ahmad","note":null,"link":null,"image":{"source":"https:\/\/s3.amazonaws.com\/pr-journal\/sifiwnw.jpg","placeholder":"https:\/\/s3.amazonaws.com\/pr-journal\/sifiwnw.jpg"},"badges":[],"verified":1,"is_verified_user":true,"research_interests":null,"blocked_by_you":false,"blocked_you":false,"hide_following":false},{"name":"Steven Henikoff","affiliation":"Fred Hutchinson Cancer Research Center","affiliations":[],"username":"steven-henikoff","note":null,"link":null,"image":{"source":"https:\/\/s3.amazonaws.com\/pr-journal\/s3pitfe.png","placeholder":"https:\/\/s3.amazonaws.com\/pr-journal\/s3pitfe.png"},"badges":[],"verified":1,"is_verified_user":true,"research_interests":null,"blocked_by_you":false,"blocked_you":false,"hide_following":false}],"versions":[],"groups":[],"is_owner":1,"has_subprotocols":0,"is_subprotocol":0,"is_bookmarked":0,"can_claim_authorship":0,"can_accept_authorship":0,"can_be_copied":1,"can_remove_fork":1,"fork_id":null,"url":"https:\/\/www.protocols.io\/view\/cut-amp-tag-data-processing-and-analysis-tutorial-bjk2kkye","forks_count":{"private":0,"public":0},"access":{"can_view":1,"can_remove":1,"can_add":0,"can_edit":0,"can_publish":0,"can_get_doi":1,"can_share":1,"can_move":1,"can_move_outside":1,"can_transfer":1,"can_download":1,"is_locked":0},"guid":"3483EF20DC1F11EABA5FF3676F0827C5","state_version_id":1358,"steps":[{"id":1001114,"guid":"3D457340DC1F11EABA5FF3676F0827C5","previous_id":1001115,"previous_guid":"F1E931B0DC1F11EABA5FF3676F0827C5","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"CF0BF71E2D284DDC9FE8FB20DD84D29E","order_id":1,"type_id":6,"title":"Section","source":{"title":"I. Introduction"}},{"id":1054724,"guid":"B8088A2FA1924A3DA2C675A8484914C4","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\"><span style = \"font-weight:bold;\">Objectives<\/span><\/div><div class = \"text-block\">This tutorial is designed for processing and analyzing CUT&Tag data following the <\/div><div class = \"text-block\"><a href=\"https:\/\/www.protocols.io\/view\/bench-top-cut-amp-tag-bcuhiwt6\/abstract\" style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">Benchtop CUT&Tag V.3 protocol<\/span><\/a><\/div><div class = \"text-block\">. The illustration data used in this tutorial is the profiling of histone modifications in the human lymphoma K562 cell line, but the tutorial is generally applicable to any chromatin protein, including transcription factors, RNA polymerase II, and epitope-tagged proteins.<\/div><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#A492FF","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1001115,"guid":"F1E931B0DC1F11EABA5FF3676F0827C5","previous_id":null,"previous_guid":null,"modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"E38D58BE6DA947B9A9FA5CADC113DEEE","order_id":1,"type_id":6,"title":"Section","source":{"title":"I. Introduction"}},{"id":1054724,"guid":"E58061A43D9A4FC9B3B6ADA235615492","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\"><span style = \"font-weight:bold;\">Overview of CUT&Tag <\/span><\/div><div class = \"text-block\">All dynamic processes that take place on DNA in the eukaryotic nucleus occur in the context of a chromatin landscape that comprises nucleosomes and their modifications, transcription factors, and chromatin-associated complexes. A variety of chromatin features mark sites of activating and silencing transcriptional regulatory elements and chromatin domains that differ between cell types and change during development. <\/div><div class = \"text-block\">The mapping of chromatin features genome-wide has traditionally been performed using chromatin immunoprecipitation (ChIP), in which chromatin is cross-linked and solubilized, and an antibody to a protein or modification of interest is used to immunoprecipitate the bound DNA (Fig. 1a). Very little has changed in the way ChIP is most generally performed since it was first described 35 years ago, and remains fraught with signal-to-noise issues and artifacts. An alternative chromatin profiling strategy is enzyme tethering in situ whereby the chromatin protein or modification of interest is targeted by an antibody or fusion protein. Then, the underlying DNA is marked or cleaved, and a succession of enzyme-tethering methods have been introduced over the past two decades. Cleavage Under Targets & Tagmentation (CUT&Tag) is a tethering method that uses a protein-A-Tn5 (pA-Tn5) transposome fusion protein (Fig. 1b). In CUT&Tag, permeabilized cells or nuclei are incubated with antibody to a specified chromatin protein, and then pA-Tn5 loaded with mosaic end adaptors is successively tethered to antibody-bound sites. Activation of the transposome by adding magnesium ions results in the integration of the adaptors into nearby DNA. These are then amplified to generate sequencing libraries. Antibody-tethered Tn5-based methods achieve high sensitivity owing to stringent washing of samples after pA-Tn5 tethering and the high efficiency of adaptor integration. The improved signal-to-noise relative to ChIP-seq translates to an order-of-magnitude reduction in the amount of sequencing required to map chromatin features, allowing sample pooling (typically up to 90 samples) for paired-end sequencing on Illumina NGS sequencers by barcoded PCR of libraries.<\/div><div style = \"text-align :; float : ;\"><img style = \"\" src = \"https:\/\/s3.amazonaws.com\/protocols-files\/public\/dc9cd4c53a1d8402112dade227f044fef5ce68005dc6abefaa0d66c259c96a73\/cg8ebb8dp.png\" \/><\/div><\/div>"}},{"id":1054725,"guid":"843B8C2899AA4AA1B8DB5E04C828D572","order_id":2,"type_id":1,"title":"description","source":{"description":"<div style = \"text-align :; float : ;\"><img style = \"\" src = \"https:\/\/s3.amazonaws.com\/protocols-files\/public\/dc9cd4c53a1d8402112dade227f044fef5ce68005dc6abefaa0d66c259c96a73\/cg8ebb8dp.png\" \/><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#A492FF","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1001127,"guid":"E2A0EC50DC2111EABA5FF3676F0827C5","previous_id":1001114,"previous_guid":"3D457340DC1F11EABA5FF3676F0827C5","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"45B9F168C9934A28BE821B800E083082","order_id":1,"type_id":6,"title":"Section","source":{"title":"I. Introduction"}},{"id":1054724,"guid":"77B85FD17EF743AD9B93B089F48971D2","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\"><span style = \"font-weight:bold;\">CUT&Tag data processing and analysis outline<\/span><\/div><div style = \"text-align :; float : ;\"><img style = \"\" src = \"https:\/\/s3.amazonaws.com\/protocols-files\/public\/dc9cd4c53a1d8402112dade227f044fef5ce68005dc6abefaa0d66c259c96a73\/cg8ibb8dp.png\" \/><\/div><\/div>"}},{"id":1054725,"guid":"020451889C7F452FBF41996CD01763F8","order_id":2,"type_id":1,"title":"description","source":{"description":"<div style = \"text-align :; float : ;\"><img style = \"\" src = \"https:\/\/s3.amazonaws.com\/protocols-files\/public\/dc9cd4c53a1d8402112dade227f044fef5ce68005dc6abefaa0d66c259c96a73\/cg8ibb8dp.png\" \/><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#A492FF","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1001128,"guid":"34D9A8E0DC2211EABA5FF3676F0827C5","previous_id":1001127,"previous_guid":"E2A0EC50DC2111EABA5FF3676F0827C5","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"9DF78FAEC03940AC8F23AC8925892CDA","order_id":1,"type_id":6,"title":"Section","source":{"title":"I. Introduction"}},{"id":1054724,"guid":"F46BE51FBED24628BA2F8EF1D736DBC1","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\"><span style = \"font-weight:bold;\">Requirements<\/span><\/div><div class = \"text-block\"><ul style = \"list-style-type:disc;\"><li style = \"counter-reset:ol0;list-style-type:disc;\">Linux system<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">R (versions >= 3.6)<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">      - dplyr<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">      - stringr<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">      - ggplot2<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">      - viridis<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">      - GenomicRanges<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">      - chromVAR<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">      - DESeq2<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">      - ggpubr<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">      - corrplot<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">      - ChIPseqSpikeInFree [Optional]<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><a href=\"#\" style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\"> <\/span><\/a><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">FastQC(version >= 0.11.9) [Optional]<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Bowtie2 (version >= 2.3.4.3)<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">samtools (version >= 1.10)<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">bedtools (version >= 2.29.1)<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Picard (version >= 2.18.29)<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">SEACR (version >= 1.3)<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">deepTools (version >= 2.0)<\/li><\/ul><\/div><div class = \"text-block\">      - dplyr<\/div><div class = \"text-block\">      - stringr<\/div><div class = \"text-block\">      - ggplot2<\/div><div class = \"text-block\">      - viridis<\/div><div class = \"text-block\">      - GenomicRanges<\/div><div class = \"text-block\">      - chromVAR<\/div><div class = \"text-block\">      - DESeq2<\/div><div class = \"text-block\">      - ggpubr<\/div><div class = \"text-block\">      - corrplot<\/div><div class = \"text-block\">      - ChIPseqSpikeInFree [Optional]<\/div><div class = \"text-block\"><pre><code><div class = \"text-blocks\"><div class = \"text-block\">## ==== R codes ==== ##<\/div><div class = \"text-block\">library(dplyr)<\/div><div class = \"text-block\">library(stringr)<\/div><div class = \"text-block\">library(ggplot2)<\/div><div class = \"text-block\">library(viridis)<\/div><div class = \"text-block\">library(GenomicRanges)<\/div><div class = \"text-block\">library(chromVAR) ## For FRiP analysis and differential analysis<\/div><div class = \"text-block\">library(DESeq2) ## For differential analysis section<\/div><div class = \"text-block\">library(ggpubr) ## For customizing figures<\/div><\/div><\/code><\/pre><\/div><div class = \"text-block\"><ul style = \"list-style-type:disc;\"><li style = \"counter-reset:ol0;list-style-type:disc;\">FastQC(version >= 0.11.9) [Optional]<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Bowtie2 (version >= 2.3.4.3)<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">samtools (version >= 1.10)<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">bedtools (version >= 2.29.1)<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Picard (version >= 2.18.29)<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">SEACR (version >= 1.3)<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">deepTools (version >= 2.0)<\/li><\/ul><\/div><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#A492FF","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1001181,"guid":"97408C10DC2211EABA5FF3676F0827C5","previous_id":1001128,"previous_guid":"34D9A8E0DC2211EABA5FF3676F0827C5","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"8BA0212FCDE247B996A4149B2769D296","order_id":1,"type_id":6,"title":"Section","source":{"title":"I. Introduction"}},{"id":1054724,"guid":"3D5DA4713DF141499B361F3D87BDA7B6","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\"><span style = \"font-weight:bold;\">Data Downloading<\/span><\/div><div class = \"text-block\">In this tutorial, we use data from Kaya-Okur et al. (2020), and available for download from <\/div><div class = \"text-block\"><a href=\"https:\/\/www.ncbi.nlm.nih.gov\/geo\/\" style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">GEO<\/span><\/a><\/div><div class = \"text-block\">The corresponding SRA entries are provided below.<\/div><div class = \"text-block\">Options to download SRA sequences from GEO: <\/div><div class = \"text-block\">- a. Using <\/div><div class = \"text-block\"><a href=\"https:\/\/www.ncbi.nlm.nih.gov\/sra\/docs\/sradownload\/\" style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">SRA Toolkit<\/span><\/a><\/div><div class = \"text-block\">- b. Download through <\/div><div class = \"text-block\"><a href=\"https:\/\/www.imm.ox.ac.uk\/files\/ccb\/downloading_fastq_geo\" style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">European Nucleotide Archive<\/span><\/a><\/div><div class = \"text-block\">. New ENA Browser: <\/div><div class = \"text-block\"><a href=\"https:\/\/www.ebi.ac.uk\/ena\/browser\/view.\" style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">https:\/\/www.ebi.ac.uk\/ena\/browser\/view.<\/span><\/a><\/div><div class = \"text-block\"> We are using this option as an illustration.<\/div><div class = \"text-block\">Data accession on GEO:<\/div><div class = \"text-block\"><ul style = \"list-style-type:disc;\"><li style = \"counter-reset:ol0;list-style-type:disc;\">H3K27me3: <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">  - SH_Hs_K27m3_NX_0918 as replicate 1: GEO accession: GSE145187, SRA entry: SRX8754646<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">  - SH_Hs_K27m3_Xpc_0107 as replicate 2: GEO accession: GSE145187, SRA entry: SRX7713678<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">H3K4me3:<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">  - SH_Hs_K4m3_NX_0918 as replicate 1: GEO accession: GSE145187, SRA entry: SRX7713692<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">  - SH_Hs_K4m3_Xpc_0107 as replicate 2: GEO accession: GSE145187, SRA entry: SRX7713696<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">IgG:<\/li><\/ul><\/div><div class = \"text-block\">  - SH_Hs_K27m3_NX_0918 as replicate 1: GEO accession: GSE145187, SRA entry: SRX8754646<\/div><div class = \"text-block\">  - SH_Hs_K27m3_Xpc_0107 as replicate 2: GEO accession: GSE145187, SRA entry: SRX7713678<\/div><div class = \"text-block\"><ul style = \"list-style-type:disc;\"><li style = \"counter-reset:ol0;list-style-type:disc;\">H3K4me3:<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">  - SH_Hs_K4m3_NX_0918 as replicate 1: GEO accession: GSE145187, SRA entry: SRX7713692<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">  - SH_Hs_K4m3_Xpc_0107 as replicate 2: GEO accession: GSE145187, SRA entry: SRX7713696<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">IgG:<\/li><\/ul><\/div><div class = \"text-block\">  - SH_Hs_K4m3_NX_0918 as replicate 1: GEO accession: GSE145187, SRA entry: SRX7713692<\/div><div class = \"text-block\">  - SH_Hs_K4m3_Xpc_0107 as replicate 2: GEO accession: GSE145187, SRA entry: SRX7713696<\/div><div class = \"text-block\"><ul style = \"list-style-type:disc;\"><\/ul><\/div><div class = \"text-block\">  - SH_Hs_IgG_1x_0924 as replicate 1:GEO accession: GSE145187, SRA entry: SRX8468909<\/div><div class = \"text-block\">  - SH_Hs_IgG_20181224 as replicate 2: GEO accession: GSM3680227, SRA entry: SRX5545346<\/div><div class = \"text-block\">First, we need to specify the project path.<\/div><div class = \"text-block\"><pre><code><div class = \"text-blocks\"><div class = \"text-block\">##== linux command ==##<\/div><div class = \"text-block\">projPath=\"\/path\/to\/project\/where\/data\/and\/results\/are\/saved\"<\/div><\/div><\/code><\/pre><\/div><div class = \"text-block\">Taking SH_Hs_IgG_20181224 as an example.<\/div><div class = \"text-block\"><pre><code><div class = \"text-blocks\"><div class = \"text-block\">##== linux command ==##<\/div><div class = \"text-block\"><span>wget -O $projPath\/data\/IgG_rep2\/IgG_rep2_R1_001.fastq.gz <\/span><a href=\"ftp:\/\/ftp.sra.ebi.ac.uk\/vol1\/fastq\/SRR875\/001\/SRR8754611\/SRR8754611_1.fastq.gz\" style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">ftp:\/\/ftp.sra.ebi.ac.uk\/vol1\/fastq\/SRR875\/001\/SRR8754611\/SRR8754611_1.fastq.gz<\/span><\/a><\/div><div class = \"text-block\"><span>wget -O $projPath\/data\/IgG_rep2\/IgG_rep2_R2_001.fastq.gz <\/span><a href=\"ftp:\/\/ftp.sra.ebi.ac.uk\/vol1\/fastq\/SRR875\/001\/SRR8754611\/SRR8754611_2.fastq.gz\" style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">ftp:\/\/ftp.sra.ebi.ac.uk\/vol1\/fastq\/SRR875\/001\/SRR8754611\/SRR8754611_2.fastq.gz<\/span><\/a><\/div><div class = \"text-block\"><span>wget -O $projPath\/data\/IgG_rep2\/IgG_rep2_R1_002.fastq.gz <\/span><a href=\"ftp:\/\/ftp.sra.ebi.ac.uk\/vol1\/fastq\/SRR875\/002\/SRR8754612\/SRR8754612_1.fastq.gz\" style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">ftp:\/\/ftp.sra.ebi.ac.uk\/vol1\/fastq\/SRR875\/002\/SRR8754612\/SRR8754612_1.fastq.gz<\/span><\/a><\/div><div class = \"text-block\"><span>wget -O $projPath\/data\/IgG_rep2\/IgG_rep2_R2_002.fastq.gz <\/span><a href=\"ftp:\/\/ftp.sra.ebi.ac.uk\/vol1\/fastq\/SRR875\/002\/SRR8754612\/SRR8754612_2.fastq.gz\" style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">ftp:\/\/ftp.sra.ebi.ac.uk\/vol1\/fastq\/SRR875\/002\/SRR8754612\/SRR8754612_2.fastq.gz<\/span><\/a><\/div><\/div><\/code><\/pre><\/div><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#A492FF","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1001189,"guid":"F6A0FB20DC2411EABA5FF3676F0827C5","previous_id":1001181,"previous_guid":"97408C10DC2211EABA5FF3676F0827C5","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"9A7A1A7414AD44D5BE739D106A64CC77","order_id":1,"type_id":6,"title":"Section","source":{"title":"II. Data Pre-processing"}},{"id":1054724,"guid":"54FAA89D165F4536842DEB43834E0A6C","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\"><span style = \"font-weight:bold;\">Quality Control using <\/span><\/div><div class = \"text-block\"><a href=\"https:\/\/www.bioinformatics.babraham.ac.uk\/projects\/fastqc\/\" style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">FastQC<\/span><\/a><\/div><div class = \"text-block\"><span style = \"font-weight:bold;\"> [Optional]<\/span><\/div><div class = \"text-block\"><span>This step is <\/span><span style = \"font-weight:bold;\">not<\/span><span> required. In case that users are generating their own data and FastQC is one of the routine checking procedures in the user's' groups, we provide this step as a troubleshooting explanation.<\/span><\/div><div class = \"text-block\">1. Obtain FastQC<\/div><div class = \"text-block\"><pre><code><div class = \"text-blocks\"><div class = \"text-block\">##== linux command ==##<\/div><div class = \"text-block\">mkdir -p $projPath\/tools<\/div><div class = \"text-block\"><span>wget -P $projPath\/tools <\/span><a href=\"https:\/\/www.bioinformatics.babraham.ac.uk\/projects\/fastqc\/fastqc_v0.11.9.zip\" style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">https:\/\/www.bioinformatics.babraham.ac.uk\/projects\/fastqc\/fastqc_v0.11.9.zip<\/span><\/a><\/div><div class = \"text-block\">cd $projPath\/tools<\/div><div class = \"text-block\">unzip fastqc_v0.11.9.zip<\/div><\/div><\/code><\/pre><\/div><div class = \"text-block\">2. Run FastQC for quality check<\/div><div class = \"text-block\"><pre><code><div class = \"text-blocks\"><div class = \"text-block\">##== linux command ==##<\/div><div class = \"text-block\">mkdir -p ${projPath}\/fastqFileQC\/${histName}<\/div><div class = \"text-block\">$projPath\/tools\/FastQC\/fastqc -o ${projPath}\/fastqFileQC\/${histName} -f fastq ${projPath}\/fastq\/${histName}_R1.fastq.gz<\/div><div class = \"text-block\">$projPath\/tools\/FastQC\/fastqc -o ${projPath}\/fastqFileQC\/${histName} -f fastq ${projPath}\/fastq\/${histName}_R2.fastq.gz<\/div><\/div><\/code><\/pre><\/div><div class = \"text-block\">3 Interpret the quality check results.<\/div><div class = \"text-block\">Quality check reference: <\/div><div class = \"text-block\"><a href=\"https:\/\/www.bioinformatics.babraham.ac.uk\/projects\/fastqc\/bad_sequence_fastqc.html\" style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">https:\/\/www.bioinformatics.babraham.ac.uk\/projects\/fastqc\/bad_sequence_fastqc.html<\/span><\/a><\/div><div class = \"text-block\">.<\/div><div class = \"text-block\">The discordant sequence content at the beginning of the reads is a common phenomenon for CUT&Tag reads. Failing to pass the Per base sequence content does not mean your data failed.<\/div><div style = \"text-align :; float : ;\"><img style = \"\" src = \"https:\/\/s3.amazonaws.com\/protocols-files\/public\/dc9cd4c53a1d8402112dade227f044fef5ce68005dc6abefaa0d66c259c96a73\/cg8ubb8dp.png\" \/><\/div><div class = \"text-block\">- It can be due to the Tn5 preference.<\/div><div class = \"text-block\">- What you might be detecting is the 10-bp periodicity that shows up as a sawtooth pattern in the length distribution. If so, this is normal and will not affect alignment or peak calling. In any case, we do not recommend trimming as the bowtie2 parameters that we list will give accurate mapping information without trimming.<\/div><\/div>"}},{"id":1054725,"guid":"54C65C9525524024844761954495C08B","order_id":2,"type_id":1,"title":"description","source":{"description":"<div style = \"text-align :; float : ;\"><img style = \"\" src = \"https:\/\/s3.amazonaws.com\/protocols-files\/public\/dc9cd4c53a1d8402112dade227f044fef5ce68005dc6abefaa0d66c259c96a73\/cg8ubb8dp.png\" \/><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#d0021b","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1001201,"guid":"DC9C6880DC2511EABA5FF3676F0827C5","previous_id":1001189,"previous_guid":"F6A0FB20DC2411EABA5FF3676F0827C5","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"36B1E6FD0C3B4CA29EF8D5766D82B10C","order_id":1,"type_id":6,"title":"Section","source":{"title":"II. Data Pre-processing"}},{"id":1054724,"guid":"6F727824B553434AB3E6E86F20CCE976","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\"><span style = \"font-weight:bold;\">Merge technical replicates\/lanes if needed [Optional]<\/span><\/div><div class = \"text-block\">Sometimes, samples are often sequenced across multiple lanes for efficiency and can be pooled before alignment. If you want to check the reproducibility between sequences of different lanes of the same sample, you can skip this step and align each sequencing file (fastq file) respectively.<\/div><div class = \"text-block\"><pre><code><div class = \"text-blocks\"><div class = \"text-block\">##== linux command ==##<\/div><div class = \"text-block\">histName=\"K27me3_rep1\"<\/div><div class = \"text-block\">mkdir -p ${projPath}\/fastq<\/div><div class = \"text-block\">cat ${projPath}\/data\/${histName}\/*_R1_*.fastq.gz >${projPath}\/fastq\/${histName}_R1.fastq.gz<\/div><div class = \"text-block\">cat ${projPath}\/data\/${histName}\/*_R2_*.fastq.gz >${projPath}\/fastq\/${histName}_R2.fastq.gz<\/div><\/div><\/code><\/pre><\/div><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#d0021b","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1001203,"guid":"FDB88350DC2511EABA5FF3676F0827C5","previous_id":1001201,"previous_guid":"DC9C6880DC2511EABA5FF3676F0827C5","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"F9C1642C9B7B4DE0BA8C93754CAE1591","order_id":1,"type_id":6,"title":"Section","source":{"title":"III. Alignment"}},{"id":1054724,"guid":"9B76D4BA698C4F8D9FFCB5BB4D36DABA","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\"><span style = \"font-weight:bold;\">Adapters and primers<\/span><\/div><div class = \"text-block\">The structure of CUT&Tag insert libraries with Tn5 adapters and barcoded PCR primers  is shown below:<\/div><div style = \"text-align :; float : ;\"><img style = \"\" src = \"https:\/\/s3.amazonaws.com\/protocols-files\/public\/dc9cd4c53a1d8402112dade227f044fef5ce68005dc6abefaa0d66c259c96a73\/cg8wbb8dp.png\" \/><\/div><div class = \"text-block\">Our standard pipeline is to perform single-index 25x25 PE Illumina sequencing on up to 90 pooled samples on a single HiSeq 2500 flowcell, where each sample has a unique PCR primer barcode. Amounts for each library are adjusted to provide ~5 million paired-end reads, which provides high-quality profiling for abundant chromatin features with a specific and high-yield antibody. Less abundant features typically require fewer reads, while lower-quality antibodies may increase the number of reads needed for generating robust chromatin profiles. A thorough discussion of feature recall and sequencing depths for CUT&Tag has been published (Kaya-Okur et al 2020).<\/div><\/div>"}},{"id":1054725,"guid":"450122A034404469AF550D8E9042AF36","order_id":2,"type_id":1,"title":"description","source":{"description":"<div style = \"text-align :; float : ;\"><img style = \"\" src = \"https:\/\/s3.amazonaws.com\/protocols-files\/public\/dc9cd4c53a1d8402112dade227f044fef5ce68005dc6abefaa0d66c259c96a73\/cg8wbb8dp.png\" \/><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#b8e986","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1001204,"guid":"4209D4F0DC2611EABA5FF3676F0827C5","previous_id":1001203,"previous_guid":"FDB88350DC2511EABA5FF3676F0827C5","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"0432F0EB14294A6EA60DD305D0CC3E35","order_id":1,"type_id":6,"title":"Section","source":{"title":"III. Alignment"}},{"id":1054724,"guid":"8C44588DCDAD4E70A29516D1D902166B","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\"><span style = \"font-weight:bold;\">Bowtie2 alignment<\/span><\/div><div class = \"text-block\">Alignment to hg38. <\/div><div class = \"text-block\"><pre><code><div class = \"text-blocks\"><div class = \"text-block\">##== linux command ==##<\/div><div class = \"text-block\">cores=8<\/div><div class = \"text-block\">ref=\"\/path\/to\/bowtie2Index\/hg38\"<\/div><div class = \"text-block\">mkdir -p ${projPath}\/alignment\/sam\/bowtie2_summary<\/div><div class = \"text-block\">mkdir -p ${projPath}\/alignment\/bam<\/div><div class = \"text-block\">mkdir -p ${projPath}\/alignment\/bed<\/div><div class = \"text-block\">mkdir -p ${projPath}\/alignment\/bedgraph<\/div><div class = \"text-block\">## Build the bowtie2 reference genome index if needed:<\/div><div class = \"text-block\">## bowtie2-build path\/to\/hg38\/fasta\/hg38.fa \/path\/to\/bowtie2Index\/hg38<\/div><div class = \"text-block\">bowtie2 --end-to-end --very-sensitive --no-mixed --no-discordant --phred33 -I 10 -X 700 -p ${cores} -x ${ref} -1 ${projPath}\/fastq\/${histName}_R1.fastq.gz -2 ${projPath}\/fastq\/${histName}_R2.fastq.gz -S ${projPath}\/alignment\/sam\/${histName}_bowtie2.sam &> ${projPath}\/alignment\/sam\/bowtie2_summary\/${histName}_bowtie2.txt<\/div><\/div><\/code><\/pre><\/div><div class = \"text-block\">The paired-end reads are aligned by Bowtie2 using parameters <\/div><div class = \"text-block\"><pre><code><div class = \"text-blocks\"><div class = \"text-block\">--end-to-end --very-sensitive --no-mixed --no-discordant --phred33 -I 10 -X 700<\/div><\/div><\/code><\/pre><\/div><div class = \"text-block\">for mapping of inserts 10-700 bp in length. <\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">Critical step<\/span><span>: There is no need to trim reads from out standard 25x25 PE sequencing, as adapter sequences will not be included in reads of inserts >25 bp. However, for users performing longer sequencing, reads will need to be trimmed by Cutadapt and mapped by<\/span><\/div><div class = \"text-block\"><pre><code><div class = \"text-blocks\"><div class = \"text-block\">--local --very-sensitive --no-mixed --no-discordant --phred33 -I 10 -X 700<\/div><\/div><\/code><\/pre><\/div><div class = \"text-block\"> to ignore any remaining adapter sequence at the 3' ends of reads during mapping.<\/div><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#b8e986","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1001205,"guid":"B43AC5C0DC2611EABA5FF3676F0827C5","previous_id":1001204,"previous_guid":"4209D4F0DC2611EABA5FF3676F0827C5","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"51E17D5F3D87434080609353102F4A1C","order_id":1,"type_id":6,"title":"Section","source":{"title":"III. Alignment"}},{"id":1054724,"guid":"3112A0418CCE4D8FBE4B5FFDD518975D","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\"><span style = \"font-weight:bold;\">Alignment to spike-in genome for spike-in calibration [optional\/recommended]<\/span><\/div><div class = \"text-block\"><span>This step is <\/span><span style = \"font-weight:bold;\">optional<\/span><span> but <\/span><span style = \"font-weight:bold;\">recommended<\/span><span> depending on your experimental protocol.<\/span><\/div><div class = \"text-block\">E. coli DNA is carried along with bacterially-produced pA-Tn5 protein and gets tagmented non-specifically during the reaction. The fraction of total reads that map to the E.coli genome depends on the yield of epitope-targeted CUT&Tag, and so depends on the number of cells used and the abundance of that epitope in chromatin. Since a constant amount of pATn5 is added to CUT&Tag reactions and brings along a fixed amount of E. coli DNA, E. coli reads can be used to normalize epitope abundance in a set of experiments. For more discussion, please see Section V.<\/div><div class = \"text-block\"><pre><code><div class = \"text-blocks\"><div class = \"text-block\">##== linux command ==##<\/div><div class = \"text-block\">spikeInRef=\"\/shared\/ngs\/illumina\/henikoff\/Bowtie2\/Ecoli\"<\/div><div class = \"text-block\">chromSize=\"\/fh\/fast\/gottardo_r\/yezheng_working\/SupplementaryData\/hg38\/chromSize\/hg38.chrom.size\"<\/div><div class = \"text-block\">## bowtie2-build path\/to\/Ecoli\/fasta\/Ecoli.fa \/path\/to\/bowtie2Index\/Ecoli<\/div><div class = \"text-block\">bowtie2 --end-to-end --very-sensitive --no-mixed --no-discordant --phred33 -I 10 -X 700 -p ${cores} -x ${spikeInRef} -1 ${projPath}\/fastq\/${histName}_R1.fastq.gz -2 ${projPath}\/fastq\/${histName}_R2.fastq.gz -S $projPath\/alignment\/sam\/${histName}_bowtie2_spikeIn.sam &> $projPath\/alignment\/sam\/bowtie2_summary\/${histName}_bowtie2_spikeIn.txt<\/div><div class = \"text-block\">seqDepthDouble=`samtools view -F 0x04 seqDepth=$((seqDepthDouble\/2))<\/div><div class = \"text-block\">echo $seqDepth >$projPath\/alignment\/sam\/bowtie2_summary\/${histName}_bowtie2_spikeIn.seqDepth<\/div><\/div><\/code><\/pre><\/div><div class = \"text-block\"><span>- For spike-in normalization, reads are aligned to the E. coli genome U00096.3 with two more parameters <\/span><span style = \"font-weight:bold;\">--no-overlap<\/span><span> and <\/span><span style = \"font-weight:bold;\">--no-dovetail<\/span><\/div><div class = \"text-block\"><pre><code><div class = \"text-blocks\"><div class = \"text-block\">--end-to-end --very-sensitive --no-overlap --no-dovetail --no-mixed --no-discordant --phred33 -I 10 -X 700<\/div><\/div><\/code><\/pre><\/div><div class = \"text-block\"><span style = \"font-weight:bold;\"> <\/span><span>to avoid possible cross-mapping of the experimental genome to that of the carry-over E. coli DNA that is used for calibration.<\/span><\/div><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#b8e986","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1001206,"guid":"09DEE7E0DC2711EABA5FF3676F0827C5","previous_id":1001205,"previous_guid":"B43AC5C0DC2611EABA5FF3676F0827C5","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"0B51449D586645A29F6809C22CC99CA9","order_id":1,"type_id":6,"title":"Section","source":{"title":"III. Alignment"}},{"id":1054724,"guid":"885081A2BB734517ABEECEDB2BDE5F98","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\"><span style = \"font-weight:bold;\">Alignment summary<\/span><\/div><div class = \"text-block\">For more detailed parameters explanation, users can refer to the <\/div><div class = \"text-block\"><a href=\"http:\/\/bowtie-bio.sourceforge.net\/bowtie2\/manual.shtml\" style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">bowite2 manual<\/span><\/a><\/div><div class = \"text-block\">Bowtie2 alignment results summary is saved at <\/div><div class = \"text-block\"><pre><code><div class = \"text-blocks\"><div class = \"text-block\">${projPath}\/alignment\/sam\/bowtie2)summary\/${histName}_bowtie2.txt<\/div><\/div><\/code><\/pre><\/div><div class = \"text-block\">and you should expect the results look similar.<\/div><div class = \"text-block\"><pre><code><div class = \"text-blocks\"><div class = \"text-block\">2984630 reads; of these:<\/div><div class = \"text-block\">  2984630 (100.00%) were paired; of these:<\/div><div class = \"text-block\">    125110 (4.19%) aligned concordantly 0 times<\/div><div class = \"text-block\">    2360430 (79.09%) aligned concordantly exactly 1 time<\/div><div class = \"text-block\">    499090 (16.72%) aligned concordantly >1 times<\/div><div class = \"text-block\">95.81% overall alignment rate<\/div><\/div><\/code><\/pre><\/div><div class = \"text-block\">- 2984640 is the sequencing depth, i.e., the total number of paired reads.<\/div><div class = \"text-block\">- 125110 is the number of read-pairs that fail to be mapped.<\/div><div class = \"text-block\">- 2360430 + 499090 is the number of read-pairs that are successfully mapped.<\/div><div class = \"text-block\">- 95.81% is the overall alignment rate<\/div><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#b8e986","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1001216,"guid":"DF84A970DC2711EABA5FF3676F0827C5","previous_id":1001206,"previous_guid":"09DEE7E0DC2711EABA5FF3676F0827C5","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"D768B49946CC476DB9CDE52C5438C5A0","order_id":1,"type_id":6,"title":"Section","source":{"title":"III. Alignment Summary"}},{"id":1054724,"guid":"4433921D12844F3A930DB7469821E12B","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\"><span style = \"font-weight:bold;\">Report sequencing mapping summary<\/span><\/div><div class = \"text-block\">Summarize the raw reads and uniquely mapping reads to report the efficiency of alignment. Alignment frequencies are expected to be >80% for high-quality data. CUT&Tag data typically has very low backgrounds, so as few as 1 million mapped fragments can give robust profiles for a histone modification in the human genome. Profiling of less-abundant transcription factors and chromatin proteins may require 10 times as many mapped fragments for downstream analysis.<\/div><div class = \"text-block\">We can evaluate the following metrics:<\/div><div class = \"text-block\"> - Sequencing depth<\/div><div class = \"text-block\"> - Alignment rate<\/div><div class = \"text-block\"> - Number of mappable fragments<\/div><div class = \"text-block\"> - Duplication rate<\/div><div class = \"text-block\"> - Unique library size<\/div><div class = \"text-block\"> - Fragment size distribution<\/div><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#417505","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1001227,"guid":"634E5090DC2C11EABA5FF3676F0827C5","previous_id":1001216,"previous_guid":"DF84A970DC2711EABA5FF3676F0827C5","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"9D5745DBEF524A0A8DB94C7CCF45E1ED","order_id":1,"type_id":6,"title":"Section","source":{"title":"III. Alignment Summary"}},{"id":1054724,"guid":"313B41A6542B4D9A8A1DF9345E287345","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\"><span style = \"font-weight:bold;\">1. Sequencing depth<\/span><\/div><div class = \"text-block\"><pre><code><div class = \"text-blocks\"><div class = \"text-block\">##=== R command ===## <\/div><div class = \"text-block\">## Path to the project and histone list<\/div><div class = \"text-block\">projPath = \"\/fh\/fast\/gottardo_r\/yezheng_working\/cuttag\/CUTTag_tutorial\"<\/div><div class = \"text-block\">sampleList = c(\"K27me3_rep1\", \"K27me3_rep2\", \"K4me3_rep1\", \"K4me3_rep2\", \"IgG_rep1\", \"IgG_rep2\")<\/div><div class = \"text-block\">histList = c(\"K27me3\", \"K4me3\", \"IgG\")<\/div><div class = \"text-block\">## Collect the alignment results from the bowtie2 alignment summary files<\/div><div class = \"text-block\">alignResult = c()<\/div><div class = \"text-block\">for(hist in sampleList){<\/div><div class = \"text-block\">  alignRes = read.table(paste0(projPath, \"\/alignment\/sam\/bowtie2_summary\/\", hist, \"_bowtie2.txt\"), header = FALSE, fill = TRUE)<\/div><div class = \"text-block\">  alignRate = substr(alignRes$V1[6], 1, nchar(as.character(alignRes$V1[6]))-1)<\/div><div class = \"text-block\">  histInfo = strsplit(hist, \"_\")[[1]]<\/div><div class = \"text-block\">  alignResult = data.frame(Histone = histInfo[1], Replicate = histInfo[2], <\/div><div class = \"text-block\">                           SequencingDepth = alignRes$V1[1] %>% as.character %>% as.numeric, <\/div><div class = \"text-block\">                           MappedFragNum_hg38 = alignRes$V1[4] %>% as.character %>% as.numeric + alignRes$V1[5] %>% as.character %>% as.numeric, <\/div><div class = \"text-block\">                           AlignmentRate_hg38 = alignRate %>% as.numeric)  %>% rbind(alignResult, .)<\/div><div class = \"text-block\">}<\/div><div class = \"text-block\">alignResult$Histone = factor(alignResult$Histone, levels = histList)<\/div><div class = \"text-block\">alignResult %>% mutate(AlignmentRate_hg38 = paste0(AlignmentRate_hg38, \"%\"))<\/div><\/div><\/code><\/pre><\/div><table border><tr style = \"text-align:center;\"><td>  <\/td><td>A<\/td><td>B<\/td><td>C<\/td><td>D<\/td><td>E<\/td><\/tr><tr><td style = \"text-align:center;\">1<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">Histone<fctr><\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">Replicate<chr><\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">SequencingDepth<dbl><\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">MappedFragNum_hg38<dbl><\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">AlignmentRate_hg38<chr><\/td><\/tr><tr><td style = \"text-align:center;\">2<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">K27me3<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">rep1<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">2984630<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">2859520<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">95.81%<\/td><\/tr><tr><td style = \"text-align:center;\">3<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">K27me3<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">rep2<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">2702260<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">2606295<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">96.45%<\/td><\/tr><tr><td style = \"text-align:center;\">4<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">K4me3<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">rep1<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">1581710<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">1494122<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">94.46%<\/td><\/tr><tr><td style = \"text-align:center;\">5<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">K4me3<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">rep2<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">1885056<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">1742005<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">92.41%<\/td><\/tr><tr><td style = \"text-align:center;\">6<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">IgG<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">rep1<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">2127635<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">1747065<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">82.11%<\/td><\/tr><tr><td style = \"text-align:center;\">7<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">IgG<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">rep2<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">2192908<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">1992929<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">90.88%<\/td><\/tr><\/table><div class = \"text-block\"><span style = \"font-weight:bold;\">2. Spike-in alignment <\/span><\/div><div class = \"text-block\"><pre><code><div class = \"text-blocks\"><div class = \"text-block\">##=== R command ===## <\/div><div class = \"text-block\">spikeAlign = c()<\/div><div class = \"text-block\">for(hist in sampleList){<\/div><div class = \"text-block\">  spikeRes = read.table(paste0(projPath, \"\/alignment\/sam\/bowtie2_summary\/\", hist, \"_bowtie2_spikeIn.txt\"), header = FALSE, fill = TRUE)<\/div><div class = \"text-block\">  alignRate = substr(spikeRes$V1[6], 1, nchar(as.character(spikeRes$V1[6]))-1)<\/div><div class = \"text-block\">  histInfo = strsplit(hist, \"_\")[[1]]<\/div><div class = \"text-block\">  spikeAlign = data.frame(Histone = histInfo[1], Replicate = histInfo[2], <\/div><div class = \"text-block\">                          SequencingDepth = spikeRes$V1[1] %>% as.character %>% as.numeric, <\/div><div class = \"text-block\">                          MappedFragNum_spikeIn = spikeRes$V1[4] %>% as.character %>% as.numeric + spikeRes$V1[5] %>% as.character %>% as.numeric, <\/div><div class = \"text-block\">                          AlignmentRate_spikeIn = alignRate %>% as.numeric)  %>% rbind(spikeAlign, .)<\/div><div class = \"text-block\">}<\/div><div class = \"text-block\">spikeAlign$Histone = factor(spikeAlign$Histone, levels = histList)<\/div><div class = \"text-block\">spikeAlign %>% mutate(AlignmentRate_spikeIn = paste0(AlignmentRate_spikeIn, \"%\"))<\/div><\/div><\/code><\/pre><\/div><table border><tr style = \"text-align:center;\"><td>  <\/td><td>A<\/td><td>B<\/td><td>C<\/td><td>D<\/td><td>E<\/td><\/tr><tr><td style = \"text-align:center;\">1<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">Histone<fctr><\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">Replicate<chr><\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">SequencingDepth<dbl><\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">MappedFragNum_spikeIn<dbl><\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">AlignmentRate_spikeIn<chr><\/td><\/tr><tr><td style = \"text-align:center;\">2<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">K27me3<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">rep1<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">2984630<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">235<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">0.01%<\/td><\/tr><tr><td style = \"text-align:center;\">3<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">K27me3<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">rep2<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">2702260<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">487<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">0.02%<\/td><\/tr><tr><td style = \"text-align:center;\">4<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">K4me3<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">rep1<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">1581710<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">375<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">0.02%<\/td><\/tr><tr><td style = \"text-align:center;\">5<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">K4me3<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">rep2<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">1885056<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">4442<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">0.24%<\/td><\/tr><tr><td style = \"text-align:center;\">6<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">IgG<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">rep1<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">2127635<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">75733<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">3.56%<\/td><\/tr><tr><td style = \"text-align:center;\">7<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">IgG<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">rep2<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">2192908<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">79123<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">3.61%<\/td><\/tr><\/table><div class = \"text-block\"><span style = \"font-weight:bold;\">3. Summarize the alignment to hg38 and E.coli<\/span><\/div><div class = \"text-block\"><pre><code><div class = \"text-blocks\"><div class = \"text-block\">##=== R command ===## <\/div><div class = \"text-block\">alignSummary = left_join(alignResult, spikeAlign, by = c(\"Histone\", \"Replicate\", \"SequencingDepth\")) %>%<\/div><div class = \"text-block\">  mutate(AlignmentRate_hg38 = paste0(AlignmentRate_hg38, \"%\"), <\/div><div class = \"text-block\">         AlignmentRate_spikeIn = paste0(AlignmentRate_spikeIn, \"%\"))<\/div><div class = \"text-block\">alignSummary<\/div><\/div><\/code><\/pre><\/div><table border><tr style = \"text-align:center;\"><td>  <\/td><td>A<\/td><td>B<\/td><td>C<\/td><td>D<\/td><td>E<\/td><td>F<\/td><td>G<\/td><\/tr><tr><td style = \"text-align:center;\">1<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">Histone<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">Replicate<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">SequencingDepth<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">MappedFragNum_hg38<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">AlignmentRate_hg38<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">MappedFragNum_spikeIn<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">AlignmentRate_spikeIn<\/td><\/tr><tr><td style = \"text-align:center;\">2<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">K27me3<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">rep1<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">2984630<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">2859520<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">95.81%<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">235<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">0.01%<\/td><\/tr><tr><td style = \"text-align:center;\">3<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">K27me3<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">rep2<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">2702260<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">2606295<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">96.45%<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">487<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">0.02%<\/td><\/tr><tr><td style = \"text-align:center;\">4<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">K4me3<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">rep1<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">1581710<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">1494122<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">94.46%<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">375<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">0.02%<\/td><\/tr><tr><td style = \"text-align:center;\">5<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">K4me3<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">rep2<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">1885056<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">1742005<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">92.41%<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">4442<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">0.24%<\/td><\/tr><tr><td style = \"text-align:center;\">6<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">IgG<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">rep1<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">2127635<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">1747065<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">82.11%<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">75733<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">3.56%<\/td><\/tr><tr><td style = \"text-align:center;\">7<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">IgG<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">rep2<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">2192908<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">1992929<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">90.88%<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">79123<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">3.61%<\/td><\/tr><\/table><div class = \"text-block\"><span style = \"font-weight:bold;\">4. Visualizing the sequencing depth and alignment results.<\/span><\/div><div class = \"text-block\"><pre><code><div class = \"text-blocks\"><div class = \"text-block\">##=== R command ===## <\/div><div class = \"text-block\">## Generate sequencing depth boxplot<\/div><div class = \"text-block\">fig3A = alignResult %>% ggplot(aes(x = Histone, y = SequencingDepth\/1000000, fill = Histone)) +<\/div><div class = \"text-block\">    geom_boxplot() +<\/div><div class = \"text-block\">    geom_jitter(aes(color = Replicate), position = position_jitter(0.15)) +<\/div><div class = \"text-block\">    scale_fill_viridis(discrete = TRUE, begin = 0.1, end = 0.9, option = \"magma\", alpha = 0.8) +<\/div><div class = \"text-block\">    scale_color_viridis(discrete = TRUE, begin = 0.1, end = 0.9) +<\/div><div class = \"text-block\">    theme_bw(base_size = 18) +<\/div><div class = \"text-block\">    ylab(\"Sequencing Depth per Million\") +<\/div><div class = \"text-block\">    xlab(\"\") + <\/div><div class = \"text-block\">    ggtitle(\"A. Sequencing Depth\")<\/div><div class = \"text-block\">fig3B = alignResult %>% ggplot(aes(x = Histone, y = MappedFragNum_hg38\/1000000, fill = Histone)) +<\/div><div class = \"text-block\">    geom_boxplot() +<\/div><div class = \"text-block\">    geom_jitter(aes(color = Replicate), position = position_jitter(0.15)) +<\/div><div class = \"text-block\">    scale_fill_viridis(discrete = TRUE, begin = 0.1, end = 0.9, option = \"magma\", alpha = 0.8) +<\/div><div class = \"text-block\">    scale_color_viridis(discrete = TRUE, begin = 0.1, end = 0.9) +<\/div><div class = \"text-block\">    theme_bw(base_size = 18) +<\/div><div class = \"text-block\">    ylab(\"Mapped Fragments per Million\") +<\/div><div class = \"text-block\">    xlab(\"\") +<\/div><div class = \"text-block\">    ggtitle(\"B. Alignable Fragment (hg38)\")<\/div><div class = \"text-block\">fig3C = alignResult %>% ggplot(aes(x = Histone, y = AlignmentRate_hg38, fill = Histone)) +<\/div><div class = \"text-block\">    geom_boxplot() +<\/div><div class = \"text-block\">    geom_jitter(aes(color = Replicate), position = position_jitter(0.15)) +<\/div><div class = \"text-block\">    scale_fill_viridis(discrete = TRUE, begin = 0.1, end = 0.9, option = \"magma\", alpha = 0.8) +<\/div><div class = \"text-block\">    scale_color_viridis(discrete = TRUE, begin = 0.1, end = 0.9) +<\/div><div class = \"text-block\">    theme_bw(base_size = 18) +<\/div><div class = \"text-block\">    ylab(\"% of Mapped Fragments\") +<\/div><div class = \"text-block\">    xlab(\"\") +<\/div><div class = \"text-block\">    ggtitle(\"C. Alignment Rate (hg38)\")<\/div><div class = \"text-block\">fig3D = spikeAlign %>% ggplot(aes(x = Histone, y = AlignmentRate_spikeIn, fill = Histone)) +<\/div><div class = \"text-block\">    geom_boxplot() +<\/div><div class = \"text-block\">    geom_jitter(aes(color = Replicate), position = position_jitter(0.15)) +<\/div><div class = \"text-block\">    scale_fill_viridis(discrete = TRUE, begin = 0.1, end = 0.9, option = \"magma\", alpha = 0.8) +<\/div><div class = \"text-block\">    scale_color_viridis(discrete = TRUE, begin = 0.1, end = 0.9) +<\/div><div class = \"text-block\">    theme_bw(base_size = 18) +<\/div><div class = \"text-block\">    ylab(\"Spike-in Alignment Rate\") +<\/div><div class = \"text-block\">    xlab(\"\") +<\/div><div class = \"text-block\">    ggtitle(\"D. Alignment Rate (E.coli)\")<\/div><div class = \"text-block\">ggarrange(fig3A, fig3B, fig3C, fig3D, ncol = 2, nrow=2, common.legend = TRUE, legend=\"bottom\")<\/div><\/div><\/code><\/pre><\/div><div style = \"text-align :; float : ;\"><img style = \"\" src = \"https:\/\/s3.amazonaws.com\/protocols-files\/public\/dc9cd4c53a1d8402112dade227f044fef5ce68005dc6abefaa0d66c259c96a73\/cg88bb8dp.png\" \/><\/div><div class = \"text-block\">In a typical CUT&Tag experiment targeting the abundant H3K27me3 histone modification in 65,000 K562 cells, the percentage of E. coli reads range from ~0.01% to 10%. With fewer cells or less abundant epitopes, E. coli reads can comprise as much as 70% of the total mapped reads. For IgG controls, the percentage of E. coli reads is typically much higher than that for an abundant histone modification.<\/div><\/div>"}},{"id":1054725,"guid":"47FE632F2DB94AEA840C61307094A712","order_id":2,"type_id":1,"title":"description","source":{"description":"<table border><tr style = \"text-align:center;\"><td>  <\/td><td>A<\/td><td>B<\/td><td>C<\/td><td>D<\/td><td>E<\/td><\/tr><tr><td style = \"text-align:center;\">1<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">Histone<fctr><\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">Replicate<chr><\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">SequencingDepth<dbl><\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">MappedFragNum_hg38<dbl><\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">AlignmentRate_hg38<chr><\/td><\/tr><tr><td style = \"text-align:center;\">2<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">K27me3<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">rep1<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">2984630<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">2859520<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">95.81%<\/td><\/tr><tr><td style = \"text-align:center;\">3<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">K27me3<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">rep2<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">2702260<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">2606295<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">96.45%<\/td><\/tr><tr><td style = \"text-align:center;\">4<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">K4me3<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">rep1<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">1581710<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">1494122<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">94.46%<\/td><\/tr><tr><td style = \"text-align:center;\">5<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">K4me3<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">rep2<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">1885056<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">1742005<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">92.41%<\/td><\/tr><tr><td style = \"text-align:center;\">6<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">IgG<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">rep1<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">2127635<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">1747065<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">82.11%<\/td><\/tr><tr><td style = \"text-align:center;\">7<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">IgG<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">rep2<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">2192908<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">1992929<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">90.88%<\/td><\/tr><\/table>"}},{"id":1054726,"guid":"06408E1141134204BA84641C22633EA5","order_id":3,"type_id":1,"title":"description","source":{"description":"<table border><tr style = \"text-align:center;\"><td>  <\/td><td>A<\/td><td>B<\/td><td>C<\/td><td>D<\/td><td>E<\/td><\/tr><tr><td style = \"text-align:center;\">1<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">Histone<fctr><\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">Replicate<chr><\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">SequencingDepth<dbl><\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">MappedFragNum_spikeIn<dbl><\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">AlignmentRate_spikeIn<chr><\/td><\/tr><tr><td style = \"text-align:center;\">2<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">K27me3<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">rep1<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">2984630<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">235<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">0.01%<\/td><\/tr><tr><td style = \"text-align:center;\">3<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">K27me3<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">rep2<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">2702260<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">487<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">0.02%<\/td><\/tr><tr><td style = \"text-align:center;\">4<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">K4me3<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">rep1<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">1581710<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">375<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">0.02%<\/td><\/tr><tr><td style = \"text-align:center;\">5<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">K4me3<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">rep2<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">1885056<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">4442<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">0.24%<\/td><\/tr><tr><td style = \"text-align:center;\">6<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">IgG<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">rep1<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">2127635<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">75733<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">3.56%<\/td><\/tr><tr><td style = \"text-align:center;\">7<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">IgG<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">rep2<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">2192908<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">79123<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">3.61%<\/td><\/tr><\/table>"}},{"id":1054727,"guid":"773C91F0C29648BB9068A58F3886BE1B","order_id":4,"type_id":1,"title":"description","source":{"description":"<table border><tr style = \"text-align:center;\"><td>  <\/td><td>A<\/td><td>B<\/td><td>C<\/td><td>D<\/td><td>E<\/td><td>F<\/td><td>G<\/td><\/tr><tr><td style = \"text-align:center;\">1<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">Histone<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">Replicate<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">SequencingDepth<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">MappedFragNum_hg38<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">AlignmentRate_hg38<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">MappedFragNum_spikeIn<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">AlignmentRate_spikeIn<\/td><\/tr><tr><td style = \"text-align:center;\">2<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">K27me3<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">rep1<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">2984630<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">2859520<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">95.81%<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">235<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">0.01%<\/td><\/tr><tr><td style = \"text-align:center;\">3<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">K27me3<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">rep2<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">2702260<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">2606295<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">96.45%<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">487<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">0.02%<\/td><\/tr><tr><td style = \"text-align:center;\">4<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">K4me3<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">rep1<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">1581710<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">1494122<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">94.46%<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">375<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">0.02%<\/td><\/tr><tr><td style = \"text-align:center;\">5<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">K4me3<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">rep2<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">1885056<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">1742005<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">92.41%<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">4442<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">0.24%<\/td><\/tr><tr><td style = \"text-align:center;\">6<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">IgG<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">rep1<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">2127635<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">1747065<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">82.11%<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">75733<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">3.56%<\/td><\/tr><tr><td style = \"text-align:center;\">7<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">IgG<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">rep2<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">2192908<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">1992929<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">90.88%<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">79123<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">3.61%<\/td><\/tr><\/table>"}},{"id":1054728,"guid":"FFFD128DD10345B1839E3F5212209B83","order_id":5,"type_id":1,"title":"description","source":{"description":"<div style = \"text-align :; float : ;\"><img style = \"\" src = \"https:\/\/s3.amazonaws.com\/protocols-files\/public\/dc9cd4c53a1d8402112dade227f044fef5ce68005dc6abefaa0d66c259c96a73\/cg88bb8dp.png\" \/><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#417505","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1001229,"guid":"A38D2730DC2C11EABA5FF3676F0827C5","previous_id":1001227,"previous_guid":"634E5090DC2C11EABA5FF3676F0827C5","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"D8008B01DAE745A48BC37FCF2255C201","order_id":1,"type_id":6,"title":"Section","source":{"title":"III. Alignment Summary"}},{"id":1054724,"guid":"5057BA157AAC45CE9E1A7955ABC7CFD9","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\"><span style = \"font-weight:bold;\">Remove duplicates [optional] <\/span><\/div><div class = \"text-block\">CUT&Tag integrates adapters into DNA in the vicinity of the antibody-tethered pA-Tn5, and the exact sites of integration are affected by the accessibility of surrounding DNA. For this reason, fragments that share exact starting and ending positions are expected to be common, and such \u2018duplicates\u2019 may not be due to duplication during PCR. In practice, we have found that the apparent duplication rate is low for high-quality CUT&Tag datasets, and even the apparent \u2018duplicate\u2019 fragments are likely to be true fragments. Thus, we do not recommend removing the duplicates. In experiments with very small amounts of material or where PCR duplication is suspected, duplicates can be removed. The following commands show how to check the duplication rate using <\/div><div class = \"text-block\"><a href=\"https:\/\/broadinstitute.github.io\/picard\/\" style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">Picard<\/span><\/a><\/div><div class = \"text-block\">.<\/div><div class = \"text-block\"><pre><code><div class = \"text-blocks\"><div class = \"text-block\">##== linux command ==##<\/div><div class = \"text-block\">## depending on how you load picard and your server environment, the picardCMD can be different. Adjust accordingly.<\/div><div class = \"text-block\">picardCMD=\"java -jar picard.jar\"<\/div><div class = \"text-block\">mkdir -p $projPath\/alignment\/rmDuplicate\/picard_summary<\/div><div class = \"text-block\">## Sort by coordinate<\/div><div class = \"text-block\">$picardCMD SortSam I=$projPath\/alignment\/sam\/${histName}_bowtie2.sam O=$projPath\/alignment\/sam\/${histName}_bowtie2.sorted.sam SORT_ORDER=coordinate<\/div><div class = \"text-block\">## mark duplicates<\/div><div class = \"text-block\">$picardCMD MarkDuplicates I=$projPath\/alignment\/sam\/${histName}_bowtie2.sorted.sam O=$projPath\/alignment\/removeDuplicate\/${histName}_bowtie2.sorted.dupMarked.sam METRICS_FILE=$projPath\/alignment\/removeDuplicate\/picard_summary\/${histName}_picard.dupMark.txt<\/div><div class = \"text-block\">## remove duplicates<\/div><div class = \"text-block\">picardCMD MarkDuplicates I=$projPath\/alignment\/sam\/${histName}_bowtie2.sorted.sam O=$projPath\/alignment\/removeDuplicate\/${histName}_bowtie2.sorted.rmDup.sam REMOVE_DUPLICATES=true METRICS_FILE=$projPath\/alignment\/removeDuplicate\/picard_summary\/${histName}_picard.rmDup.txt<\/div><\/div><\/code><\/pre><\/div><div class = \"text-block\">We summarize the apparent duplication rate and calculate the unique library size without duplicates.<\/div><div class = \"text-block\"><pre><code><div class = \"text-blocks\"><div class = \"text-block\">##=== R command ===## <\/div><div class = \"text-block\">## Summarize the duplication information from the picard summary outputs.<\/div><div class = \"text-block\">dupResult = c()<\/div><div class = \"text-block\">for(hist in sampleList){<\/div><div class = \"text-block\">  dupRes = read.table(paste0(projPath, \"\/alignment\/rmDuplicate\/picard_summary\/\", hist, \"_picard.rmDup.txt\"), header = TRUE, fill = TRUE)<\/div><div class = \"text-block\">  histInfo = strsplit(hist, \"_\")[[1]]<\/div><div class = \"text-block\">  dupResult = data.frame(Histone = histInfo[1], Replicate = histInfo[2], MappedFragNum_hg38 = dupRes$READ_PAIRS_EXAMINED[1] %>% as.character %>% as.numeric, DuplicationRate = dupRes$PERCENT_DUPLICATION[1] %>% as.character %>% as.numeric * 100, EstimatedLibrarySize = dupRes$ESTIMATED_LIBRARY_SIZE[1] %>% as.character %>% as.numeric) %>% mutate(UniqueFragNum = MappedFragNum_hg38 * (1-DuplicationRate\/100))  %>% rbind(dupResult, .)<\/div><div class = \"text-block\">}<\/div><div class = \"text-block\">dupResult$Histone = factor(dupResult$Histone, levels = histList)<\/div><div class = \"text-block\">alignDupSummary = left_join(alignSummary, dupResult, by = c(\"Histone\", \"Replicate\", \"MappedFragNum_hg38\")) %>% mutate(DuplicationRate = paste0(DuplicationRate, \"%\"))<\/div><div class = \"text-block\">alignDupSummary<\/div><\/div><\/code><\/pre><\/div><table border><tr style = \"text-align:center;\"><td>  <\/td><td>A<\/td><td>B<\/td><td>C<\/td><td>D<\/td><td>E<\/td><td>F<\/td><td>G<\/td><td>H<\/td><td>I<\/td><td>J<\/td><\/tr><tr><td style = \"text-align:center;\">1<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">Histone<fctr><\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">Replicate<chr><\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">SequencingDepth<dbl><\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">MappedFragNum_hg38<dbl><\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">AlignmentRate_hg38<chr><\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">MappedFragNum_spikeIn<dbl><\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">AlignmentRate_spikeIn<chr><\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">DuplicationRate<chr><\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">EstimatedLibrarySize<dbl><\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">UniqueFragNum<\/td><\/tr><tr><td style = \"text-align:center;\">2<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">K27me3<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">rep1<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">2984630<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">2859520<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">95.81%<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">235<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">0.01%<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">4.8503%<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">28683768<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">2720824.7<\/td><\/tr><tr><td style = \"text-align:center;\">3<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">K27me3<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">rep2<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">2702260<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">2606295<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">96.45%<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">487<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">0.02%<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">1.0445%<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">125234408<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">2579072.2<\/td><\/tr><tr><td style = \"text-align:center;\">4<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">K4me3<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">rep1<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">1581710<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">1494122<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">94.46%<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">375<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">0.02%<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">6.6056%<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">10843753<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">1395426.3<\/td><\/tr><tr><td style = \"text-align:center;\">5<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">K4me3<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">rep2<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">1885056<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">1742005<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">92.41%<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">4442<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">0.24%<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">2.7026%<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">31790431<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">1694925.6<\/td><\/tr><tr><td style = \"text-align:center;\">6<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">IgG<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">rep1<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">2127635<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">1747065<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">82.11%<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">75733<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">3.56%<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">81.336%<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">327661<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">326072.2<\/td><\/tr><tr><td style = \"text-align:center;\">7<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">IgG<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">rep2<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">2192908<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">1992929<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">90.88%<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">79123<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">3.61%<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">34.3392%<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">2192721<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">1308573.1<\/td><\/tr><\/table><div class = \"text-block\">- In these example datasets, the IgG control samples have relatively high duplication rates, since reads in this sample derive from non-specific tagmentation in the CUT&Tag reactions. Therefore, it is appropriate to remove the duplicates from the IgG datasets before downstream analysis. <\/div><div class = \"text-block\">- The estimated library size is the estimated number of unique molecules in the library based on PE duplication calculated by Picard.<\/div><div class = \"text-block\">- The estimated library sizes are proportional to the abundance of the targeted epitope and to the quality of the antibody used, while the estimated library sizes of IgG samples are expected to be very low.<\/div><div class = \"text-block\">- The unique fragment number is calculated by the MappedFragNum_hg38 * (1-DuplicationRate\/100).<\/div><div class = \"text-block\"><pre><code><div class = \"text-blocks\"><div class = \"text-block\">##=== R command ===## <\/div><div class = \"text-block\">## generate boxplot figure for the  duplication rate<\/div><div class = \"text-block\">fig4A = dupResult %>% ggplot(aes(x = Histone, y = DuplicationRate, fill = Histone)) +<\/div><div class = \"text-block\">    geom_boxplot() +<\/div><div class = \"text-block\">    geom_jitter(aes(color = Replicate), position = position_jitter(0.15)) +<\/div><div class = \"text-block\">    scale_fill_viridis(discrete = TRUE, begin = 0.1, end = 0.9, option = \"magma\", alpha = 0.8) +<\/div><div class = \"text-block\">    scale_color_viridis(discrete = TRUE, begin = 0.1, end = 0.9) +<\/div><div class = \"text-block\">    theme_bw(base_size = 18) +<\/div><div class = \"text-block\">    ylab(\"Duplication Rate (*100%)\") +<\/div><div class = \"text-block\">    xlab(\"\") <\/div><div class = \"text-block\">fig4B = dupResult %>% ggplot(aes(x = Histone, y = EstimatedLibrarySize, fill = Histone)) +<\/div><div class = \"text-block\">    geom_boxplot() +<\/div><div class = \"text-block\">    geom_jitter(aes(color = Replicate), position = position_jitter(0.15)) +<\/div><div class = \"text-block\">    scale_fill_viridis(discrete = TRUE, begin = 0.1, end = 0.9, option = \"magma\", alpha = 0.8) +<\/div><div class = \"text-block\">    scale_color_viridis(discrete = TRUE, begin = 0.1, end = 0.9) +<\/div><div class = \"text-block\">    theme_bw(base_size = 18) +<\/div><div class = \"text-block\">    ylab(\"Estimated Library Size\") +<\/div><div class = \"text-block\">    xlab(\"\") <\/div><div class = \"text-block\">fig4C = dupResult %>% ggplot(aes(x = Histone, y = UniqueFragNum, fill = Histone)) +<\/div><div class = \"text-block\">    geom_boxplot() +<\/div><div class = \"text-block\">    geom_jitter(aes(color = Replicate), position = position_jitter(0.15)) +<\/div><div class = \"text-block\">    scale_fill_viridis(discrete = TRUE, begin = 0.1, end = 0.9, option = \"magma\", alpha = 0.8) +<\/div><div class = \"text-block\">    scale_color_viridis(discrete = TRUE, begin = 0.1, end = 0.9) +<\/div><div class = \"text-block\">    theme_bw(base_size = 18) +<\/div><div class = \"text-block\">    ylab(\"# of Unique Fragments\") +<\/div><div class = \"text-block\">    xlab(\"\")<\/div><div class = \"text-block\">ggarrange(fig4A, fig4B, fig4C, ncol = 3, common.legend = TRUE, legend=\"bottom\")<\/div><\/div><\/code><\/pre><\/div><div style = \"text-align :; float : ;\"><img style = \"\" src = \"https:\/\/s3.amazonaws.com\/protocols-files\/public\/dc9cd4c53a1d8402112dade227f044fef5ce68005dc6abefaa0d66c259c96a73\/cg9ebb8dp.png\" \/><\/div><\/div>"}},{"id":1054725,"guid":"EE3BA802C3134C4992FE91E4EEFF35EF","order_id":2,"type_id":1,"title":"description","source":{"description":"<table border><tr style = \"text-align:center;\"><td>  <\/td><td>A<\/td><td>B<\/td><td>C<\/td><td>D<\/td><td>E<\/td><td>F<\/td><td>G<\/td><td>H<\/td><td>I<\/td><td>J<\/td><\/tr><tr><td style = \"text-align:center;\">1<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">Histone<fctr><\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">Replicate<chr><\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">SequencingDepth<dbl><\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">MappedFragNum_hg38<dbl><\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">AlignmentRate_hg38<chr><\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">MappedFragNum_spikeIn<dbl><\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">AlignmentRate_spikeIn<chr><\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">DuplicationRate<chr><\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">EstimatedLibrarySize<dbl><\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">UniqueFragNum<\/td><\/tr><tr><td style = \"text-align:center;\">2<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">K27me3<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">rep1<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">2984630<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">2859520<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">95.81%<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">235<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">0.01%<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">4.8503%<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">28683768<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">2720824.7<\/td><\/tr><tr><td style = \"text-align:center;\">3<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">K27me3<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">rep2<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">2702260<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">2606295<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">96.45%<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">487<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">0.02%<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">1.0445%<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">125234408<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">2579072.2<\/td><\/tr><tr><td style = \"text-align:center;\">4<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">K4me3<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">rep1<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">1581710<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">1494122<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">94.46%<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">375<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">0.02%<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">6.6056%<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">10843753<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">1395426.3<\/td><\/tr><tr><td style = \"text-align:center;\">5<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">K4me3<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">rep2<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">1885056<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">1742005<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">92.41%<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">4442<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">0.24%<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">2.7026%<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">31790431<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">1694925.6<\/td><\/tr><tr><td style = \"text-align:center;\">6<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">IgG<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">rep1<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">2127635<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">1747065<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">82.11%<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">75733<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">3.56%<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">81.336%<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">327661<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">326072.2<\/td><\/tr><tr><td style = \"text-align:center;\">7<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">IgG<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">rep2<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">2192908<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">1992929<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">90.88%<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">79123<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">3.61%<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">34.3392%<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">2192721<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">1308573.1<\/td><\/tr><\/table>"}},{"id":1054726,"guid":"1CD5B0787C1444CAB46137D4F98C66E2","order_id":3,"type_id":1,"title":"description","source":{"description":"<div style = \"text-align :; float : ;\"><img style = \"\" src = \"https:\/\/s3.amazonaws.com\/protocols-files\/public\/dc9cd4c53a1d8402112dade227f044fef5ce68005dc6abefaa0d66c259c96a73\/cg9ebb8dp.png\" \/><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#417505","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1001230,"guid":"27604B90DC2E11EABA5FF3676F0827C5","previous_id":1001229,"previous_guid":"A38D2730DC2C11EABA5FF3676F0827C5","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"66F5D66D8B014229946257F982C5651D","order_id":1,"type_id":6,"title":"Section","source":{"title":"III. Alignment Summary"}},{"id":1054724,"guid":"00D3BF9486794411BC4F9FCC5DD3E7F3","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\"><span style = \"font-weight:bold;\">Assess mapped fragment size distribution<\/span><\/div><div class = \"text-block\">CUT&Tag inserts adapters on either side of chromatin particles in the vicinity of the tethered enzyme, although tagmentation within chromatin particles can also occur. So, CUT&Tag reactions targeting a histone modification predominantly results in fragments that are nucleosomal lengths (~180 bp), or multiples of that length. CUT&Tag targeting transcription factors predominantly produce nucleosome-sized fragments and variable amounts of shorter fragments, from neighboring nucleosomes and the factor-bound site, respectively. Tagmentation of DNA on the surface of nucleosomes also occurs, and plotting fragment lengths with single-basepair resolution reveal a 10-bp sawtooth periodicity, which is typical of successful CUT&Tag experiments.<\/div><div class = \"text-block\"><pre><code><div class = \"text-blocks\"><div class = \"text-block\">##== linux command ==##<\/div><div class = \"text-block\">mkdir -p $projPath\/alignment\/sam\/fragmentLen<\/div><div class = \"text-block\">## Extract the 9th column from the alignment sam file which is the fragment length<\/div><div class = \"text-block\">samtools view -F 0x04 $projPath\/alignment\/sam\/${histName}_bowtie2.sam | awk -F'\\t' 'function abs(x){return ((x < 0.0) ? -x : x)} {print abs($9)}' | sort | uniq -c | awk -v OFS=\"\\t\" '{print $2, $1\/2}' >$projPath\/alignment\/sam\/fragmentLen\/${histName}_fragmentLen.txt<\/div><\/div><\/code><\/pre><\/div><div class = \"text-block\"><pre><code><div class = \"text-blocks\"><div class = \"text-block\">##=== R command ===## <\/div><div class = \"text-block\">## Collect the fragment size information<\/div><div class = \"text-block\">fragLen = c()<\/div><div class = \"text-block\">for(hist in sampleList){<\/div><div class = \"text-block\">  histInfo = strsplit(hist, \"_\")[[1]]<\/div><div class = \"text-block\">  fragLen = read.table(paste0(projPath, \"\/alignment\/sam\/fragmentLen\/\", hist, \"_fragmentLen.txt\"), header = FALSE) %>% mutate(fragLen = V1 %>% as.numeric, fragCount = V2 %>% as.numeric, Weight = as.numeric(V2)\/sum(as.numeric(V2)), Histone = histInfo[1], Replicate = histInfo[2], sampleInfo = hist) %>% rbind(fragLen, .) <\/div><div class = \"text-block\">}<\/div><div class = \"text-block\">fragLen$sampleInfo = factor(fragLen$sampleInfo, levels = sampleList)<\/div><div class = \"text-block\">fragLen$Histone = factor(fragLen$Histone, levels = histList)<\/div><div class = \"text-block\">## Generate the fragment size density plot (violin plot)<\/div><div class = \"text-block\">fig5A = fragLen %>% ggplot(aes(x = sampleInfo, y = fragLen, weight = Weight, fill = Histone)) +<\/div><div class = \"text-block\">    geom_violin(bw = 5) +<\/div><div class = \"text-block\">    scale_y_continuous(breaks = seq(0, 800, 50)) +<\/div><div class = \"text-block\">    scale_fill_viridis(discrete = TRUE, begin = 0.1, end = 0.9, option = \"magma\", alpha = 0.8) +<\/div><div class = \"text-block\">    scale_color_viridis(discrete = TRUE, begin = 0.1, end = 0.9) +<\/div><div class = \"text-block\">    theme_bw(base_size = 20) +<\/div><div class = \"text-block\">    ggpubr::rotate_x_text(angle = 20) +<\/div><div class = \"text-block\">    ylab(\"Fragment Length\") +<\/div><div class = \"text-block\">    xlab(\"\")<\/div><div class = \"text-block\">fig5B = fragLen %>% ggplot(aes(x = fragLen, y = fragCount, color = Histone, group = sampleInfo, linetype = Replicate)) +<\/div><div class = \"text-block\">  geom_line(size = 1) +<\/div><div class = \"text-block\">  scale_color_viridis(discrete = TRUE, begin = 0.1, end = 0.9, option = \"magma\") +<\/div><div class = \"text-block\">  theme_bw(base_size = 20) +<\/div><div class = \"text-block\">  xlab(\"Fragment Length\") +<\/div><div class = \"text-block\">  ylab(\"Count\") +<\/div><div class = \"text-block\">  coord_cartesian(xlim = c(0, 500))<\/div><div class = \"text-block\">ggarrange(fig5A, fig5B, ncol = 2)<\/div><\/div><\/code><\/pre><\/div><div style = \"text-align :; float : ;\"><img style = \"\" src = \"https:\/\/s3.amazonaws.com\/protocols-files\/public\/dc9cd4c53a1d8402112dade227f044fef5ce68005dc6abefaa0d66c259c96a73\/cg9gbb8dp.png\" \/><\/div><div class = \"text-block\">- The smaller fragments (50-100 bp) can be due to that tethered Tn5 can tagment on the surface of a nucleosome as well as in linker regions, so the small fragments might not be the background.<\/div><\/div>"}},{"id":1054725,"guid":"EAFCB24E17CF4B36A96985DCF110695C","order_id":2,"type_id":1,"title":"description","source":{"description":"<div style = \"text-align :; float : ;\"><img style = \"\" src = \"https:\/\/s3.amazonaws.com\/protocols-files\/public\/dc9cd4c53a1d8402112dade227f044fef5ce68005dc6abefaa0d66c259c96a73\/cg9gbb8dp.png\" \/><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#417505","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1001240,"guid":"C1B74040DC2E11EABA5FF3676F0827C5","previous_id":1001230,"previous_guid":"27604B90DC2E11EABA5FF3676F0827C5","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"9CB43B65FDE844549935513C27A1C40E","order_id":1,"type_id":6,"title":"Section","source":{"title":"III. Alignment Summary"}},{"id":1054724,"guid":"6493285055DA46819745E05B46DAAEB3","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\"><span style = \"font-weight:bold;\">Assess replicate reproducibility<\/span><\/div><div class = \"text-block\">Data reproducibility between replicates is assessed by correlation analysis of mapped read counts across the genome. For the simplicity of implementation, we will postpone this analysis after Section IV when the file format has been converted into fragment bed files.<\/div><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#417505","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1001242,"guid":"EC4829A0DC2E11EABA5FF3676F0827C5","previous_id":1001240,"previous_guid":"C1B74040DC2E11EABA5FF3676F0827C5","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"754707ED37EA43B2B7299E5BD38CA9A2","order_id":1,"type_id":6,"title":"Section","source":{"title":"IV. Alignment filtering and file format conversion"}},{"id":1054724,"guid":"F26A87FF08CA47399C1BC86CA38CEA41","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\"><span style = \"font-weight:bold;\">Filtering mapped reads by the mapping quality filtering [optinal]<\/span><\/div><div class = \"text-block\">Some projects may require more stringent filtering on the alignment quality score. This <\/div><div class = \"text-block\"><a href=\"http:\/\/biofinysics.blogspot.com\/2014\/05\/how-does-bowtie2-assign-mapq-scores.html\" style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">blog<\/span><\/a><\/div><div class = \"text-block\"> detailedly discussed how does bowtie assign quality score with examples.<\/div><div class = \"text-block\"><span>MAPQ(x) = -10 * log<\/span><span style = \"vertical-align:sub;\">10<\/span><span>P(x is mapped wrongly) = -10 * log<\/span><span style = \"vertical-align:sub;\">10<\/span><span>(p)<\/span><\/div><div class = \"text-block\">which ranges from 0 to 37, 40 or 42.<\/div><div class = \"text-block\"><pre><code><div class = \"text-blocks\"><div class = \"text-block\">samtools view -q minQualityScore<\/div><\/div><\/code><\/pre><\/div><div class = \"text-block\"> will eliminate all the alignment results that are below the minQualityScore defined by user.<\/div><div class = \"text-block\"><pre><code><div class = \"text-blocks\"><div class = \"text-block\">##== linux command ==##<\/div><div class = \"text-block\">minQualityScore=2<\/div><div class = \"text-block\">samtools view -q $minQualityScore ${projPath}\/alignment\/sam\/${histName}_bowtie2.sam >${projPath}\/alignment\/sam\/${histName}_bowtie2.qualityScore$minQualityScore.sam<\/div><\/div><\/code><\/pre><\/div><div class = \"text-block\"><span>- If you do implement this filtering, please replace the <\/span><span style = \"font-weight:bold;\">${histName}_bowtie2.sam<\/span><span> in the following steps by this filtered sam file <\/span><span style = \"font-weight:bold;\">${histName}_bowtie2.qualityScore$minQualityScore.sam<\/span><span style = \"font-weight:bold;\">.<\/span><\/div><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#94EBFF","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1001243,"guid":"C1E78290DC2F11EABA5FF3676F0827C5","previous_id":1001242,"previous_guid":"EC4829A0DC2E11EABA5FF3676F0827C5","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"BD4C8F47D3874DDB9748C25879AE1F7D","order_id":1,"type_id":6,"title":"Section","source":{"title":"IV. Alignment filtering and file format conversion"}},{"id":1054724,"guid":"B9B9D7EE949E43839174CC31331CEB28","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\"><span style = \"font-weight:bold;\">File format conversion<\/span><\/div><div class = \"text-block\"><span>This section is <\/span><span style = \"font-weight:bold;\">required<\/span><span> in preparation for the peak calling and visualization where there are a few filtering and file format conversion that need to be done.<\/span><\/div><div class = \"text-block\"><pre><code><div class = \"text-blocks\"><div class = \"text-block\">##== linux command ==##<\/div><div class = \"text-block\">## Filter and keep the mapped read pairs<\/div><div class = \"text-block\">samtools view -bS -F 0x04 $projPath\/alignment\/sam\/${histName}_bowtie2.sam $projPath\/alignment\/bam\/${histName}_bowtie2.mapped.bam<\/div><div class = \"text-block\">## Convert into bed file format<\/div><div class = \"text-block\">bedtools bamtobed -i $projPath\/alignment\/bam\/${histName}_bowtie2.mapped.bam -bedpe $projPath\/alignment\/bed\/${histName}_bowtie2.bed<\/div><div class = \"text-block\">## Keep the read pairs that are on the same chromosome and fragment length less than 1000bp.<\/div><div class = \"text-block\">awk '$1==$4 && $6-$2 < 1000 {print $0}' $projPath\/alignment\/bed\/${histName}_bowtie2.bed $projPath\/alignment\/bed\/${histName}_bowtie2.clean.bed<\/div><div class = \"text-block\">## Only extract the fragment related columns<\/div><div class = \"text-block\">cut -f 1,2,6 $projPath\/alignment\/bed\/${histName}_bowtie2.clean.bed | sort -k1,1 -k2,2n -k3,3n  >$projPath\/alignment\/bed\/${histName}_bowtie2.fragments.bed<\/div><\/div><\/code><\/pre><\/div><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#94EBFF","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1001245,"guid":"FEAA9FF0DC2F11EABA5FF3676F0827C5","previous_id":1001243,"previous_guid":"C1E78290DC2F11EABA5FF3676F0827C5","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"CE44CB747A9B4CC1BFDE4649F3B531B0","order_id":1,"type_id":6,"title":"Section","source":{"title":"IV. Alignment filtering and file format conversion"}},{"id":1054724,"guid":"035F1D27FD844CE681C90C4981028A7F","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\"><span style = \"font-weight:bold;\">Assess replicate reproducibility (continue step 12.4)<\/span><\/div><div class = \"text-block\">To study the reproducibility between replicates and across conditions, the genome is split into 500 bp bins, and a Pearson correlation of the log2-transformed values of read counts in each bin is calculated between replicate datasets. Multiple replicates and IgG control datasets are displayed in a hierarchically clustered correlation matrix. <\/div><div class = \"text-block\"><pre><code><div class = \"text-blocks\"><div class = \"text-block\">##== linux command ==##<\/div><div class = \"text-block\">## We use the mid point of each fragment to infer which 500bp bins does this fragment belong to.<\/div><div class = \"text-block\">binLen=500<\/div><div class = \"text-block\">awk -v w=$binLen '{print $1, int(($2 + $3)\/(2*w))*w + w\/2}' $projPath\/alignment\/bed\/${histName}_bowtie2.fragments.bed | sort -k1,1V -k2,2n | uniq -c | awk -v OFS=\"\\t\" '{print $2, $3, $1}' |  sort -k1,1V -k2,2n  >$projPath\/alignment\/bed\/${histName}_bowtie2.fragmentsCount.bin$binLen.bed<\/div><\/div><\/code><\/pre><\/div><div class = \"text-block\"><pre><code><div class = \"text-blocks\"><div class = \"text-block\">##== R command ==##<\/div><div class = \"text-block\">reprod = c()<\/div><div class = \"text-block\">fragCount = NULL<\/div><div class = \"text-block\">for(hist in sampleList){<\/div><div class = \"text-block\">  if(is.null(fragCount)){<\/div><div class = \"text-block\">    fragCount = read.table(paste0(projPath, \"\/alignment\/bed\/\", hist, \"_bowtie2.fragmentsCount.bin500.bed\"), header = FALSE) <\/div><div class = \"text-block\">    colnames(fragCount) = c(\"chrom\", \"bin\", hist)<\/div><div class = \"text-block\">  }else{<\/div><div class = \"text-block\">    fragCountTmp = read.table(paste0(projPath, \"\/alignment\/bed\/\", hist, \"_bowtie2.fragmentsCount.bin500.bed\"), header = FALSE)<\/div><div class = \"text-block\">    colnames(fragCountTmp) = c(\"chrom\", \"bin\", hist)<\/div><div class = \"text-block\">    fragCount = full_join(fragCount, fragCountTmp, by = c(\"chrom\", \"bin\"))<\/div><div class = \"text-block\">  }<\/div><div class = \"text-block\">}<\/div><div class = \"text-block\">M = cor(fragCount %>% select(-c(\"chrom\", \"bin\")) %>% log2(), use = \"complete.obs\") <\/div><div class = \"text-block\">corrplot(M, method = \"color\", outline = T, addgrid.col = \"darkgray\", order=\"hclust\", addrect = 3, rect.col = \"black\", rect.lwd = 3,cl.pos = \"b\", tl.col = \"indianred4\", tl.cex = 1, cl.cex = 1, addCoef.col = \"black\", number.digits = 2, number.cex = 1, col = colorRampPalette(c(\"midnightblue\",\"white\",\"darkred\"))(100))<\/div><\/div><\/code><\/pre><\/div><div style = \"text-align :; float : ;\"><img style = \"\" src = \"https:\/\/s3.amazonaws.com\/protocols-files\/public\/dc9cd4c53a1d8402112dade227f044fef5ce68005dc6abefaa0d66c259c96a73\/cg9ibb8dp.png\" \/><\/div><\/div>"}},{"id":1054725,"guid":"64DD980297174DF69C126C2366451796","order_id":2,"type_id":1,"title":"description","source":{"description":"<div style = \"text-align :; float : ;\"><img style = \"\" src = \"https:\/\/s3.amazonaws.com\/protocols-files\/public\/dc9cd4c53a1d8402112dade227f044fef5ce68005dc6abefaa0d66c259c96a73\/cg9ibb8dp.png\" \/><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#94EBFF","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1001247,"guid":"4A3D8C70DC3011EABA5FF3676F0827C5","previous_id":1001245,"previous_guid":"FEAA9FF0DC2F11EABA5FF3676F0827C5","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"830BCA4ABE364C51BBBAF614A380FE61","order_id":1,"type_id":6,"title":"Section","source":{"title":"V. Spike-in calibration"}},{"id":1054724,"guid":"C0FE6F67B75F4AC0A7F5BE35B97CE623","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\"><span style = \"font-weight:bold;\">Spike-in calibration<\/span><\/div><div class = \"text-block\"><span>This section is <\/span><span style = \"font-weight:bold;\">optional<\/span><span> but <\/span><span style = \"font-weight:bold;\">recommended<\/span><span> depending on your experimental protocol. We have shown the alignment to the spike-in genome in step 10 and the spike-in alignment summary in step 12.<\/span><\/div><div class = \"text-block\">The underlying assumption is that the ratio of fragments mapped to the primary genome to the E. coli genome is the same for a series of samples, each using the same number of cells. Because of this assumption, we do not normalize between experiments or between batches of purified pATn5, which can have very different amounts of carry-over E. coli DNA. Using a constant C to avoid small fractions in normalized data, we define a scaling factor S as <\/div><div class = \"text-block\"><pre><code><div class = \"text-blocks\"><div class = \"text-block\">S = C \/ (fragments_mapped_to_E. coli_genome)<\/div><\/div><\/code><\/pre><\/div><div class = \"text-block\">Normalized coverage is then calculated as:<\/div><div class = \"text-block\"><pre><code><div class = \"text-blocks\"><div class = \"text-block\">Normalized coverage = (primary_genome_coverage) * S<\/div><\/div><\/code><\/pre><\/div><div class = \"text-block\">The Constant is an arbitrary multiplier, typically 10,000. The resulting file will be comparatively small as a genomic coverage bedGraph file.<\/div><div class = \"text-block\"><pre><code><div class = \"text-blocks\"><div class = \"text-block\">##== linux command ==##<\/div><div class = \"text-block\">if [[ \"$seqDepth\" -gt \"1\" ]]; then<\/div><div class = \"text-block\">    mkdir -p $projPath\/alignment\/bedgraph<\/div><div class = \"text-block\">    scale_factor=`echo \"10000 \/ $seqDepth\" | bc -l`<\/div><div class = \"text-block\">    echo \"Scaling factor for $histName is: $scale_factor!\"<\/div><div class = \"text-block\">    bedtools genomecov -bg -scale $scale_factor -i $projPath\/alignment\/bed\/${histName}_bowtie2.fragments.bed -g $chromSize > $projPath\/alignment\/bedgraph\/${histName}_bowtie2.fragments.normalized.bedgraph<\/div><div class = \"text-block\">fi<\/div><\/div><\/code><\/pre><\/div><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#84CE84","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1001249,"guid":"D86EC360DC3011EABA5FF3676F0827C5","previous_id":1001247,"previous_guid":"4A3D8C70DC3011EABA5FF3676F0827C5","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"A222E312DF13494DA1D04527E6C42DC4","order_id":1,"type_id":6,"title":"Section","source":{"title":"V. Spike-in calibration"}},{"id":1054724,"guid":"C04BD3BD92E94E24BEC6C4526B0DFE94","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\"><span style = \"font-weight:bold;\">Scaling factor<\/span><\/div><div class = \"text-block\"><pre><code><div class = \"text-blocks\"><div class = \"text-block\">##=== R command ===## <\/div><div class = \"text-block\">scaleFactor = c()<\/div><div class = \"text-block\">multiplier = 10000<\/div><div class = \"text-block\">for(hist in sampleList){<\/div><div class = \"text-block\">  spikeDepth = read.table(paste0(projPath, \"\/alignment\/sam\/bowtie2_summary\/\", hist, \"_bowtie2_spikeIn.seqDepth\"), header = FALSE, fill = TRUE)$V1[1]<\/div><div class = \"text-block\">  histInfo = strsplit(hist, \"_\")[[1]]<\/div><div class = \"text-block\">  scaleFactor = data.frame(scaleFactor = multiplier\/spikeDepth, Histone = histInfo[1], Replicate = histInfo[2])  %>% rbind(scaleFactor, .)<\/div><div class = \"text-block\">}<\/div><div class = \"text-block\">scaleFactor$Histone = factor(scaleFactor$Histone, levels = histList)<\/div><div class = \"text-block\">left_join(alignDupSummary, scaleFactor, by = c(\"Histone\", \"Replicate\"))<\/div><\/div><\/code><\/pre><\/div><table border><tr style = \"text-align:center;\"><td>  <\/td><td>A<\/td><td>B<\/td><td>C<\/td><td>D<\/td><td>E<\/td><td>F<\/td><td>G<\/td><td>H<\/td><td>I<\/td><td>J<\/td><td>K<\/td><\/tr><tr><td style = \"text-align:center;\">1<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">Histone<fctr><\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">Replicate<chr><\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">SequencingDepth<dbl><\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">MappedFragNum_hg38<dbl><\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">AlignmentRate_hg38<chr><\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">MappedFragNum_spikeIn<dbl><\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">AlignmentRate_spikeIn<chr><\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">DuplicationRate<chr><\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">EstimatedLibrarySize<dbl><\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">UniqueFragNum<dbl><\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">scaleFactor<dbl><\/td><\/tr><tr><td style = \"text-align:center;\">2<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">K27me3<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">rep1<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">2984630<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">2859520<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">95.81%<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">235<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">0.01%<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">4.8503%<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">28683768<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">2720824.7<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">42.5531915<\/td><\/tr><tr><td style = \"text-align:center;\">3<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">K27me3<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">rep2<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">2702260<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">2606295<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">96.45%<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">487<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">0.02%<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">1.0445%<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">125234408<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">2579072.2<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">20.5338809<\/td><\/tr><tr><td style = \"text-align:center;\">4<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">K4me3<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">rep1<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">1581710<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">1494122<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">94.46%<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">375<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">0.02%<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">6.6056%<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">10843753<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">1395426.3<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">26.6666667<\/td><\/tr><tr><td style = \"text-align:center;\">5<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">K4me3<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">rep2<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">1885056<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">1742005<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">92.41%<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">4442<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">0.24%<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">2.7026%<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">31790431<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">1694925.6<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">2.2512382<\/td><\/tr><tr><td style = \"text-align:center;\">6<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">IgG<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">rep1<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">2127635<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">1747065<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">82.11%<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">75733<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">3.56%<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">81.336%<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">327661<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">326072.2<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">0.1320428<\/td><\/tr><tr><td style = \"text-align:center;\">7<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">IgG<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">rep2<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">2192908<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">1992929<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">90.88%<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">79123<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">3.61%<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">34.3392%<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">2192721<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">1308573.1<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">0.1263855<\/td><\/tr><\/table><div class = \"text-block\"><pre><code><div class = \"text-blocks\"><div class = \"text-block\">##=== R command ===##<\/div><div class = \"text-block\">## Generate sequencing depth boxplot<\/div><div class = \"text-block\">fig6A = scaleFactor %>% ggplot(aes(x = Histone, y = scaleFactor, fill = Histone)) +<\/div><div class = \"text-block\">    geom_boxplot() +<\/div><div class = \"text-block\">    geom_jitter(aes(color = Replicate), position = position_jitter(0.15)) +<\/div><div class = \"text-block\">    scale_fill_viridis(discrete = TRUE, begin = 0.1, end = 0.9, option = \"magma\", alpha = 0.8) +<\/div><div class = \"text-block\">    scale_color_viridis(discrete = TRUE, begin = 0.1, end = 0.9) +<\/div><div class = \"text-block\">    theme_bw(base_size = 20) +<\/div><div class = \"text-block\">    ylab(\"Spike-in Scalling Factor\") +<\/div><div class = \"text-block\">    xlab(\"\")<\/div><div class = \"text-block\">normDepth = inner_join(scaleFactor, alignResult, by = c(\"Histone\", \"Replicate\")) %>% mutate(normDepth = MappedFragNum_hg38 * scaleFactor)<\/div><div class = \"text-block\">fig6B = normDepth %>% ggplot(aes(x = Histone, y = normDepth, fill = Histone)) +<\/div><div class = \"text-block\">    geom_boxplot() +<\/div><div class = \"text-block\">    geom_jitter(aes(color = Replicate), position = position_jitter(0.15)) +<\/div><div class = \"text-block\">    scale_fill_viridis(discrete = TRUE, begin = 0.1, end = 0.9, option = \"magma\", alpha = 0.8) +<\/div><div class = \"text-block\">    scale_color_viridis(discrete = TRUE, begin = 0.1, end = 0.9) +<\/div><div class = \"text-block\">    theme_bw(base_size = 20) +<\/div><div class = \"text-block\">    ylab(\"Normalization Fragment Count\") +<\/div><div class = \"text-block\">    xlab(\"\") + <\/div><div class = \"text-block\">    coord_cartesian(ylim = c(1000000, 130000000))<\/div><div class = \"text-block\">ggarrange(fig6A, fig6B, ncol = 2, common.legend = TRUE, legend=\"bottom\")<\/div><\/div><\/code><\/pre><\/div><div style = \"text-align :; float : ;\"><img style = \"\" src = \"https:\/\/s3.amazonaws.com\/protocols-files\/public\/dc9cd4c53a1d8402112dade227f044fef5ce68005dc6abefaa0d66c259c96a73\/cg9kbb8dp.png\" \/><\/div><\/div>"}},{"id":1054725,"guid":"5FF9D125795D449BB8E54B3D3D8E1570","order_id":2,"type_id":1,"title":"description","source":{"description":"<table border><tr style = \"text-align:center;\"><td>  <\/td><td>A<\/td><td>B<\/td><td>C<\/td><td>D<\/td><td>E<\/td><td>F<\/td><td>G<\/td><td>H<\/td><td>I<\/td><td>J<\/td><td>K<\/td><\/tr><tr><td style = \"text-align:center;\">1<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">Histone<fctr><\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">Replicate<chr><\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">SequencingDepth<dbl><\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">MappedFragNum_hg38<dbl><\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">AlignmentRate_hg38<chr><\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">MappedFragNum_spikeIn<dbl><\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">AlignmentRate_spikeIn<chr><\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">DuplicationRate<chr><\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">EstimatedLibrarySize<dbl><\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">UniqueFragNum<dbl><\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">scaleFactor<dbl><\/td><\/tr><tr><td style = \"text-align:center;\">2<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">K27me3<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">rep1<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">2984630<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">2859520<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">95.81%<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">235<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">0.01%<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">4.8503%<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">28683768<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">2720824.7<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">42.5531915<\/td><\/tr><tr><td style = \"text-align:center;\">3<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">K27me3<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">rep2<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">2702260<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">2606295<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">96.45%<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">487<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">0.02%<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">1.0445%<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">125234408<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">2579072.2<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">20.5338809<\/td><\/tr><tr><td style = \"text-align:center;\">4<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">K4me3<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">rep1<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">1581710<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">1494122<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">94.46%<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">375<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">0.02%<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">6.6056%<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">10843753<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">1395426.3<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">26.6666667<\/td><\/tr><tr><td style = \"text-align:center;\">5<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">K4me3<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">rep2<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">1885056<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">1742005<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">92.41%<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">4442<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">0.24%<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">2.7026%<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">31790431<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">1694925.6<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">2.2512382<\/td><\/tr><tr><td style = \"text-align:center;\">6<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">IgG<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">rep1<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">2127635<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">1747065<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">82.11%<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">75733<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">3.56%<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">81.336%<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">327661<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">326072.2<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">0.1320428<\/td><\/tr><tr><td style = \"text-align:center;\">7<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">IgG<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">rep2<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">2192908<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">1992929<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">90.88%<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">79123<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">3.61%<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">34.3392%<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">2192721<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">1308573.1<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">0.1263855<\/td><\/tr><\/table>"}},{"id":1054726,"guid":"FD5E2E8F254347E8BE1E028A388E19BA","order_id":3,"type_id":1,"title":"description","source":{"description":"<div style = \"text-align :; float : ;\"><img style = \"\" src = \"https:\/\/s3.amazonaws.com\/protocols-files\/public\/dc9cd4c53a1d8402112dade227f044fef5ce68005dc6abefaa0d66c259c96a73\/cg9kbb8dp.png\" \/><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#84CE84","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1001250,"guid":"75857450DC3111EABA5FF3676F0827C5","previous_id":1001249,"previous_guid":"D86EC360DC3011EABA5FF3676F0827C5","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"1C2028ED9AF54E27942743CDBBBA1E20","order_id":1,"type_id":6,"title":"Section","source":{"title":"VI. Peak calling"}},{"id":1054724,"guid":"E39EA297030A4DA5B84DA7C79D563A36","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\"><span style = \"font-weight:bold;\">SEACR<\/span><\/div><div class = \"text-block\">The Sparse Enrichment Analysis for CUT&RUN, <\/div><div class = \"text-block\"><a href=\"https:\/\/github.com\/FredHutch\/SEACR\/\" style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">SEACR<\/span><\/a><\/div><div class = \"text-block\"> package is designed to call peaks and enriched regions from chromatin profiling data with very low backgrounds (i.e., regions with no read coverage) that are typical for CUT&Tag chromatin profiling experiments. SEACR requires bedGraph files from paired-end sequencing as input and defines peaks as contiguous blocks of basepair coverage that do not overlap with blocks of background signal delineated in the IgG control dataset. SEACR is effective for calling both narrow peaks from factor binding sites and broad domains characteristic of some histone modifications. The description of the method is published at <\/div><div class = \"text-block\"><a href=\"https:\/\/epigeneticsandchromatin.biomedcentral.com\/articles\/10.1186\/s13072-019-0287-4\" style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">Meers et al. 2019<\/span><\/a><\/div><div class = \"text-block\"> and the user\u2019s manual is available on GitHub at  Since we have normalized fragment counts with the E. coli read count, we set the normalization option of SEACR to \u201cnon\u201d. Otherwise, the \u201cnorm\u201d is recommended.<\/div><div class = \"text-block\"><pre><code><div class = \"text-blocks\"><div class = \"text-block\">##== linux command ==##<\/div><div class = \"text-block\">seacr=\"\/fh\/fast\/gottardo_r\/yezheng_working\/Software\/SEACR\/SEACR_1.3.sh\"<\/div><div class = \"text-block\">histControl=$2<\/div><div class = \"text-block\">mkdir -p $projPath\/peakCalling\/SEACR<\/div><div class = \"text-block\">bash $seacr $projPath\/alignment\/bedgraph\/${histName}_bowtie2.fragments.normalized.bedgraph \\<\/div><div class = \"text-block\">     $projPath\/alignment\/bedgraph\/${histControl}_bowtie2.fragments.normalized.bedgraph \\<\/div><div class = \"text-block\">     non stringent $projPath\/peakCalling\/SEACR\/${histName}_seacr_control.peaks<\/div><div class = \"text-block\">bash $seacr $projPath\/alignment\/bedgraph\/${histName}_bowtie2.fragments.normalized.bedgraph 0.01 non stringent $projPath\/peakCalling\/SEACR\/${histName}_seacr_top0.01.peaks<\/div><\/div><\/code><\/pre><\/div><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#FFED92","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1001251,"guid":"E6FF2310DC3111EABA5FF3676F0827C5","previous_id":1001250,"previous_guid":"75857450DC3111EABA5FF3676F0827C5","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"057F9EB2E2234A568C18182C47530197","order_id":1,"type_id":6,"title":"Section","source":{"title":"VI. Peak calling"}},{"id":1054724,"guid":"4C5458D2AECA4231852BAEF97C231A80","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\"><span style = \"font-weight:bold;\">Number of peaks<\/span><\/div><div class = \"text-block\"><pre><code><div class = \"text-blocks\"><div class = \"text-block\">##=== R command ===## <\/div><div class = \"text-block\">peakN = c()<\/div><div class = \"text-block\">peakWidth = c()<\/div><div class = \"text-block\">peakType = c(\"control\", \"top0.01\")<\/div><div class = \"text-block\">for(hist in sampleList){<\/div><div class = \"text-block\">  histInfo = strsplit(hist, \"_\")[[1]]<\/div><div class = \"text-block\">  if(histInfo[1] != \"IgG\"){<\/div><div class = \"text-block\">    for(type in peakType){<\/div><div class = \"text-block\">      peakInfo = read.table(paste0(projPath, \"\/peakCalling\/SEACR\/\", hist, \"_seacr_\", type, \".peaks.stringent.bed\"), header = FALSE, fill = TRUE)  %>% mutate(width = abs(V3-V2))<\/div><div class = \"text-block\">      peakN = data.frame(peakN = nrow(peakInfo), peakType = type, Histone = histInfo[1], Replicate = histInfo[2]) %>% rbind(peakN, .)<\/div><div class = \"text-block\">      peakWidth = data.frame(width = peakInfo$width, peakType = type, Histone = histInfo[1], Replicate = histInfo[2])  %>% rbind(peakWidth, .)<\/div><div class = \"text-block\">    }<\/div><div class = \"text-block\">  }<\/div><div class = \"text-block\">}<\/div><div class = \"text-block\">peakN %>% select(Histone, Replicate, peakType, peakN)<\/div><\/div><\/code><\/pre><\/div><table border><tr style = \"text-align:center;\"><td>  <\/td><td>A<\/td><td>B<\/td><td>C<\/td><td>D<\/td><\/tr><tr><td style = \"text-align:center;\">1<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">Histone<chr><\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">Replicate<chr><\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">peakType<chr><\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">peakN<int><\/td><\/tr><tr><td style = \"text-align:center;\">2<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">K27me3<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">rep1<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">control<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">144906<\/td><\/tr><tr><td style = \"text-align:center;\">3<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">K27me3<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">rep1<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">top0.01<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">5829<\/td><\/tr><tr><td style = \"text-align:center;\">4<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">K27me3<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">rep2<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">control<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">74444<\/td><\/tr><tr><td style = \"text-align:center;\">5<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">K27me3<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">rep2<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">top0.01<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">9642<\/td><\/tr><tr><td style = \"text-align:center;\">6<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">K4me3<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">rep1<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">control<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">8709<\/td><\/tr><tr><td style = \"text-align:center;\">7<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">K4me3<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">rep1<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">top0.01<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">878<\/td><\/tr><tr><td style = \"text-align:center;\">8<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">K4me3<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">rep2<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">control<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">8190<\/td><\/tr><tr><td style = \"text-align:center;\">9<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">K4me3<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">rep2<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">top0.01<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">3724<\/td><\/tr><\/table><\/div>"}},{"id":1054725,"guid":"2FB02BBA56D84B0EBE2A20149B65ACEF","order_id":2,"type_id":1,"title":"description","source":{"description":"<table border><tr style = \"text-align:center;\"><td>  <\/td><td>A<\/td><td>B<\/td><td>C<\/td><td>D<\/td><\/tr><tr><td style = \"text-align:center;\">1<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">Histone<chr><\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">Replicate<chr><\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">peakType<chr><\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">peakN<int><\/td><\/tr><tr><td style = \"text-align:center;\">2<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">K27me3<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">rep1<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">control<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">144906<\/td><\/tr><tr><td style = \"text-align:center;\">3<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">K27me3<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">rep1<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">top0.01<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">5829<\/td><\/tr><tr><td style = \"text-align:center;\">4<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">K27me3<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">rep2<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">control<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">74444<\/td><\/tr><tr><td style = \"text-align:center;\">5<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">K27me3<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">rep2<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">top0.01<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">9642<\/td><\/tr><tr><td style = \"text-align:center;\">6<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">K4me3<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">rep1<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">control<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">8709<\/td><\/tr><tr><td style = \"text-align:center;\">7<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">K4me3<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">rep1<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">top0.01<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">878<\/td><\/tr><tr><td style = \"text-align:center;\">8<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">K4me3<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">rep2<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">control<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">8190<\/td><\/tr><tr><td style = \"text-align:center;\">9<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">K4me3<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">rep2<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">top0.01<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">3724<\/td><\/tr><\/table>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#FFED92","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1001252,"guid":"0798A060DC3211EABA5FF3676F0827C5","previous_id":1001251,"previous_guid":"E6FF2310DC3111EABA5FF3676F0827C5","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"03ECF2B644B3402E9AFF732E2FDDF636","order_id":1,"type_id":6,"title":"Section","source":{"title":"VI. Peak calling"}},{"id":1054724,"guid":"33179BE31256439F8D21EB6556E30AD7","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\"><span style = \"font-weight:bold;\">Reproducibility of the peak across biological replicates<\/span><\/div><div class = \"text-block\">Peak calling on replicate datasets is compared to define reproducible peaks. The top 1% of peaks (ranked by total signal in each block) are selected as high-confidence sites. <\/div><div class = \"text-block\"><pre><code><div class = \"text-blocks\"><div class = \"text-block\">##=== R command ===## <\/div><div class = \"text-block\">histL = c(\"K27me3\", \"K4me3\")<\/div><div class = \"text-block\">repL = paste0(\"rep\", 1:2)<\/div><div class = \"text-block\">peakType = c(\"control\", \"top0.01\")<\/div><div class = \"text-block\">peakOverlap = c()<\/div><div class = \"text-block\">for(type in peakType){<\/div><div class = \"text-block\">  for(hist in histL){<\/div><div class = \"text-block\">    overlap.gr = GRanges()<\/div><div class = \"text-block\">    for(rep in repL){<\/div><div class = \"text-block\">      peakInfo = read.table(paste0(projPath, \"\/peakCalling\/SEACR\/\", hist, \"_\", rep, \"_seacr_\", type, \".peaks.stringent.bed\"), header = FALSE, fill = TRUE)<\/div><div class = \"text-block\">      peakInfo.gr = GRanges(peakInfo$V1, IRanges(start = peakInfo$V2, end = peakInfo$V3), strand = \"*\")<\/div><div class = \"text-block\">      if(length(overlap.gr) >0){<\/div><div class = \"text-block\">        overlap.gr = overlap.gr[findOverlaps(overlap.gr, peakInfo.gr)@from]<\/div><div class = \"text-block\">      }else{<\/div><div class = \"text-block\">        overlap.gr = peakInfo.gr<\/div><div class = \"text-block\">      }<\/div><div class = \"text-block\">    }<\/div><div class = \"text-block\">    peakOverlap = data.frame(peakReprod = length(overlap.gr), Histone = hist, peakType = type) %>% rbind(peakOverlap, .)<\/div><div class = \"text-block\">  }<\/div><div class = \"text-block\">}<\/div><div class = \"text-block\">peakReprod = left_join(peakN, peakOverlap, by = c(\"Histone\", \"peakType\")) %>% mutate(peakReprodRate = peakReprod\/peakN * 100)<\/div><div class = \"text-block\">peakReprod %>% select(Histone, Replicate, peakType, peakN, peakReprodNum = peakReprod, peakReprodRate)<\/div><\/div><\/code><\/pre><\/div><table border><tr style = \"text-align:center;\"><td>  <\/td><td>A<\/td><td>B<\/td><td>C<\/td><td>D<\/td><td>E<\/td><td>F<\/td><\/tr><tr><td style = \"text-align:center;\">1<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">Histone<chr><\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">Replicate<chr><\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">peakType<chr><\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">peakN<int><\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">peakReprodNum<int><\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">peakReprodRate<dbl><\/td><\/tr><tr><td style = \"text-align:center;\">2<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">K27me3<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">rep1<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">control<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">144906<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">71692<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">49.47483<\/td><\/tr><tr><td style = \"text-align:center;\">3<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">K27me3<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">rep1<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">top0.01<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">5829<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">5314<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">91.16487<\/td><\/tr><tr><td style = \"text-align:center;\">4<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">K27me3<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">rep2<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">control<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">74444<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">71692<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">96.30326<\/td><\/tr><tr><td style = \"text-align:center;\">5<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">K27me3<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">rep2<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">top0.01<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">9642<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">5314<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">55.11305<\/td><\/tr><tr><td style = \"text-align:center;\">6<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">K4me3<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">rep1<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">control<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">8709<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">7959<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">91.38822<\/td><\/tr><tr><td style = \"text-align:center;\">7<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">K4me3<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">rep1<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">top0.01<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">878<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">872<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">99.31663<\/td><\/tr><tr><td style = \"text-align:center;\">8<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">K4me3<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">rep2<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">control<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">8190<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">7959<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">97.17949<\/td><\/tr><tr><td style = \"text-align:center;\">9<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">K4me3<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">rep2<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">top0.01<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">3724<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">872<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">23.41568<\/td><\/tr><\/table><div class = \"text-block\">The reproducibility is calculated by <\/div><div style = \"text-align :; float : ;\"><span style = \"\"># peaks overlapping rep1 and rep2\/# peaks of rep1 or rep2 * 100<\/span><\/div><div class = \"text-block\">Therefore, it is sensitive to the total number of peaks called in each replicate.<\/div><\/div>"}},{"id":1054725,"guid":"C00AD2A62F86425EA932B0A4B15835B1","order_id":2,"type_id":1,"title":"description","source":{"description":"<table border><tr style = \"text-align:center;\"><td>  <\/td><td>A<\/td><td>B<\/td><td>C<\/td><td>D<\/td><td>E<\/td><td>F<\/td><\/tr><tr><td style = \"text-align:center;\">1<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">Histone<chr><\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">Replicate<chr><\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">peakType<chr><\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">peakN<int><\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">peakReprodNum<int><\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">peakReprodRate<dbl><\/td><\/tr><tr><td style = \"text-align:center;\">2<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">K27me3<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">rep1<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">control<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">144906<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">71692<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">49.47483<\/td><\/tr><tr><td style = \"text-align:center;\">3<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">K27me3<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">rep1<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">top0.01<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">5829<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">5314<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">91.16487<\/td><\/tr><tr><td style = \"text-align:center;\">4<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">K27me3<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">rep2<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">control<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">74444<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">71692<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">96.30326<\/td><\/tr><tr><td style = \"text-align:center;\">5<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">K27me3<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">rep2<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">top0.01<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">9642<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">5314<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">55.11305<\/td><\/tr><tr><td style = \"text-align:center;\">6<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">K4me3<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">rep1<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">control<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">8709<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">7959<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">91.38822<\/td><\/tr><tr><td style = \"text-align:center;\">7<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">K4me3<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">rep1<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">top0.01<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">878<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">872<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">99.31663<\/td><\/tr><tr><td style = \"text-align:center;\">8<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">K4me3<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">rep2<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">control<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">8190<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">7959<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">97.17949<\/td><\/tr><tr><td style = \"text-align:center;\">9<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">K4me3<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">rep2<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">top0.01<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">3724<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">872<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">23.41568<\/td><\/tr><\/table>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#FFED92","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1001253,"guid":"46EEC4B0DC3211EABA5FF3676F0827C5","previous_id":1001252,"previous_guid":"0798A060DC3211EABA5FF3676F0827C5","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"C32CA5D5AE954998AE514527F4B158B7","order_id":1,"type_id":6,"title":"Section","source":{"title":"VI. Peak calling"}},{"id":1054724,"guid":"D9B80DFF0B6A4D0AB23C4E3CB7B9750A","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\"><span style = \"font-weight:bold;\">FRagment proportion in Peaks regions (FRiPs)<\/span><\/div><div class = \"text-block\">We calculate the fraction of reads in peaks (FRiPs) as a measure of signal-to-noise and contrast it to FRiPs in the IgG control dataset for illustration. Although sequencing depths for CUT&Tag are typically only 1-5 million reads, the low background of the method results in high FRiP scores.<\/div><div class = \"text-block\"><pre><code><div class = \"text-blocks\"><div class = \"text-block\">##=== R command ===## <\/div><div class = \"text-block\">library(chromVAR)<\/div><div class = \"text-block\">bamDir = paste0(projPath, \"\/alignment\/bam\")<\/div><div class = \"text-block\">inPeakData = c()<\/div><div class = \"text-block\">## overlap with bam file to get count<\/div><div class = \"text-block\">for(hist in histL){<\/div><div class = \"text-block\">  for(rep in repL){<\/div><div class = \"text-block\">    peakRes = read.table(paste0(projPath, \"\/peakCalling\/SEACR\/\", hist, \"_\", rep, \"_seacr_control.peaks.stringent.bed\"), header = FALSE, fill = TRUE)<\/div><div class = \"text-block\">    peak.gr = GRanges(seqnames = peakRes$V1, IRanges(start = peakRes$V2, end = peakRes$V3), strand = \"*\")<\/div><div class = \"text-block\">    bamFile = paste0(bamDir, \"\/\", hist, \"_\", rep, \"_bowtie2.mapped.bam\")<\/div><div class = \"text-block\">    fragment_counts <- getCounts(bamFile, peak.gr, paired = TRUE, by_rg = FALSE, format = \"bam\")<\/div><div class = \"text-block\">    inPeakN = counts(fragment_counts)[,1] %>% sum<\/div><div class = \"text-block\">    inPeakData = rbind(inPeakData, data.frame(inPeakN = inPeakN, Histone = hist, Replicate = rep))<\/div><div class = \"text-block\">  }<\/div><div class = \"text-block\">}<\/div><div class = \"text-block\">frip = left_join(inPeakData, alignResult, by = c(\"Histone\", \"Replicate\")) %>% mutate(frip = inPeakN\/MappedFragNum_hg38 * 100)<\/div><div class = \"text-block\">frip %>% select(Histone, Replicate, SequencingDepth, MappedFragNum_hg38, AlignmentRate_hg38, FragInPeakNum = inPeakN, FRiPs = frip)<\/div><\/div><\/code><\/pre><\/div><table border><tr style = \"text-align:center;\"><td>  <\/td><td>A<\/td><td>B<\/td><td>C<\/td><td>D<\/td><td>E<\/td><td>F<\/td><\/tr><tr><td style = \"text-align:center;\">1<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">Histone<chr><\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">Replicate<chr><\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">SequencingDepth<dbl><\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">MappedFragNum_hg38<dbl><\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">AlignmentRate_hg38<dbl><\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">FragInPeakNum<dbl><\/td><\/tr><tr><td style = \"text-align:center;\">2<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">K27me3<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">rep1<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">2984630<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">2859520<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">95.81<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">2223813<\/td><\/tr><tr><td style = \"text-align:center;\">3<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">K27me3<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">rep2<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">2702260<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">2606295<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">96.45<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">1060373<\/td><\/tr><tr><td style = \"text-align:center;\">4<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">K4me3<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">rep1<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">1581710<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">1494122<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">94.46<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">1368641<\/td><\/tr><tr><td style = \"text-align:center;\">5<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">K4me3<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">rep2<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">1885056<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">1742005<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">92.41<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">1244857<\/td><\/tr><\/table><\/div>"}},{"id":1054725,"guid":"4769A5746B304A3EB14E3B2ED4A726D4","order_id":2,"type_id":1,"title":"description","source":{"description":"<table border><tr style = \"text-align:center;\"><td>  <\/td><td>A<\/td><td>B<\/td><td>C<\/td><td>D<\/td><td>E<\/td><td>F<\/td><\/tr><tr><td style = \"text-align:center;\">1<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">Histone<chr><\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">Replicate<chr><\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">SequencingDepth<dbl><\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">MappedFragNum_hg38<dbl><\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">AlignmentRate_hg38<dbl><\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">FragInPeakNum<dbl><\/td><\/tr><tr><td style = \"text-align:center;\">2<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">K27me3<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">rep1<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">2984630<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">2859520<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">95.81<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">2223813<\/td><\/tr><tr><td style = \"text-align:center;\">3<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">K27me3<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">rep2<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">2702260<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">2606295<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">96.45<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">1060373<\/td><\/tr><tr><td style = \"text-align:center;\">4<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">K4me3<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">rep1<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">1581710<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">1494122<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">94.46<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">1368641<\/td><\/tr><tr><td style = \"text-align:center;\">5<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">K4me3<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">rep2<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">1885056<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">1742005<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">92.41<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">1244857<\/td><\/tr><\/table>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#FFED92","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1001254,"guid":"74F3C630DC3211EABA5FF3676F0827C5","previous_id":1001253,"previous_guid":"46EEC4B0DC3211EABA5FF3676F0827C5","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"36294D6CDCA246AD8E0C42B8D7C766E7","order_id":1,"type_id":6,"title":"Section","source":{"title":"VI. Peak calling"}},{"id":1054724,"guid":"A6422AF01F4A410B8F02ED6F1EC2D035","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\"><span style = \"font-weight:bold;\">Visualization of peak number, peak width, peak reproducibility and FRiPs<\/span><\/div><div class = \"text-block\"><pre><code><div class = \"text-blocks\"><div class = \"text-block\">fig7A = peakN %>% ggplot(aes(x = Histone, y = peakN, fill = Histone)) +<\/div><div class = \"text-block\">    geom_boxplot() +<\/div><div class = \"text-block\">    geom_jitter(aes(color = Replicate), position = position_jitter(0.15)) +<\/div><div class = \"text-block\">    facet_grid(~peakType) +<\/div><div class = \"text-block\">    scale_fill_viridis(discrete = TRUE, begin = 0.1, end = 0.55, option = \"magma\", alpha = 0.8) +<\/div><div class = \"text-block\">    scale_color_viridis(discrete = TRUE, begin = 0.1, end = 0.9) +<\/div><div class = \"text-block\">    theme_bw(base_size = 18) +<\/div><div class = \"text-block\">    ylab(\"Number of Peaks\") +<\/div><div class = \"text-block\">    xlab(\"\")<\/div><div class = \"text-block\">fig7B = peakWidth %>% ggplot(aes(x = Histone, y = width, fill = Histone)) +<\/div><div class = \"text-block\">    geom_violin() +<\/div><div class = \"text-block\">    facet_grid(Replicate~peakType) +<\/div><div class = \"text-block\">    scale_fill_viridis(discrete = TRUE, begin = 0.1, end = 0.55, option = \"magma\", alpha = 0.8) +<\/div><div class = \"text-block\">    scale_color_viridis(discrete = TRUE, begin = 0.1, end = 0.9) +<\/div><div class = \"text-block\">    scale_y_continuous(trans = \"log\", breaks = c(400, 3000, 22000)) +<\/div><div class = \"text-block\">    theme_bw(base_size = 18) +<\/div><div class = \"text-block\">    ylab(\"Width of Peaks\") +<\/div><div class = \"text-block\">    xlab(\"\")<\/div><div class = \"text-block\">fig7C = peakReprod %>% ggplot(aes(x = Histone, y = peakReprodRate, fill = Histone, label = round(peakReprodRate, 2))) +<\/div><div class = \"text-block\">    geom_bar(stat = \"identity\") +<\/div><div class = \"text-block\">    geom_text(vjust = 0.1) +<\/div><div class = \"text-block\">    facet_grid(Replicate~peakType) +<\/div><div class = \"text-block\">    scale_fill_viridis(discrete = TRUE, begin = 0.1, end = 0.55, option = \"magma\", alpha = 0.8) +<\/div><div class = \"text-block\">    scale_color_viridis(discrete = TRUE, begin = 0.1, end = 0.9) +<\/div><div class = \"text-block\">    theme_bw(base_size = 18) +<\/div><div class = \"text-block\">    ylab(\"% of Peaks Reproduced\") +<\/div><div class = \"text-block\">    xlab(\"\")<\/div><div class = \"text-block\">fig7D = frip %>% ggplot(aes(x = Histone, y = frip, fill = Histone, label = round(frip, 2))) +<\/div><div class = \"text-block\">    geom_boxplot() +<\/div><div class = \"text-block\">    geom_jitter(aes(color = Replicate), position = position_jitter(0.15)) +<\/div><div class = \"text-block\">    scale_fill_viridis(discrete = TRUE, begin = 0.1, end = 0.55, option = \"magma\", alpha = 0.8) +<\/div><div class = \"text-block\">    scale_color_viridis(discrete = TRUE, begin = 0.1, end = 0.9) +<\/div><div class = \"text-block\">    theme_bw(base_size = 18) +<\/div><div class = \"text-block\">    ylab(\"% of Fragments in Peaks\") +<\/div><div class = \"text-block\">    xlab(\"\")<\/div><div class = \"text-block\">ggarrange(fig7A, fig7B, fig7C, fig7D, ncol = 2, nrow=2, common.legend = TRUE, legend=\"bottom\")<\/div><\/div><\/code><\/pre><\/div><div style = \"text-align :; float : ;\"><img style = \"\" src = \"https:\/\/s3.amazonaws.com\/protocols-files\/public\/dc9cd4c53a1d8402112dade227f044fef5ce68005dc6abefaa0d66c259c96a73\/cg9nbb8dp.png\" \/><\/div><\/div>"}},{"id":1054725,"guid":"FE625CE33F1747559D3FAC3F0E9153CA","order_id":2,"type_id":1,"title":"description","source":{"description":"<div style = \"text-align :; float : ;\"><img style = \"\" src = \"https:\/\/s3.amazonaws.com\/protocols-files\/public\/dc9cd4c53a1d8402112dade227f044fef5ce68005dc6abefaa0d66c259c96a73\/cg9nbb8dp.png\" \/><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#FFED92","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1001255,"guid":"CC749790DC3211EABA5FF3676F0827C5","previous_id":1001254,"previous_guid":"74F3C630DC3211EABA5FF3676F0827C5","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"B27E1BCDC110456CA3299EC9CBF5C58A","order_id":1,"type_id":6,"title":"Section","source":{"title":"VII. Visualization"}},{"id":1054724,"guid":"A502A6B59C11487E9F3986AD668B65AF","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\"><span style = \"font-weight:bold;\">Visualization<\/span><\/div><div class = \"text-block\">Typically we are interested in visualizing a chromatin landscape in regions using a genome browser. The <\/div><div class = \"text-block\"><a href=\"http:\/\/software.broadinstitute.org\/software\/igv\/home\" style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">Integrative Genomic Viewer<\/span><\/a><\/div><div class = \"text-block\"> provides a web app version and a local desktop version that is easy to use. The <\/div><div class = \"text-block\"><a href=\"https:\/\/genome.ucsc.edu\/\" style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">UCSC Genome Browser<\/span><\/a><\/div><div class = \"text-block\"> provides the most comprehensive supplementary genome information.<\/div><div class = \"text-block\">Browser display of normalized bedGraph files:<\/div><div style = \"text-align :; float : ;\"><img style = \"\" src = \"https:\/\/s3.amazonaws.com\/protocols-files\/public\/dc9cd4c53a1d8402112dade227f044fef5ce68005dc6abefaa0d66c259c96a73\/cg9qbb8dp.png\" \/><\/div><\/div>"}},{"id":1054725,"guid":"22D6CF387E8145778B41B639E12B9AC6","order_id":2,"type_id":1,"title":"description","source":{"description":"<div style = \"text-align :; float : ;\"><img style = \"\" src = \"https:\/\/s3.amazonaws.com\/protocols-files\/public\/dc9cd4c53a1d8402112dade227f044fef5ce68005dc6abefaa0d66c259c96a73\/cg9qbb8dp.png\" \/><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#EA9F6C","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1001256,"guid":"6C843D30DC3311EABA5FF3676F0827C5","previous_id":1001255,"previous_guid":"CC749790DC3211EABA5FF3676F0827C5","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"52063175796F4047B63D031A6B475F9B","order_id":1,"type_id":6,"title":"Section","source":{"title":"VII. Visualization"}},{"id":1054724,"guid":"8FFF8E5C189C486FBF684859E5D81C98","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\"><span style = \"font-weight:bold;\">Heatmap visualization of specific regions<\/span><\/div><div class = \"text-block\"><span>We are also interested in looking at chromatin features at a list of annotated sites, for example, histone modification signal at gene promoters. We will use the <\/span><span style = \"font-weight:bold;\">computeMatrix<\/span><span> and <\/span><span style = \"font-weight:bold;\">plotHeatmap<\/span><span> functions from <\/span><\/div><div class = \"text-block\"><a href=\"https:\/\/deeptools.readthedocs.io\/en\/develop\/\" style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">deepTools<\/span><\/a><\/div><div class = \"text-block\"> to generate the heatmap.<\/div><div class = \"text-block\"><pre><code><div class = \"text-blocks\"><div class = \"text-block\">##== linux command ==##<\/div><div class = \"text-block\">mkdir -p $projPath\/alignment\/bigwig                                                                                                                                        <\/div><div class = \"text-block\">samtools sort -o $projPath\/alignment\/bam\/${histName}.sorted.bam $projPath\/alignment\/bam\/${histName}_bowtie2.mapped.bam                                                     <\/div><div class = \"text-block\">samtools index $projPath\/alignment\/bam\/${histName}.sorted.bam                                                                                                              <\/div><div class = \"text-block\">bamCoverage -b $projPath\/alignment\/bam\/${histName}.sorted.bam -o $projPath\/alignment\/bigwig\/${histName}_raw.bw    <\/div><\/div><\/code><\/pre><\/div><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#EA9F6C","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1001257,"guid":"77E30170DC3311EABA5FF3676F0827C5","previous_id":1001256,"previous_guid":"6C843D30DC3311EABA5FF3676F0827C5","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"372FC51FDF4240C198F4BBE7279C7371","order_id":1,"type_id":6,"title":"Section","source":{"title":"VII. Visualization"}},{"id":1054724,"guid":"04AEBAFCB76944C09C76CE29615E16D9","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\"><span style = \"font-weight:bold;\">Heatmap over transcription units<\/span><\/div><div class = \"text-block\"><pre><code><div class = \"text-blocks\"><div class = \"text-block\">##== linux command ==##<\/div><div class = \"text-block\">cores=8<\/div><div class = \"text-block\">computeMatrix scale-regions -S $projPath\/alignment\/bigwig\/K27me3_rep1_raw.bw \\<\/div><div class = \"text-block\">                               $projPath\/alignment\/bigwig\/K27me3_rep2_raw.bw \\<\/div><div class = \"text-block\">                               $projPath\/alignment\/bigwig\/K4me3_rep1_raw.bw \\<\/div><div class = \"text-block\">                               $projPath\/alignment\/bigwig\/K4me3_rep2_raw.bw \\<\/div><div class = \"text-block\">                              -R $projPath\/data\/hg38_gene\/hg38_gene.tsv \\<\/div><div class = \"text-block\">                              --beforeRegionStartLength 3000 \\<\/div><div class = \"text-block\">                              --regionBodyLength 5000 \\<\/div><div class = \"text-block\">                              --afterRegionStartLength 3000 \\<\/div><div class = \"text-block\">                              --skipZeros -o $projPath\/data\/hg38_gene\/matrix_gene.mat.gz -p $cores<\/div><div class = \"text-block\">plotHeatmap -m $projPath\/data\/hg38_gene\/matrix_gene.mat.gz -out $projPath\/data\/hg38_gene\/Histone_gene.png --sortUsing sum<\/div><\/div><\/code><\/pre><\/div><div style = \"text-align :; float : ;\"><img style = \"\" src = \"https:\/\/s3.amazonaws.com\/protocols-files\/public\/dc9cd4c53a1d8402112dade227f044fef5ce68005dc6abefaa0d66c259c96a73\/cg9sbb8dp.png\" \/><\/div><\/div>"}},{"id":1054725,"guid":"CC7C937BB3024891B26704C66369CAB1","order_id":2,"type_id":1,"title":"description","source":{"description":"<div style = \"text-align :; float : ;\"><img style = \"\" src = \"https:\/\/s3.amazonaws.com\/protocols-files\/public\/dc9cd4c53a1d8402112dade227f044fef5ce68005dc6abefaa0d66c259c96a73\/cg9sbb8dp.png\" \/><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#EA9F6C","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1001258,"guid":"928DC9B0DC3311EABA5FF3676F0827C5","previous_id":1001257,"previous_guid":"77E30170DC3311EABA5FF3676F0827C5","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"CCB7F54DFB9D49D2B4A59D7F6DE95C87","order_id":1,"type_id":6,"title":"Section","source":{"title":"VII. Visualization"}},{"id":1054724,"guid":"73D662BD42374754B7BB753EA729158B","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\"><span style = \"font-weight:bold;\">Heatmap on CUT&Tag peaks<\/span><\/div><div class = \"text-block\">We use the midpoint of the signal block returned from SEACR to align signals in heatmaps. The sixth column of the SEACR output is an entry in the form chr:start-end that represents the first and ending bases of the region with the maximum signal of the region. We first generate a new bed file containing this midpoint information in column 6 and use deeptools for the heatmap visualization.<\/div><div class = \"text-block\"><pre><code><div class = \"text-blocks\"><div class = \"text-block\">##== linux command ==##<\/div><div class = \"text-block\">awk '{split($6, summit, \":\"); split(summit[2], region, \"-\"); print summit[1]\"\\t\"region[1]\"\\t\"region[2]}' $projPath\/peakCalling\/SEACR\/${histName}_${repName}_seacr_control.pe\\<\/div><div class = \"text-block\">aks.stringent.bed >$projPath\/peakCalling\/SEACR\/${histName}_${repName}_seacr_control.peaks.summitRegion.bed<\/div><div class = \"text-block\">computeMatrix reference-point -S $projPath\/alignment\/bigwig\/${histName}_${repName}_raw.bw \\<\/div><div class = \"text-block\">              -R $projPath\/peakCalling\/SEACR\/${histName}_${repName}_seacr_control.peaks.summitRegion.bed \\<\/div><div class = \"text-block\">              --skipZeros -o $projPath\/peakCalling\/SEACR\/${histName}_${repName}_SEACR.mat.gz -p $cores -a 3000 -b 3000 --referencePoint center<\/div><div class = \"text-block\">plotHeatmap -m $projPath\/peakCalling\/SEACR\/${histName}_SEACR.mat.gz -out $projPath\/peakCalling\/SEACR\/${histName}_SEACR_heatmap.png --sortUsing sum --startLabel \"Peak Start\" -\\<\/div><div class = \"text-block\">-endLabel \"Peak End\" --xAxisLabel \"\" --regionsLabel \"Peaks\" --samplesLabel \"${histName} ${repName}\"<\/div><\/div><\/code><\/pre><\/div><div style = \"text-align :; float : ;\"><img style = \"\" src = \"https:\/\/s3.amazonaws.com\/protocols-files\/public\/dc9cd4c53a1d8402112dade227f044fef5ce68005dc6abefaa0d66c259c96a73\/cg9ubb8dp.png\" \/><\/div><\/div>"}},{"id":1054725,"guid":"53ABA0C785504D318041506ADB143428","order_id":2,"type_id":1,"title":"description","source":{"description":"<div style = \"text-align :; float : ;\"><img style = \"\" src = \"https:\/\/s3.amazonaws.com\/protocols-files\/public\/dc9cd4c53a1d8402112dade227f044fef5ce68005dc6abefaa0d66c259c96a73\/cg9ubb8dp.png\" \/><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#EA9F6C","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1001260,"guid":"EE641280DC3311EABA5FF3676F0827C5","previous_id":1001258,"previous_guid":"928DC9B0DC3311EABA5FF3676F0827C5","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"D7EF350B6CF4417181F54E4558648657","order_id":1,"type_id":6,"title":"Section","source":{"title":"VIII. Differential analysis"}},{"id":1054724,"guid":"F963A55E2B574B56A4A2B9FFAB218938","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\"><span style = \"font-weight:bold;\">DESeq2<\/span><\/div><div class = \"text-block\">DESeq2: <\/div><div class = \"text-block\"><a href=\"https:\/\/genomebiology.biomedcentral.com\/articles\/10.1186\/s13059-014-0550-8\" style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">Moderated estimation of fold change and dispersion for RNA-seq data with DESeq2<\/span><\/a><\/div><div class = \"text-block\">Estimate variance-mean dependence in count data from high-throughput sequencing assays and test for differential expression based on a model using the negative binomial distribution.<\/div><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#E57785","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1001263,"guid":"29AFF930DC3411EABA5FF3676F0827C5","previous_id":1001260,"previous_guid":"EE641280DC3311EABA5FF3676F0827C5","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"20539FA0A7B844C390C3F99FCCC299CB","order_id":1,"type_id":6,"title":"Section","source":{"title":"VIII. Differential analysis"}},{"id":1054724,"guid":"EA3F3A01C43541F583673A181A5D84CF","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\"><span style = \"font-weight:bold;\">Create the <\/span><\/div><div style = \"text-align :; float : ;\"><span style = \"\">peak \\times sample<\/span><\/div><div class = \"text-block\"><span style = \"font-weight:bold;\"> <\/span><span style = \"font-weight:bold;\"> matrix.<\/span><\/div><div class = \"text-block\">Usually, the differential tests compare two or more conditions of the same histone modification. In this tutorial, limited by the demonstration data, we will illustrate the differential detection by comparing two replicates of H3K27me3 and two replicates of H3K4me3. We will use DESeq2 (<\/div><div class = \"text-block\"><a href=\"http:\/\/bioconductor.org\/packages\/release\/bioc\/vignettes\/DESeq2\/inst\/doc\/DESeq2.html#why-un-normalized-counts\" style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">complete tutorial<\/span><\/a><\/div><div class = \"text-block\">)  as an illustration.<\/div><div class = \"text-block\">Create a master peak list merging all the peaks called for each sample.<\/div><div class = \"text-block\"><pre><code><div class = \"text-blocks\"><div class = \"text-block\">##=== R command ===## <\/div><div class = \"text-block\">mPeak = GRanges()<\/div><div class = \"text-block\">## overlap with bam file to get count<\/div><div class = \"text-block\">for(hist in histL){<\/div><div class = \"text-block\">  for(rep in repL){<\/div><div class = \"text-block\">    peakRes = read.table(paste0(projPath, \"\/peakCalling\/SEACR\/\", hist, \"_\", rep, \"_seacr_control.peaks.stringent.bed\"), header = FALSE, fill = TRUE)<\/div><div class = \"text-block\">    mPeak = GRanges(seqnames = peakRes$V1, IRanges(start = peakRes$V2, end = peakRes$V3), strand = \"*\") %>% append(mPeak, .)<\/div><div class = \"text-block\">  }<\/div><div class = \"text-block\">}<\/div><div class = \"text-block\">masterPeak = reduce(mPeak)<\/div><\/div><\/code><\/pre><\/div><div class = \"text-block\">Get the fragment counts for each peak in the master peak list.<\/div><div class = \"text-block\"><pre><code><div class = \"text-blocks\"><div class = \"text-block\">##=== R command ===## <\/div><div class = \"text-block\">library(DESeq2)<\/div><div class = \"text-block\">bamDir = paste0(projPath, \"\/alignment\/bam\")<\/div><div class = \"text-block\">countMat = matrix(NA, length(masterPeak), length(histL)*length(repL))<\/div><div class = \"text-block\">## overlap with bam file to get count<\/div><div class = \"text-block\">i = 1<\/div><div class = \"text-block\">for(hist in histL){<\/div><div class = \"text-block\">  for(rep in repL){<\/div><div class = \"text-block\">    bamFile = paste0(bamDir, \"\/\", hist, \"_\", rep, \"_bowtie2.mapped.bam\")<\/div><div class = \"text-block\">    fragment_counts <- getCounts(bamFile, masterPeak, paired = TRUE, by_rg = FALSE, format = \"bam\")<\/div><div class = \"text-block\">    countMat[, i] = counts(fragment_counts)[,1]<\/div><div class = \"text-block\">    i = i + 1<\/div><div class = \"text-block\">  }<\/div><div class = \"text-block\">}<\/div><div class = \"text-block\">colnames(countMat) = paste(rep(histL, 2), rep(repL, each = 2), sep = \"_\")<\/div><\/div><\/code><\/pre><\/div><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#E57785","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1001264,"guid":"9B0F1B10DC3411EABA5FF3676F0827C5","previous_id":1001263,"previous_guid":"29AFF930DC3411EABA5FF3676F0827C5","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"6509079240BF4B4296192FEF6D393523","order_id":1,"type_id":6,"title":"Section","source":{"title":"VIII. Differential analysis"}},{"id":1054724,"guid":"DD1CB07A438D4A8AAAD414C1D612F6B8","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\"><span style = \"font-weight:bold;\">Sequencing depth normalization and differential enriched peaks detection<\/span><\/div><div class = \"text-block\"><pre><code><div class = \"text-blocks\"><div class = \"text-block\">##=== R command ===## <\/div><div class = \"text-block\">selectR = which(rowSums(countMat) > 5) ## remove low count genes<\/div><div class = \"text-block\">dataS = countMat[selectR,]<\/div><div class = \"text-block\">condition = factor(rep(histL, each = length(repL)))<\/div><div class = \"text-block\">dds = DESeqDataSetFromMatrix(countData = dataS,<\/div><div class = \"text-block\">                              colData = DataFrame(condition),<\/div><div class = \"text-block\">                              design = ~ condition)<\/div><div class = \"text-block\">DDS = DESeq(dds)<\/div><div class = \"text-block\">normDDS = counts(DDS, normalized = TRUE) ## normalization with respect to the sequencing depth<\/div><div class = \"text-block\">colnames(normDDS) = paste0(colnames(normDDS), \"_norm\")<\/div><div class = \"text-block\">res = results(DDS, independentFiltering = FALSE, altHypothesis = \"greaterAbs\")<\/div><div class = \"text-block\">countMatDiff = cbind(dataS, normDDS, res)<\/div><div class = \"text-block\">head(countMatDiff)<\/div><\/div><\/code><\/pre><\/div><div style = \"text-align :; float : ;\"><img style = \"\" src = \"https:\/\/s3.amazonaws.com\/protocols-files\/public\/dc9cd4c53a1d8402112dade227f044fef5ce68005dc6abefaa0d66c259c96a73\/cg9wbb8dp.png\" \/><\/div><div class = \"text-block\">- DESeq2 requires the input matrix should be un-normalized counts or estimated counts of sequencing reads.<\/div><div class = \"text-block\">- DESeq2 model internally corrects for library size.<\/div><div class = \"text-block\"><span>- <\/span><span style = \"font-weight:bold;\">countMatDiff<\/span><span> summarizes the differential analysis results: <\/span><\/div><div class = \"text-block\">  - First 4 columns: raw reads counts after filtering the peak regions with low counts<\/div><div class = \"text-block\">  - Second 4 columns: normalized read counts eliminating library size difference.<\/div><div class = \"text-block\">  - Remaining columns: differential detection results.<\/div><\/div>"}},{"id":1054725,"guid":"4FDFF091BD69438285F19AB0C6822561","order_id":2,"type_id":1,"title":"description","source":{"description":"<div style = \"text-align :; float : ;\"><img style = \"\" src = \"https:\/\/s3.amazonaws.com\/protocols-files\/public\/dc9cd4c53a1d8402112dade227f044fef5ce68005dc6abefaa0d66c259c96a73\/cg9wbb8dp.png\" \/><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#E57785","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1001266,"guid":"CE321420DC3411EABA5FF3676F0827C5","previous_id":1001264,"previous_guid":"9B0F1B10DC3411EABA5FF3676F0827C5","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"5A398B74F89C45F78ECB95E5CAB682BB","order_id":1,"type_id":6,"title":"Section","source":{"title":"IX. Additional Alternatives"}},{"id":1054724,"guid":"9ADA0D71ABA746A49EE6B18E4A6754C0","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\"><span style = \"font-weight:bold;\">ChIPseqSpikeInFree for normalizing data without spike-in DNA [Optional]<\/span><\/div><div class = \"text-block\">ChIPseqSpikeInFree: <\/div><div class = \"text-block\"><a href=\"http:\/\/ttps:\/\/academic.oup.com\/bioinformatics\/article\/36\/4\/1270\/5578481\" style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">a ChIP-seq normalization approach to reveal global changes in histone modifications without spike-in<\/span><\/a><\/div><div class = \"text-block\"> is a novel ChIP-seq normalization method to effectively determine scaling factors for samples across various conditions and treatments, which does not rely on exogenous spike-in chromatin or peak detection to reveal global changes in histone modification occupancy. The installation details can be found on GitHub at <\/div><div class = \"text-block\"><a href=\"https:\/\/github.com\/stjude\/ChIPseqSpikeInFree\" style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">https:\/\/github.com\/stjude\/ChIPseqSpikeInFree<\/span><\/a><\/div><div class = \"text-block\">.<\/div><div class = \"text-block\"><pre><code><div class = \"text-blocks\"><div class = \"text-block\">##=== R command ===## <\/div><div class = \"text-block\">library(\"ChIPseqSpikeInFree\")<\/div><div class = \"text-block\">bamDir = paste0(projPath, \"\/alignment\/bam\")<\/div><div class = \"text-block\">metaData = c()<\/div><div class = \"text-block\">for(hist in sampleList){<\/div><div class = \"text-block\">  histInfo = strsplit(hist, \"_\")[[1]] <\/div><div class = \"text-block\">  metaData = data.frame(ID = paste0(hist, \"_bowtie2.mapped.bam\"), ANTIBODY = histInfo[1], GROUP = histInfo[2]) %>% rbind(metaData, .)<\/div><div class = \"text-block\">}<\/div><div class = \"text-block\">write.table(metaData, file = paste0(projPath, \"\/alignment\/ChIPseqSpikeInFree\/metaData.txt\"), row.names = FALSE, quote = FALSE, sep = \"\\t\")<\/div><div class = \"text-block\">metaFile = paste0(projPath, \"\/alignment\/ChIPseqSpikeInFree\/metaData.txt\")<\/div><div class = \"text-block\">bams = paste0(projPath, \"\/alignment\/bam\/\", metaData$ID)<\/div><div class = \"text-block\">ChIPseqSpikeInFree(bamFiles = bams, chromFile = \"hg38\", metaFile = metaFile, prefix = paste0(projPath, \"\/alignment\/ChIPseqSpikeInFree\/SpikeInFree_results\"))<\/div><\/div><\/code><\/pre><\/div><div class = \"text-block\">- <\/div><div class = \"text-block\"><a href=\"https:\/\/github.com\/stjude\/ChIPseqSpikeInFree#interpretation-of-scaling-factor-table\" style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">Interpretation of the ChIPseqSpikeInFree output<\/span><\/a><\/div><div class = \"text-block\">.<\/div><div class = \"text-block\">- <\/div><div class = \"text-block\"><a href=\"https:\/\/github.com\/stjude\/ChIPseqSpikeInFree#how-to-use-chipseqspikein-scaling-factor\" style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">How to use ChIPseqSpikeInFree scaling factor.<\/span><\/a><\/div><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#EA94FF","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1001267,"guid":"426C1B60DC3511EABA5FF3676F0827C5","previous_id":1001266,"previous_guid":"CE321420DC3411EABA5FF3676F0827C5","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"5D11F0497D7F444287BD6A1289A78BB6","order_id":1,"type_id":6,"title":"Section","source":{"title":"IX. Additional Alternatives"}},{"id":1054724,"guid":"200B4987844145E59A0D849731819923","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\"><span style = \"font-weight:bold;\">Other peak calling methods.<\/span><\/div><div class = \"text-block\">- MACS2: <\/div><div class = \"text-block\"><a href=\"https:\/\/genomebiology.biomedcentral.com\/articles\/10.1186\/gb-2008-9-9-r137\" style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">Model-based Analysis of ChIP-Seq (MACS)<\/span><\/a><\/div><div class = \"text-block\"> Installation details can be found at <\/div><div class = \"text-block\"><a href=\"https:\/\/github.com\/taoliu\/MACS\/wiki\" style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">https:\/\/github.com\/taoliu\/MACS\/wiki<\/span><\/a><\/div><div class = \"text-block\">.<\/div><div class = \"text-block\"><pre><code><div class = \"text-blocks\"><div class = \"text-block\">##== linux command ==##<\/div><div class = \"text-block\">histName=\"K27me3\"<\/div><div class = \"text-block\">controlName=\"IgG\"<\/div><div class = \"text-block\">mkdir -p $projPath\/peakCalling<\/div><div class = \"text-block\">macs2 callpeak -t ${projPath}\/alignment\/bam\/${histName}_rep1_bowtie2.mapped.bam \\<\/div><div class = \"text-block\">      -c ${projPath}\/alignment\/bam\/${controlName}_rep1_bowtie2.mapped.bam \\<\/div><div class = \"text-block\">      -g hs -f BAMPE -n macs2_peak_q0.1 --outdir $projPath\/peakCalling\/MACS2 -q 0.1 --keep-dup all 2>${projPath}\/peakCalling\/MACS2\/macs2Peak_summary.txt<\/div><\/div><\/code><\/pre><\/div><div class = \"text-block\">- dPeak: <\/div><div class = \"text-block\"><a href=\"https:\/\/journals.plos.org\/ploscompbiol\/article?id=10.1371\/journal.pcbi.1003246\" style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">dPeak: High Resolution Identification of Transcription Factor Binding Sites from PET and SET ChIP-Seq Data<\/span><\/a><\/div><div class = \"text-block\">- MOSAiCS: <\/div><div class = \"text-block\"><a href=\"https:\/\/www.ncbi.nlm.nih.gov\/pmc\/articles\/PMC4608541\/\" style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">A Statistical Framework for the Analysis of ChIP-Seq Data<\/span><\/a><\/div><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#EA94FF","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1001268,"guid":"47CC7320DC3511EABA5FF3676F0827C5","previous_id":1001267,"previous_guid":"426C1B60DC3511EABA5FF3676F0827C5","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"147765AA801C4B85BAFA597978AAFD0E","order_id":1,"type_id":6,"title":"Section","source":{"title":"IX. Additional Alternatives"}},{"id":1054724,"guid":"FB981D0EF62440269214A8F7DD513EBD","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\"><span style = \"font-weight:bold;\">Other packages for differential analysis of binding sites<\/span><\/div><div class = \"text-block\">- Limma: <\/div><div class = \"text-block\"><a href=\"https:\/\/academic.oup.com\/nar\/article\/43\/7\/e47\/2414268\" style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">limma powers differential expression analyses for RNA-sequencing and microarray studies<\/span><\/a><\/div><div class = \"text-block\">Limma is an R package for the analysis of gene expression microarray data, especially<\/div><div class = \"text-block\">the use of linear models for analysing designed experiments and the assessment of differential expression. Limma provides the ability to analyse comparisons between many<\/div><div class = \"text-block\">RNA targets simultaneously in arbitrary complicated designed experiments. Empirical<\/div><div class = \"text-block\">Bayesian methods are used to provide stable results even when the number of arrays<\/div><div class = \"text-block\">is small. Limma can be extended to study differential fragment enrichment analysis within peak regions. Notably, limma can deal with both fixed effect model and random effect model.<\/div><div class = \"text-block\">- edgeR: <\/div><div class = \"text-block\"><a href=\"https:\/\/academic.oup.com\/nar\/article\/40\/10\/4288\/2411520\" style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">Differential Expression Analysis of Multifactor RNA-Seq Experiments With Respect to Biological Variation<\/span><\/a><\/div><div class = \"text-block\">Differential expression analysis of RNA-seq expression profiles with biological replication. Implements a range of statistical methodology based on the negative binomial distributions, including empirical Bayes estimation, exact tests, generalized linear models, and quasi-likelihood tests. As well as RNA-seq, it be applied to thedifferential signal analysis of other types of genomic data that produce read counts, including ChIP-seq, ATAC-seq, Bisulfite-seq, SAGE and CAGE. edgeR can deal with multifactor problem.<\/div><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#EA94FF","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1001269,"guid":"4D18F4C0DC3511EABA5FF3676F0827C5","previous_id":1001268,"previous_guid":"47CC7320DC3511EABA5FF3676F0827C5","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"D8AC3881BCCC4F2FA16FF981CB266EAB","order_id":1,"type_id":6,"title":"Section","source":{"title":"X. Troubleshooting: Generating your data"}},{"id":1054724,"guid":"D6CFD54D3A7D4879A6BBA8FF06C3031D","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">This workflow can be followed with your own data and will generate a standardized set of quality-control reports. However, many sequencing facilities do not perform 25x25 PE sequencing, and alternate parameters for trimming and mapping are provided here. Control datasets for non-specific antibody (IgG) profiling or ATAC-seq profiling of your material can also be used for optional analysis detailed here.<\/div><div class = \"text-block\">Stringent washing with 300 mM NaCl is critical to limit the affinity of Tn5 for exposed DNA. We describe here the need for controlling background Tn5 affinities and describe how our CUT&Tag protocol effectively suppresses this artifact for unambiguous mapping of chromatin epitopes. We present a protocol that can process either native or fixed nuclei and includes alternative methods for DNA isolation. To illustrate the method, we describe a typical experiment, including evaluation of the results using a new metric for peak-calling information. Further, we validate a single-tube format for CUT&Tag that requires no DNA isolation but instead uses tagmented material directly for library amplification. We document critical steps for the CUT&Tag protocol, informed by our experiences, helping users establish this method in their research.<\/div><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#A492FF","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1001271,"guid":"5D97AC60DC3511EABA5FF3676F0827C5","previous_id":1001269,"previous_guid":"4D18F4C0DC3511EABA5FF3676F0827C5","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"F813269BF7C042E8AF9581A63977CF36","order_id":1,"type_id":6,"title":"Section","source":{"title":"Reference"}},{"id":1054724,"guid":"D9EA980622B24BCBACFF87ED7DFEEE31","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Kaya-Okur HS, Wu SJ, Codomo CA, Pledger ES, Bryson TD, Henikoff JG, Ahmad K, Henikoff S: CUT&Tag for efficient epigenomic profiling of small samples and single cells. Nature Communications 2019 10:1930 (PMID:31036827).<\/div><div class = \"text-block\">Meers, M.P., Tenenbaum, D. & Henikoff, S. Peak calling by Sparse Enrichment Analysis for CUT&RUN chromatin profiling. Epigenetics & Chromatin 12, 42 (2019). <\/div><div class = \"text-block\"><a href=\"https:\/\/doi.org\/10.1186\/s13072-019-0287-4\" style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">https:\/\/doi.org\/10.1186\/s13072-019-0287-4<\/span><\/a><\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">Cite this tutorial<\/span><\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">Zheng Y et al (2020). Protocol.io<\/span><\/div><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#94EBFF","section_duration":0,"critical":null,"critical_id":null,"duration":0}],"document":null,"materials":[],"description":"<div class = \"text-blocks\"><div class = \"text-block\"><span>This tutorial is designed for processing and analyzing CUT&Tag data following the <\/span><a href=\"https:\/\/www.protocols.io\/view\/bench-top-cut-amp-tag-bcuhiwt6\/abstract\" style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">Benchtop CUT&Tag V.3 protocol<\/span><\/a><span>.  The illustration data used in this tutorial is the profiling of histone modifications in the human lymphoma K562 cell line, but the tutorial is generally applicable to any chromatin protein, including transcription factors, RNA polymerase II, and epitope-tagged proteins. For reproducible analysis, this tutorial is also available on GitHub at <\/span><a href=\"https:\/\/yezhengstat.github.io\/CUTTag_tutorial\" style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">https:\/\/yezhengstat.github.io\/CUTTag_tutorial\/<\/span><\/a><span style = \":;\">.<\/span><\/div><\/div>","changed_on":1597246844}