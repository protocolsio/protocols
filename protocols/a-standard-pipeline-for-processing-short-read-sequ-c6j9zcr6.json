{"access":{"can_view":true,"can_edit":false,"can_remove":true,"can_add":false,"can_publish":false,"can_get_doi":true,"can_share":true,"can_move":true,"can_move_outside":true,"can_transfer":true,"can_download":true,"limited_run":false,"limited_private_links":false,"limited_blind_links":false,"is_locked":false},"authors":[{"name":"James Reeve","affiliation":"Tjärnö Marine Laboratory, University of Gothenburg, 452 96 Strömstad, Sweden","affiliation_url":"","username":"james-reeve","link":"","image":{"source":"/img/avatars/010.png","placeholder":"/img/avatars/010.png","webp_source":""},"note":"Corresponding author","is_verified_user":true},{"name":"Amin Ghane","affiliation":"Department of Botany and Biodiversity Research, University of Vienna, Vienna, Austria","affiliation_url":null,"username":"","link":null,"image":{"source":"","placeholder":"","webp_source":""},"note":"","is_verified_user":false},{"name":"Pierre Barry","affiliation":" BIPOLIS, CIBIO, University of Porto, 4485-661 Vairão, Portugal","affiliation_url":null,"username":"","link":null,"image":{"source":"","placeholder":"","webp_source":""},"note":"","is_verified_user":false},{"name":"Alfonso Balmori-de la Puente","affiliation":" BIPOLIS, CIBIO, University of Porto, 4485-661 Vairão, Portugal; Universitat de Barcelona, 08028 Barcelona, Spain","affiliation_url":null,"username":"","link":null,"image":{"source":"","placeholder":"","webp_source":""},"note":"","is_verified_user":false},{"name":"Roger K. Butlin","affiliation":"School of Biological Sciences, University of Sheffield, Sheffield S10 2TN, UK; Tjärnö Marine Laboratory, University of Gothenburg, 452 96 Strömstad, Sweden","affiliation_url":null,"username":"","link":null,"image":{"source":"","placeholder":"","webp_source":""},"note":"","is_verified_user":false},{"name":"Le Qin Choo","affiliation":"School of Biological Sciences, University of Sheffield, Sheffield S10 2TN, UK","affiliation_url":null,"username":"","link":null,"image":{"source":"","placeholder":"","webp_source":""},"note":"","is_verified_user":false},{"name":"Alan Le Moan","affiliation":"Roscoff Marine Station, Sorbonne University, 29680 Roscoff, France","affiliation_url":null,"username":"","link":null,"image":{"source":"","placeholder":"","webp_source":""},"note":"","is_verified_user":false},{"name":"Diego Garica Castillo","affiliation":"ISTA, 3400 Klosterneuberg, Austria","affiliation_url":null,"username":"","link":null,"image":{"source":"","placeholder":"","webp_source":""},"note":"","is_verified_user":false},{"name":"Ana-Maria Peris Tamayo","affiliation":"Faculty of Biosciences and Aquaculture, Nord University, 8049 Bodø, Norway","affiliation_url":null,"username":"","link":null,"image":{"source":"","placeholder":"","webp_source":""},"note":"","is_verified_user":false},{"name":"Sarah Kingston","affiliation":"Sea Education Association, Woods Hole, MA 02543, USA","affiliation_url":null,"username":"","link":null,"image":{"source":"","placeholder":"","webp_source":""},"note":"","is_verified_user":false},{"name":"Erica Leder","affiliation":"Tjärnö Marine Laboratory, University of Gothenburg, 452 96 Strömstad, Sweden","affiliation_url":null,"username":"","link":null,"image":{"source":"","placeholder":"","webp_source":""},"note":"","is_verified_user":false},{"name":"Sean Stankowski","affiliation":"ISTA, 3400 Klosterneuberg, Austria; Department of Ecology and Evolution, University of Sussex, Brighton BN1 9RH, UK","affiliation_url":null,"username":"","link":null,"image":{"source":"","placeholder":"","webp_source":""},"note":"","is_verified_user":false}],"before_start":"","book_chapter":null,"can_accept_authorship":false,"can_be_copied":true,"can_claim_authorship":false,"can_manage_keywords":true,"can_remove_fork":false,"can_sign":false,"child_steps":{},"cited_protocols":[],"collection_items":[],"created_on":1703003053,"creator":{"name":"James Reeve","affiliation":"Tjärnö Marine Laboratory, University of Gothenburg, 452 96 Strömstad, Sweden","affiliation_url":"","username":"james-reeve","link":"","image":{"source":"/img/avatars/010.png","placeholder":"/img/avatars/010.png","webp_source":""},"badges":[{"id":2,"name":"Author","image":{"source":"/img/badges/bronze.svg","placeholder":"/img/badges/bronze.svg"}}],"affiliations":[{"affiliation":"Tjärnö Marine Laboratory, University of Gothenburg, 452 96 Strömstad, Sweden","url":"","is_default":true}]},"cross_cloud_origin":null,"description":"{\"blocks\":[{\"key\":\"6us99\",\"text\":\"This protocol explains the default pipeline we recommend for analysing short-read data for Littorina marine snails. The pipeline was designed based on our experience processing WGS data, and careful consideration of the available tools. We are presenting this protocol as a suggestion of how Littorina sequencing data can be processed, and as a template for building more specific pipelines. Our hope is that through writing this protocol we can have more consistency among projects, leading to greater transparency for collaborators and providing a template which could be used to build pipelines for other organisms.\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}}],\"entityMap\":{}}","disclaimer":"{\"blocks\":[{\"key\":\"cll7p\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}}],\"entityMap\":{}}","document":"","documents":[{"id":428810,"guid":"","type_id":0,"filename":"","key":"","color":"","height":0,"width":0,"is_document":null,"original_file_id":null,"thumb_url":"https://protocols.io/img/extensions/pdf.png","size":393152,"is_private":0,"is_new":0,"ofn":"LitSD_pipeline_protocol_v1.pdf","url":"https://content.protocols.io/files/pc2kcbbdp.pdf","bucket_name":null,"s3_webp_url":"","file_id":428810}],"doi":null,"doi_status":0,"ethics_statement":null,"fork_id":null,"fork_info":null,"forks":[],"funders":[{"funder_name":"Swedish Research Council","grant_id":"2018-03695_VR"}],"groups":[],"guid":"61C03FBAF9F74B72A2EB85496C17688D","guidelines":"{\"blocks\":[{\"key\":\"a57hn\",\"text\":\"This protocol was created as a guide for new users. We strongly recommend exploring your data and reading the manuals for the software we present, before designing your own sequence data pipeline.\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}}],\"entityMap\":{}}","has_references":true,"has_step_reagents":false,"has_versions":false,"id":92513,"image":{"source":"https://content.protocols.io/files/pdbbcbbdp.jpg","webp_source":"https://content.protocols.io/files/pdbacbbdp.webp","placeholder":"https://content.protocols.io/files/pc2vcbbdp.png","webp_placeholder":""},"image_attribution":"","in_trash":false,"is_bookmarked":false,"is_contact_suspended":false,"is_content_confidential":false,"is_content_warning":false,"is_doi_reserved":false,"is_in_pending_publishing":false,"is_in_transfer":false,"is_owner":true,"is_research":true,"is_retracted":false,"is_shared_directly":false,"is_subprotocol":null,"is_unlisted":false,"item_id":1199333,"journal":null,"journals":[],"keywords":"bioinformatics,biology,genetics,sequencing,Littorina","last_modified":1703080146,"link":"","location":null,"manuscript_citation":"","materials":[],"materials_text":"","ownership_history":null,"parent_collections":[],"parent_protocols":[],"peer_reviewed":false,"protocol_references":"{\"blocks\":[{\"key\":\"2p4gg\",\"text\":\"       Del Fabbro, C., Scalabrin, S., Morgante, M., \\u0026 Giorgi, F.M. (2013). An extensive evaluation of read trimming effects on Illumina NGS data analysis. PLoS One, 8(12), e85024. https://doi.org/10.1371/journal.pone.0085024\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[{\"key\":0,\"offset\":196,\"length\":27}],\"data\":{}},{\"key\":\"9h5ck\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}},{\"key\":\"4ts33\",\"text\":\"       Evolgenomics (2022). Haplotagging. GitHub repository. https://github.com/evolgenomics/haplotagging\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[{\"style\":\"UNDERLINE\",\"offset\":61,\"length\":44}],\"entityRanges\":[{\"key\":1,\"offset\":61,\"length\":44}],\"data\":{}},{\"key\":\"ebnbu\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}},{\"key\":\"fkqdm\",\"text\":\"       Garrison E., Kronenberg, Z.N., Dawson, E.T., Pedersen, B.S., \\u0026 Prins, P. (2022). A spectrum of free software tools for processing the VCF variant call format: vcflib, bio-vcf, cyvcf2, hts-nim and silvar. PLoS Computational Biology. 18(5): e1009123. https://doi.org/10.1371/journal.pcbi.1009123\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[{\"style\":\"UNDERLINE\",\"offset\":256,\"length\":44}],\"entityRanges\":[{\"key\":2,\"offset\":256,\"length\":44}],\"data\":{}},{\"key\":\"cb6ck\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}},{\"key\":\"8eo35\",\"text\":\"\\tHarvard Chan Bioinformatics Core training. (n.d.) Introduction to RNA-Seq using high performance computing. hpctraining. https://hbctraining.github.io/Intro-to-rnaseq-hpc-salmon/lessons/qc_fastqc_assessment.html\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[{\"style\":\"UNDERLINE\",\"offset\":122,\"length\":90}],\"entityRanges\":[{\"key\":3,\"offset\":122,\"length\":90}],\"data\":{}},{\"key\":\"78khg\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}},{\"key\":\"dg6vs\",\"text\":\"        Kofler, R., Orozco-terWengel, P., De Maio, N., Pandey, R.V., Nolte, V., Futschik, A., Kosiol, C., \\u0026 Schlötterer, C. (2011). PoPoolation: a toolbox for population genetic analysis of next generation sequencing data from pooled individuals. PLoS One. 6(1), e15925. https://doi.org/10.1371/journal.pone.0015925\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[{\"style\":\"UNDERLINE\",\"offset\":271,\"length\":44}],\"entityRanges\":[{\"key\":4,\"offset\":271,\"length\":44}],\"data\":{}},{\"key\":\"6qedt\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}},{\"key\":\"8tcec\",\"text\":\"\\tIllumina. (2023). Advantages of paired-end and single-read sequencing. Illumina Experiments \\u0026 Protocols. https://emea.illumina.com/science/technology/next-generation-sequencing/plan-experiments/paired-end-vs-single-read.html#:~:text=Unlike%20single%2Dread%20seqeuncing%2C%20paired,gene%20fusions%20and%20novel%20transcripts.\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[{\"style\":\"UNDERLINE\",\"offset\":106,\"length\":218}],\"entityRanges\":[{\"key\":5,\"offset\":106,\"length\":218}],\"data\":{}},{\"key\":\"1sc6d\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}},{\"key\":\"aacto\",\"text\":\"        Meier, J.I., Salazar, P.A., Kučka, M., \\u0026 Chan, Y.F. (2021). Haplotype tapping reveals parallel formation of hybrid races in two butterfly species. PNAS. 118(25), e2015005118. https://doi.org/10.1073/pnas.2015005118\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[{\"style\":\"UNDERLINE\",\"offset\":183,\"length\":39}],\"entityRanges\":[{\"key\":6,\"offset\":183,\"length\":39}],\"data\":{}},{\"key\":\"1pgnd\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}},{\"key\":\"82jem\",\"text\":\"\\tMusich, R., Cadle-Davidson, L., \\u0026 Osier, M.V. (2021). Comparison of short-read sequence aligners indicates strengths and weaknesses for biologists to consider. Frontiers in Plant Science. 12. https://doi.org/10.3389/fpls.2021.657240\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[{\"style\":\"UNDERLINE\",\"offset\":193,\"length\":40}],\"entityRanges\":[{\"key\":7,\"offset\":193,\"length\":40}],\"data\":{}},{\"key\":\"5lln3\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}},{\"key\":\"9beq4\",\"text\":\"\\tPerini, S. (2021). Reproductive isolation at contact zones [Doctoral thesis, University of Gothenburg]. GUPEA. https://gupea.ub.gu.se/handle/2077/67013\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}},{\"key\":\"9sfi2\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}},{\"key\":\"fplp3\",\"text\":\"Predeus, A. [predeus]. (2017). Duplicates on Illumina. [online forum]. Biostars. \",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}},{\"key\":\"aelin\",\"text\":\"https://www.biostars.org/p/229842/   \",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[{\"style\":\"UNDERLINE\",\"offset\":0,\"length\":34}],\"entityRanges\":[{\"key\":8,\"offset\":0,\"length\":34}],\"data\":{}},{\"key\":\"arkin\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}},{\"key\":\"d1as5\",\"text\":\"\\tPuritz, J.B., Matz, M.V., Toonen, R.J., Weber, J.N., Bolnick, D.I., \\u0026 Bird, C.E. (2014). Demystifying the RAD fad. Molecular Ecology. 23(24), 5937-5942. https://doi.org/10.1111/mec.12965\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[{\"key\":9,\"offset\":155,\"length\":32}],\"data\":{}},{\"key\":\"2fpj6\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}},{\"key\":\"6suhl\",\"text\":\"\\tRochette, N.C., Rivera-Colón, A.G., \\u0026 Catchen, J.M. (2019). Stacks 2: analytical methods for paired-end sequencing improve RADseq-based population genomics. Molecular Ecology. 28(21), 4737-4754. https://doi.org/10.1111/mec.15253\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[{\"style\":\"UNDERLINE\",\"offset\":196,\"length\":33}],\"entityRanges\":[{\"key\":10,\"offset\":196,\"length\":33}],\"data\":{}},{\"key\":\"13va2\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}},{\"key\":\"efvn9\",\"text\":\"\\tSchilbert,H.M., Rempel, A., \\u0026 Pucker, B. (2020). Comparison of read mapping and variant calling tools for the analysis of plant NGS data. Plants. 9(4): 439. https://doi.org/10.3390/plants9040439\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[{\"style\":\"UNDERLINE\",\"offset\":158,\"length\":37}],\"entityRanges\":[{\"key\":11,\"offset\":158,\"length\":37}],\"data\":{}},{\"key\":\"7c7rn\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}},{\"key\":\"5qas9\",\"text\":\"\\tSchlötterer, C., Tobler, R., Kofler, R., \\u0026 Nolte, V. (2014). Sequencing pools of individuals - mining genome-wide polymorphism data without big funding. Nature Reviews Genetics. 15, 749-763. https://doi.org/10.1038/nrg3803\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[{\"style\":\"UNDERLINE\",\"offset\":192,\"length\":31}],\"entityRanges\":[{\"key\":12,\"offset\":192,\"length\":31}],\"data\":{}},{\"key\":\"d9897\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}},{\"key\":\"bd23o\",\"text\":\"\\tStankowski, S., Zagrodzka, Z.B., Garlovsky, M., Pal, A., Shipilina, D., Garcia Castilo, D., Le Moan, A., Leder E., Reeve, J., Johannesson, K., Westram, A.M., \\u0026 Butlin, R.K. (2023). Selection on many loci drove the origin and spread of a key innovation. BioR𝛘iv. ttps://doi.org/10.1101/2023.02.13.528213\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[{\"style\":\"UNDERLINE\",\"offset\":263,\"length\":40}],\"entityRanges\":[{\"key\":13,\"offset\":263,\"length\":40}],\"data\":{}},{\"key\":\"bu10h\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}},{\"key\":\"c9du9\",\"text\":\"\\tShaji, A., Numanagić, I., \\u0026 Berger, B. (2018). Latent variable model for aligning barcoded short-reads improves downstream analyses. Research in Computational Molecular Biology. Apr;10812:280-282. ​​https://doi.org/10.1101/220236\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[{\"style\":\"UNDERLINE\",\"offset\":200,\"length\":30}],\"entityRanges\":[{\"key\":14,\"offset\":200,\"length\":30}],\"data\":{}},{\"key\":\"c5pnl\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}},{\"key\":\"b1839\",\"text\":\"        Trapnell, C., \\u0026 Salzburg, S.L. (2010). How to map billions of short reads onto genomes. Nature Biotechnology. 27(5), 455-457. https//doi.org/10.1038/nbt0509-455\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[{\"key\":15,\"offset\":149,\"length\":19}],\"data\":{}},{\"key\":\"7iona\",\"text\":\"\\t\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}},{\"key\":\"fevg2\",\"text\":\"\\tZanti, M., Michailidou, K., Loizidou, M.A., Machattou, C., Pirpa, P., Christodoulou, K., Spyrou, G.M., Kyriacou, K., \\u0026 Hadjisavvas, A. (2021). Performance evaluation of pipelines for mapping variant calling and interval padding, for the analysis of NGS germline panels. BMC Bioinformatics. 22: 218. https://doi.org/10.1186/s12859-021-04144-1\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[{\"style\":\"UNDERLINE\",\"offset\":300,\"length\":42}],\"entityRanges\":[{\"key\":16,\"offset\":300,\"length\":42}],\"data\":{}},{\"key\":\"6qucj\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}}],\"entityMap\":{\"0\":{\"type\":\"link\",\"mutability\":\"MUTABLE\",\"data\":{\"guid\":\"185DAC539E8E11EE885E0A58A9FEAC02\",\"url\":\"https://doi.org/10.1371%2Fjournal.pone.0085024\"}},\"1\":{\"type\":\"link\",\"mutability\":\"MUTABLE\",\"data\":{\"guid\":\"185DAC539E8E11EE885E0A58A9FEAC02\",\"url\":\"https://github.com/evolgenomics/haplotagging\"}},\"10\":{\"type\":\"link\",\"mutability\":\"MUTABLE\",\"data\":{\"guid\":\"185DAC539E8E11EE885E0A58A9FEAC02\",\"url\":\"https://doi.org/10.1111/mec.15253\"}},\"11\":{\"type\":\"link\",\"mutability\":\"MUTABLE\",\"data\":{\"guid\":\"185DAC539E8E11EE885E0A58A9FEAC02\",\"url\":\"https://doi.org/10.3390/plants9040439\"}},\"12\":{\"type\":\"link\",\"mutability\":\"MUTABLE\",\"data\":{\"guid\":\"185DAC539E8E11EE885E0A58A9FEAC02\",\"url\":\"https://doi.org/10.1038/nrg3803\"}},\"13\":{\"type\":\"link\",\"mutability\":\"MUTABLE\",\"data\":{\"guid\":\"185DAC539E8E11EE885E0A58A9FEAC02\",\"url\":\"https://doi.org/10.1101/2023.02.13.528213\"}},\"14\":{\"type\":\"link\",\"mutability\":\"MUTABLE\",\"data\":{\"guid\":\"185DAC539E8E11EE885E0A58A9FEAC02\",\"url\":\"https://doi.org/10.1101/220236\"}},\"15\":{\"type\":\"link\",\"mutability\":\"MUTABLE\",\"data\":{\"guid\":\"185DAC539E8E11EE885E0A58A9FEAC02\",\"url\":\"https://doi.org/10.1038%2Fnbt0509-455\"}},\"16\":{\"type\":\"link\",\"mutability\":\"MUTABLE\",\"data\":{\"guid\":\"185DAC539E8E11EE885E0A58A9FEAC02\",\"url\":\"https://doi.org/10.1186/s12859-021-04144-1\"}},\"2\":{\"type\":\"link\",\"mutability\":\"MUTABLE\",\"data\":{\"guid\":\"185DAC539E8E11EE885E0A58A9FEAC02\",\"url\":\"https://doi.org/10.1371/journal.pcbi.1009123\"}},\"3\":{\"type\":\"link\",\"mutability\":\"MUTABLE\",\"data\":{\"guid\":\"185DAC539E8E11EE885E0A58A9FEAC02\",\"url\":\"https://hbctraining.github.io/Intro-to-rnaseq-hpc-salmon/lessons/qc_fastqc_assessment.html\"}},\"4\":{\"type\":\"link\",\"mutability\":\"MUTABLE\",\"data\":{\"guid\":\"185DAC539E8E11EE885E0A58A9FEAC02\",\"url\":\"https://doi.org/10.1371/journal.pone.0015925\"}},\"5\":{\"type\":\"link\",\"mutability\":\"MUTABLE\",\"data\":{\"guid\":\"185DAC539E8E11EE885E0A58A9FEAC02\",\"url\":\"https://emea.illumina.com/science/technology/next-generation-sequencing/plan-experiments/paired-end-vs-single-read.html#:~:text=Unlike%20single%2Dread%20seqeuncing%2C%20paired,gene%20fusions%20and%20novel%20transcripts\"}},\"6\":{\"type\":\"link\",\"mutability\":\"MUTABLE\",\"data\":{\"guid\":\"185DAC539E8E11EE885E0A58A9FEAC02\",\"url\":\"https://doi.org/10.1073/pnas.2015005118\"}},\"7\":{\"type\":\"link\",\"mutability\":\"MUTABLE\",\"data\":{\"guid\":\"185DAC539E8E11EE885E0A58A9FEAC02\",\"url\":\"https://doi.org/10.3389/fpls.2021.657240\"}},\"8\":{\"type\":\"link\",\"mutability\":\"MUTABLE\",\"data\":{\"guid\":\"185DAC539E8E11EE885E0A58A9FEAC02\",\"url\":\"https://www.biostars.org/p/229842\"}},\"9\":{\"type\":\"link\",\"mutability\":\"MUTABLE\",\"data\":{\"guid\":\"185DAC539E8E11EE885E0A58A9FEAC02\",\"url\":\"https://doi.org/10.1111/mec.12965\"}}}}","public":true,"public_fork_note":"","published_on":1703080146,"references":[],"related_equipments":[],"related_materials":[],"reserved_doi":"","retraction_reason":null,"samples":{},"shared_access_id":106,"show_comparison":false,"sign_info":null,"space_access":{"can_view":false,"can_edit":false,"can_remove":false,"can_add":false,"can_publish":true,"can_get_doi":true,"can_share":false,"can_move":false,"can_move_outside":false,"can_transfer":false,"can_download":false,"limited_run":false,"limited_private_links":false,"limited_blind_links":false,"is_locked":false},"state_version_id":935,"stats":{"is_voted":false,"number_of_views":0,"number_of_steps":28,"number_of_bookmarks":0,"number_of_comments":0,"number_of_bookmarked_comments":0,"number_of_steps_comments":0,"number_of_protocol_comments":0,"number_of_exports":0,"number_of_runs":0,"number_of_votes":0,"number_of_reagents":0,"number_of_equipments":0,"number_of_collections":0,"number_of_forks":{"private":0,"public":0},"number_of_accessible_forks":0},"status":{"id":1,"info":"We use this protocol as a starting step for designing pipelines specific to our data."},"steps":[{"id":1884150,"guid":"C230CDC21B9245E19C5819C02ADEB80B","previous_id":0,"previous_guid":null,"section":"\u003cp\u003eOverview\u003c/p\u003e","section_color":"#A492FF","section_duration":0,"is_substep":false,"step":"{\"blocks\":[{\"key\":\"1trpm\",\"text\":\"Processing of short read sequencing data can be broken down into four major steps (Fig. 1): \",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}},{\"key\":\"6qij\",\"text\":\"      1) read quality inspection and trimming\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}},{\"key\":\"fp4nd\",\"text\":\"      2) read mapping\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}},{\"key\":\"6sb0h\",\"text\":\"      3) variant calling \",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}},{\"key\":\"2h3rt\",\"text\":\"      4) variant filtering\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}},{\"key\":\"83e7r\",\"text\":\"There are numerous sub-steps in between, which together have a plethora of different adjustments one could make. Without a reference, two users could create vastly different pipelines for the same data. Below, we outline our recommended pipeline steps, briefly describing the process, showing example code, and explaining the different options available. \",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}},{\"key\":\"45qt1\",\"text\":\" \",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}},{\"key\":\"dsidd\",\"text\":\" \",\"type\":\"atomic\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[{\"key\":0,\"offset\":0,\"length\":1}],\"data\":{}},{\"key\":\"df7m4\",\"text\":\" \",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}}],\"entityMap\":{\"0\":{\"type\":\"image\",\"mutability\":\"MUTABLE\",\"data\":{\"align\":\"left\",\"guid\":\"BF8244FD2F0D4C4C9799EFD7762B66BC\",\"height\":860.8319467554077,\"is_video\":false,\"legend\":\"{\\\"blocks\\\":[{\\\"key\\\":\\\"fs6ji\\\",\\\"text\\\":\\\"Figure 1: flowchart of steps in the Littorina variant calling pipeline. See Table S1 for definitions\\\",\\\"type\\\":\\\"unstyled\\\",\\\"depth\\\":0,\\\"inlineStyleRanges\\\":[{\\\"style\\\":\\\"bold\\\",\\\"offset\\\":0,\\\"length\\\":9}],\\\"entityRanges\\\":[],\\\"data\\\":{}}],\\\"entityMap\\\":{}}\",\"mime\":null,\"nestedSelector\":null,\"original_name\":null,\"placeholder\":\"https://lh7-us.googleusercontent.com/3y8eyHGCkGxMQe3Lo1KIQ2xpiVUvasR5Umcx7d339ktWHdC8LVrdecmhHykLLsvDyFlsRtNbDnQa0VhuL5rB3Vt-wHn4VxatxdpSvHbv3V6pA3A2978RJ9AfSq4rmFazq5o5MY1kTZdcsYSVFUD4Vbs\",\"shadow\":false,\"source\":\"https://lh7-us.googleusercontent.com/3y8eyHGCkGxMQe3Lo1KIQ2xpiVUvasR5Umcx7d339ktWHdC8LVrdecmhHykLLsvDyFlsRtNbDnQa0VhuL5rB3Vt-wHn4VxatxdpSvHbv3V6pA3A2978RJ9AfSq4rmFazq5o5MY1kTZdcsYSVFUD4Vbs\",\"width\":580}}}}","data":null,"protocol_id":92513,"case_id":0,"critical_ids":"","duration":0,"original_id":0,"number":"1","cases":[],"critical":null},{"id":1884152,"guid":"FE4B90C65FCE4A149D75502DAD2556D7","previous_id":1884150,"previous_guid":"C230CDC21B9245E19C5819C02ADEB80B","section":"\u003cp\u003eRead quality inspection and trimming\u003c/p\u003e","section_color":"#94EBFF","section_duration":0,"is_substep":false,"step":"{\"blocks\":[{\"key\":\"ev829\",\"text\":\"Short-read sequencers output raw data in fastq format. This contains nucleotides along with a Phred-likelihood quality score for each base (the probability that the called base is wrong). Bases at the end of reads often have lower quality than those at the start. Trimming these poor quality bases is recommended using a tool like fastp. (Del Fabbro 2013, PLoS One). Base quality is not the only metric that can be used to evaluate reads; other important statistics include read length, GC content, duplications and adaptor content (HBCtraining, n.d.). We recommend using fastqc to generate summary reports of read quality. For datasets of many individuals, these reports can be merged with MultiQC.\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[{\"style\":\"bold\",\"offset\":41,\"length\":5},{\"style\":\"bold\",\"offset\":331,\"length\":5},{\"style\":\"bold\",\"offset\":572,\"length\":6},{\"style\":\"bold\",\"offset\":691,\"length\":7}],\"entityRanges\":[],\"data\":{}},{\"key\":\"5cgtg\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}},{\"key\":\"4oe97\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}}],\"entityMap\":{}}","data":null,"protocol_id":92513,"case_id":0,"critical_ids":"","duration":0,"original_id":0,"number":"2","cases":[],"critical":null},{"id":1884153,"guid":"7E85BBD35ACC4279A251E1DC84F46ED7","previous_id":1884159,"previous_guid":"68F7565830384987B790ABCE9B0301A6","section":"\u003cp\u003eRead mapping\u003c/p\u003e","section_color":"#84CE84","section_duration":0,"is_substep":false,"step":"{\"blocks\":[{\"key\":\"eorfr\",\"text\":\"Once we have good quality reads, we next map them onto the Littorina saxatilis reference genome (De Jode et al., in review). At the simplest level, read mapping is just aligning DNA sequences. The complexity comes in when trying to optimise this process for next generation sequencing data (Trapnell and Salzberg 2010). We recommend using the Burrows-Wheeler Aligner (BWA). Other read callers can do a similar job, but BWA has the highest accuracy in benchmarking papers (Musich et al. 2021, Zanti et al. 2021, Schilbert et al. 2020). BWA takes two fastq files as input per sample, the forward and reverse reads. If sequencing data are paired-end, then BWA outputs a single SAM file. This output adds additional information to the fastq which shows where each read is placed on the reference genome and if there are any mismatches. SAM files tend to be massive, so as a final step we compress them to BAM format.\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[{\"style\":\"bold\",\"offset\":368,\"length\":3},{\"style\":\"bold\",\"offset\":419,\"length\":4},{\"style\":\"bold\",\"offset\":470,\"length\":1},{\"style\":\"bold\",\"offset\":535,\"length\":3},{\"style\":\"bold\",\"offset\":549,\"length\":5},{\"style\":\"bold\",\"offset\":653,\"length\":3},{\"style\":\"bold\",\"offset\":674,\"length\":3},{\"style\":\"bold\",\"offset\":731,\"length\":6},{\"style\":\"bold\",\"offset\":832,\"length\":3},{\"style\":\"bold\",\"offset\":901,\"length\":3}],\"entityRanges\":[],\"data\":{}}],\"entityMap\":{}}","data":null,"protocol_id":92513,"case_id":0,"critical_ids":"","duration":0,"original_id":0,"number":"5","cases":[],"critical":null},{"id":1884154,"guid":"17205D0D90004B7CA0A20A9F97EA5540","previous_id":1884172,"previous_guid":"26084948E5CF4D73BD66A89F078420C9","section":"\u003cp\u003eVariant calling\u003c/p\u003e","section_color":"#FFED92","section_duration":0,"is_substep":false,"step":"{\"blocks\":[{\"key\":\"9123j\",\"text\":\"Variant calling sifts through multiple BAM files to identify genomic positions that vary among individuals. These variants can include indels, SNPs, SNVs, or repeated elements. The most common variants used in evolutionary research are SNPs. SNP calling identifies positions where two (or more) versions of a nucleotide are present in a population. Each individual is also assigned a genotype, often scored as ‘0/0’ if  homozygous for the reference allele (i.e., the individual carries two alleles that match the allele in the reference genome), ‘1/1’ if homozygous for the alternative allele, and ‘0/1’ if heterozygous. Individuals with no called genotype at this position are scored as ‘./.’.\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}},{\"key\":\"2kkog\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}},{\"key\":\"5j6gc\",\"text\":\" Genotypes can be called with a range of different models (one of the key distinctions among different calling software packages) that give each individual three probability scores (one for each possible genotype) at each biallelic site. In addition, other metrics, such as depth of coverage (i.e. how many reads are used), mapping quality and strand biases, are provided. All of this information is stored in a variant call format (VCF) file. \",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[{\"style\":\"bold\",\"offset\":433,\"length\":3}],\"entityRanges\":[],\"data\":{}},{\"key\":\"1kd49\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}},{\"key\":\"bjos\",\"text\":\"We recommend calling variants using the program bcftools. It performed quicker and as accurately (evaluated with precision and recall) as a more popular caller (GATK; https://gatk.broadinstitute.org/hc/en-us), when tested on sequence data from a set of Littorina parent-offspring trios. There are two steps to calling with bcftools; first, sequences from each BAM file are concatenated together into an mpileup file. \",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[{\"style\":\"bold\",\"offset\":48,\"length\":8},{\"style\":\"bold\",\"offset\":323,\"length\":8},{\"style\":\"bold\",\"offset\":360,\"length\":4},{\"style\":\"bold\",\"offset\":403,\"length\":8},{\"style\":\"UNDERLINE\",\"offset\":167,\"length\":40}],\"entityRanges\":[{\"key\":0,\"offset\":167,\"length\":40}],\"data\":{}}],\"entityMap\":{\"0\":{\"type\":\"link\",\"mutability\":\"MUTABLE\",\"data\":{\"guid\":\"E49E44529E9011EE885E0A58A9FEAC02\",\"url\":\"https://gatk.broadinstitute.org/hc/en-us\"}}}}","data":null,"protocol_id":92513,"case_id":0,"critical_ids":"","duration":0,"original_id":0,"number":"9","cases":[],"critical":null},{"id":1884155,"guid":"8274B4E3175541B18F7FD4A24775CBC9","previous_id":1884300,"previous_guid":"06EC2B15AB8248208EBAF0DD3F48A588","section":"\u003cp\u003eVariant filtering\u003c/p\u003e","section_color":"#EA9F6C","section_duration":0,"is_substep":false,"step":"{\"blocks\":[{\"key\":\"9mgdq\",\"text\":\"After calling, variants must be filtered to remove possible poorly sequenced, low quality sites and undesired types of variant (e.g. indels). This step will vary most between studies, as filtering thresholds depend heavily on the type of data, sequencing approach and end results of the analysis. The recommendations we give below are intended to provide some advice for new users, as a benchmark for some of the most common filters. Depending on the downstream analysis and other factors like sample number and sequencing depth, some criteria might need tweaking. For instance, for low coverage data a lot of information may be lost with the filters proposed here. On the other hand, for very precise analysis, even more stringent filters are required. Ultimately, judgement is left up to the user; we recommend extracting variant quality scores (e.g. DP, SP, MQ, or QUAL) from the VCF and plotting their distributions before choosing filtering thresholds. \",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[{\"style\":\"bold\",\"offset\":883,\"length\":3}],\"entityRanges\":[],\"data\":{}},{\"key\":\"do7pf\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}},{\"key\":\"7no3k\",\"text\":\"Main steps in filtering:\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[{\"style\":\"italic\",\"offset\":0,\"length\":24}],\"entityRanges\":[],\"data\":{}},{\"key\":\"d1tma\",\"text\":\"It is best to think about filtering as three steps. \",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}},{\"key\":\"7kpnd\",\"text\":\"Hard filtering: the removal of entire variants, purging their record from the VCF file\",\"type\":\"ordered-list-item\",\"depth\":0,\"inlineStyleRanges\":[{\"style\":\"bold\",\"offset\":78,\"length\":3}],\"entityRanges\":[],\"data\":{}},{\"key\":\"1bs0l\",\"text\":\"Soft filtering: the masking of individual genotypes from the file by setting these as missing data\",\"type\":\"ordered-list-item\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}},{\"key\":\"4to18\",\"text\":\"Filter by the proportion of missing data: removing entire sites where fewer than x% of individuals have a genotype\",\"type\":\"ordered-list-item\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}},{\"key\":\"4igg9\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}},{\"key\":\"4k7du\",\"text\":\"A note on applying filters:\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[{\"style\":\"italic\",\"offset\":0,\"length\":27}],\"entityRanges\":[],\"data\":{}},{\"key\":\"2le05\",\"text\":\"It is tempting to apply filters in a single command which removes sites or masks genotypes based on multiple criteria simultaneously. Although this may seem more efficient, it is difficult to check that filters are applied as expected. It is much easier to understand the effect of each filter if they are run separately, or in small sets. The number of sites left after each filter (see code below) should be recorded to keep track of data loss over the entire filtering process . Be sure not to overwrite your original file so you can always go back and filter the dataset based on a different set of criteria if needed.\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}},{\"key\":\"c2d9s\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}},{\"key\":\"3jmcg\",\"text\":\" \",\"type\":\"atomic\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[{\"key\":0,\"offset\":0,\"length\":1}],\"data\":{}},{\"key\":\"6uirr\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}}],\"entityMap\":{\"0\":{\"type\":\"code_insert\",\"mutability\":\"IMMUTABLE\",\"data\":{\"blocks\":[{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"5mft2\",\"text\":\"# Counting SNPs in VCF\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"3370j\",\"text\":\"zcat /path/output.vcf.gz | awk ‘!/\\\\#/’ | wc -l\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"4ih6g\",\"text\":\"# OsX terminal uses gzcat\",\"type\":\"unstyled\"}],\"entityMap\":{}}}}}","data":null,"protocol_id":92513,"case_id":0,"critical_ids":"","duration":0,"original_id":0,"number":"10","cases":[],"critical":null},{"id":1884157,"guid":"0AB1A42262694E88B794743ACE7F83BB","previous_id":1884152,"previous_guid":"FE4B90C65FCE4A149D75502DAD2556D7","section":"\u003cp\u003eRead quality inspection and trimming\u003c/p\u003e","section_color":"#94EBFF","section_duration":0,"is_substep":false,"step":"{\"blocks\":[{\"key\":\"12do3\",\"text\":\"1.1) Read quality:\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[{\"style\":\"bold\",\"offset\":0,\"length\":18}],\"entityRanges\":[],\"data\":{}},{\"key\":\"9k47l\",\"text\":\"Before trimming and mapping, our reads are evaluated with fastqc per individual and MultiQC for the whole dataset. We run fastqc with default settings, apart from -t which specifies the number of threads (-t will depend on your computer specifications). The resulting quality reports are composed of several sections (e.g. read length, nucleotide content, adaptors, duplication). Detailed example reports and a tutorial video are on the fastqc website. We recommend looking at these before deciding how to trim reads.\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[{\"style\":\"bold\",\"offset\":58,\"length\":6},{\"style\":\"bold\",\"offset\":84,\"length\":7},{\"style\":\"bold\",\"offset\":122,\"length\":7},{\"style\":\"bold\",\"offset\":437,\"length\":6},{\"style\":\"UNDERLINE\",\"offset\":411,\"length\":14},{\"style\":\"UNDERLINE\",\"offset\":437,\"length\":14}],\"entityRanges\":[{\"key\":0,\"offset\":411,\"length\":14},{\"key\":1,\"offset\":437,\"length\":14}],\"data\":{}},{\"key\":\"fvoik\",\"text\":\" \",\"type\":\"atomic\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[{\"key\":2,\"offset\":0,\"length\":1}],\"data\":{}},{\"key\":\"1q3lv\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}}],\"entityMap\":{\"0\":{\"type\":\"link\",\"mutability\":\"MUTABLE\",\"data\":{\"guid\":\"ECF639599E8E11EE885E0A58A9FEAC02\",\"url\":\"http://www.youtube.com/watch?v=bz93ReOv87Y\"}},\"1\":{\"type\":\"link\",\"mutability\":\"MUTABLE\",\"data\":{\"guid\":\"ECF639599E8E11EE885E0A58A9FEAC02\",\"url\":\"https://www.bioinformatics.babraham.ac.uk/projects/fastqc\"}},\"2\":{\"type\":\"code_insert\",\"mutability\":\"IMMUTABLE\",\"data\":{\"blocks\":[{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"b31ts\",\"text\":\"# fastqc\\nfastqc --dir /path/temp_files -t 20 \\\\\\n\\t/path/file.fastq.gz \\\\\\n\\t--outdir /path/output/\\n\\n# MultiQC\\nmultiqc /path/fastqc/dir \\\\\\n\\t-o /path/output/dir \\\\\\n\\t-n output.name.prefix\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"bbikt\",\"text\":\"\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"59dnd\",\"text\":\"# Note: change ‘/path/’ to your own file directory path.\",\"type\":\"unstyled\"}],\"entityMap\":{}}}}}","data":null,"protocol_id":92513,"case_id":0,"critical_ids":"","duration":0,"original_id":0,"number":"3","cases":[],"critical":null},{"id":1884159,"guid":"68F7565830384987B790ABCE9B0301A6","previous_id":1884157,"previous_guid":"0AB1A42262694E88B794743ACE7F83BB","section":"\u003cp\u003eRead quality inspection and trimming\u003c/p\u003e","section_color":"#94EBFF","section_duration":0,"is_substep":false,"step":"{\"blocks\":[{\"key\":\"4580j\",\"text\":\"1.2) Read trimming:\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[{\"style\":\"bold\",\"offset\":0,\"length\":19}],\"entityRanges\":[],\"data\":{}},{\"key\":\"6lrnq\",\"text\":\"We recommend the program fastp for trimming adaptors and removing low quality ends. This program can identify adaptor sequences (assuming standard adaptors were used by the sequencing centre), and other known errors like polyG tails, and automatically trim them from the data.  There are also options to specify adaptor sequences manually and the number of base pairs to clip, if the default settings do not work with the data. fastp also generates a quality report which can be compared with the fastqc reports to see if the trimming is successful.\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[{\"style\":\"bold\",\"offset\":25,\"length\":6},{\"style\":\"bold\",\"offset\":428,\"length\":6},{\"style\":\"bold\",\"offset\":497,\"length\":6}],\"entityRanges\":[],\"data\":{}},{\"key\":\"7u17i\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}},{\"key\":\"25mop\",\"text\":\"For paired-end sequencing (Illumina, 2023) you must specify both a forward (-i) and reverse (-I) read files. By default fastp overwrites existing files, we set -o and -O to specify the output. Optional filtering steps we use are -g to trim polyG tails, -c to perform base correction in overlapping paired data, and -y as a complexity filter that removes reads with \\u003c 30% complexity (shifts between neighbouring base pairs; basei ≠ basei+1). Finally, --html, --json, and --report_title are set to specify where the output reports are placed.\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[{\"style\":\"bold\",\"offset\":120,\"length\":5}],\"entityRanges\":[],\"data\":{}},{\"key\":\"531eb\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}},{\"key\":\"anclu\",\"text\":\" \",\"type\":\"atomic\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[{\"key\":0,\"offset\":0,\"length\":1}],\"data\":{}},{\"key\":\"6r5n7\",\"text\":\"It is a good idea to inspect the reports at this point to determine if read trimming has improved the quality (see fastqc tutorials). If so, move onto read mapping. If not, the fastp options need tweaking until the reads are ready to map.\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[{\"style\":\"UNDERLINE\",\"offset\":114,\"length\":17},{\"style\":\"bold\",\"offset\":177,\"length\":5}],\"entityRanges\":[{\"key\":1,\"offset\":114,\"length\":17}],\"data\":{}},{\"key\":\"83ppe\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}}],\"entityMap\":{\"0\":{\"type\":\"code_insert\",\"mutability\":\"IMMUTABLE\",\"data\":{\"blocks\":[{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"5gvvn\",\"text\":\"fastp \\\\\\n      -i /path/input_R1.fastq.gz \\\\ # input files\\n      -I /path/input_R2.fastq.gz \\\\ \",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"9e6nr\",\"text\":\"\\t-o /path/output_R1.fastq.gz \\\\ # output files\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"ah07m\",\"text\":\"      -O /path/output_R2.fastq.gz \\\\\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"en087\",\"text\":\"\\t--thread 20 -g -c -y 30 \\\\\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"f8hhd\",\"text\":\"\\t--html /path/output_report.html \\\\ # quality reports\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"67hqe\",\"text\":\"\\t--json /path/output_report.json \\\\\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"8q8s4\",\"text\":\"\\t--report_title report.title.prefix \",\"type\":\"unstyled\"}],\"entityMap\":{}}},\"1\":{\"type\":\"link\",\"mutability\":\"MUTABLE\",\"data\":{\"guid\":\"57E7970B9E8F11EE885E0A58A9FEAC02\",\"url\":\"https://www.bioinformatics.babraham.ac.uk/projects/fastqc\"}}}}","data":null,"protocol_id":92513,"case_id":0,"critical_ids":"","duration":0,"original_id":0,"number":"4","cases":[],"critical":null},{"id":1884161,"guid":"7DB6DBC051A44A9F9A55A18C6FBB9999","previous_id":1884153,"previous_guid":"7E85BBD35ACC4279A251E1DC84F46ED7","section":"\u003cp\u003eRead mapping\u003c/p\u003e","section_color":"#84CE84","section_duration":0,"is_substep":false,"step":"{\"blocks\":[{\"key\":\"5movf\",\"text\":\"2.1) Index reference genome:\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[{\"style\":\"bold\",\"offset\":0,\"length\":28}],\"entityRanges\":[],\"data\":{}},{\"key\":\"4qo8l\",\"text\":\"Before running BWA we need to index the reference genome. This helps the algorithm to find shorter sequences throughout the genome, speeding up the whole process (Trapnell and Salzberg 2010). We index the reference genome with the simple one-liner below. This only has to be done once, but remember to keep the index files in the same directory as the reference genome.\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[{\"style\":\"bold\",\"offset\":15,\"length\":4}],\"entityRanges\":[],\"data\":{}},{\"key\":\"263d7\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}},{\"key\":\"db0hp\",\"text\":\" \",\"type\":\"atomic\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[{\"key\":0,\"offset\":0,\"length\":1}],\"data\":{}},{\"key\":\"ffefn\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}}],\"entityMap\":{\"0\":{\"type\":\"code_insert\",\"mutability\":\"IMMUTABLE\",\"data\":{\"blocks\":[{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"7d7n8\",\"text\":\"bwa index /path/reference.fa\",\"type\":\"unstyled\"}],\"entityMap\":{}}}}}","data":null,"protocol_id":92513,"case_id":0,"critical_ids":"","duration":0,"original_id":0,"number":"6","cases":[],"critical":null},{"id":1884163,"guid":"6117A130A0B04AA8A36B26B99D31237E","previous_id":1884161,"previous_guid":"7DB6DBC051A44A9F9A55A18C6FBB9999","section":"\u003cp\u003eRead mapping\u003c/p\u003e","section_color":"#84CE84","section_duration":0,"is_substep":false,"step":"{\"blocks\":[{\"key\":\"cfe2d\",\"text\":\"2.2) Mapping reads with BWA:\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[{\"style\":\"bold\",\"offset\":0,\"length\":28}],\"entityRanges\":[],\"data\":{}},{\"key\":\"3quud\",\"text\":\"Reads are mapped to the reference genome using BWA. We use the maximal exact matches (mem) algorithm. Three input files are required: the reference genome, the forward reads fastq and the reverse reads fastq. We optionally set -M to mark shorter splits as secondary alignments (i.e. other parts of the genome with lower quality mapping), -R to specify the read group information (flags that indicate how a read was sequenced and the sample it came from), and -t to set the number of threads to run in parallel. Lastly, the standard output is piped into samtools to write the file in the compressed BAM format.\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[{\"style\":\"bold\",\"offset\":47,\"length\":3},{\"style\":\"bold\",\"offset\":174,\"length\":5},{\"style\":\"bold\",\"offset\":202,\"length\":5},{\"style\":\"bold\",\"offset\":553,\"length\":9},{\"style\":\"bold\",\"offset\":598,\"length\":4}],\"entityRanges\":[],\"data\":{}},{\"key\":\"2hs9e\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}},{\"key\":\"5s87n\",\"text\":\" \",\"type\":\"atomic\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[{\"key\":0,\"offset\":0,\"length\":1}],\"data\":{}},{\"key\":\"b7pob\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}}],\"entityMap\":{\"0\":{\"type\":\"code_insert\",\"mutability\":\"IMMUTABLE\",\"data\":{\"blocks\":[{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"557s7\",\"text\":\"bwa mem \\\\\\n     -M -t 20\\\\\\n     -R '@RG\\\\tID:1\\\\tSM:{sample.name}\\\\tPL:ILLUMINA\\\\tLB:lin\\\\tPU:{platform.name}' \\\\\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"1ajt7\",\"text\":\"     /path/reference.fa \\\\ # reference genome\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"7sp3b\",\"text\":\"     /path/input_R1.fastq.qz \\\\ # trimmed forward reads\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"1mtj2\",\"text\":\"     /path/input_R2.fastq.gz |\\\\ # trimmed reverse reads\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"1j6oo\",\"text\":\"  samtools view -b \\u003e /path/output.bam\",\"type\":\"unstyled\"}],\"entityMap\":{}}}}}","data":null,"protocol_id":92513,"case_id":0,"critical_ids":"","duration":0,"original_id":0,"number":"7","cases":[],"critical":null},{"id":1884168,"guid":"E708AB4A21A349D893E116D806AA89C9","previous_id":1884163,"previous_guid":"6117A130A0B04AA8A36B26B99D31237E","section":"\u003cp\u003eRead mapping\u003c/p\u003e","section_color":"#84CE84","section_duration":0,"is_substep":false,"step":"{\"blocks\":[{\"key\":\"b3109\",\"text\":\"2.3) Post mapping read data sorting:\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[{\"style\":\"bold\",\"offset\":0,\"length\":36}],\"entityRanges\":[],\"data\":{}},{\"key\":\"26j6f\",\"text\":\"After mapping reads, some additional intermediate steps are needed before we can start variant calling. These steps vary depending on the type of analysis conducted and which software are used. For this default pipeline, we follow the guidelines from the samtools website (http://www.htslib.org/algorithms/duplicate.html). Our intermediate steps are i) reordering reads in the BAM, ii) identifying possible duplicated reads, and iii) creating a summary report. \",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[{\"style\":\"bold\",\"offset\":255,\"length\":8},{\"style\":\"bold\",\"offset\":377,\"length\":3}],\"entityRanges\":[],\"data\":{}},{\"key\":\"ebrbr\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}}],\"entityMap\":{}}","data":null,"protocol_id":92513,"case_id":0,"critical_ids":"","duration":0,"original_id":0,"number":"8","cases":[],"critical":null},{"id":1884170,"guid":"3456474BE75F4313A5267E2630021462","previous_id":1884168,"previous_guid":"E708AB4A21A349D893E116D806AA89C9","section":"\u003cp\u003eRead mapping\u003c/p\u003e","section_color":"#84CE84","section_duration":0,"is_substep":true,"step":"{\"blocks\":[{\"key\":\"1tjlv\",\"text\":\"2.3.1) Sort BAM:\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[{\"style\":\"bold\",\"offset\":0,\"length\":16}],\"entityRanges\":[],\"data\":{}},{\"key\":\"5d4nh\",\"text\":\"Sorting steps are all conducted using samtools. Reads are sorted in two ways, first alphabetically by read name using the -n option, then by genome position with the default sort command. In between these sorting steps, we run the fixmate to fill in missing details among paired reads, with the -m option adding a mate-score tag to the BAM. While this does not seem very important, this step is necessary when we identify duplicates. Each of these samtools commands is piped into a single line of code, to avoid creating a massive number of intermediate files.\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[{\"style\":\"bold\",\"offset\":38,\"length\":8},{\"style\":\"bold\",\"offset\":336,\"length\":3},{\"style\":\"bold\",\"offset\":448,\"length\":9}],\"entityRanges\":[],\"data\":{}},{\"key\":\"boiac\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}},{\"key\":\"9nti\",\"text\":\" \",\"type\":\"atomic\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[{\"key\":0,\"offset\":0,\"length\":1}],\"data\":{}},{\"key\":\"cmfi9\",\"text\":\"The samtools -@ option sets the number of threads to run, and the - are placeholders for the input and output files. These placeholders are necessary to pipe different samtools commands together.\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[{\"style\":\"bold\",\"offset\":4,\"length\":8},{\"style\":\"bold\",\"offset\":168,\"length\":9}],\"entityRanges\":[],\"data\":{}},{\"key\":\"1glpq\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}}],\"entityMap\":{\"0\":{\"type\":\"code_insert\",\"mutability\":\"IMMUTABLE\",\"data\":{\"blocks\":[{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"ad2cs\",\"text\":\"samtools collate -@ 20 -Ou /path/input.bam |\\\\ # sort by read names\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"egqef\",\"text\":\"samtools fixmate -@ 20 -m - - |\\\\ # fix mate-pair information\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"5o25t\",\"text\":\"samtools sort -@ 20 - -o /path/output.bam - # sort by positions\",\"type\":\"unstyled\"}],\"entityMap\":{}}}}}","data":null,"protocol_id":92513,"case_id":0,"critical_ids":"","duration":0,"original_id":0,"number":"8.1","cases":[],"critical":null},{"id":1884171,"guid":"6541771E5DB042EE9E5CBED4BF7DF9AB","previous_id":1884170,"previous_guid":"3456474BE75F4313A5267E2630021462","section":"\u003cp\u003eRead mapping\u003c/p\u003e","section_color":"#84CE84","section_duration":0,"is_substep":true,"step":"{\"blocks\":[{\"key\":\"cb25e\",\"text\":\"2.3.2) Mark duplicates:\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[{\"style\":\"bold\",\"offset\":0,\"length\":23}],\"entityRanges\":[],\"data\":{}},{\"key\":\"as9rt\",\"text\":\"Duplicated reads are identified in the sorted BAM with samtools markdup. PCR duplicates can occur during the amplification steps of library preparation. Another type of duplication, optical duplication, originates from technical artefacts in the clustering on the Illumina flowcell and these are not identified by default. samtools markdup uses coordinate and tile information from the read name to mark optical duplicates, using the -d option to set the distance among coordinates. Optionally both types of duplicates can be removed with the -r option. \",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[{\"style\":\"bold\",\"offset\":46,\"length\":4},{\"style\":\"bold\",\"offset\":55,\"length\":8},{\"style\":\"bold\",\"offset\":64,\"length\":7},{\"style\":\"bold\",\"offset\":323,\"length\":8},{\"style\":\"bold\",\"offset\":332,\"length\":7}],\"entityRanges\":[],\"data\":{}},{\"key\":\"fje6b\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}},{\"key\":\"12csk\",\"text\":\" \",\"type\":\"atomic\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[{\"key\":0,\"offset\":0,\"length\":1}],\"data\":{}},{\"key\":\"cs0g5\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}}],\"entityMap\":{\"0\":{\"type\":\"code_insert\",\"mutability\":\"IMMUTABLE\",\"data\":{\"blocks\":[{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"ckm3g\",\"text\":\"samtools markdup -@ 20 -d 100 /path/input.bam /path/output.bam\",\"type\":\"unstyled\"}],\"entityMap\":{}}}}}","data":null,"protocol_id":92513,"case_id":0,"critical_ids":"","duration":0,"original_id":0,"number":"8.2","cases":[],"critical":null},{"id":1884172,"guid":"26084948E5CF4D73BD66A89F078420C9","previous_id":1884171,"previous_guid":"6541771E5DB042EE9E5CBED4BF7DF9AB","section":"\u003cp\u003eRead mapping\u003c/p\u003e","section_color":"#84CE84","section_duration":0,"is_substep":true,"step":"{\"blocks\":[{\"key\":\"4ah8m\",\"text\":\"2.3.3) Index and generate flagstat report:\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[{\"style\":\"bold\",\"offset\":0,\"length\":42}],\"entityRanges\":[],\"data\":{}},{\"key\":\"8nbe1\",\"text\":\"Duplicate marked BAM files are indexed with samtools index and a summary table of BAM flags is generated with samtools flagstat. Neither step is necessary for our variant calling, but index files are required for several programs that take BAM inputs, and the flagstats reports are a convenient way to assess overall mapping quality (e.g. the percentage of mapped reads, the number of duplicates, mappings to more than one location). See table 1 for a comparison of mapping quality among different Littorina species.\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[{\"style\":\"bold\",\"offset\":17,\"length\":4},{\"style\":\"bold\",\"offset\":44,\"length\":8},{\"style\":\"bold\",\"offset\":53,\"length\":6},{\"style\":\"bold\",\"offset\":82,\"length\":3},{\"style\":\"bold\",\"offset\":110,\"length\":17},{\"style\":\"bold\",\"offset\":240,\"length\":3}],\"entityRanges\":[],\"data\":{}},{\"key\":\"19ddl\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}},{\"key\":\"21srl\",\"text\":\" \",\"type\":\"atomic\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[{\"key\":0,\"offset\":0,\"length\":1}],\"data\":{}},{\"key\":\"eprl1\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}},{\"key\":\"3ifbs\",\"text\":\" \",\"type\":\"atomic\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[{\"key\":1,\"offset\":0,\"length\":1}],\"data\":{}},{\"key\":\"364pr\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}}],\"entityMap\":{\"0\":{\"type\":\"code_insert\",\"mutability\":\"IMMUTABLE\",\"data\":{\"blocks\":[{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"1aq7q\",\"text\":\"samtools index -b /path/input.bam\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"3mnv0\",\"text\":\"samtools flagstat /path/input.bam \\u003e /path/output.flagstat\",\"type\":\"unstyled\"}],\"entityMap\":{}}},\"1\":{\"type\":\"tables\",\"mutability\":\"MUTABLE\",\"data\":{\"cellsMeta\":{\"0_0\":\"\",\"0_1\":\"\",\"0_2\":\"\",\"0_3\":\"\",\"0_4\":\"\",\"1_0\":\"\",\"1_1\":\"\",\"1_2\":\"\",\"1_3\":\"\",\"1_4\":\"\",\"2_0\":\"\",\"2_1\":\"\",\"2_2\":\"\",\"2_3\":\"\",\"2_4\":\"\",\"3_0\":\"\",\"3_1\":\"\",\"3_2\":\"\",\"3_3\":\"\",\"3_4\":\"\",\"4_0\":\"\",\"4_1\":\"\",\"4_2\":\"\",\"4_3\":\"\",\"4_4\":\"\",\"5_0\":\"\",\"5_1\":\"\",\"5_2\":\"\",\"5_3\":\"\",\"5_4\":\"\",\"6_0\":\"\",\"6_1\":\"\",\"6_2\":\"\",\"6_3\":\"\",\"6_4\":\"\",\"A_1\":{\"className\":\"_dt-italic\"},\"A_2\":{\"className\":\"_dt-italic\"},\"A_3\":{\"className\":\"_dt-italic\"},\"A_4\":{\"className\":\"_dt-italic\"},\"A_5\":{\"className\":\"_dt-italic\"},\"A_6\":{\"className\":\"_dt-italic\"},\"B_1\":{\"className\":\"_dt-h-center\"},\"B_2\":{\"className\":\"_dt-h-center\"},\"B_3\":{\"className\":\"_dt-h-center\"},\"B_4\":{\"className\":\"_dt-h-center\"},\"B_5\":{\"className\":\"_dt-h-center\"},\"B_6\":{\"className\":\"_dt-h-center\"},\"C_1\":{\"className\":\"_dt-h-center\"},\"C_2\":{\"className\":\"_dt-h-center\"},\"C_3\":{\"className\":\"_dt-h-center\"},\"C_4\":{\"className\":\"_dt-h-center\"},\"C_5\":{\"className\":\"_dt-h-center\"},\"C_6\":{\"className\":\"_dt-h-center\"},\"D_1\":{\"className\":\"_dt-h-center\"},\"D_2\":{\"className\":\"_dt-h-center\"},\"D_3\":{\"className\":\"_dt-h-center\"},\"D_4\":{\"className\":\"_dt-h-center\"},\"D_5\":{\"className\":\"_dt-h-center\"},\"D_6\":{\"className\":\"_dt-h-center\"},\"E_1\":{\"className\":\"_dt-h-center\"},\"E_2\":{\"className\":\"_dt-h-center\"},\"E_3\":{\"className\":\"_dt-h-center\"},\"E_4\":{\"className\":\"_dt-h-center\"},\"E_5\":{\"className\":\"_dt-h-center\"},\"E_6\":{\"className\":\"_dt-h-center\"}},\"colTitles\":[\"Species\",\"Mapped\",\"Primary\",\"Paired\",\"N\"],\"colWidths\":[100,100,100,100,100],\"data\":[[\"L. saxatilis\",\"98.77%\",\"75.35%\",\"53.18%\",\"4\"],[\"L. obtusata\",\"97.61%\",\"81.39%\",\"73.72%\",\"14\"],[\"L. fabilis\",\"97.91%\",\"80.38%\",\"71.91%\",\"432\"],[\"L. compressa\",\"98.60%\",\"92.39%\",\"80.02%\",\"8\"],[\"L. arcana\",\"98.69%\",\"93.00%\",\"82.15%\",\"8\"],[\"L. saxatilis\",\"98.77%\",\"93.15%\",\"82.82%\",\"137\"]],\"guid\":\"98A251465EFB455693C557642CF3C628\",\"isJexcelDataFormat\":true,\"legend\":{\"blocks\":[{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[{\"length\":9,\"offset\":0,\"style\":\"bold\"},{\"length\":1,\"offset\":16,\"style\":\"bold\"},{\"length\":1,\"offset\":202,\"style\":\"bold\"},{\"length\":6,\"offset\":213,\"style\":\"bold\"},{\"length\":7,\"offset\":287,\"style\":\"bold\"},{\"length\":6,\"offset\":362,\"style\":\"bold\"}],\"key\":\"1vtbg\",\"text\":\"Table 1: Example mapping statistics for different species in the genus Littorina, mapped to the L. saxatilis v.2 reference genome (De Jode, et al., in review). Values are the average percentages across N samples. Mapped indicates the percentage of reads aligned to the reference genome. Primary excludes lower quality reads mapped to multiple genomic positions. Paired represents both the forward and reverse reads mapping to the same genomic region. \",\"type\":\"unstyled\"}],\"entityMap\":{}},\"mergeCells\":{},\"printData\":[[\"L. saxatilis\",\"98.77%\",\"75.35%\",\"53.18%\",\"4\"],[\"L. obtusata\",\"97.61%\",\"81.39%\",\"73.72%\",\"14\"],[\"L. fabilis\",\"97.91%\",\"80.38%\",\"71.91%\",\"432\"],[\"L. compressa\",\"98.60%\",\"92.39%\",\"80.02%\",\"8\"],[\"L. arcana\",\"98.69%\",\"93.00%\",\"82.15%\",\"8\"],[\"L. saxatilis\",\"98.77%\",\"93.15%\",\"82.82%\",\"137\"]],\"rowHeights\":[23,23,23,23,23,23]}}}}","data":null,"protocol_id":92513,"case_id":0,"critical_ids":"","duration":0,"original_id":0,"number":"8.3","cases":[],"critical":null},{"id":1884299,"guid":"8CDB112F56A640ECA768184DB8DBDBFE","previous_id":1884154,"previous_guid":"17205D0D90004B7CA0A20A9F97EA5540","section":"\u003cp\u003eVariant calling\u003c/p\u003e","section_color":"#FFED92","section_duration":0,"is_substep":true,"step":"{\"blocks\":[{\"key\":\"55mia\",\"text\":\"3.1) mpileup:\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[{\"style\":\"bold\",\"offset\":0,\"length\":13}],\"entityRanges\":[],\"data\":{}},{\"key\":\"fqj4u\",\"text\":\"This step estimates a genotype likelihood for each variant. mpileup files can take some time to generate. Splitting the genome into regions with -r CHROM:POS, speeds up the process by parallelising the job. Splitting is done by chromosome, splitting some of the larger chromosomes in half. The -a option tells bcftools to annotate the mpileup with additional quality scores. We add allele depth (AD), total depth (DP) and strand bias (SP) per site to the FORMAT field, and the allelic depth (AD) per individual to the INFO field.\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[{\"style\":\"bold\",\"offset\":60,\"length\":7},{\"style\":\"bold\",\"offset\":310,\"length\":9},{\"style\":\"bold\",\"offset\":335,\"length\":8}],\"entityRanges\":[],\"data\":{}},{\"key\":\"1sfcb\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}},{\"key\":\"db0t2\",\"text\":\" \",\"type\":\"atomic\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[{\"key\":0,\"offset\":0,\"length\":1}],\"data\":{}},{\"key\":\"19bnj\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}}],\"entityMap\":{\"0\":{\"type\":\"code_insert\",\"mutability\":\"IMMUTABLE\",\"data\":{\"blocks\":[{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"9955j\",\"text\":\"bcftools mpileup \\\\\\n\\t--threads 20 \\\\\\n      -a FORMAT/AD,FORMAT/DP,FORMAT/SP,INFO/AD \\\\ # specify tags\\n\\t-f /path/reference.fa \\\\ # reference genome\\n\\t-b /path/list.of.bams \\\\\\n\\t-r CHROM:POS |\\\\ # optional for parallelising\",\"type\":\"unstyled\"}],\"entityMap\":{}}}}}","data":null,"protocol_id":92513,"case_id":0,"critical_ids":"","duration":0,"original_id":0,"number":"9.1","cases":[],"critical":null},{"id":1884300,"guid":"06EC2B15AB8248208EBAF0DD3F48A588","previous_id":1884299,"previous_guid":"8CDB112F56A640ECA768184DB8DBDBFE","section":"\u003cp\u003eVariant calling\u003c/p\u003e","section_color":"#FFED92","section_duration":0,"is_substep":true,"step":"{\"blocks\":[{\"key\":\"5qc7g\",\"text\":\"3.2) Variant call:\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[{\"style\":\"bold\",\"offset\":0,\"length\":18}],\"entityRanges\":[],\"data\":{}},{\"key\":\"6svlo\",\"text\":\"The next step is to call variant sites with bcftools call. The -m option activates the multiallelic calling mode, -Oz compresses the output, and -f GQ,GP includes genotype quality (GQ) and genotype probability (GP) in the output. We recommend calling both variant and invariant sites (of sufficient quality), as invariant positions are needed to correctly calculate many population genetic statistics  (e.g. π and dxy). \",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[{\"style\":\"bold\",\"offset\":44,\"length\":13},{\"style\":\"bold\",\"offset\":144,\"length\":1}],\"entityRanges\":[],\"data\":{}},{\"key\":\"33c5e\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}},{\"key\":\"8gcph\",\"text\":\" \",\"type\":\"atomic\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[{\"key\":0,\"offset\":0,\"length\":1}],\"data\":{}},{\"key\":\"1gknl\",\"text\":\"There are a few options to consider when calling variants. Downstream processes can be sped up by changing the output to be in binary call format (BCF) with -Ob. However, this will increase the file size. If space is limited, set -v to remove invariant sites from the output, but this limits the potential for some downstream analysis.\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[{\"style\":\"bold\",\"offset\":147,\"length\":3}],\"entityRanges\":[],\"data\":{}}],\"entityMap\":{\"0\":{\"type\":\"code_insert\",\"mutability\":\"IMMUTABLE\",\"data\":{\"blocks\":[{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"6vqrn\",\"text\":\"bcftools call \\\\\\n\\t--threads 20 \\\\\\n\\t-f GQ,GP \\\\\\n\\t-m -Oz \\\\ # add -v to drop invariant sites\\n\\t-o /path/output.vcf.gz\",\"type\":\"unstyled\"}],\"entityMap\":{}}}}}","data":null,"protocol_id":92513,"case_id":0,"critical_ids":"","duration":0,"original_id":0,"number":"9.2","cases":[],"critical":null},{"id":1884301,"guid":"47BD7E28FF8C4E29BC7D8439412DDDED","previous_id":1884155,"previous_guid":"8274B4E3175541B18F7FD4A24775CBC9","section":"\u003cp\u003eVariant filtering\u003c/p\u003e","section_color":"#EA9F6C","section_duration":0,"is_substep":false,"step":"{\"blocks\":[{\"key\":\"7k9ip\",\"text\":\"4.1) Hard filters:\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[{\"style\":\"bold\",\"offset\":0,\"length\":18}],\"entityRanges\":[],\"data\":{}},{\"key\":\"7tv4e\",\"text\":\"The goal is to delete entire positions from the VCF based on criteria that suggest the site was poorly sequenced or problematic. Hard filters can also be used to remove types of variants that are not of interest, such as indels or multiallelic sites. Below are some commands for filters that are commonly applied, but this list is not exhaustive. Different variant callers also compute different quality statistics, so be aware that the names and possible options vary if you are using a different caller (e.g., GATK). Short descriptions of the quality statistics should be listed in the VCF header.\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[{\"style\":\"bold\",\"offset\":48,\"length\":3},{\"style\":\"bold\",\"offset\":512,\"length\":4},{\"style\":\"bold\",\"offset\":588,\"length\":3}],\"entityRanges\":[],\"data\":{}}],\"entityMap\":{}}","data":null,"protocol_id":92513,"case_id":0,"critical_ids":"","duration":0,"original_id":0,"number":"11","cases":[],"critical":null},{"id":1884303,"guid":"A94E0F1AC3FE4D7CB25FA57B7E4454D2","previous_id":1884301,"previous_guid":"47BD7E28FF8C4E29BC7D8439412DDDED","section":"\u003cp\u003eVariant filtering\u003c/p\u003e","section_color":"#EA9F6C","section_duration":0,"is_substep":true,"step":"{\"blocks\":[{\"key\":\"dvogp\",\"text\":\"4.1.1) Remove indels and multallelic sites:\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[{\"style\":\"bold\",\"offset\":0,\"length\":43}],\"entityRanges\":[],\"data\":{}},{\"key\":\"cpnnf\",\"text\":\"Firstly, we remove types of variants which are not interesting for our research. Typically for WGS analysis, indels and multiallelic variants are removed, but there is some evidence that they may contribute to evolutionary processes (Perini 2021). We opted for not just removing indels, but also SNPs within 5bp of them as these sites tend to be problematic due to errors in the realignment process. The -g 5:indel,other option removes sites around indels, while the -v snps keeps only SNPs. We also remove multiallelic sites by setting -M 2. Specifically, this option caps the number of alleles per site to two. Optionally, a minimum can be set with -m 2 to remove invariant sites.\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}},{\"key\":\"171k1\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}},{\"key\":\"3jnqv\",\"text\":\" \",\"type\":\"atomic\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[{\"key\":0,\"offset\":0,\"length\":1}],\"data\":{}},{\"key\":\"1vuh4\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}},{\"key\":\"6kcf8\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}}],\"entityMap\":{\"0\":{\"type\":\"code_insert\",\"mutability\":\"IMMUTABLE\",\"data\":{\"blocks\":[{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"dc80t\",\"text\":\"bcftools filter -Ou -g 5:indel,other /path/output.vcf.gz |\\\\\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"1643q\",\"text\":\"bcftools view -Oz -M 2 -v snps \\u003e /path/SNP_only.vcf.gz\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"6r024\",\"text\":\"# Add -m 2 to last line to remove invariant sites\",\"type\":\"unstyled\"}],\"entityMap\":{}}}}}","data":null,"protocol_id":92513,"case_id":0,"critical_ids":"","duration":0,"original_id":0,"number":"11.1","cases":[],"critical":null},{"id":1884306,"guid":"F06D7CB1C258455C8B0A25A2418C392D","previous_id":1884303,"previous_guid":"A94E0F1AC3FE4D7CB25FA57B7E4454D2","section":"\u003cp\u003eVariant filtering\u003c/p\u003e","section_color":"#EA9F6C","section_duration":0,"is_substep":true,"step":"{\"blocks\":[{\"key\":\"fb5vj\",\"text\":\"4.1.2) Total read depth per site:\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[{\"style\":\"bold\",\"offset\":0,\"length\":33}],\"entityRanges\":[],\"data\":{}},{\"key\":\"9va54\",\"text\":\"Next we filter by total read depth per site (INFO/DP). This is the sum of reads across all samples. Only an upper limit is generally needed, as low read depth will be filtered by other steps (see soft filters). When depth is too high we recommend removing the whole site, as these can represent repeated sequences and misalignments of the reference genome. A common criterion is to drop sites with more than 2.5x the average coverage.\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}},{\"key\":\"f4dim\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}},{\"key\":\"c44ql\",\"text\":\" \",\"type\":\"atomic\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[{\"key\":0,\"offset\":0,\"length\":1}],\"data\":{}},{\"key\":\"73hv8\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}}],\"entityMap\":{\"0\":{\"type\":\"code_insert\",\"mutability\":\"IMMUTABLE\",\"data\":{\"blocks\":[{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"8lmri\",\"text\":\"bcftools filter -Oz -e “INFO/DP\\u003e2.5*AVG(INFO/DP)” /path/SNP_only.vcf.gz \\u003e /path/DP_filt.vcf.gz\",\"type\":\"unstyled\"}],\"entityMap\":{}}}}}","data":null,"protocol_id":92513,"case_id":0,"critical_ids":"","duration":0,"original_id":0,"number":"11.2","cases":[],"critical":null},{"id":1884308,"guid":"6E88290EB9F542E78AB87C144333C0A0","previous_id":1884306,"previous_guid":"F06D7CB1C258455C8B0A25A2418C392D","section":"\u003cp\u003eVariant filtering\u003c/p\u003e","section_color":"#EA9F6C","section_duration":0,"is_substep":true,"step":"{\"blocks\":[{\"key\":\"fbcbn\",\"text\":\"4.1.2b) Setting a minimum total depth filter [conditional]\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[{\"style\":\"bold\",\"offset\":0,\"length\":58}],\"entityRanges\":[],\"data\":{}},{\"key\":\"e4\",\"text\":\"For high coverage calls including invariant sites you can set a lower limit to remove sites where there is a risk of calling an invariant site by mistake.  We recommend dropping sites with fewer reads than 14 x the number of samples. The parameter 14 is based on the distribution of variant and invariant sites in L. saxatilis data (Stankowski et al., 2023). \",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}},{\"key\":\"6ktd4\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}},{\"key\":\"2qf2i\",\"text\":\"Again, do not set  the lower INFO/DP filter for low coverage data. This will throw away too many good quality sites. We do not want to toss the baby with the bath water.\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}},{\"key\":\"8rn7h\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}}],\"entityMap\":{}}","data":null,"protocol_id":92513,"case_id":0,"critical_ids":"","duration":0,"original_id":0,"number":"11.3","cases":[],"critical":null},{"id":1884310,"guid":"B4141145DC164C83849A4643BFA91B00","previous_id":1884308,"previous_guid":"6E88290EB9F542E78AB87C144333C0A0","section":"\u003cp\u003eVariant filtering\u003c/p\u003e","section_color":"#EA9F6C","section_duration":0,"is_substep":true,"step":"{\"blocks\":[{\"key\":\"chbma\",\"text\":\"4.1.3) mapping quality, genotype quality and strand-bias:\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[{\"style\":\"bold\",\"offset\":0,\"length\":57}],\"entityRanges\":[],\"data\":{}},{\"key\":\"em5eu\",\"text\":\"Three more steps are involved in hard filtering, mapping quality (MQ), site call quality (QUAL) and strand bias (SP) filters. All three use Phred quality scores, which correspond to the probability of an error. The Phred scale is logarithmic, so larger scores indicate a lower probability of error. For example, a Phred-score of 20 indicates a 1% change of an error and a Phred-score of 30 indicates a 0.1% chance. \",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}},{\"key\":\"9ni50\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}},{\"key\":\"df22i\",\"text\":\"The first Phred-score is MQ, the average mapping quality at a site. Typically this should be set high to drop poorly mapped positions. Values between 30 and 40 are common. \",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}},{\"key\":\"dkhna\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}},{\"key\":\"97u99\",\"text\":\" \",\"type\":\"atomic\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[{\"key\":0,\"offset\":0,\"length\":1}],\"data\":{}},{\"key\":\"78cb3\",\"text\":\"QUAL is the probability that the alternative allele call was wrong. A score of 30 is common.\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}},{\"key\":\"87uoc\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}},{\"key\":\"1gh2q\",\"text\":\" \",\"type\":\"atomic\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[{\"key\":1,\"offset\":0,\"length\":1}],\"data\":{}},{\"key\":\"282g\",\"text\":\"Lastly, SP is the probability that one DNA strand is sequenced at a higher frequency than the other. Dropping SP \\u003e 3 is recommended as a light filter. Your threshold should be based on the distribution of scores (Fig. 2).\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}},{\"key\":\"8usl1\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}},{\"key\":\"22jfb\",\"text\":\" \",\"type\":\"atomic\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[{\"key\":2,\"offset\":0,\"length\":1}],\"data\":{}},{\"key\":\"2v6l1\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}}],\"entityMap\":{\"0\":{\"type\":\"code_insert\",\"mutability\":\"IMMUTABLE\",\"data\":{\"blocks\":[{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"cj2gv\",\"text\":\"bcftools filter -Oz -e “MQ\\u003c30” /path/DP_filt.vcf.gz \\u003e /path/MQ_filt.vcf.gz\",\"type\":\"unstyled\"}],\"entityMap\":{}}},\"1\":{\"type\":\"code_insert\",\"mutability\":\"IMMUTABLE\",\"data\":{\"blocks\":[{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"ffjqd\",\"text\":\"bcftools filter -Oz -e “QUAL\\u003c30” /path/MQ_filt.vcf.gz \\u003e /path/QUAL_filt.vcf.gz\",\"type\":\"unstyled\"}],\"entityMap\":{}}},\"2\":{\"type\":\"code_insert\",\"mutability\":\"IMMUTABLE\",\"data\":{\"blocks\":[{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"di6d3\",\"text\":\"bcftools filter -Oz -e “SP\\u003e3” /path/QUAL_filt.vcf.gz \\u003e /path/SP_filt.vcf.gz\",\"type\":\"unstyled\"}],\"entityMap\":{}}}}}","data":null,"protocol_id":92513,"case_id":0,"critical_ids":"","duration":0,"original_id":0,"number":"11.4","cases":[],"critical":null},{"id":1884316,"guid":"4C9D0E47AC1E47B79A01677E88A891BC","previous_id":1884310,"previous_guid":"B4141145DC164C83849A4643BFA91B00","section":"\u003cp\u003eVariant filtering\u003c/p\u003e","section_color":"#EA9F6C","section_duration":0,"is_substep":false,"step":"{\"blocks\":[{\"key\":\"eljnn\",\"text\":\"4.2) Soft filters:\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[{\"style\":\"bold\",\"offset\":0,\"length\":18}],\"entityRanges\":[],\"data\":{}},{\"key\":\"1vclc\",\"text\":\"After we have arrived at a set of variants that we feel are of adequate quality, we will now soft filter individual genotypes to mask those that we do not trust. Soft filters \",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}},{\"key\":\"epkfk\",\"text\":\"will set genotypes that do not pass our filters to missing (./.) while genotypes that pass the filters remain unaffected.  \",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}},{\"key\":\"6ee1v\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}},{\"key\":\"e8008\",\"text\":\"For bcftools the two soft filtered statistics are the genotype quality score (GQ) and depth of coverage (FMT/DP) per sample. GQ is Phred scored, thus GQ of 20 indicates a 1% chance that the call is incorrect for that sample. A GQ score of 30 is considered the gold standard, but might be overly conservative with low coverage data. \",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[{\"style\":\"bold\",\"offset\":4,\"length\":8}],\"entityRanges\":[],\"data\":{}},{\"key\":\"7h92h\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}},{\"key\":\"3h295\",\"text\":\"FMT/DP is the depth from the format field of the VCF (i.e. the coverage for each sample). At least 2 reads need to be present to call a heterozygote in diploid data. However, at FMT/DP = 2 there is only a 50% chance that we have seen both alleles. 5 reads gives us a 93.8% chance. With 10 reads this goes up to 99.8%, but if the threshold is above the targeted coverage most sites will be dropped. In short, the higher thresholds are more accurate, but the appropriate choice depends on sequencing depth.\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[{\"style\":\"bold\",\"offset\":49,\"length\":3}],\"entityRanges\":[],\"data\":{}},{\"key\":\"7oq0c\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}},{\"key\":\"esjn8\",\"text\":\" \",\"type\":\"atomic\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[{\"key\":0,\"offset\":0,\"length\":1}],\"data\":{}},{\"key\":\"fjf0k\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}}],\"entityMap\":{\"0\":{\"type\":\"code_insert\",\"mutability\":\"IMMUTABLE\",\"data\":{\"blocks\":[{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"62pbp\",\"text\":\"bcftools filter -S .-e \\\"FMT/GQ\\u003c20 || FMT/DP\\u003c5\\\" /path/SP_filt.vcf.gz \\u003e /path/soft_filt.vcf.gz   \",\"type\":\"unstyled\"}],\"entityMap\":{}}}}}","data":null,"protocol_id":92513,"case_id":0,"critical_ids":"","duration":0,"original_id":0,"number":"12","cases":[],"critical":null},{"id":1884319,"guid":"8DF047E0B66D40539613376A683D4746","previous_id":1884316,"previous_guid":"4C9D0E47AC1E47B79A01677E88A891BC","section":"\u003cp\u003eVariant filtering\u003c/p\u003e","section_color":"#EA9F6C","section_duration":0,"is_substep":false,"step":"{\"blocks\":[{\"key\":\"cgktq\",\"text\":\"4.3) Filter out missing data:\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[{\"style\":\"bold\",\"offset\":0,\"length\":29}],\"entityRanges\":[],\"data\":{}},{\"key\":\"8s2kj\",\"text\":\"After setting low quality genotypes to missing, we need to remove sites with high missing data. The percentage of missing data at which we remove sites is up to the user to decide. A simple rule is that with more samples more missing data can be tolerated. Filters that remove sites with more than 10-20% missing genotypes are common.\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}},{\"key\":\"cunm7\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}},{\"key\":\"2q8s4\",\"text\":\" \",\"type\":\"atomic\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[{\"key\":0,\"offset\":0,\"length\":1}],\"data\":{}},{\"key\":\"5tsea\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}}],\"entityMap\":{\"0\":{\"type\":\"code_insert\",\"mutability\":\"IMMUTABLE\",\"data\":{\"blocks\":[{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"ds4l0\",\"text\":\"bcftools filter -e \\\"F_MISSING\\u003e0.1\\\" /path/soft_filt.vcf.gz \\u003e /path/filtered.vcf.gz \",\"type\":\"unstyled\"}],\"entityMap\":{}}}}}","data":null,"protocol_id":92513,"case_id":0,"critical_ids":"","duration":0,"original_id":0,"number":"13","cases":[],"critical":null},{"id":1884321,"guid":"9606B0B0D1BC4EFC949941C3CC1E7E70","previous_id":1884319,"previous_guid":"8DF047E0B66D40539613376A683D4746","section":"\u003cp\u003eVariant filtering\u003c/p\u003e","section_color":"#EA9F6C","section_duration":0,"is_substep":false,"step":"{\"blocks\":[{\"key\":\"sb4i\",\"text\":\"4.4) How do I choose filtering thresholds for my data?\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[{\"style\":\"bold\",\"offset\":0,\"length\":54}],\"entityRanges\":[],\"data\":{}},{\"key\":\"asv2k\",\"text\":\"Before and after applying a filter it is good practice to plot the distributions of key VCF statistics. There are no strict rules for choosing filters, only guidelines. Examples for some Littorina datasets are provided in Table 2.  Do not blindly follow our example filters (Table 2). They are a starting point, to get a feel for how scores are distributed. We strongly recommend looking at the quality scores of each VCF before filtering. One must use common sense, logic and the shapes of the distributions to decide the best thresholds. After filtering, it is useful to replot these distributions to ensure that the filter worked as expected. \",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[{\"style\":\"bold\",\"offset\":88,\"length\":4},{\"style\":\"bold\",\"offset\":418,\"length\":4}],\"entityRanges\":[],\"data\":{}},{\"key\":\"f0g0e\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}},{\"key\":\"70r0\",\"text\":\" \",\"type\":\"atomic\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[{\"key\":0,\"offset\":0,\"length\":1}],\"data\":{}},{\"key\":\"6m4g4\",\"text\":\"Quality scores can be extracted from a VCF with bcftools query. The results can then be plotted in R, or any other data analysis program. Trying this for the full data set is very time consuming as there is a lot of data to view. To speed things up, we recommend randomly downsampling a small proportion of SNPs using vcfrandomsample from the vcflib package (Garrison et al. 2022). For information on filtering invariant positions, see the supplementary information in Stankowski et al. 2023. \",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[{\"style\":\"bold\",\"offset\":39,\"length\":3},{\"style\":\"bold\",\"offset\":48,\"length\":14},{\"style\":\"bold\",\"offset\":99,\"length\":1},{\"style\":\"bold\",\"offset\":318,\"length\":15},{\"style\":\"bold\",\"offset\":343,\"length\":6}],\"entityRanges\":[],\"data\":{}},{\"key\":\"2g4u\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}},{\"key\":\"17ssg\",\"text\":\" \",\"type\":\"atomic\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[{\"key\":1,\"offset\":0,\"length\":1}],\"data\":{}},{\"key\":\"jntf\",\"text\":\"bcftools query uses the -f option to query. This is followed by a string expression in quotation marks. See the full bcftools manual for details. We are extracting the chromosome name (CHROM), site position (POS) and the focal score. This last value can be set to score in the VCF. By default the score for each site (often site average) is extracted. Place square brackets around the value to get the score for each genotype.\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[{\"style\":\"bold\",\"offset\":0,\"length\":15},{\"style\":\"bold\",\"offset\":117,\"length\":8},{\"style\":\"bold\",\"offset\":277,\"length\":3}],\"entityRanges\":[],\"data\":{}},{\"key\":\"fpic3\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}},{\"key\":\"5iof6\",\"text\":\" \",\"type\":\"atomic\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[{\"key\":2,\"offset\":0,\"length\":1}],\"data\":{}},{\"key\":\"92q1k\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}},{\"key\":\"ck5kk\",\"text\":\" \",\"type\":\"atomic\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[{\"key\":3,\"offset\":0,\"length\":1}],\"data\":{}},{\"key\":\"93tvq\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}},{\"key\":\"c300j\",\"text\":\" \",\"type\":\"atomic\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[{\"key\":4,\"offset\":0,\"length\":1}],\"data\":{}},{\"key\":\"eq2h\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}},{\"key\":\"8p53e\",\"text\":\" \",\"type\":\"atomic\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[{\"key\":5,\"offset\":0,\"length\":1}],\"data\":{}},{\"key\":\"4nif6\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}},{\"key\":\"9nn2u\",\"text\":\" \",\"type\":\"atomic\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[{\"key\":6,\"offset\":0,\"length\":1}],\"data\":{}},{\"key\":\"b6ji9\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}},{\"key\":\"897d6\",\"text\":\"For strand-bias we are looking at the average score per site. While we could download all scores then calculate the average, it is much faster to calculate the average beforehand. Below, we use the awk command to directly calculate the row averages from the bcftools query output. \",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[{\"style\":\"bold\",\"offset\":198,\"length\":3},{\"style\":\"bold\",\"offset\":258,\"length\":14}],\"entityRanges\":[],\"data\":{}},{\"key\":\"ah8pj\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}},{\"key\":\"e8nbb\",\"text\":\" \",\"type\":\"atomic\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[{\"key\":7,\"offset\":0,\"length\":1}],\"data\":{}},{\"key\":\"avemm\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}},{\"key\":\"a8i6e\",\"text\":\"Our VCF does not automatically include the fraction of missing genotypes per site (FMISS). FMISS is added using the +fill-tags plugin. This plugin was introduced in version 1.2 of bcftools.\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[{\"style\":\"bold\",\"offset\":4,\"length\":3},{\"style\":\"bold\",\"offset\":180,\"length\":8}],\"entityRanges\":[],\"data\":{}},{\"key\":\"48m8k\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}},{\"key\":\"6lrik\",\"text\":\" \",\"type\":\"atomic\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[{\"key\":8,\"offset\":0,\"length\":1}],\"data\":{}},{\"key\":\"63tst\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}},{\"key\":\"5kd3s\",\"text\":\"Since we are extracting scores, it is a good idea to also look at the distribution of allele frequencies. Although we will not filter these scores, the distribution can indicate possible problems with the data.\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}},{\"key\":\"bt2al\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}},{\"key\":\"b61pb\",\"text\":\" \",\"type\":\"atomic\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[{\"key\":9,\"offset\":0,\"length\":1}],\"data\":{}},{\"key\":\"7lenl\",\"text\":\"Once quality scores are extracted you can plot them to determine your filtering thresholds. These can then be compared to the values after filtering (Fig. 2). We show how to do this for total site depth in R script.\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[{\"style\":\"bold\",\"offset\":206,\"length\":2}],\"entityRanges\":[],\"data\":{}},{\"key\":\"52g3g\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}},{\"key\":\"ekh8r\",\"text\":\" \",\"type\":\"atomic\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[{\"key\":10,\"offset\":0,\"length\":1}],\"data\":{}},{\"key\":\"1trq\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}},{\"key\":\"8eeaj\",\"text\":\" \",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}},{\"key\":\"941r3\",\"text\":\" \",\"type\":\"atomic\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[{\"key\":11,\"offset\":0,\"length\":1}],\"data\":{}},{\"key\":\"du0g2\",\"text\":\" \",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}}],\"entityMap\":{\"0\":{\"type\":\"tables\",\"mutability\":\"MUTABLE\",\"data\":{\"cellsMeta\":{\"0_0\":\"\",\"0_1\":\"\",\"0_2\":\"\",\"0_3\":\"\",\"0_4\":\"\",\"0_5\":\"\",\"0_6\":\"\",\"0_7\":\"\",\"1_0\":\"\",\"1_1\":\"\",\"1_2\":\"\",\"1_3\":\"\",\"1_4\":\"\",\"1_5\":\"\",\"1_6\":\"\",\"1_7\":\"\",\"2_0\":\"\",\"2_1\":\"\",\"2_2\":\"\",\"2_3\":\"\",\"2_4\":\"\",\"2_5\":\"\",\"2_6\":\"\",\"2_7\":\"\"},\"colTitles\":[\"Type\",\"INFO/DP\",\"MQ\",\"QUAL\",\"SP\",\"GQ\",\"FMT/DP\",\"FMISS\"],\"colWidths\":[\"129\",\"74\",\"53\",\"59\",\"46\",\"41\",\"72\",\"63\"],\"data\":[[\"Low coverage WGS (3X)\",\"-\",\"\\u0026lt; 20\",\"\\u0026lt; 30\",\"\\u0026gt; 3\",\"\\u0026lt; 20\",\"\\u0026lt; 1 | \\u0026gt;18\",\"\\u0026gt; 20%\"],[\"High coverage WGS (20X)\",\"\\u0026gt; 2xMDP\",\"\\u0026lt; 40\",\"\\u0026lt; 30\",\"\\u0026gt; 3\",\"\\u0026lt; 20\",\"\\u0026lt; 5\",\"\\u0026gt;10%\"]],\"guid\":\"9348FE2295DD4DF6B3B3FE3B515C4BCE\",\"isJexcelDataFormat\":true,\"legend\":{\"blocks\":[{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[{\"length\":8,\"offset\":0,\"style\":\"bold\"},{\"length\":8,\"offset\":89,\"style\":\"bold\"},{\"length\":2,\"offset\":172,\"style\":\"bold\"},{\"length\":4,\"offset\":207,\"style\":\"bold\"},{\"length\":2,\"offset\":250,\"style\":\"bold\"},{\"length\":6,\"offset\":310,\"style\":\"bold\"},{\"length\":2,\"offset\":344,\"style\":\"bold\"},{\"length\":5,\"offset\":380,\"style\":\"bold\"}],\"key\":\"6u8fl\",\"text\":\"Table 2: Example thresholds for Littorina data with low and high coverage. Hard filters: INFO/DP = total read coverage across all samples.  With MDP = average depth score. MQ = phred-scaled mapping quality. QUAL = phred-scaled variant call quality.  SP = phred-scaled probability of strand bias. Soft filters: FMT/DP = read depth per genotype. GQ = phred-scaled genotype quality. FMISS = proportion of samples missing per site.\",\"type\":\"unstyled\"}],\"entityMap\":{}},\"mergeCells\":{},\"printData\":[[\"Low coverage WGS (3X)\",\"-\",\"\\u0026lt; 20\",\"\\u0026lt; 30\",\"\\u0026gt; 3\",\"\\u0026lt; 20\",\"\\u0026lt; 1 | \\u0026gt;18\",\"\\u0026gt; 20%\"],[\"High coverage WGS (20X)\",\"\\u0026gt; 2xMDP\",\"\\u0026lt; 40\",\"\\u0026lt; 30\",\"\\u0026gt; 3\",\"\\u0026lt; 20\",\"\\u0026lt; 5\",\"\\u0026gt;10%\"]],\"rowHeights\":[23,23]}},\"1\":{\"type\":\"code_insert\",\"mutability\":\"IMMUTABLE\",\"data\":{\"blocks\":[{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"4est1\",\"text\":\"# Randomly sample 1% of SNPs\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"arted\",\"text\":\"bcftools view filtered.vcf.gz | vcfrandomsample -r 0.01 \\u003e subset.vcf\",\"type\":\"unstyled\"}],\"entityMap\":{}}},\"10\":{\"type\":\"code_insert\",\"mutability\":\"IMMUTABLE\",\"data\":{\"blocks\":[{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"ea8no\",\"text\":\"library(\\\"ggplot2\\\")\\n# Load data into R\\nvcfstat \\u003c- read.table(\\\"filepath/vcfstats.tDP.txt\\\",\\n\\tcol.names = c(\\\"CHROM\\\", \\\"POS\\\", \\\"STAT\\\"))\\n# Plot distribution curve\\nggplot(vcfstat, aes(STAT))+\\n\\tgeom_density(colour = \\\"red\\\")+\\n\\tlabs(x = \\\"Depth of coverage for each site\\\", y = \\\"Density\\\")+\\n\\ttheme_classic()\",\"type\":\"unstyled\"}],\"entityMap\":{}}},\"11\":{\"type\":\"image\",\"mutability\":\"MUTABLE\",\"data\":{\"guid\":\"D1F7CB4FA5534A0A867D538C62826747\",\"height\":\"558\",\"is_video\":false,\"legend\":\"{\\\"blocks\\\":[{\\\"key\\\":\\\"d18sc\\\",\\\"text\\\":\\\"Figure 2: density curves for VCF statistics before (light red) and after (dark red) filtering.  DP = total read depth per site. AF = frequency of the alternative allele. QUAL = Phred scaled variant call quality score. MQ =  average Phred-scaled mapping quality. SP = Phred-scaled probability of strand bias. MISS = fraction of samples with missing alleles per SNP. Filtering thresholds are from our high coverage example (Table 2).\\\",\\\"type\\\":\\\"unstyled\\\",\\\"depth\\\":0,\\\"inlineStyleRanges\\\":[{\\\"style\\\":\\\"bold\\\",\\\"offset\\\":0,\\\"length\\\":9},{\\\"style\\\":\\\"bold\\\",\\\"offset\\\":96,\\\"length\\\":2},{\\\"style\\\":\\\"bold\\\",\\\"offset\\\":128,\\\"length\\\":2},{\\\"style\\\":\\\"bold\\\",\\\"offset\\\":169,\\\"length\\\":5},{\\\"style\\\":\\\"bold\\\",\\\"offset\\\":218,\\\"length\\\":2},{\\\"style\\\":\\\"bold\\\",\\\"offset\\\":262,\\\"length\\\":2},{\\\"style\\\":\\\"bold\\\",\\\"offset\\\":308,\\\"length\\\":4}],\\\"entityRanges\\\":[],\\\"data\\\":{}}],\\\"entityMap\\\":{}}\",\"mime\":null,\"nestedSelector\":null,\"original_name\":null,\"placeholder\":\"https://lh7-us.googleusercontent.com/QKEq0ydmWjea-c3ukkInN4w8tVKKJKdvbiUBMnH1zyMD4u3rb8h0eD6HvNnF_0AbqwH6DYSVimThsu8ncyRjbD8HaSst_5c6q2TXRJEQcf5RKGPjjqkdK0SmjegFZZLgtW3tT7yUgR5LPt1mAix9R2g\",\"shadow\":false,\"source\":\"https://lh7-us.googleusercontent.com/QKEq0ydmWjea-c3ukkInN4w8tVKKJKdvbiUBMnH1zyMD4u3rb8h0eD6HvNnF_0AbqwH6DYSVimThsu8ncyRjbD8HaSst_5c6q2TXRJEQcf5RKGPjjqkdK0SmjegFZZLgtW3tT7yUgR5LPt1mAix9R2g\",\"width\":\"586\"}},\"2\":{\"type\":\"code_insert\",\"mutability\":\"IMMUTABLE\",\"data\":{\"blocks\":[{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"8do8p\",\"text\":\"# Total read depth per site [INFO/DP]\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"fs09s\",\"text\":\"bcftools query -f '%CHROM\\\\t%POS\\\\t%DP\\\\t]\\\\n' subset.vcf \\u003e output/vcfstats.tDP.txt\",\"type\":\"unstyled\"}],\"entityMap\":{}}},\"3\":{\"type\":\"code_insert\",\"mutability\":\"IMMUTABLE\",\"data\":{\"blocks\":[{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"eb96v\",\"text\":\"# Average map quality per site [MQ]\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"7b98c\",\"text\":\"bcftools query -f '%CHROM\\\\t%POS\\\\t%MQ\\\\n' subset.vcf \\u003e output/vcfstats.MQ.txt\",\"type\":\"unstyled\"}],\"entityMap\":{}}},\"4\":{\"type\":\"code_insert\",\"mutability\":\"IMMUTABLE\",\"data\":{\"blocks\":[{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"2gn7v\",\"text\":\"# Call quality per site [QUAL]\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"8tmrr\",\"text\":\"bcftools query -f '%CHROM\\\\t%POS\\\\t%QUAL\\\\n' subset.vcf  \\u003e output/vcfstats.QUAL.txt\",\"type\":\"unstyled\"}],\"entityMap\":{}}},\"5\":{\"type\":\"code_insert\",\"mutability\":\"IMMUTABLE\",\"data\":{\"blocks\":[{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"ettl5\",\"text\":\"# Read depth per sample [FMT/DP]\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"a75v2\",\"text\":\"bcftools query -f '%CHROM\\\\t%POS\\\\t[%DP\\\\t]\\\\n' subset.vcf \\u003e output/vcfstats.sDP.txt\",\"type\":\"unstyled\"}],\"entityMap\":{}}},\"6\":{\"type\":\"code_insert\",\"mutability\":\"IMMUTABLE\",\"data\":{\"blocks\":[{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"4pr5o\",\"text\":\"# Genotype quality per sample (Phred-score) [GQ]\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"18orm\",\"text\":\"bcftools query -f '%CHROM\\\\t%POS\\\\t[%GQ\\\\t]\\\\n' subset.vcf \\u003e output/vcfstats.GQ.txt\",\"type\":\"unstyled\"}],\"entityMap\":{}}},\"7\":{\"type\":\"code_insert\",\"mutability\":\"IMMUTABLE\",\"data\":{\"blocks\":[{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"7or0f\",\"text\":\"# Strand-bias P-value (Phred-score) [SP]\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"eupir\",\"text\":\"bcftools query -f '%CHROM\\\\t%POS\\\\t[%SP\\\\t]\\\\n' subset.vcf |\\\\\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"a1er8\",\"text\":\"       awk 'BEGIN{OFS = \\\"\\\\t\\\"}{sum = 0; for (i = 3; i \\u003c= NF; i++) sum += $i; sum /= NF; print $1,$2,sum}' \\u003e output/vcfstats.SP.txt\",\"type\":\"unstyled\"}],\"entityMap\":{}}},\"8\":{\"type\":\"code_insert\",\"mutability\":\"IMMUTABLE\",\"data\":{\"blocks\":[{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"9g6km\",\"text\":\"# Missing data [FMISS]\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"b8u69\",\"text\":\"bcftools +fill-tags subset.vcf -- -t 'FMISS=F_MISSING' | bcftools query -f '%CHROM\\\\t%POS\\\\t%FMISS\\\\n' \\u003e output/vcfstats.MISS.txt\",\"type\":\"unstyled\"}],\"entityMap\":{}}},\"9\":{\"type\":\"code_insert\",\"mutability\":\"IMMUTABLE\",\"data\":{\"blocks\":[{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"de014\",\"text\":\"# Allele frequency [AF]\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"c7i4n\",\"text\":\"bcftools +fill-tags subset.vcf -- -t AF | bcftools query -f '%CHROM\\\\t%POS\\\\t%AF\\\\n' \\u003e vcfstats.AF.txt\",\"type\":\"unstyled\"}],\"entityMap\":{}}}}}","data":null,"protocol_id":92513,"case_id":0,"critical_ids":"","duration":0,"original_id":0,"number":"14","cases":[],"critical":null},{"id":1884330,"guid":"2830BA2265CB4E8BA6F76D88C0D1900E","previous_id":1884321,"previous_guid":"9606B0B0D1BC4EFC949941C3CC1E7E70","section":"\u003cp\u003eAppendix 1: adjustments for different datasets\u003c/p\u003e","section_color":"#E57785","section_duration":0,"is_substep":false,"step":"{\"blocks\":[{\"key\":\"6uc9v\",\"text\":\"Our default pipeline is developed for whole genome shotgun reads, with the goal of producing a set of SNP genotypes for analysis, as this is the most common approach used in evolutionary genomics research. However, other types of sequencing data require modifications to our pipeline. Here we give general advice about how our pipeline can be modified for three common types of data: RAD-seq, PoolSeq, and Haplotagging.\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}},{\"key\":\"5es35\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}}],\"entityMap\":{}}","data":null,"protocol_id":92513,"case_id":0,"critical_ids":"","duration":0,"original_id":0,"number":"15","cases":[],"critical":null},{"id":1884331,"guid":"070959A7F6014119B40FC20CB6999D29","previous_id":1884330,"previous_guid":"2830BA2265CB4E8BA6F76D88C0D1900E","section":"\u003cp\u003eAppendix 1: adjustments for different datasets\u003c/p\u003e","section_color":"#E57785","section_duration":0,"is_substep":false,"step":"{\"blocks\":[{\"key\":\"c2656\",\"text\":\"RAD-seq:\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[{\"style\":\"bold\",\"offset\":0,\"length\":8}],\"entityRanges\":[],\"data\":{}},{\"key\":\"akbbv\",\"text\":\"\\tRestriction-site-associated DNA (RAD) sequencing is an older approach still widely used in population genetic studies (Puritz et al. 2014). It breaks DNA at specific restriction sites resulting in several thousand short reads per run. It is commonly used as a cheaper alternative to WGS. RAD-seq fragments the genome at restriction sites using specific adaptor sequences. Trimming RAD-reads requires special handling of these adaptors. We recommend ignoring adaptors in fastp (option ‘-A') and processing RAD-seq data with an established pipeline (e.g. stacks, Rochette et al., 2019).\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[{\"style\":\"bold\",\"offset\":470,\"length\":7}],\"entityRanges\":[],\"data\":{}}],\"entityMap\":{}}","data":null,"protocol_id":92513,"case_id":0,"critical_ids":"","duration":0,"original_id":0,"number":"16","cases":[],"critical":null},{"id":1884333,"guid":"2FDCF23A721949B89D30A45B2F4F3FF8","previous_id":1884331,"previous_guid":"070959A7F6014119B40FC20CB6999D29","section":"\u003cp\u003eAppendix 1: adjustments for different datasets\u003c/p\u003e","section_color":"#E57785","section_duration":0,"is_substep":false,"step":"{\"blocks\":[{\"key\":\"bvo70\",\"text\":\"PoolSeq:\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[{\"style\":\"bold\",\"offset\":0,\"length\":8}],\"entityRanges\":[],\"data\":{}},{\"key\":\"5ip8l\",\"text\":\"\\tPooled sequencing is a common approach for analysing allele frequencies among populations on a budget (Schlötterer et al. 2014). DNA samples are pooled together in even proportions across a population to create a single pooled sample, which is then sequenced at high coverage. A single pair of fastq files is generated for each population.\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[{\"style\":\"bold\",\"offset\":295,\"length\":5}],\"entityRanges\":[],\"data\":{}},{\"key\":\"d93l4\",\"text\":\"\\t\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}},{\"key\":\"7rjj3\",\"text\":\"\\tPoolSeq and WGS-seq pipelines are similar. The major difference is that variant calling requires a program which can handle high “ploidy” (e.g. N ≥ 50). PoPoolation (Kofler et al. 2011) was specially designed to handle PoolSeq data. Filtering options are more limited with PoPoolation, as it only retains the statistics added to the mpileup. However, many of the filtering steps we have mentioned for VCFs can be applied to the mpileup and BAM files (see example in Morales et al. 2019).\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[{\"style\":\"bold\",\"offset\":154,\"length\":12},{\"style\":\"bold\",\"offset\":186,\"length\":1},{\"style\":\"bold\",\"offset\":274,\"length\":11},{\"style\":\"bold\",\"offset\":334,\"length\":7},{\"style\":\"bold\",\"offset\":402,\"length\":4},{\"style\":\"bold\",\"offset\":429,\"length\":8},{\"style\":\"bold\",\"offset\":440,\"length\":5}],\"entityRanges\":[],\"data\":{}}],\"entityMap\":{}}","data":null,"protocol_id":92513,"case_id":0,"critical_ids":"","duration":0,"original_id":0,"number":"17","cases":[],"critical":null},{"id":1884334,"guid":"E89B9B419BE5421DA38BCE130EABFB6A","previous_id":1884333,"previous_guid":"2FDCF23A721949B89D30A45B2F4F3FF8","section":"\u003cp\u003eAppendix 1: adjustments for different datasets\u003c/p\u003e","section_color":"#E57785","section_duration":0,"is_substep":false,"step":"{\"blocks\":[{\"key\":\"aqbgn\",\"text\":\"Haplotagging:\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[{\"style\":\"bold\",\"offset\":0,\"length\":13}],\"entityRanges\":[],\"data\":{}},{\"key\":\"abk8a\",\"text\":\"\\tHaplotagging is a new method of sequencing that keeps linkage information among reads (Meier et al. 2021). DNA libraries are prepared using specialised beads marking long DNA fragments with barcodes. Barcoded molecules are then sheared and washed off the beads and amplified with PCR, before standard Illumina short-read sequencing. \",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}},{\"key\":\"eqfvj\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}},{\"key\":\"f30pv\",\"text\":\"SamHaplotag is a pipeline specifically made to process haplotagged data (evolgenomics, 2022). In demultiplexing, the barcodes are encoded within the comments fields, using the 10xspoof.pl script.The reads are then trimmed (if necessary) and, the haplotag barcodes are converted using the 16BaseBCGen programme into generic 16-base barcodes with 7-base joins which can then be used as input for read mapping. We recommend using the EMA read mapper (Shajii et al. 2017) instead of  BWA, to keep barcode information, which improves downstream genotyping accuracy, phasing, and structural variant detection. Variant calling and filtering can proceed with the recommendations of our pipeline.\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[{\"style\":\"UNDERLINE\",\"offset\":0,\"length\":11},{\"style\":\"UNDERLINE\",\"offset\":176,\"length\":11},{\"style\":\"bold\",\"offset\":0,\"length\":11},{\"style\":\"bold\",\"offset\":431,\"length\":4},{\"style\":\"bold\",\"offset\":480,\"length\":3}],\"entityRanges\":[{\"key\":0,\"offset\":0,\"length\":11},{\"key\":1,\"offset\":176,\"length\":11}],\"data\":{}}],\"entityMap\":{\"0\":{\"type\":\"link\",\"mutability\":\"MUTABLE\",\"data\":{\"guid\":\"8C18682F9E9411EE885E0A58A9FEAC02\",\"url\":\"https://github.com/wtsi-hpag/SamHaplotag\"}},\"1\":{\"type\":\"link\",\"mutability\":\"MUTABLE\",\"data\":{\"guid\":\"8C18682F9E9411EE885E0A58A9FEAC02\",\"url\":\"https://github.com/evolgenomics/haplotagging/blob/master/10X_spoof.pl\"}}}}","data":null,"protocol_id":92513,"case_id":0,"critical_ids":"","duration":0,"original_id":0,"number":"18","cases":[],"critical":null},{"id":1884336,"guid":"1981898C3D624BC99C88D252A0FF91DA","previous_id":1884334,"previous_guid":"E89B9B419BE5421DA38BCE130EABFB6A","section":"\u003cp\u003eAppendix 2: glossary\u003c/p\u003e","section_color":"#EA94FF","section_duration":0,"is_substep":false,"step":"{\"blocks\":[{\"key\":\"4mmf6\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}},{\"key\":\"91ga\",\"text\":\" \",\"type\":\"atomic\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[{\"key\":0,\"offset\":0,\"length\":1}],\"data\":{}},{\"key\":\"4hegm\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}}],\"entityMap\":{\"0\":{\"type\":\"image\",\"mutability\":\"IMMUTABLE\",\"data\":{\"height\":461,\"id\":429091,\"is_video\":false,\"legend\":\"{\\\"blocks\\\":[{\\\"key\\\":\\\"6vjbv\\\",\\\"text\\\":\\\"Table S1: glossary of software and file formats. Check the version of your software before running this pipeline. Newer versions may have different options specified in their manual.\\\",\\\"type\\\":\\\"unstyled\\\",\\\"depth\\\":0,\\\"inlineStyleRanges\\\":[{\\\"style\\\":\\\"bold\\\",\\\"offset\\\":0,\\\"length\\\":9}],\\\"entityRanges\\\":[],\\\"data\\\":{}}],\\\"entityMap\\\":{}}\",\"mime\":\"image/png\",\"originalFile\":{},\"original_name\":\"Screenshot 2023-12-19 at 18.33.53.png\",\"placeholder\":\"https://content.protocols.io/files/pdbfcbbdp.jpg\",\"source\":\"https://content.protocols.io/files/pdbdcbbdp.jpg\",\"type\":1,\"webp_placeholder\":\"https://content.protocols.io/files/pdbecbbdp.webp\",\"webp_source\":\"https://content.protocols.io/files/pdbccbbdp.webp\",\"width\":550}}}}","data":null,"protocol_id":92513,"case_id":0,"critical_ids":"","duration":0,"original_id":0,"number":"19","cases":[],"critical":null}],"template_id":1,"title":"A standard pipeline for processing short-read sequencing data from Littorina snails","title_html":"A standard pipeline for processing short-read sequencing data from Littorina snails","type_id":1,"units":[{"id":1,"type_id":3,"name":"µL","can_manage":0,"read_only":0},{"id":2,"type_id":3,"name":"mL","can_manage":0,"read_only":0},{"id":3,"type_id":3,"name":"L","can_manage":0,"read_only":0},{"id":4,"type_id":3,"name":"µg","can_manage":0,"read_only":0},{"id":5,"type_id":3,"name":"mg","can_manage":0,"read_only":0},{"id":6,"type_id":3,"name":"g","can_manage":0,"read_only":0},{"id":7,"type_id":3,"name":"kg","can_manage":0,"read_only":0},{"id":8,"type_id":3,"name":"ng","can_manage":0,"read_only":0},{"id":9,"type_id":3,"name":"Hz","can_manage":0,"read_only":0},{"id":10,"type_id":24,"name":"°C","can_manage":0,"read_only":0},{"id":11,"type_id":24,"name":"°К","can_manage":0,"read_only":0},{"id":12,"type_id":24,"name":"°F","can_manage":0,"read_only":0},{"id":13,"type_id":25,"name":"Mass Percent","can_manage":0,"read_only":0},{"id":14,"type_id":25,"name":"% volume","can_manage":0,"read_only":0},{"id":15,"type_id":25,"name":"Mass / % volume","can_manage":0,"read_only":0},{"id":16,"type_id":25,"name":"Parts per Million (PPM)","can_manage":0,"read_only":0},{"id":17,"type_id":25,"name":"Parts per Billion (PPB)","can_manage":0,"read_only":0},{"id":18,"type_id":25,"name":"Parts per Trillion (PPT)","can_manage":0,"read_only":0},{"id":19,"type_id":25,"name":"Mole Fraction","can_manage":0,"read_only":0},{"id":20,"type_id":25,"name":"Mole Percent","can_manage":0,"read_only":0},{"id":21,"type_id":25,"name":"Molarity (M)","can_manage":0,"read_only":1},{"id":22,"type_id":25,"name":"Molarity (m)","can_manage":0,"read_only":0},{"id":23,"type_id":25,"name":"Genome copies per ml","can_manage":0,"read_only":0},{"id":24,"type_id":3,"name":"μV","can_manage":0,"read_only":0},{"id":25,"type_id":3,"name":"ms","can_manage":0,"read_only":0},{"id":26,"type_id":3,"name":"pg","can_manage":0,"read_only":0},{"id":27,"type_id":25,"name":"Molarity dilutions","can_manage":0,"read_only":0},{"id":28,"type_id":25,"name":"millimolar (mM)","can_manage":0,"read_only":0},{"id":29,"type_id":25,"name":"micromolar (µM)","can_manage":0,"read_only":0},{"id":30,"type_id":25,"name":"nanomolar (nM)","can_manage":0,"read_only":0},{"id":31,"type_id":25,"name":"picomolar (pM)","can_manage":0,"read_only":0},{"id":32,"type_id":24,"name":"Room temperature","can_manage":0,"read_only":0},{"id":33,"type_id":30,"name":"rpm","can_manage":0,"read_only":0},{"id":34,"type_id":30,"name":"x g","can_manage":0,"read_only":0},{"id":165,"type_id":24,"name":"On ice","can_manage":0,"read_only":0},{"id":200,"type_id":32,"name":"cm","can_manage":0,"read_only":0},{"id":201,"type_id":32,"name":"mm","can_manage":0,"read_only":0},{"id":202,"type_id":32,"name":"µm","can_manage":0,"read_only":0},{"id":203,"type_id":32,"name":"nm","can_manage":0,"read_only":0},{"id":204,"type_id":25,"name":"mg/mL","can_manage":0,"read_only":0},{"id":205,"type_id":25,"name":"µg/µL","can_manage":0,"read_only":0},{"id":206,"type_id":25,"name":"% (v/v)","can_manage":0,"read_only":0},{"id":207,"type_id":3,"name":"V","can_manage":0,"read_only":0},{"id":1324,"type_id":30,"name":"rcf","can_manage":0,"read_only":0},{"id":1359,"type_id":35,"name":"Bar","can_manage":0,"read_only":0},{"id":1360,"type_id":35,"name":"Pa","can_manage":0,"read_only":0}],"uri":"a-standard-pipeline-for-processing-short-read-sequ-c6j9zcr6","url":"https://www.protocols.io/view/a-standard-pipeline-for-processing-short-read-sequ-c6j9zcr6","version_class":92513,"version_data":{"id":0,"code":"c6j9zcr6","version_class":92513,"parent_id":null,"parent_uri":null,"is_same_owner":false,"is_parent_public":false,"has_pending_merge_request":false,"has_approved_merge_request":false,"merge_request":null},"version_id":0,"version_uri":"a-standard-pipeline-for-processing-short-read-sequ-dm6gp3m21vzp/v1","versions":[{"id":92513,"title":"A standard pipeline for processing short-read sequencing data from Littorina snails","title_html":"A standard pipeline for processing short-read sequencing data from Littorina snails","image":{"source":"https://content.protocols.io/files/pdbbcbbdp.jpg","webp_source":null,"placeholder":"https://content.protocols.io/files/pdbbcbbdp.jpg","webp_placeholder":null},"doi":null,"uri":"a-standard-pipeline-for-processing-short-read-sequ-c6j9zcr6","published_on":1703080146,"modified_on":1703080146,"version_class":92513,"version_id":0,"version_code":"c6j9zcr6","version_uri":"a-standard-pipeline-for-processing-short-read-sequ-dm6gp3m21vzp/v1","created_on":1703003053,"categories":null,"type_id":1,"creator":{"name":"James Reeve","affiliation":"Tjärnö Marine Laboratory, University of Gothenburg, 452 96 Strömstad, Sweden","affiliation_url":"","username":"james-reeve","link":"","image":{"source":"/img/avatars/010.png","placeholder":"/img/avatars/010.png","webp_source":""}},"stats":{"number_of_comments":0,"last_comment_time":0}}],"warning":""}