{"id":51613,"title":"Viral sequence identification SOP with VirSorter2","title_html":"<p>Viral sequence identification SOP with VirSorter2<\/p>","image":{"source":"https:\/\/www.protocols.io\/img\/default_protocol.png","placeholder":"https:\/\/www.protocols.io\/img\/default_protocol.png"},"doi":"dx.doi.org\/10.17504\/protocols.io.bwm5pc86","doi_status":2,"uri":"viral-sequence-identification-sop-with-virsorter2-bwm5pc86","type_id":1,"template_id":5,"published_on":1626716422,"parent_protocols":[],"parent_collections":[],"cited_protocols":[],"version_id":2,"version_data":{"id":"2","code":"bwm5pc86","parent_id":48800,"parent_uri":"viral-sequence-identification-sop-with-virsorter2-btv8nn9w","is_same_owner":true,"has_pending_merge_request":false,"has_approved_merge_request":true},"created_on":1626427824,"modified_on":null,"categories":null,"public":1,"is_unlisted":0,"creator":{"name":"Jiarong Guo","affiliation":null,"affiliations":[{"affiliation":null,"url":null,"is_default":1}],"username":"jiarong-guo","note":null,"link":null,"image":{"source":"\/img\/avatars\/002.png","placeholder":"\/img\/avatars\/002.png"},"badges":[{"id":2,"image":{"source":"\/img\/badges\/bronze.svg","placeholder":"\/img\/badges\/bronze.svg"},"name":"Author"}],"verified":0,"is_verified_user":false,"research_interests":null,"blocked_by_you":false,"blocked_you":false,"hide_following":false},"journal":null,"journal_name":null,"journal_link":null,"article_citation":null,"has_versions":0,"link":null,"total_collections":0,"number_of_steps":5,"authors":[{"name":"Jiarong Guo","affiliation":"Ohio State University, Columbus","affiliations":[],"username":"jiarong-guo","note":null,"link":null,"image":{"source":"\/img\/avatars\/002.png","placeholder":"\/img\/avatars\/002.png"},"badges":[],"verified":1,"is_verified_user":true,"research_interests":null,"blocked_by_you":false,"blocked_you":false,"hide_following":false},{"name":"Dean Vik","affiliation":"Ohio State University, Columbus","affiliations":[],"username":null,"note":null,"link":null,"image":{"source":null,"placeholder":null},"badges":[],"verified":0,"is_verified_user":false,"research_interests":null,"blocked_by_you":false,"blocked_you":false,"hide_following":false},{"name":"Akbar Adjie Pratama","affiliation":"Ohio State University, Columbus","affiliations":[],"username":"akbar-adjie-pratama","note":null,"link":null,"image":{"source":"\/img\/avatars\/005.png","placeholder":"\/img\/avatars\/005.png"},"badges":[],"verified":1,"is_verified_user":true,"research_interests":null,"blocked_by_you":false,"blocked_you":false,"hide_following":false},{"name":"Simon Roux","affiliation":"LBNL, DOE Joint Genome Institute","affiliations":[],"username":"simon-roux","note":null,"link":null,"image":{"source":"\/img\/avatars\/014.png","placeholder":"\/img\/avatars\/014.png"},"badges":[],"verified":1,"is_verified_user":true,"research_interests":null,"blocked_by_you":false,"blocked_you":false,"hide_following":false},{"name":"Matthew Sullivan","affiliation":"Ohio State University, Columbus","affiliations":[],"username":"matthew-sullivan2","note":null,"link":null,"image":{"source":"\/img\/avatars\/017.png","placeholder":"\/img\/avatars\/017.png"},"badges":[],"verified":1,"is_verified_user":true,"research_interests":null,"blocked_by_you":false,"blocked_you":false,"hide_following":false}],"versions":[],"groups":[{"id":50,"uri":"sullivan-lab","title":"Sullivan Lab","image":{"source":"https:\/\/s3.amazonaws.com\/pr-journal\/fxc3an.jpg","placeholder":"https:\/\/s3.amazonaws.com\/pr-journal\/fxc3an.jpg"},"tech_support":{"email":null,"phone":null,"hide_contact":0,"use_email":0,"url":null},"is_member":1,"request":{"id":50,"uri":"sullivan-lab","title":"Sullivan Lab","image":{"source":"https:\/\/s3.amazonaws.com\/pr-journal\/fxc3an.jpg","placeholder":"https:\/\/s3.amazonaws.com\/pr-journal\/fxc3an.jpg"},"tech_support":{"email":null,"phone":null,"hide_contact":0,"use_email":0,"url":null},"is_member":1,"description":null,"research_interests":null,"website":null,"location":null,"affiliation":null,"status":{"is_visible":true,"access_level":0},"stats":{"files":[],"total_members":0,"total_followers":0,"total_child_groups":0,"total_parent_groups":0,"has_collaborations":0},"user_status":{"is_member":true,"is_confirmed":true,"is_invited":false,"is_owner":false,"is_admin":false,"is_following":false},"join_link":null,"token":null,"owner":{"name":" ","affiliation":null,"affiliations":[],"username":null,"note":null,"link":null,"image":{"source":null,"placeholder":null},"badges":[],"verified":0,"is_verified_user":false,"research_interests":null,"blocked_by_you":false,"blocked_you":false,"hide_following":false},"is_protocol_requested":0,"is_group_requested":0,"is_my":false,"is_request":false,"is_confirmed":1,"is_declined":0,"requester":{"name":" ","affiliation":null,"affiliation_url":null,"username":null,"link":null},"protocol":{"id":0,"title":"Viral sequence identification SOP with VirSorter2","title_html":"Viral sequence identification SOP with VirSorter2","image":{"source":null,"placeholder":null},"doi":null,"doi_status":0,"uri":"viral-sequence-identification-sop-with-virsorter2-bwm5pc86","type_id":1,"template_id":0,"published_on":null,"stats":{"number_of_views":0,"number_of_steps":0,"number_of_bookmarks":0,"number_of_comments":0,"number_of_exports":0,"number_of_runs":0,"number_of_votes":0,"is_voted":0},"parent_protocols":[],"parent_collections":[],"cited_protocols":[]},"created_on":1617333965,"resolve_on":0,"resolved_user":{"name":" ","affiliation":null,"affiliations":[],"username":null,"note":null,"link":null,"image":{"source":null,"placeholder":null},"badges":[],"verified":0,"is_verified_user":false,"research_interests":null,"blocked_by_you":false,"blocked_you":false,"hide_following":false},"shared":false}},{"id":166,"uri":"ivirus","title":"iVirus","image":{"source":"https:\/\/s3.amazonaws.com\/pr-journal\/ddtbvtw.png","placeholder":"https:\/\/s3.amazonaws.com\/pr-journal\/ddtbvtw.png"},"tech_support":{"email":null,"phone":null,"hide_contact":0,"use_email":0,"url":null},"is_member":1,"request":{"id":166,"uri":"ivirus","title":"iVirus","image":{"source":"https:\/\/s3.amazonaws.com\/pr-journal\/ddtbvtw.png","placeholder":"https:\/\/s3.amazonaws.com\/pr-journal\/ddtbvtw.png"},"tech_support":{"email":null,"phone":null,"hide_contact":0,"use_email":0,"url":null},"is_member":1,"description":null,"research_interests":null,"website":null,"location":null,"affiliation":null,"status":{"is_visible":true,"access_level":0},"stats":{"files":[],"total_members":0,"total_followers":0,"total_child_groups":0,"total_parent_groups":0,"has_collaborations":0},"user_status":{"is_member":true,"is_confirmed":true,"is_invited":false,"is_owner":false,"is_admin":false,"is_following":false},"join_link":null,"token":null,"owner":{"name":" ","affiliation":null,"affiliations":[],"username":null,"note":null,"link":null,"image":{"source":null,"placeholder":null},"badges":[],"verified":0,"is_verified_user":false,"research_interests":null,"blocked_by_you":false,"blocked_you":false,"hide_following":false},"is_protocol_requested":0,"is_group_requested":0,"is_my":false,"is_request":false,"is_confirmed":1,"is_declined":0,"requester":{"name":" ","affiliation":null,"affiliation_url":null,"username":null,"link":null},"protocol":{"id":0,"title":"Viral sequence identification SOP with VirSorter2","title_html":"Viral sequence identification SOP with VirSorter2","image":{"source":null,"placeholder":null},"doi":null,"doi_status":0,"uri":"viral-sequence-identification-sop-with-virsorter2-bwm5pc86","type_id":1,"template_id":0,"published_on":null,"stats":{"number_of_views":0,"number_of_steps":0,"number_of_bookmarks":0,"number_of_comments":0,"number_of_exports":0,"number_of_runs":0,"number_of_votes":0,"is_voted":0},"parent_protocols":[],"parent_collections":[],"cited_protocols":[]},"created_on":1617333965,"resolve_on":0,"resolved_user":{"name":" ","affiliation":null,"affiliations":[],"username":null,"note":null,"link":null,"image":{"source":null,"placeholder":null},"badges":[],"verified":0,"is_verified_user":false,"research_interests":null,"blocked_by_you":false,"blocked_you":false,"hide_following":false},"shared":false}}],"is_owner":1,"has_subprotocols":0,"is_subprotocol":0,"is_bookmarked":0,"can_claim_authorship":0,"can_accept_authorship":0,"can_be_copied":1,"can_remove_fork":1,"fork_id":null,"url":"https:\/\/www.protocols.io\/view\/viral-sequence-identification-sop-with-virsorter2-bwm5pc86","forks_count":{"private":0,"public":0},"access":{"can_view":1,"can_remove":0,"can_add":0,"can_edit":0,"can_publish":0,"can_get_doi":0,"can_share":1,"can_move":1,"can_move_outside":1,"can_transfer":1,"can_download":1,"is_locked":0},"guid":"574FB7457D394B958A9A85030308DF69","state_version_id":280,"steps":[{"id":1214326,"guid":"1C8E6AB6807949AF936FEDCD7AA087E8","previous_id":null,"previous_guid":null,"modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"C8701279A8B0496E9326FF3860130CEE","order_id":1,"type_id":6,"title":"Section","source":{"title":"Install dependencies and prep test data"}},{"id":1054724,"guid":"0038B0CAEA4345FFB1BA2BD1352D9079","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\"><span style = \"font-weight:bold;\">Install dependencies<\/span><\/div><br\/><div class = \"text-block\">We need following three tools for this SOP:<\/div><br\/><div class = \"text-block\"><a href=\"https:\/\/bitbucket.org\/MAVERICLab\/virsorter2\/src\/master\" style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">VirSorter2<\/span><\/a><\/div><div class = \"text-block\">(version >=2.2.3)<\/div><div class = \"text-block\"><a href=\"https:\/\/bitbucket.org\/berkeleylab\/checkv\/src\/master\" style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">CheckV<\/span><\/a><\/div><div class = \"text-block\">(version >=0.7.0)<\/div><div class = \"text-block\"><a href=\"https:\/\/github.com\/shafferm\/DRAM\" style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">DRAMv<\/span><\/a><\/div><div class = \"text-block\">(version >=1.2.0)<\/div><br\/><div class = \"text-block\">First lets create new conda environment for this tutorial:<\/div><br\/><div class = \"text-block\"><pre><code><div class = \"text-blocks\"><div class = \"text-block\"># install VirSorter2, checkV and DRAMv <\/div><div class = \"text-block\">conda create -n viral-id-sop virsorter=2 checkv dram <\/div><div class = \"text-block\"># activate env <\/div><div class = \"text-block\">conda activate viral-id-sop<\/div><\/div><\/code><\/pre><\/div><br\/><div class = \"text-block\">Each tool has its own database. VirSorter2 database takes ~10 mins to download;<\/div><div class = \"text-block\">CheckV database takes <5 mins; DRAMv database setup can take a long time ~5h and ~60GB of memory.<\/div><br\/><br\/><div class = \"text-block\"><pre><code><div class = \"text-blocks\"><div class = \"text-block\"># vs2 db: db-vs2<\/div><div class = \"text-block\">virsorter setup -d db-vs2 -j 4<\/div><div class = \"text-block\"># checkv db: checkv-db-v1.0<\/div><div class = \"text-block\">checkv download_database .<\/div><div class = \"text-block\"># DRAMv: db-dramv<\/div><div class = \"text-block\">DRAM-setup.py prepare_databases --skip_uniref --output_dir db-dramv<\/div><\/div><\/code><\/pre><\/div><br\/><div class = \"text-block\">Note: DRAMv by default use KOfam HMMs to get KEGG orthology identifiers. If you have access to KEGG database (not open source), you can link it to the DRAMv too. See details in <\/div><div class = \"text-block\"><a href=\"https:\/\/github.com\/shafferm\/DRAM\" style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">DRAMv documentation<\/span><\/a><\/div><div class = \"text-block\">.<\/div><br\/><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#A492FF","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1214327,"guid":"27C1AC4FBD7D4F23BAD4DAD5E538C791","previous_id":1214326,"previous_guid":"1C8E6AB6807949AF936FEDCD7AA087E8","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"FAB5CD9FB46D49629FA397345DE97A65","order_id":1,"type_id":6,"title":"Section","source":{"title":"Install dependencies and prep test data"}},{"id":1054724,"guid":"0B2EE208FF864589B09E3E7B22C9E791","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\"><span style = \"font-weight:bold;\">Prep test data<\/span><\/div><br\/><div class = \"text-block\">We need a small test data for this tutorial. Here we grab seven sequences identified by VirSorter2 from a soil sample  the sequence names are named after their categories in manual curation step that we will discuss later.<\/div><br\/><br\/><div class = \"text-block\"><pre><code><div class = \"text-blocks\"><div class = \"text-block\">wget -O test.fa https:\/\/bitbucket.org\/MAVERICLab\/virsorter2\/raw\/15a21fa9c1ee1d2af52b0148b167292e549d356e\/test\/test-for-sop.fa<\/div><\/div><\/code><\/pre><\/div><br\/><br\/><br\/><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#A492FF","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1214328,"guid":"27E549FFA6F84C1393AAB77652911FFD","previous_id":1214327,"previous_guid":"27C1AC4FBD7D4F23BAD4DAD5E538C791","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"52D768666ADB4EC3806EA37768058BE9","order_id":1,"type_id":6,"title":"Section","source":{"title":"SOP"}},{"id":1054724,"guid":"FE49802522824EAA98B64183B4E241C6","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\"><span style = \"font-weight:bold;\">Run VirSorter2<\/span><\/div><br\/><div class = \"text-block\">First, run VirSorter2 with a loose cutoff of 0.5 for maximal sensitivity. We are only interested in phages (dsDNA and ssDNA phage). A minimal length 5000 bp is chosen since it is the minimum required by downstream viral<\/div><div class = \"text-block\">classification. You can adjust the \"-j\" option based on the availability of CPU cores. Note that the \"--keep-original-seq\" option preserves the original sequence of circular and (near) fully viral contigs (score >0.8 as a whole sequence) and we are passing them to checkV to trim possible host genes left at ends and handle duplicate segments of circular contigs.<\/div><br\/><div class = \"text-block\"><pre><code><div class = \"text-blocks\"><div class = \"text-block\">virsorter run --keep-original-seq -i 5seq.fa -w vs2-pass1 --include-groups dsDNAphage,ssDNA --min-length 5000 --min-score 0.5 -j 28 all<\/div><\/div><\/code><\/pre><\/div><br\/><div class = \"text-block\"><span style = \"font-weight:bold;\">Run checkV<\/span><\/div><br\/><div class = \"text-block\">There could be some non-viral sequences or regions in the VirSorter2 results with a minimal score cutoff of 0.5. Here we use CheckV to quality control the VirSorter2 results and also to trim potential host regions left at the ends of proviruses. You can adjust the \"-t\" option based on the availability of CPU cores.<\/div><br\/><div class = \"text-block\"><pre><code><div class = \"text-blocks\"><div class = \"text-block\">checkv end_to_end vs2-pass1\/final-viral-combined.fa checkv -t 28 -d \/fs\/project\/PAS1117\/jiarong\/db\/checkv-db-v1.0<\/div><\/div><\/code><\/pre><\/div><br\/><br\/><div class = \"text-block\"><span style = \"font-weight:bold;\">Run VirSorter2 again<\/span><\/div><br\/><div class = \"text-block\">Then we run the checkV-trimmed sequences through VirSorter2 again to generate \"affi-contigs.tab\" files needed by DRAMv to identify AMGs. You can adjust the \"-j\" option based on the availability of CPU cores. Note the \"--seqname-suffix-off\" option preserves the original input sequence name since we are sure there is no chance of getting >1 proviruses from the same contig in this second pass, and the \"--viral-gene-enrich-off\" option turns off the requirement of having more viral genes than host genes to make sure that VirSorter2 is not doing any screening at this step. The above two options require VirSorter2 version >=2.2.1.<\/div><br\/><div class = \"text-block\"><pre><code><div class = \"text-blocks\"><div class = \"text-block\">cat checkv\/proviruses.fna checkv\/viruses.fna > checkv\/combined.fna<\/div><div class = \"text-block\">virsorter run --seqname-suffix-off --viral-gene-enrich-off --provirus-off --prep-for-dramv -i checkv\/combined.fna -w vs2-pass2 --include-groups dsDNAphage,ssDNA --min-length 5000 --min-score 0.5 -j 28 all<\/div><\/div><\/code><\/pre><\/div><br\/><br\/><div class = \"text-block\"><span style = \"font-weight:bold;\">Run DRAMv<\/span><\/div><br\/><div class = \"text-block\">Then run DRAMv to annotate the identified sequences, which can be used for manual curation. You can adjust the \"--threads\" option based on availability of CPU cores.<\/div><br\/><div class = \"text-block\"><pre><code><div class = \"text-blocks\"><div class = \"text-block\"># step 1 annotate<\/div><div class = \"text-block\">DRAM-v.py annotate -i vs2-pass2\/for-dramv\/final-viral-combined-for-dramv.fa -v vs2-pass2\/for-dramv\/viral-affi-contigs-for-dramv.tab -o dramv-annotate --skip_trnascan --threads 28 --min_contig_size 1000<\/div><div class = \"text-block\">#step 2 summarize anntotations<\/div><div class = \"text-block\">DRAM-v.py distill -i dramv-annotate\/annotations.tsv -o dramv-distill<\/div><\/div><\/code><\/pre><\/div><br\/><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#94EBFF","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1214329,"guid":"9547B93D29EA40148F24C942D17892C0","previous_id":1214328,"previous_guid":"27E549FFA6F84C1393AAB77652911FFD","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"D3027C8B3D904A1093B60F855425E147","order_id":1,"type_id":6,"title":"Section","source":{"title":"Manual curation"}},{"id":1054724,"guid":"7B5529FE546B4D958CC2CB4AF18D0CE9","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\"><span style = \"font-weight:bold;\">Screening based on viral and host gene counts, score, hallmark gene counts, and contig length<\/span><\/div><br\/><div class = \"text-block\">The viral and host gene counts from checkV can be used for false positive screen ing. Since checkV is very conservative on calling viral genes, those sequences with viral genes called by checkV should be viral, and those with no viral gene called by checkV are more likely to be non-viral. Based on our benchmark with a soil bulk metagenome, those with no viral and no host gene called are viral; those with no viral gene and 2 or more host genes are mostly non-viral; those with no viral gene and 1 host gene are hard to tell viral from non-viral (likely mobile genetic elements, similar to category 3 in VirSorter1), and should be discarded unless manually checked. Here we only select those >10kb for manual curation since shorter ones are too short to tell. Also those with VirSorter2 score \u22650.95 or hallmark gene count >2 are mostly viral. These empirical screening criteria are summarized below:<\/div><br\/><div class = \"text-block\"><ul style = \"list-style-type:disc;\"><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">Keep1: <\/span><span>viral_gene >0<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">Keep2<\/span><span>: viral_gene =0 AND (host_gene =0 OR score >=0.95 OR hallmark >2)<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">Manual check:<\/span><span> (NOT in Keep1 OR Keep2) AND viral_gene =0 AND host_gene =1 AND length >=10kb<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">Discard:<\/span><span> the rest<\/span><\/li><\/ul><\/div><br\/><div class = \"text-block\">To look at the viral_gene, host_gene, score, and hallmark of sequences you can merge \"vs2-pass1\/final-viral-score.tsv\" and \"checkv\/contamination.tsv\", and filter in a spreadsheet.<\/div><br\/><br\/><div class = \"text-block\"><span style = \"font-weight:bold;\">DRAMv annotation screening<\/span><\/div><div class = \"text-block\"><span>There are some genes that are common in both viruses and hosts (e.g.  Polyliposaccharides [LPS] related) and mobile element, which can cause false positives in the above \"<\/span><span style = \"font-weight:bold;\">Keep2<\/span><span>\" category. Thus we want to be cautious with contigs with these genes. We have compiled a list of \"suspicious\" genes in <\/span><\/div><div class = \"text-block\"><a href=\"https:\/\/bitbucket.org\/MAVERICLab\/virsorter2-sop\/raw\/03b8f28bee979e2b7fd99d7375d915c29c938339\/resource\/suspicious-gene.list\" style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">this link<\/span><\/a><\/div><div class = \"text-block\"><span>. You can subset the DRAMv table using contigs in the \"<\/span><span style = \"font-weight:bold;\">Keep2<\/span><span>\" category, and screen for the \"suspicious\" genes in the subset DRAMv table (ignore case, e.g. use \"-i\" option for \"grep\"),  and then put contigs with those genes in the \u201c<\/span><span style = \"font-weight:bold;\">Manual check<\/span><span>\u201d category.<\/span><\/div><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#84CE84","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1214330,"guid":"E31E0D674B2042239652F6AF2E6DE329","previous_id":1214329,"previous_guid":"9547B93D29EA40148F24C942D17892C0","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"E6E9FF6EE7D748D48CE2F4A306895920","order_id":1,"type_id":6,"title":"Section","source":{"title":"Manual curation"}},{"id":1054724,"guid":"53C8167CB1D34BE7A1DED417C7D81A8A","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\"><span style = \"font-weight:bold;\">Manual curation<\/span><\/div><br\/><div class = \"text-block\">For those in \u201cmanual check\u201d category, you can look through their annotations in \"dramv-annotate\/annotations.tsv\", in which each gene of every contig is a line and has annotation from multiple databases. This step is hard to standardize, but below are some criteria based on our experience.<\/div><br\/><div class = \"text-block\">Criteria for calling a contig viral:<\/div><div class = \"text-block\"><ul style = \"list-style-type:disc;\"><li style = \"counter-reset:ol0;list-style-type:disc;\">Structural genes, hallmark genes, depletion in annotations or enrichment for hypotheticals (~10% genes having non-hypothetical annotations)<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Lacking hallmarks but >=50% of annotated genes hit to a virus and at least half of those have viral bitcore >100 and the contig is <50kb in length<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Provirus: Integrase\/recombinase\/excisionase\/repressor, enrichment of viral genes on one side<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Provirus: \u201cbreak\u201d in the genome: gap between two genes corresponding to a strand switch, higher coding density, depletion in annotations, and an enrichment for phage genes on one side<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Few annotations only ~1-3 genes, but with at least half hitting to viruses, and where the genes hitting cells have a bitscore no more than 150% that of the viral bitscores and\/or viral bitscores are >100<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">LPS (lipopolysaccharide) looking regions if also has very strong hits to viral genes bitscore > 100<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Criteria for callling a contig non-viral:<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">>3x cellular like genes than viral, nearly all genes annotated, no genes hitting to only viruses and no viral hallmark genes<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Lacking any viral hallmark genes and >50kb<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Strings of many obvious cellular genes, with no other viral hallmark genes. Examples encountered in our benchmarking include 1) CRISPR Cas, 2) ABC transporters, 3) Sporulation proteins, 4) Two-component systems, 5) Secretion system. Some of these may be encoded by viruses, but are not indicative of a viral contig without further evidence.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Multiple plasmid genes or transposases but no clear genes hitting only to viruses<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Few annotations, only ~1-3 genes hitting to both viruses and cellular genes but with stronger bitscores for the cellular genes.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">LPS looking regions if no strong viral hits. Enriched in genes commonly associated with Lipopolysaccharide or LPS, such as epimerases, glycosyl transferases, acyltransferase, short-chain dehydrogenase\/reductase, dehydratase<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Genes annotated as Type IV and\/or Type VI secretion system surrounded by non-viral genes<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Few annotations, only ~1-3 genes all hitting to cellular genes (even if bitscore <100) with no viral hits<\/li><\/ul><\/div><br\/><div class = \"text-block\">Criteria for callling a contig non-viral:<\/div><div class = \"text-block\"><ul style = \"list-style-type:disc;\"><li style = \"counter-reset:ol0;list-style-type:disc;\">>3x cellular like genes than viral, nearly all genes annotated, no genes hitting to only viruses and no viral hallmark genes<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Lacking any viral hallmark genes and >50kb<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Strings of many obvious cellular genes, with no other viral hallmark genes. Examples encountered in our benchmarking include 1) CRISPR Cas, 2) ABC transporters, 3) Sporulation proteins, 4) Two-component systems, 5) Secretion system. Some of these may be encoded by viruses, but are not indicative of a viral contig without further evidence.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Multiple plasmid genes or transposases but no clear genes hitting only to viruses<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Few annotations, only ~1-3 genes hitting to both viruses and cellular genes but with stronger bitscores for the cellular genes.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">LPS looking regions if no strong viral hits. Enriched in genes commonly associated with Lipopolysaccharide or LPS, such as epimerases, glycosyl transferases, acyltransferase, short-chain dehydrogenase\/reductase, dehydratase<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Genes annotated as Type IV and\/or Type VI secretion system surrounded by non-viral genes<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Few annotations, only ~1-3 genes all hitting to cellular genes (even if bitscore <100) with no viral hits<\/li><\/ul><\/div><br\/><div class = \"text-block\">Lastly, user beware that any provirus boundary predicted by VirSorter 2 and\/or checkV is an approximate estimate only (calling \u201cends\u201d is quite a challenging problem in prophage discovery), and needs to be manually inspected carefully too, especially for AMG studies.<\/div><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#84CE84","section_duration":0,"critical":null,"critical_id":null,"duration":0}],"document":"","materials":[],"description":"<div class = \"text-blocks\"><div class = \"text-block\">This protocol shows how to use VirSorter2, checkV, DRAMv and some manual curation criteria for viral sequence identification.<\/div><\/div>","changed_on":1626716422}