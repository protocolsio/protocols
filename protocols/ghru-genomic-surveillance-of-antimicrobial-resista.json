{"id":44111,"title":"GHRU (Genomic Surveillance of Antimicrobial Resistance) Retrospective 1 Bioinformatics Methods","title_html":"<p>GHRU (Genomic Surveillance of Antimicrobial Resistance) Retrospective 1 Bioinformatics Methods<\/p>","image":{"source":"https:\/\/s3.amazonaws.com\/protocols-files\/public\/01a7878d3c622e9c4d27343721a1b5c5559e4cb768b63015146659aa9ec62085\/cpndbgvt7.jpg","placeholder":"https:\/\/s3.amazonaws.com\/protocols-files\/public\/01a7878d3c622e9c4d27343721a1b5c5559e4cb768b63015146659aa9ec62085\/cpndbgvt7.jpg"},"doi":null,"doi_status":0,"uri":"ghru-genomic-surveillance-of-antimicrobial-resista-bpbpmimn","type_id":1,"template_id":5,"published_on":1604332069,"parent_protocols":[],"parent_collections":[],"cited_protocols":[],"version_id":2,"version_data":{"id":"2","code":"bpbpmimn","parent_id":43887,"parent_uri":"ghru-genomic-surveillance-of-antimicrobial-resista-bn4pmgvn","is_same_owner":true,"has_pending_merge_request":false,"has_approved_merge_request":true},"created_on":1604331955,"modified_on":null,"categories":null,"public":1,"is_unlisted":0,"creator":{"name":"Anthony Underwood","affiliation":null,"affiliations":[],"username":"anthony-underwood2","note":null,"link":null,"image":{"source":"https:\/\/s3.amazonaws.com\/protocols-files\/public\/01a7878d3c622e9c4d27343721a1b5c5559e4cb768b63015146659aa9ec62085\/cnk8bgvt7.png","placeholder":"https:\/\/s3.amazonaws.com\/protocols-files\/public\/01a7878d3c622e9c4d27343721a1b5c5559e4cb768b63015146659aa9ec62085\/cnk8bgvt7.png"},"badges":[{"id":2,"image":{"source":"\/img\/badges\/bronze.svg","placeholder":"\/img\/badges\/bronze.svg"},"name":"Author"}],"verified":0,"is_verified_user":false,"research_interests":null,"blocked_by_you":false,"blocked_you":false,"hide_following":false},"journal":null,"journal_name":null,"journal_link":null,"article_citation":null,"has_versions":0,"link":null,"total_collections":0,"number_of_steps":6,"authors":[{"name":"Anthony Underwood","affiliation":"Centre for Genomic Pathogen Surveillance","affiliations":[],"username":"anthony-underwood2","note":null,"link":null,"image":{"source":"https:\/\/s3.amazonaws.com\/protocols-files\/public\/01a7878d3c622e9c4d27343721a1b5c5559e4cb768b63015146659aa9ec62085\/cnk8bgvt7.png","placeholder":"https:\/\/s3.amazonaws.com\/protocols-files\/public\/01a7878d3c622e9c4d27343721a1b5c5559e4cb768b63015146659aa9ec62085\/cnk8bgvt7.png"},"badges":[],"verified":1,"is_verified_user":true,"research_interests":null,"blocked_by_you":false,"blocked_you":false,"hide_following":false}],"versions":[],"groups":[],"is_owner":1,"has_subprotocols":0,"is_subprotocol":0,"is_bookmarked":0,"can_claim_authorship":0,"can_accept_authorship":0,"can_be_copied":1,"can_remove_fork":1,"fork_id":null,"url":"https:\/\/www.protocols.io\/view\/ghru-genomic-surveillance-of-antimicrobial-resista-bpbpmimn","forks_count":{"private":0,"public":0},"access":{"can_view":1,"can_remove":1,"can_add":0,"can_edit":0,"can_publish":0,"can_get_doi":1,"can_share":1,"can_move":1,"can_move_outside":1,"can_transfer":1,"can_download":1,"is_locked":0},"guid":"D0FF11DA189145938C1352209C7916B3","state_version_id":3,"steps":[{"id":1067394,"guid":"EF7482355CEA435293F9EEBEB6D3CB9A","previous_id":null,"previous_guid":null,"modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"5F0B641AFD5C4FF4B5A5A7EC08945739","order_id":1,"type_id":6,"title":"Section","source":{"title":""}},{"id":1054724,"guid":"E17EBED9CFC045D6A8FE594AF36F14C1","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\"><span style = \"font-weight:bold;\">De novo assembly<\/span><\/div><div class = \"text-block\">reads trimming and adapter removal using trimmomatic (0.38) [3], read correction using lighter (1.1.1)  [4], downsampling to 100x coverage using seqtk (1.3)  [5], read merging using flash (1.2.11) [6], assembly using SPAdes (3.12.0) [7]. Quality control was performed using fastqc (0.11.8)  [8], multiqc (1.7) [9] and qualifyr (1.4.4) [10]. Species identification was carried out by bactinspector (0.1.3) [11] and contamination checked using Confindr (0.7.2) [12].<\/div><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1067395,"guid":"083782A5EC984FE198C0F7B08F489B27","previous_id":1067394,"previous_guid":"EF7482355CEA435293F9EEBEB6D3CB9A","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"0A4224D3C509497E91807E75B9CA7A8A","order_id":1,"type_id":6,"title":"Section","source":{"title":""}},{"id":1054724,"guid":"5295AF138E654487994B3D2484CACCB3","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\"><span style = \"font-weight:bold;\">Mapping based phylogeny<\/span><\/div><div class = \"text-block\">Reads were trimmed as described for de novo assembly and mapped to a reference with bwa mem (0.7.17) [13], variants called and filtered using bcf tools (1.9) [14] and the filtering conditions for a low quality position being '%QUAL<25 || FORMAT\/DP<10 || MAX(FORMAT\/ADF)<2 || MAX(FORMAT\/ADR)<2 || MAX(FORMAT\/AD)\/SUM(FORMAT\/DP)<0.9 || MQ<30 || MQ0F>0.1'. A pseudoalignment where each sample has a base relative to the reference sequence. Missing bases and low quality bases are encoded using the - and N characters. The alignment was used to generate a maximum likelihood tree using iqtree (1.6.8) [15,16] and ultrafast bootstraps (parameters -m GTR+G -alrt 1000 -bb 1000).<\/div><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1067396,"guid":"E38F76BE9EC74DD5B8CCD19DF12C2408","previous_id":1067395,"previous_guid":"083782A5EC984FE198C0F7B08F489B27","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"F25E0B350D984AFF8996D10FFAAA3B02","order_id":1,"type_id":6,"title":"Section","source":{"title":""}},{"id":1054724,"guid":"2D1878C6E6D94A5DAD7E9198957D463C","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\"><span style = \"font-weight:bold;\">AMR determinant detection<\/span><\/div><div class = \"text-block\">The ARIBA software (2.14.4) [17] was used to detect acquired genes using the NCBI database [18] (downloaded 2019-10-30) and the pointfinder database (downloaded 2020-12-11) adapted for Ariba [19].<\/div><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1067397,"guid":"7F3DE37F48A54426BEC59C885C2C8D82","previous_id":1067396,"previous_guid":"E38F76BE9EC74DD5B8CCD19DF12C2408","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"10EE72E1F3C848B9A61006F2D5BAC4FC","order_id":1,"type_id":6,"title":"Section","source":{"title":""}},{"id":1054724,"guid":"8949A06D459E48B0B9BB65F753378CF7","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\"><span style = \"font-weight:bold;\">MLST detection<\/span><\/div><div class = \"text-block\">The ARIBA software (2.14.4) [17] was used to determine the 7-locus MLST type using the profile and alleles found in the pubmlst database [20,21] (downloaded 2020-12-20).<\/div><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1067398,"guid":"8B5EA537DDCE44DF86059B1CD05A7AD2","previous_id":1067397,"previous_guid":"7F3DE37F48A54426BEC59C885C2C8D82","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"CE558D1E3E95469FA46E9A180FC342A6","order_id":1,"type_id":6,"title":"Section","source":{"title":""}},{"id":1054724,"guid":"369839AB8F4346A4837AEE651B95DE9B","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\"><span style = \"font-weight:bold;\">Table 1: Nextflow workflows<\/span><\/div><table border><tr style = \"text-align:center;\"><td>  <\/td><td>A<\/td><td>B<\/td><td>C<\/td><td>D<\/td><\/tr><tr><td style = \"text-align:center;\">1<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;font-weight:bold;\">Workflow name<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;font-weight:bold;\">Workflow link<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;font-weight:bold;\">Docker hub Container(s) used <\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;font-weight:bold;\">Version at publication<\/td><\/tr><tr><td style = \"text-align:center;\">2<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">De novo  assembly<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">https:\/\/gitlab.com\/cgps\/ghru\/pipelines\/assembly<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">bioinformant\/ghru-assembly:version\nOR\nregistry.gitlab.com\/cgps\/ghru\/pipelines\/assembly:version<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">1.5.5<\/td><\/tr><tr><td style = \"text-align:center;\">3<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">Mapping based SNP phylogeny<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">https:\/\/gitlab.com\/cgps\/ghru\/pipelines\/snp_phylogeny<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">bioinformant\/ghru-snp-phylogeny:version\nOR\nregistry.gitlab.com\/cgps\/ghru\/pipelines\/snp_phylogeny:version<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">1.2.2<\/td><\/tr><tr><td style = \"text-align:center;\">4<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">AMR determinant detection<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">https:\/\/gitlab.com\/cgps\/ghru\/pipelines\/dsl2\/pipelines\/amr_prediction<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">bioinformant\/ghru-amr-prediction:version\nOR\nregistry.gitlab.com\/cgps\/ghru\/pipelines\/dsl2\/pipelines\/amr_prediction<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">1.0<\/td><\/tr><tr><td style = \"text-align:center;\">5<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">MLST<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">https:\/\/gitlab.com\/cgps\/ghru\/pipelines\/dsl2\/pipelines\/mlst<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">bioinformant\/ghru-mlst:version\nOR\nregistry.gitlab.com\/cgps\/ghru\/pipelines\/dsl2\/pipelines\/mlst:version<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">1.0<\/td><\/tr><\/table><\/div>"}},{"id":1054725,"guid":"320B9BE973A54CB0AB814D403475B322","order_id":2,"type_id":1,"title":"description","source":{"description":"<table border><tr style = \"text-align:center;\"><td>  <\/td><td>A<\/td><td>B<\/td><td>C<\/td><td>D<\/td><\/tr><tr><td style = \"text-align:center;\">1<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;font-weight:bold;\">Workflow name<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;font-weight:bold;\">Workflow link<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;font-weight:bold;\">Docker hub Container(s) used <\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;font-weight:bold;\">Version at publication<\/td><\/tr><tr><td style = \"text-align:center;\">2<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">De novo  assembly<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">https:\/\/gitlab.com\/cgps\/ghru\/pipelines\/assembly<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">bioinformant\/ghru-assembly:version\nOR\nregistry.gitlab.com\/cgps\/ghru\/pipelines\/assembly:version<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">1.5.5<\/td><\/tr><tr><td style = \"text-align:center;\">3<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">Mapping based SNP phylogeny<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">https:\/\/gitlab.com\/cgps\/ghru\/pipelines\/snp_phylogeny<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">bioinformant\/ghru-snp-phylogeny:version\nOR\nregistry.gitlab.com\/cgps\/ghru\/pipelines\/snp_phylogeny:version<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">1.2.2<\/td><\/tr><tr><td style = \"text-align:center;\">4<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">AMR determinant detection<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">https:\/\/gitlab.com\/cgps\/ghru\/pipelines\/dsl2\/pipelines\/amr_prediction<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">bioinformant\/ghru-amr-prediction:version\nOR\nregistry.gitlab.com\/cgps\/ghru\/pipelines\/dsl2\/pipelines\/amr_prediction<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">1.0<\/td><\/tr><tr><td style = \"text-align:center;\">5<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">MLST<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">https:\/\/gitlab.com\/cgps\/ghru\/pipelines\/dsl2\/pipelines\/mlst<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">bioinformant\/ghru-mlst:version\nOR\nregistry.gitlab.com\/cgps\/ghru\/pipelines\/dsl2\/pipelines\/mlst:version<\/td><td rowspan = \"\" colspan = \"\" style =\"display : table-cell;\">1.0<\/td><\/tr><\/table>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1067399,"guid":"00E580D6E31D4C8F8A915C5A80D63935","previous_id":1067398,"previous_guid":"8B5EA537DDCE44DF86059B1CD05A7AD2","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"756FC71BE4FB4627956326C726B67D2C","order_id":1,"type_id":6,"title":"Section","source":{"title":""}},{"id":1054724,"guid":"16238BCE30164B45842ECFCC84C673F5","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\"><span style = \"font-weight:bold;\">References<\/span><\/div><div class = \"text-block\">1.  Di Tommaso P, Chatzou M, Floden EW, Barja PP, Palumbo E, Notredame C. Nextflow enables reproducible computational workflows. Nat Biotechnol 2017; 35:316\u2013319.<\/div><div class = \"text-block\">2.  Merkel, D. Docker: lightweight linux containers for consistent development and deployment. 2014; 239.<\/div><div class = \"text-block\">3.  Bolger AM, Lohse M, Usadel B. Trimmomatic: a flexible trimmer for Illumina sequence data. Bioinforma Oxf Engl 2014; 30:2114\u20132120.<\/div><div class = \"text-block\">4.  Song L, Florea L, Langmead B. Lighter: fast and memory-efficient sequencing error correction without counting. Genome Biol 2014; 15:509.<\/div><div class = \"text-block\">5.  Li H. lh3\/seqtk. 2020. Available at: https:\/\/github.com\/lh3\/seqtk. Accessed 26 October 2020.<\/div><div class = \"text-block\">6.  Mago\u010d T, Salzberg SL. FLASH: fast length adjustment of short reads to improve genome assemblies. Bioinformatics 2011; 27:2957\u20132963.<\/div><div class = \"text-block\">7.  Bankevich A, Nurk S, Antipov D, et al. SPAdes: a new genome assembly algorithm and its applications to single-cell sequencing. J Comput Biol J Comput Mol Cell Biol 2012; 19:455\u2013477.<\/div><div class = \"text-block\">8.  FastQC A Quality Control tool for High Throughput Sequence Data. Available at: https:\/\/www.bioinformatics.babraham.ac.uk\/projects\/fastqc\/. Accessed 7 October 2020.<\/div><div class = \"text-block\">9.  Ewels P, Magnusson M, Lundin S, K\u00e4ller M. MultiQC: summarize analysis results for multiple tools and samples in a single report. Bioinforma Oxf Engl 2016; 32:3047\u20133048.<\/div><div class = \"text-block\">10.  Qualifyr. Available at: https:\/\/gitlab.com\/cgps\/qualifyr. Accessed 7 October 2020.<\/div><div class = \"text-block\">11.  BactInspector. Available at: https:\/\/gitlab.com\/antunderwood\/bactinspector. Accessed 26 October 2020.<\/div><div class = \"text-block\">12.  Low AJ, Koziol AG, Manninger PA, Blais B, Carrillo CD. ConFindr: rapid detection of intraspecies and cross-species contamination in bacterial whole-genome sequence data. PeerJ 2019; 7:e6995.<\/div><div class = \"text-block\">13.  Li H. Aligning sequence reads, clone sequences and assembly contigs with BWA-MEM. ArXiv13033997 Q-Bio 2013; Available at: http:\/\/arxiv.org\/abs\/1303.3997. Accessed 26 October 2020.<\/div><div class = \"text-block\">14.  samtools\/bcftools. samtools, 2020. Available at: https:\/\/github.com\/samtools\/bcftools. Accessed 26 October 2020.<\/div><div class = \"text-block\">15.  Nguyen L-T, Schmidt HA, von Haeseler A, Minh BQ. IQ-TREE: A Fast and Effective Stochastic Algorithm for Estimating Maximum-Likelihood Phylogenies. Mol Biol Evol 2015; 32:268\u2013274.<\/div><div class = \"text-block\">16.  Hoang DT, Chernomor O, von Haeseler A, Minh BQ, Vinh LS. UFBoot2: Improving the Ultrafast Bootstrap Approximation. Mol Biol Evol 2018; 35:518\u2013522.<\/div><div class = \"text-block\">17.  Hunt M, Mather AE, S\u00e1nchez-Bus\u00f3 L, et al. ARIBA: rapid antimicrobial resistance genotyping directly from sequencing reads. Microb Genomics 2017; 3:e000131.<\/div><div class = \"text-block\">18.  Bacterial Antimicrobial Resistance Reference Gene. Available at: https:\/\/www.ncbi.nlm.nih.gov\/bioproject\/PRJNA313047. Accessed 26 October 2020.<\/div><div class = \"text-block\">19.  ariba_amr_databases. Available at: https:\/\/gitlab.com\/cgps\/ghru\/pipelines\/data_sources\/ariba_amr_databases. Accessed 26 October 2020.<\/div><div class = \"text-block\">20.  Jolley KA, Chan M-S, Maiden MCJ. mlstdbNet - distributed multi-locus sequence typing (MLST) databases. BMC Bioinformatics 2004; 5:86.<\/div><div class = \"text-block\">21.  Jolley KA, Maiden MCJ. BIGSdb: Scalable analysis of bacterial genome variation at the population level. BMC Bioinformatics 2010; 11:595.<\/div><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"","section_duration":0,"critical":null,"critical_id":null,"duration":0}],"document":null,"materials":[],"description":"<div class = \"text-blocks\"><div class = \"text-block\">A description of the pipelines used for analysing genome data from the retrospective 1 project of the NIHR Global Health Research Unit (Genomic Surveillance of Antimicrobial Resistance)<\/div><div class = \"text-block\">All genome sequence data were processed using versioned Nextflow [1] workflows and associated Docker [2] containers covering the foundational analyses of de novo assembly,mapping-based SNP phylogeny, MLST assignation and AMR determinant detection (table 1). The exact steps performed can be derived from examination of the pipeline code but each workflow will be described in brief.<\/div><\/div>","changed_on":1604332069}