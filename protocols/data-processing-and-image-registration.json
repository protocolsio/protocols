{"id":49131,"title":"Data Processing and Image Registration","title_html":"<p>Data Processing and Image Registration<\/p>","image":{"source":"https:\/\/www.protocols.io\/img\/default_protocol.png","placeholder":"https:\/\/www.protocols.io\/img\/default_protocol.png"},"doi":"dx.doi.org\/10.17504\/protocols.io.bt8jnrun","doi_status":2,"uri":"data-processing-and-image-registration-bt8jnrun","type_id":1,"template_id":1,"published_on":1619200100,"parent_protocols":[],"parent_collections":[],"cited_protocols":[],"version_id":1,"version_data":{"id":"1","code":"bt8jnrun","parent_id":29628,"parent_uri":"lipid-annotation-of-maldi-ims-datasets-864hzgw","is_same_owner":true,"has_pending_merge_request":false,"has_approved_merge_request":true},"created_on":1618432985,"modified_on":null,"categories":null,"public":1,"is_unlisted":0,"creator":{"name":"Jamie Allen","affiliation":"Vanderbilt University","affiliations":[{"affiliation":"Vanderbilt University","url":"","is_default":1}],"username":"jamie-allen","note":null,"link":null,"image":{"source":"\/img\/avatars\/002.png","placeholder":"\/img\/avatars\/002.png"},"badges":[{"id":4,"image":{"source":"\/img\/badges\/gold.svg","placeholder":"\/img\/badges\/gold.svg"},"name":"Gold power author!"}],"verified":0,"is_verified_user":false,"research_interests":null,"blocked_by_you":false,"blocked_you":false,"hide_following":false},"journal":null,"journal_name":null,"journal_link":null,"article_citation":null,"has_versions":0,"link":null,"total_collections":0,"number_of_steps":35,"authors":[{"name":"Elizabeth Neumann","affiliation":"Vanderbilt University","affiliations":[],"username":"elizabeth-neumann","note":"","link":null,"image":{"source":"\/img\/avatars\/011.png","placeholder":"\/img\/avatars\/011.png"},"badges":[],"verified":1,"is_verified_user":true,"research_interests":null,"blocked_by_you":false,"blocked_you":false,"hide_following":false},{"name":"Nathan Heath Patterson","affiliation":"Vanderbilt University","affiliations":[],"username":"nathan-heath-patterson","note":"","link":null,"image":{"source":"\/img\/avatars\/003.png","placeholder":"\/img\/avatars\/003.png"},"badges":[],"verified":1,"is_verified_user":true,"research_interests":null,"blocked_by_you":false,"blocked_you":false,"hide_following":false},{"name":"Lukasz Migas","affiliation":"Delft University of Technology","affiliations":[],"username":"lukasz-migas","note":"","link":null,"image":{"source":"https:\/\/s3.amazonaws.com\/pr-journal\/bejza.jpg","placeholder":"https:\/\/s3.amazonaws.com\/pr-journal\/bejza.jpg"},"badges":[],"verified":1,"is_verified_user":true,"research_interests":null,"blocked_by_you":false,"blocked_you":false,"hide_following":false},{"name":"Jamie Allen","affiliation":"Vanderbilt University","affiliations":[],"username":"jamie-allen","note":"","link":null,"image":{"source":"\/img\/avatars\/002.png","placeholder":"\/img\/avatars\/002.png"},"badges":[],"verified":1,"is_verified_user":true,"research_interests":null,"blocked_by_you":false,"blocked_you":false,"hide_following":false},{"name":"Carrie  Romer","affiliation":"Vanderbilt University","affiliations":[],"username":"carrie--romer","note":"","link":null,"image":{"source":"\/img\/avatars\/002.png","placeholder":"\/img\/avatars\/002.png"},"badges":[],"verified":1,"is_verified_user":true,"research_interests":null,"blocked_by_you":false,"blocked_you":false,"hide_following":false},{"name":"Jeff Spraggins","affiliation":"Vanderbilt University","affiliations":[],"username":"jeff-spraggins","note":"","link":null,"image":{"source":"https:\/\/s3.amazonaws.com\/pr-journal\/bftu6bxe.jpg","placeholder":"https:\/\/s3.amazonaws.com\/pr-journal\/bftu6bxe.jpg"},"badges":[],"verified":1,"is_verified_user":true,"research_interests":null,"blocked_by_you":false,"blocked_you":false,"hide_following":false},{"name":"Danielle Gutierrez","affiliation":"Vanderbilt University","affiliations":[],"username":"danielle-gutierrez","note":"","link":null,"image":{"source":"https:\/\/s3.amazonaws.com\/pr-journal\/bftz6bx6.jpeg","placeholder":"https:\/\/s3.amazonaws.com\/pr-journal\/bftz6bx6.jpeg"},"badges":[],"verified":1,"is_verified_user":true,"research_interests":null,"blocked_by_you":false,"blocked_you":false,"hide_following":false}],"versions":[],"groups":[{"id":1142,"uri":"BIOMIC","title":"VU Biomolecular Multimodal Imaging Center","image":{"source":"https:\/\/s3.amazonaws.com\/pr-journal\/bftr6bxe.png","placeholder":"https:\/\/s3.amazonaws.com\/pr-journal\/bftr6bxe.png"},"tech_support":{"email":"jeff.spraggins@vanderbilte.du","phone":"","hide_contact":0,"use_email":0,"url":null},"is_member":1,"request":{"id":1142,"uri":"BIOMIC","title":"VU Biomolecular Multimodal Imaging Center","image":{"source":"https:\/\/s3.amazonaws.com\/pr-journal\/bftr6bxe.png","placeholder":"https:\/\/s3.amazonaws.com\/pr-journal\/bftr6bxe.png"},"tech_support":{"email":"jeff.spraggins@vanderbilte.du","phone":"","hide_contact":0,"use_email":0,"url":null},"is_member":1,"description":null,"research_interests":null,"website":null,"location":null,"affiliation":null,"status":{"is_visible":true,"access_level":0},"stats":{"files":[],"total_members":0,"total_followers":0,"total_child_groups":0,"total_parent_groups":0,"has_collaborations":0},"user_status":{"is_member":true,"is_confirmed":true,"is_invited":false,"is_owner":false,"is_admin":false,"is_following":false},"join_link":null,"token":null,"owner":{"name":" ","affiliation":null,"affiliations":[],"username":null,"note":null,"link":null,"image":{"source":null,"placeholder":null},"badges":[],"verified":0,"is_verified_user":false,"research_interests":null,"blocked_by_you":false,"blocked_you":false,"hide_following":false},"is_protocol_requested":0,"is_group_requested":0,"is_my":false,"is_request":false,"is_confirmed":1,"is_declined":0,"requester":{"name":" ","affiliation":null,"affiliation_url":null,"username":null,"link":null},"protocol":{"id":0,"title":"Data Processing and Image Registration","title_html":"Data Processing and Image Registration","image":{"source":null,"placeholder":null},"doi":null,"doi_status":0,"uri":"data-processing-and-image-registration-bt8jnrun","type_id":1,"template_id":0,"published_on":null,"stats":{"number_of_views":0,"number_of_steps":0,"number_of_bookmarks":0,"number_of_comments":0,"number_of_exports":0,"number_of_runs":0,"number_of_votes":0,"is_voted":0},"parent_protocols":[],"parent_collections":[],"cited_protocols":[]},"created_on":1580516257,"resolve_on":0,"resolved_user":{"name":" ","affiliation":null,"affiliations":[],"username":null,"note":null,"link":null,"image":{"source":null,"placeholder":null},"badges":[],"verified":0,"is_verified_user":false,"research_interests":null,"blocked_by_you":false,"blocked_you":false,"hide_following":false},"shared":false}}],"is_owner":1,"has_subprotocols":0,"is_subprotocol":0,"is_bookmarked":0,"can_claim_authorship":0,"can_accept_authorship":0,"can_be_copied":1,"can_remove_fork":1,"fork_id":null,"url":"https:\/\/www.protocols.io\/view\/data-processing-and-image-registration-bt8jnrun","forks_count":{"private":0,"public":0},"access":{"can_view":1,"can_remove":0,"can_add":0,"can_edit":0,"can_publish":0,"can_get_doi":0,"can_share":1,"can_move":1,"can_move_outside":1,"can_transfer":1,"can_download":1,"is_locked":0},"guid":"9005901452E6453983A8D5C324180271","state_version_id":537,"steps":[{"id":1161858,"guid":"54F2D84B18604E81B4497554C1D93A08","previous_id":1161862,"previous_guid":"D8BD5A18D1354E20A497ECAE06D0899D","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"D4D9E5AD7F8C496888A8E6AE0ABF56AC","order_id":1,"type_id":6,"title":"Section","source":{"title":"Data Processing"}},{"id":1054724,"guid":"7B603134149045F99B40C01970E3AC09","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\"><div class = \"justify\" style = \"text-align:left\">Extract peak intensity from the calibrated dataset using one of the available options:<\/div><\/div><div class = \"text-block\"><div class = \"justify\" style = \"text-align:left\"> <\/div><\/div><div class = \"text-block\"><div class = \"justify\" style = \"text-align:left\">1a. Extract ion images based on an untargeted feature list that has not been narrowed down by the previous step. <\/div><\/div><div class = \"text-block\"><div class = \"justify\" style = \"text-align:left\">1b. Extract ion images based on the identified feature list generated using the previous step. <\/div><\/div><div class = \"text-block\">Note: In either case, narrow 3-5 m\/z bin extraction windows are created for each selected peak and the ion images are generated. The width of the extraction window is important because if it is too wide, several poorly resolved ions can be captured within one ion image. <\/div><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#A492FF","section_duration":0,"critical":[],"critical_id":null,"duration":0},{"id":1161859,"guid":"792E0F0D1C364109815CF3ED1EF40F1C","previous_id":1162277,"previous_guid":"E6C4E0E09E1B11EB89776B30DE995ED1","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"E1D7A894128242AD98663DAF612C1718","order_id":1,"type_id":6,"title":"Section","source":{"title":"Data Processing"}},{"id":1054724,"guid":"B5678026D92043FA8C8CD38B7E5121B4","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\"><span>Calculate ppm error associated with common lipids, such as [PC(32:0)+H]<\/span><span style = \"vertical-align:super;\">+<\/span><span> and [PC(34:1)+H]<\/span><span style = \"vertical-align:super;\">+<\/span><span>, for mass errors.  If mass error is above 3 ppm, re-calibrate.<\/span><\/div><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#A492FF","section_duration":0,"critical":[],"critical_id":null,"duration":0},{"id":1161860,"guid":"6540291ECD784E209B1CD08913521E49","previous_id":1162278,"previous_guid":"19D4C7209E1C11EB89776B30DE995ED1","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"AB13E4F6BAE14648AF9C8DBD31306117","order_id":1,"type_id":6,"title":"Section","source":{"title":"Data Processing"}},{"id":1054724,"guid":"74F76DC8C6FC45CDB51D15613124F0EE","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\"><span>If LC-MS\/MS has been performed, annotate each <\/span><span style = \"font-style:italic;\">m\/z<\/span><span> value against the LC-MS\/MS list, otherwise move to 7.1<\/span><\/div><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#A492FF","section_duration":0,"critical":[],"critical_id":null,"duration":0},{"id":1161861,"guid":"1327329C9ACE4128BC82CC7F5274B1CC","previous_id":1161860,"previous_guid":"6540291ECD784E209B1CD08913521E49","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"7719F36FC2424BA1B1EF319ECE4D05E0","order_id":1,"type_id":6,"title":"Section","source":{"title":"Data Processing"}},{"id":1054724,"guid":"2D7D1FF4D9174ED9B1314F59DF86FFC7","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\"><span>Perform peak picking on the mean mass spectrum and use LIPIDMAPS database to annotate each <\/span><span style = \"font-style:italic;\">m\/z<\/span><span> value with the following search criteria:<\/span><\/div><div class = \"text-block\"><a href=\"https:\/\/www.lipidmaps.org\/resources\/tools\/bulk_structure_searches.php?database=COMP_DB\" style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">https:\/\/www.lipidmaps.org\/resources\/tools\/bulk_structure_searches.php?database=COMP_DB<\/span><\/a><\/div><div class = \"text-block\"><span>1a. Positive Mode Adducts: [M+H]<\/span><span style = \"vertical-align:super;\">+<\/span><span>, [M+H-H<\/span><span style = \"vertical-align:sub;\">2<\/span><span>O]<\/span><span style = \"vertical-align:super;\">+<\/span><span>, [M+Na]<\/span><span style = \"vertical-align:super;\">+<\/span><span>, [M+K]<\/span><span style = \"vertical-align:super;\">+<\/span><\/div><div class = \"text-block\"><span>1b. Negative Mode Adducts: [M+H]<\/span><span style = \"vertical-align:super;\">-<\/span><span>, [M+Cl]<\/span><span style = \"vertical-align:super;\">-<\/span><span>, [M+HCOO]<\/span><span style = \"vertical-align:super;\">-<\/span><span>, [M+OAc]<\/span><span style = \"vertical-align:super;\">-<\/span><\/div><div class = \"text-block\"><span>2.   Specify Mass Tolerance: 0.005 <\/span><span style = \"font-style:italic;\">m\/z<\/span><\/div><div class = \"text-block\">3.   Specify Chains: Even Chains Only<\/div><div class = \"text-block\">4.   Sort: Delta<\/div><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#A492FF","section_duration":0,"critical":[],"critical_id":null,"duration":0},{"id":1161862,"guid":"D8BD5A18D1354E20A497ECAE06D0899D","previous_id":1161861,"previous_guid":"1327329C9ACE4128BC82CC7F5274B1CC","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"D907AFAAD94D4450B452CCDE4014FC6F","order_id":1,"type_id":6,"title":"Section","source":{"title":"Data Processing"}},{"id":1054724,"guid":"E13BA9139B7048C7AB7F1DC88E56983D","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Calculate ppm error associated with each assignment and remove assignments with errors larger than 5 ppm, although most have errors lower than 3 ppm. <\/div><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#A492FF","section_duration":0,"critical":[],"critical_id":null,"duration":0},{"id":1162253,"guid":"AA408C209E1911EBAD39DFC772F1C772","previous_id":null,"previous_guid":null,"modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"DCA351CFBF854B15911B458E9848E2CA","order_id":1,"type_id":6,"title":"Section","source":{"title":"Data Processing"}},{"id":1054724,"guid":"408EF8A441794D21A9E9D3E80F0A5B17","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Convert Bruker (.d) raw file into a custom binary data format in profile mode at native spectral resolution. <\/div><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#A492FF","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1162263,"guid":"A9C65DA09E1A11EB89776B30DE995ED1","previous_id":null,"previous_guid":null,"modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"6DCD2BA0C2404E34A5CDB1CD7D64804D","order_id":1,"type_id":6,"title":"Section","source":{"title":"Data Processing"}},{"id":1054724,"guid":"CD25523969E8424694630B559AD22696","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Convert Bruker (.d) raw file into custom binary data format in profile mode at native spectral resolution.<\/div><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#A492FF","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1162267,"guid":"388CA8A09E1B11EB89776B30DE995ED1","previous_id":1162263,"previous_guid":"A9C65DA09E1A11EB89776B30DE995ED1","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"1A9CF65D3DA74EA298CEBD194E99714F","order_id":1,"type_id":6,"title":"Section","source":{"title":"Data Processing"}},{"id":1054724,"guid":"C9353CAFDABE4BD1A35B8F0B9D9244A0","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Perform mass alignment and calibration of the dataset.<\/div><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#A492FF","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1162268,"guid":"5063B7709E1B11EB89776B30DE995ED1","previous_id":1162267,"previous_guid":"388CA8A09E1B11EB89776B30DE995ED1","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"3D41897DDE274E0B8D5A066618B5C3E0","order_id":1,"type_id":6,"title":"Section","source":{"title":"Data Processing"}},{"id":1054724,"guid":"F9CB4E5C18F8455886BEEECD58F02E59","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\"><div class = \"justify\" style = \"text-align:left\">Spectral misalignment is estimated for each pixel and corrected using PCHIP interpolation or linear shift. Alignment is carried out using a Python msalign package (https:\/\/github.com\/lukasz-migas\/msalign). All spectra are first aligned based on automatically selected peaks and then recalibrated using at least three of the following well-characterized lipids: <\/div><\/div><div class = \"text-block\"><div class = \"justify\" style = \"text-align:left\">1. Positive mode: m\/z 703.5748, 734.5694, 760.5851, 810.6001. <\/div><\/div><div class = \"text-block\">2. Negative mode: m\/z 673.4814, 744.5549, 834.5291, 885.5499.<\/div><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#A492FF","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1162277,"guid":"E6C4E0E09E1B11EB89776B30DE995ED1","previous_id":1162268,"previous_guid":"5063B7709E1B11EB89776B30DE995ED1","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"66B6DEE669C24F3CBC732DD7FF53085B","order_id":1,"type_id":6,"title":"Section","source":{"title":"Data Processing"}},{"id":1054724,"guid":"574A696191004A8497F9E1227A0053A3","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Create a mean mass spectrum by taking the mean of each mass bin in the dataset.<\/div><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#A492FF","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1162278,"guid":"19D4C7209E1C11EB89776B30DE995ED1","previous_id":1161859,"previous_guid":"792E0F0D1C364109815CF3ED1EF40F1C","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"A8E3058A40544F83BF337481EB10FE69","order_id":1,"type_id":6,"title":"Section","source":{"title":"Data Processing"}},{"id":1054724,"guid":"DE61BE3B9663454CB47440428A606ADD","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Compute total ion current (TIC)-based normalization factors for each pixel after alignment and calibration.<\/div><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#A492FF","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1162310,"guid":"4C8A37B09E2411EB89776B30DE995ED1","previous_id":1161858,"previous_guid":"54F2D84B18604E81B4497554C1D93A08","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"E4893C9D28D84B0F98B83622D6404D26","order_id":1,"type_id":6,"title":"Section","source":{"title":"Data Processing"}},{"id":1054724,"guid":"A04A03C6B9CC4F06B477E2B2C406AA0C","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Export the extracted peak intensities to a columnar CSV file by concatenating the x and y-coordinates from the registration step with the preselected ions in the form: x, y, m\/z 1, m\/z 2 \u2026 m\/z N. <\/div><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#A492FF","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1162312,"guid":"F4CCDD109E2411EB89776B30DE995ED1","previous_id":1162310,"previous_guid":"4C8A37B09E2411EB89776B30DE995ED1","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"5B3482259FAA4F749D75E36B2AB27056","order_id":1,"type_id":6,"title":"Section","source":{"title":"Data Processing"}},{"id":1054724,"guid":"896A4612FE9E44FFAF84571D5EA61BA9","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Read-in the table into Python and export the peak intensities to an imzML file using the Python pyimzML library (https:\/\/github.com\/lukasz-migas\/pyimzML).<\/div><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#A492FF","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1162313,"guid":"0B48EFC09E2511EB89776B30DE995ED1","previous_id":1162312,"previous_guid":"F4CCDD109E2411EB89776B30DE995ED1","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"6D14F8BEE90E41AC98B866D066E2DC30","order_id":1,"type_id":6,"title":"Section","source":{"title":"Image Alignment and Registration"}},{"id":1054724,"guid":"AA152DCAF9F545E794679CBE47572389","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Generate a MALDI imaging mass spectrometry (IMS) pixel map using regToolboxMSRC<\/div><div class = \"text-block\">https:\/\/github.com\/nhpatterson\/regtoolboxmsrc<\/div><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#94EBFF","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1162314,"guid":"3FDEE4509E2611EB89776B30DE995ED1","previous_id":1162313,"previous_guid":"0B48EFC09E2511EB89776B30DE995ED1","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"11AB5E1251F2486CA2A26C7357A60230","order_id":1,"type_id":6,"title":"Section","source":{"title":"Image Alignment and Registration"}},{"id":1054724,"guid":"9AD9B5A4470C40F8A6FD228DB45E244A","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Using FIJI ImageJ, select corresponding laser ablation marks and IMS pixels in the post-acquisition autofluorescence (post-AF) and IMS pixel map, respectively.<\/div><div class = \"text-block\">https:\/\/fiji.sc<\/div><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#94EBFF","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1162315,"guid":"6B4D35609E2611EB89776B30DE995ED1","previous_id":1162314,"previous_guid":"3FDEE4509E2611EB89776B30DE995ED1","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"B09C40A22FE745FF87677F224D8D7CC1","order_id":1,"type_id":6,"title":"Section","source":{"title":"Image Alignment and Registration"}},{"id":1054724,"guid":"7BA4F84E060344A29862FA5F434838B9","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Use a \"Landmark Correspondences\" FIJI plugin to find an affine transformation between the two images, resampling the post-AF image to the IMS pixel map by selecting post-AF image as source image, and IMS pixel map as the template image within the plugin.<\/div><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#94EBFF","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1162316,"guid":"B9B27BC09E2611EB89776B30DE995ED1","previous_id":1162315,"previous_guid":"6B4D35609E2611EB89776B30DE995ED1","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"1DB75A9BFD044F59A78ADDF0B7767CD3","order_id":1,"type_id":6,"title":"Section","source":{"title":"Image Alignment and Registration"}},{"id":1054724,"guid":"8CD661E169F544F6A147DC1B1A93FD16","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Save the post-AF image.<\/div><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#94EBFF","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1162317,"guid":"C7CC1A409E2611EB89776B30DE995ED1","previous_id":1162316,"previous_guid":"B9B27BC09E2611EB89776B30DE995ED1","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"D81CD9D0B93D435BAA82897241DDD927","order_id":1,"type_id":6,"title":"Section","source":{"title":"Image Alignment and Registration"}},{"id":1054724,"guid":"CFAA7AE98E5B49E487E608804037031B","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Using wsireg (https:\/\/github.com\/nhpatterson\/wsireg) to align other microscopy modalities, such as CODEX multiplexed IF, preIMS AF, PAS or any other associated microscopy image, to the newly saved post-AF image. wsireg will generate pyramidal OME-TIFF images for all images after registration. <\/div><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#94EBFF","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1162318,"guid":"0B2354709E2711EB89776B30DE995ED1","previous_id":1162317,"previous_guid":"C7CC1A409E2611EB89776B30DE995ED1","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"0132424C1D5F4B25BCCB44674A426EBA","order_id":1,"type_id":6,"title":"Section","source":{"title":"Image Alignment and Registration"}},{"id":1054724,"guid":"6E3D7568814B4C2CB0DC1835884626B9","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">When complete, all images will be sampled in the same coordinates as the IMS pixel map and IMS can be overlaid onto microscopy by scaling the IMS data to the same resolution as the microscopy data.<\/div><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#94EBFF","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1162337,"guid":"3B6DADE09E2E11EB9B2D0B91F02B959C","previous_id":1162253,"previous_guid":"AA408C209E1911EBAD39DFC772F1C772","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"57F527713B074C94A60726352F7F39F3","order_id":1,"type_id":6,"title":"Section","source":{"title":"Data Processing"}},{"id":1054724,"guid":"2E97C25C76FC4368963E1203B49533E1","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\"><div class = \"justify\" style = \"text-align:left\">Perform mass alignment and calibration of the dataset. <\/div><\/div><div class = \"text-block\"><div class = \"justify\" style = \"text-align:left\"><\/div><\/div><div class = \"text-block\"><div class = \"justify\" style = \"text-align:left\">Spectral misalignment is estimated for each pixel and corrected using PCHIP interpolation or linear shift. Alignment is carried out using a Python msalign package (https:\/\/github.com\/lukasz-migas\/msalign). All spectra are first aligned based on automatically selected peaks and then recalibrated using at least three of the following well-characterized lipids: <\/div><\/div><div class = \"text-block\"><div class = \"justify\" style = \"text-align:left\"><\/div><\/div><div class = \"text-block\"><div class = \"justify\" style = \"text-align:left\">1. Positive mode: m\/z 703.5748, 734.5694, 760.5851, 810.6001. <\/div><\/div><div class = \"text-block\"><div class = \"justify\" style = \"text-align:left\">2. Negative mode: m\/z 673.4814, 744.5549, 834.5291, 885.5499. <\/div><\/div><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#A492FF","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1162338,"guid":"9AE97F109E2E11EB9B2D0B91F02B959C","previous_id":1162337,"previous_guid":"3B6DADE09E2E11EB9B2D0B91F02B959C","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"C2A4982960554FA79CD42BFD8B067C19","order_id":1,"type_id":6,"title":"Section","source":{"title":"Data Processing"}},{"id":1054724,"guid":"9CCC626244BE4A5C9CD73B299CF81F55","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Create a mean mass spectrum by taking the mean of each mass bin in the dataset.<\/div><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#A492FF","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1162339,"guid":"C09D23609E2E11EB9B2D0B91F02B959C","previous_id":1162338,"previous_guid":"9AE97F109E2E11EB9B2D0B91F02B959C","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"23EFA0AA6EF0400292A63523C5248FC6","order_id":1,"type_id":6,"title":"Section","source":{"title":"Data Processing"}},{"id":1054724,"guid":"99A274AB89F8484AB30466249B488774","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Calculate ppm error associated with common lipids, such as [PC(32:0)+H]+ and [PC(34:1)+H]+.  If mass error is above 3 ppm, re-calibrate the entire dataset with additional well-characterized ions.<\/div><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#A492FF","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1162341,"guid":"14236E909E2F11EB9B2D0B91F02B959C","previous_id":1162339,"previous_guid":"C09D23609E2E11EB9B2D0B91F02B959C","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"6990E038E7224C6CB18A0435879712CF","order_id":1,"type_id":6,"title":"Section","source":{"title":"Data Processing"}},{"id":1054724,"guid":"1926DAC285EE452A9B9BA7D71E87DE7B","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Compute total ion current (TIC)-based normalization factors for each pixel after alignment and calibration has been performed.  <\/div><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#A492FF","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1162342,"guid":"3004DAB09E3211EB9B2D0B91F02B959C","previous_id":1162341,"previous_guid":"14236E909E2F11EB9B2D0B91F02B959C","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"0E7163F9153E4BEAB9953CF3AA01ED3F","order_id":1,"type_id":6,"title":"Section","source":{"title":"Data Processing"}},{"id":1054724,"guid":"35E39F9315CB4BD5A9E6B7E09796732A","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">If LC-MS\/MS has been performed, annotate each m\/z value against the LC-MS\/MS list, otherwise move to 6.1<\/div><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#A492FF","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1162343,"guid":"414953509E3211EB9B2D0B91F02B959C","previous_id":1162342,"previous_guid":"3004DAB09E3211EB9B2D0B91F02B959C","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"FB3E9EF3F1D94EE9800928EEBBE98AEA","order_id":1,"type_id":6,"title":"Section","source":{"title":"Data Processing"}},{"id":1054724,"guid":"E2A14EADEFD84650AECE7D0EE5617B4C","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Use LIPIDMAPS database to annotate each m\/z value with the following search criteria:<\/div><div class = \"text-block\"><a href=\"https:\/\/www.lipidmaps.org\/resources\/tools\/bulk_structure_searches.php?database=COMP_DB\" style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">https:\/\/www.lipidmaps.org\/resources\/tools\/bulk_structure_searches.php?database=COMP_DB<\/span><\/a><\/div><div class = \"text-block\">1a. Positive Mode Adducts: [M+H]+, [M+H-H2O]+, [M+Na]+, [M+K]+<\/div><div class = \"text-block\">1b. Negative Mode Adducts: [M+H]-, [M+Cl]-, [M+HCOO]-, [M+OAc]-<\/div><div class = \"text-block\">2.   Specify Mass Tolerance: 0.005 m\/z<\/div><div class = \"text-block\">3.   Specify Chains: Even Chains Only<\/div><div class = \"text-block\">4.   Sort: Delta<\/div><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#A492FF","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1162344,"guid":"B44C3A209E3211EB9B2D0B91F02B959C","previous_id":1162343,"previous_guid":"414953509E3211EB9B2D0B91F02B959C","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"2143DA8519AE46EC93292AE1D2C845C6","order_id":1,"type_id":6,"title":"Section","source":{"title":"Data Processing"}},{"id":1054724,"guid":"14BAB89184EA4899A1A3275CA5BC3C5F","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Calculate the ppm error associated with each assignment and remove assignments with errors larger than 5 ppm, although most have errors lower than 3 ppm.<\/div><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#A492FF","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1162688,"guid":"DE70AE309EC311EB9B2D0B91F02B959C","previous_id":1162344,"previous_guid":"B44C3A209E3211EB9B2D0B91F02B959C","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"4E43BE4AACF544AB8E35988F3F4F8BCE","order_id":1,"type_id":6,"title":"Section","source":{"title":"Data Processing"}},{"id":1054724,"guid":"2A5F29413E0C420C85BE60BA3D69BE41","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\"><div class = \"justify\" style = \"text-align:left\">Extract peak intensity from the calibrated dataset using one of the available options: <\/div><\/div><div class = \"text-block\"><div class = \"justify\" style = \"text-align:left\"><\/div><\/div><div class = \"text-block\"><div class = \"justify\" style = \"text-align:left\">1. Extract ion images based on an untargeted feature list that has not been narrowed down by the previous step. <\/div><\/div><div class = \"text-block\"><div class = \"justify\" style = \"text-align:left\">2. Extract ion images based on the identified feature list generated using the previous step.<\/div><\/div><div class = \"text-block\"><div class = \"justify\" style = \"text-align:left\"><\/div><\/div><div class = \"text-block\"><div class = \"justify\" style = \"text-align:left\">Note: In either case, narrow 3-5 m\/z bin extraction windows are created for each selected peak and the ion images are generated. The width of the extraction window is important because if it is too wide, several poorly resolved ions can be captured within one ion image.<\/div><\/div><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#A492FF","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1162690,"guid":"E7BC37F09EC511EB9B2D0B91F02B959C","previous_id":1162688,"previous_guid":"DE70AE309EC311EB9B2D0B91F02B959C","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"026757E2DC7644348B9E97785AF8AA8A","order_id":1,"type_id":6,"title":"Section","source":{"title":"Data Processing"}},{"id":1054724,"guid":"9BAEBE68E2E1404D93F95B7399C01E4F","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Export the extracted peak intensities to a columnar CSV file by concatenating the x and y-coordinates from the registration step with the preselected ions in the form: x, y, m\/z 1, m\/z 2 \u2026 m\/z N. <\/div><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#A492FF","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1162691,"guid":"27C24B509EC611EB9B2D0B91F02B959C","previous_id":1162690,"previous_guid":"E7BC37F09EC511EB9B2D0B91F02B959C","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"505D15470EAC4D00922F4BC337D7E3D9","order_id":1,"type_id":6,"title":"Section","source":{"title":"Data Processing"}},{"id":1054724,"guid":"6CEC2B6EF86143AC8D0CD833BE8BD54C","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Read-in the table into Python and export the peak intensities to an imzML file using the Python pyimzML library (https:\/\/github.com\/lukasz-migas\/pyimzML).<\/div><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#A492FF","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1162694,"guid":"739611609EC611EB9B2D0B91F02B959C","previous_id":1162691,"previous_guid":"27C24B509EC611EB9B2D0B91F02B959C","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"B5E22307513345168DB87B7BA529C794","order_id":1,"type_id":6,"title":"Section","source":{"title":"Image Alignment and Registration"}},{"id":1054724,"guid":"F0281A8707F24FD19BCDD392BFD28A28","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Generate a MALDI imaging mass spectrometry pixel map using regToolboxMSRC (https:\/\/github.com\/nhpatterson\/regtoolboxmsrc). <\/div><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#94EBFF","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1162695,"guid":"B2211D809EC611EB9B2D0B91F02B959C","previous_id":1162694,"previous_guid":"739611609EC611EB9B2D0B91F02B959C","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"36A47D435DE5470FA2151EDBEE10B210","order_id":1,"type_id":6,"title":"Section","source":{"title":"Image Alignment and Registration"}},{"id":1054724,"guid":"ADACE38DFA374B499AF5FD41AA26DA4C","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Using FIJI ImageJ, select corresponding laser ablation marks and IMS pixels in the post-acquisition autofluorescence image map and IMS pixel map, respectively.<\/div><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#94EBFF","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1162696,"guid":"D04CA8109EC611EB9B2D0B91F02B959C","previous_id":1162695,"previous_guid":"B2211D809EC611EB9B2D0B91F02B959C","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"FB44AA411F014A469C27B631B08C2E08","order_id":1,"type_id":6,"title":"Section","source":{"title":"Image Alignment and Registration"}},{"id":1054724,"guid":"B558A6FC209D4BD18504AA4A6EDA7A2C","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Use a \"Landmark Correspondences\" FIJI plugin to find an affine transformation between the two images, resampling the post-AF image to the IMS pixel map by selecting post-AF image as source image, and IMS pixel map as the template image within the plugin.<\/div><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#94EBFF","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1162697,"guid":"5E2D4E009EC711EB9B2D0B91F02B959C","previous_id":1162696,"previous_guid":"D04CA8109EC611EB9B2D0B91F02B959C","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"DAD756691AD448DF9B0788143A4CA4A8","order_id":1,"type_id":6,"title":"Section","source":{"title":"Image Alignment and Registration"}},{"id":1054724,"guid":"633C0C8D9EFA4A47A907621746ACF994","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Save the transformed and registered post-AF image.<\/div><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#94EBFF","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1162698,"guid":"74D15B109EC711EB9B2D0B91F02B959C","previous_id":1162697,"previous_guid":"5E2D4E009EC711EB9B2D0B91F02B959C","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"4B12DB65BF304E1EA8A6B6EDA44A6200","order_id":1,"type_id":6,"title":"Section","source":{"title":"Image Alignment and Registration"}},{"id":1054724,"guid":"76E0313D4A904220AF8E26D85B4EDF9F","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Using wsireg (https:\/\/github.com\/nhpatterson\/wsireg) to align other microscopy modalities, such as CODEX multiplexed IF, preIMS AF, PAS or any other associated microscopy image, to the newly saved post-AF image. wsireg will generate pyramidal OME-TIFF images for all images after registration.<\/div><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#94EBFF","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1162699,"guid":"C02CE3E09EC711EB9B2D0B91F02B959C","previous_id":1162698,"previous_guid":"74D15B109EC711EB9B2D0B91F02B959C","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"B480A722EBAE420594B50A4F474B8D64","order_id":1,"type_id":6,"title":"Section","source":{"title":"Image Alignment and Registration"}},{"id":1054724,"guid":"75651F24EFB84C1A974B67C4E1364206","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">When complete, all images will be sampled in the same coordinates as the IMS pixel map and IMS can be overlaid onto microscopy by scaling the IMS data to the same resolution as the microscopy data.<\/div><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#94EBFF","section_duration":0,"critical":null,"critical_id":null,"duration":0}],"document":"","materials":[],"description":"<div class = \"text-blocks\"><div class = \"text-block\">Scope: <\/div><div class = \"text-block\">Annotate lipid species detected by MALDI IMS analysis, and register MALDI IMS images to different types of microscopy images.<\/div><div class = \"text-block\">Expected Outcome:<\/div><div class = \"text-block\">A list of lipid identifications with low mass errors (<5 ppm) that correlate to ion images produced by MALDI IMS analysis, and the ability to layer different images from different assays.<\/div><\/div>","changed_on":1619200100}