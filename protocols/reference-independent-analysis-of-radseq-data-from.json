{"id":34379,"title":"Reference-independent analysis of RADseq data from a single sample","title_html":"<p>Reference-independent analysis of RADseq data from a single sample<\/p>","image":{"source":"https:\/\/www.protocols.io\/img\/default_protocol.png","placeholder":"https:\/\/www.protocols.io\/img\/default_protocol.png"},"doi":"dx.doi.org\/10.17504\/protocols.io.bdtji6kn","doi_status":2,"uri":"reference-independent-analysis-of-radseq-data-from-bdtji6kn","type_id":1,"template_id":1,"published_on":1592921677,"parent_protocols":[],"parent_collections":[],"cited_protocols":[],"version_id":0,"created_on":1584453941,"categories":null,"creator":{"name":"Bradley J. Till","affiliation":"Centro de Gen\u00f3mica Nutricional Agroacu\u00edcola; https:\/\/orcid.org\/0000-0002-1300-8285","affiliations":[{"affiliation":"Centro de Gen\u00f3mica Nutricional Agroacu\u00edcola; https:\/\/orcid.org\/0000-0002-1300-8285","url":"","is_default":1}],"username":"bradley-till","link":null,"image":{"source":"\/img\/avatars\/005.png","placeholder":"\/img\/avatars\/005.png"},"badges":[{"id":2,"image":{"source":"\/img\/badges\/bronze.svg","placeholder":"\/img\/badges\/bronze.svg"},"name":"Author"}],"verified":0,"is_verified_user":false,"research_interests":null,"blocked_by_you":false,"blocked_you":false,"hide_following":false},"journal":null,"journal_name":null,"journal_link":null,"article_citation":null,"public":1,"has_versions":0,"link":null,"total_collections":0,"number_of_steps":17,"authors":[{"name":"Bradley Till","affiliation":"Centro de Gen\u00f3mica Nutricional Agroacu\u00edcola; https:\/\/orcid.org\/0000-0002-1300-8285","affiliations":[],"username":"bradley-till","link":null,"image":{"source":"\/img\/avatars\/005.png","placeholder":"\/img\/avatars\/005.png"},"badges":[],"verified":1,"is_verified_user":true,"research_interests":null,"blocked_by_you":false,"blocked_you":false,"hide_following":false},{"name":"Claudia Osorio","affiliation":"Instituto de Investigaciones Agropecuarias","affiliations":[],"username":"claudia-osorio","link":null,"image":{"source":"\/img\/avatars\/004.png","placeholder":"\/img\/avatars\/004.png"},"badges":[],"verified":1,"is_verified_user":true,"research_interests":null,"blocked_by_you":false,"blocked_you":false,"hide_following":false},{"name":"Rachel Howard-Till","affiliation":"Centro de Gen\u00f3mica Nutricional Agroacu\u00edcola; https:\/\/orcid.org\/0000-0003-2568-7980","affiliations":[],"username":"rachel-howardtill","link":null,"image":{"source":"\/img\/avatars\/017.png","placeholder":"\/img\/avatars\/017.png"},"badges":[],"verified":1,"is_verified_user":true,"research_interests":null,"blocked_by_you":false,"blocked_you":false,"hide_following":false}],"versions":[],"groups":[],"is_owner":1,"has_subprotocols":0,"is_subprotocol":0,"is_bookmarked":0,"can_claim_authorship":0,"can_accept_authorship":0,"can_be_copied":1,"can_remove_fork":1,"fork_id":null,"url":"https:\/\/www.protocols.io\/view\/reference-independent-analysis-of-radseq-data-from-bdtji6kn","forks_count":{"private":0,"public":0},"access":{"can_view":1,"can_remove":0,"can_add":0,"can_edit":0,"can_publish":0,"can_get_doi":0,"can_share":1,"can_move":1,"can_move_outside":1,"can_transfer":1,"can_download":1,"is_locked":0},"guid":"46EADFB0685811EAAD78C19B3B28CFC1","state_version_id":2475,"steps":[{"id":898029,"guid":"2CE51AF0686111EAAD78C19B3B28CFC1","previous_id":null,"previous_guid":null,"modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"421596F28A48487B900677E6934B6AC2","order_id":1,"type_id":6,"title":"Section","source":{"title":""}},{"id":1054724,"guid":"27F558CBFB5D46D7B7FD91A64EF00E82","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Prepare genomic DNA for sequencing.  <\/div><\/div>"}},{"id":1054725,"guid":"5199967E4106499EB4E2D33D5D66D266","order_id":2,"type_id":26,"title":"notes","source":{"id":0,"parent_id":0,"uri":"","title":"","body":"<div class = \"text-blocks\"><div class = \"text-block\"><span>The extraction of genomic DNA of suitable quality and quantity is essential for a successful experiment. We have prepared a detailed protocol for low-cost tissue collection, desiccation, genomic DNA extraction, and concentration that provides DNA suitable for next generation sequencing (<\/span><a href=\"https:\/\/dx.doi.org\/10.17504\/protocols.io.bdg9i3z6\" style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">https:\/\/dx.doi.org\/10.17504\/protocols.io.bdg9i3z6<\/span><\/a><span>).   <\/span><\/div><\/div>","created_on":0,"changed_on":0,"creator":{"name":" ","affiliation":null,"affiliations":[],"username":"","link":null,"image":{"source":"","placeholder":""},"badges":[],"verified":0,"is_verified_user":false,"research_interests":null,"blocked_by_you":false,"blocked_you":false,"hide_following":false},"comments":[]}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"","section_duration":0,"critical":[],"critical_id":null,"duration":0},{"id":898102,"guid":"3023D8F0686611EAAD78C19B3B28CFC1","previous_id":898029,"previous_guid":"2CE51AF0686111EAAD78C19B3B28CFC1","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"1B51382EA7CB4E3DA0A0963B398A56B6","order_id":1,"type_id":6,"title":"Section","source":{"title":""}},{"id":1054724,"guid":"2AC51DC0E29D409695FCE8C842CC6FD1","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Choose experimental parameters for the single sample pilot experiment part 1: Select size ranges and the amount of input genomic DNA needed for NGS library preparation. <\/div><div class = \"text-block\">A. Download and install RestrictionDigest software following the instructions in the readme file.<\/div><div class = \"text-block\">B. Download the reference genome assembly of a closely related species (genomic fasta as .fa or .fna).<\/div><div class = \"text-block\">C. Place the genomic fasta file in the RestrictionDigest directory.<\/div><div class = \"text-block\">D. Edit the Perl script file to select your enzyme(s), genome and output directory. (see note below).  <\/div><div class = \"text-block\">E. Execute the Perl script by opening a terminal window and changing the directory (cd) so that you are within the RestrictionDigest directory, and typing \"perl bthunbergii_haeIII.pl\" without the quotation marks and changing the name of the .pl file accordingly (in the command below the file is called yourperlscript.pl). <\/div><div class = \"text-block\">F. Multiple files will be produced.  Open the file starting with \"digestion_summary...\"<\/div><div class = \"text-block\">G. Review the length ranges and fragment ranges, and choose a suitable range and starting DNA concentration for the experiment.  For example, when digested with HaeIII, it is expected that a 350 to 700 bp range would represent 0.179 of the B. thunbergii genome.  The assumption is made that the GC content between B. thunbergii and B. darwinii are similar, and that 350 to 700 bp fragments of the B. darwinii genome digested with Hae III will represent a genome fraction similar to 0.179. This fraction is used to determine the starting amount of genomic DNA for the restriction digestion.  For example, if 200 nanograms of starting material is required for library preparation, a minimum of 200 ng \/0.179 = 1.1 micrograms of starting genomic DNA is required.  A larger starting amount is advised as genome fraction estimations may vary from the true fraction, and the recovery of the selected DNA molecular weight range from an agarose gel will be less than 100%.<\/div><\/div>"}},{"id":1054725,"guid":"00DF257FB0B543F59086ECB8DF438414","order_id":2,"type_id":26,"title":"notes","source":{"id":0,"parent_id":0,"uri":"","title":"","body":"<div class = \"text-blocks\"><div class = \"text-block\"><span>For reduced-representation genome sequencing, an experimental design is developed using available genome size and sequence data, and the desired sequencing chemistry and read-length, in order to choose restriction enzyme(s) and molecular weight range of DNA fragments to produce the  desired number of unique base pairs. For example, there is no reference genome available for Berberis darwinii, but scaffold sequences are available for the closely related Berberis thunbergii (<\/span><a href=\"https:\/\/www.ncbi.nlm.nih.gov\/assembly\/GCA_003290165.1\" style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">https:\/\/www.ncbi.nlm.nih.gov\/assembly\/GCA_003290165.1\/<\/span><\/a><span>). The Perl module RestrictionDigest (<\/span><a href=\"https:\/\/github.com\/JINPENG-WANG\/RestrictionDigest\" style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">https:\/\/github.com\/JINPENG-WANG\/RestrictionDigest<\/span><\/a><span>) can be used to model the percentage of the genome represented in a specific molecular weight range when digested with a particular restriction endonuclease. The assumption with this approach is that the two genomes have a similar GC content and produce a similar genomic fraction under the same digestion and size selection parameters.  <\/span><\/div><\/div>","created_on":0,"changed_on":0,"creator":{"name":" ","affiliation":null,"affiliations":[],"username":"","link":null,"image":{"source":"","placeholder":""},"badges":[],"verified":0,"is_verified_user":false,"research_interests":null,"blocked_by_you":false,"blocked_you":false,"hide_following":false},"comments":[]}},{"id":1054726,"guid":"25C4A530687811EAAD78C19B3B28CFC1","order_id":3,"type_id":8,"title":"software","source":{"name":"RestrictionDigest","developer":"Jinpeng Wang","repository":"GitHub","link":"https:\/\/github.com\/JINPENG-WANG\/RestrictionDigest","os_name":null,"os_version":null}},{"id":1054727,"guid":"823D567254C14E54859514E7DBF811AC","order_id":4,"type_id":26,"title":"notes","source":{"id":0,"parent_id":0,"uri":"","title":"","body":"<div class = \"text-blocks\"><div class = \"text-block\">Edit the below text using Ubuntu Text Editor.  Save the file with a unique name (in this example, bthunbergii_haeIII.pl) and place this file into the RestrictionDigest directory.  Edit the third line for the path and the name of your genome fasta file (the example is a fasta file titled thunbergii.fna that is in the folder titled RestrictionDigest located in the home directory).  Edit line 9 for your restriction nucleases used (this example uses HaeIII).  Edit line 10 for the size range.  Edit line 12 with the output directory (in this example the directory is titled HaeIII_thunbergii and is located in the RestrictionDigest folder).  Copy all text below.  Line 1 should contain text \"use RestrictionDigest\".<\/div><div class = \"text-block\">-------------<\/div><div class = \"text-block\">use RestrictionDigest;<\/div><div class = \"text-block\">my $single_digest=RestrictionDigest::SingleItem::Single->new();<\/div><div class = \"text-block\">$single_digest->add_ref(-reference=>\"\/home\/bradleytill\/RestrictionDigest\/thunbergii.fna\");<\/div><div class = \"text-block\">$single_digest->new_enzyme(-enzyme_name=>\"EcoRI\", -recognition_site =>\"G|AATTC\");<\/div><div class = \"text-block\">$single_digest->new_enzyme(-enzyme_name=>\"AluI\", -recognition_site =>\"AG|CT\");<\/div><div class = \"text-block\">$single_digest->new_enzyme(-enzyme_name=>\"HaeIII\", -recognition_site =>\"GG|CC\");<\/div><div class = \"text-block\">$single_digest->new_enzyme(-enzyme_name=>\"NlaIII\", -recognition_site =>\"CAGT|\");<\/div><div class = \"text-block\">$single_digest->new_enzyme(-enzyme_name=>\"FatI\", -recognition_site =>\"|CATG\");<\/div><div class = \"text-block\">$single_digest->add_single_enzyme(-enzyme =>\"HaeIII\");<\/div><div class = \"text-block\">$single_digest->change_range(-start =>350,-end =>700);<\/div><div class = \"text-block\">$single_digest->change_lengths_distribution_parameters(-front =>100,-behind =>1200,-step =>50);<\/div><div class = \"text-block\">$single_digest->add_output_dir(-output_dir=>\"\/home\/bradleytill\/RestrictionDigest\/HaeIII_thunbergii\");<\/div><div class = \"text-block\">$single_digest->single_digest();<\/div><div class = \"text-block\">$single_digest->frags_in_range_coverage_ratio();<\/div><div class = \"text-block\">$single_digest->all_frags_coverage_ratio();<\/div><\/div>","created_on":0,"changed_on":0,"creator":{"name":" ","affiliation":null,"affiliations":[],"username":"","link":null,"image":{"source":"","placeholder":""},"badges":[],"verified":0,"is_verified_user":false,"research_interests":null,"blocked_by_you":false,"blocked_you":false,"hide_following":false},"comments":[]}},{"id":1054728,"guid":"E3506C70688111EAAD78C19B3B28CFC1","order_id":5,"type_id":15,"title":"command","source":{"id":7199,"name":"perl yourperlscript.pl","command_name":"RestrictionDigest","command":"Perl script for in silico evaluation of length ranges and genome fractions of DNA digested with one or two defined restriction endonucleases.","os_name":null,"os_version":null}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"","section_duration":0,"critical":[],"critical_id":null,"duration":0},{"id":898174,"guid":"5ACBC790687811EAAD78C19B3B28CFC1","previous_id":898102,"previous_guid":"3023D8F0686611EAAD78C19B3B28CFC1","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"293B5050E68547258F3079C4E4C982BC","order_id":1,"type_id":6,"title":"Section","source":{"title":""}},{"id":1054724,"guid":"05C7C2885A05424EAD30701D84F3395F","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Choose experimental parameters for the single sample pilot experiment part 2: Estimate the number of unique base pairs that will be sequenced based on the range of fragments selected, the library preparation method and the sequencing method, and determine required sequencing throughput.  <\/div><\/div>"}},{"id":1054725,"guid":"87C690F2111B4CF98BAE91FA427A20DE","order_id":2,"type_id":26,"title":"notes","source":{"id":0,"parent_id":0,"uri":"","title":"","body":"<div class = \"text-blocks\"><div class = \"text-block\">For example, literature searches suggest Berberis darwinii has an expected genome size of approximately 1.5 Gb.  Therefore, sequencing of the entire isolated molecular weight range of 350-700 bps would produce about (1.5 x 0.179) x 268 Mbps of unique sequence.  For the pilot experiment a 2x150PE sequencing approach was chosen with a library preparation utilizing 200 ng of starting material that included a  size enrichment for fragments of 350 bps.  Library preparation was outsourced to a sequencing provider and resulted in 75% of DNA fragments having a 395 bp or lower insert size.  This was used to adjust the rough estimation of the number of unique base pairs  to decide the minimal sequencing throughput to purchase for a successful experiment.  For example, in our experiment, the fraction of the genome from 350 - 400 bp, plus an additional 25% to compensate for the fragments falling outside of this range, is calculated at 83.75 Mbs. Using this estimation, 1 Gb of raw sequencing data was purchased as it should provide a maximum of 11.9x  coverage for a single sample. For comparison, if all 268 Mbps were sequenced, 1Gb of sequencing data  would produce an average coverage of 3.73x. Actual coverage was expected to fall within the range of 11.9 and 3.73x,  and therefore 1 Gb was considered suitable to evaluate SNP discovery. <\/div><\/div>","created_on":0,"changed_on":0,"creator":{"name":" ","affiliation":null,"affiliations":[],"username":"","link":null,"image":{"source":"","placeholder":""},"badges":[],"verified":0,"is_verified_user":false,"research_interests":null,"blocked_by_you":false,"blocked_you":false,"hide_following":false},"comments":[]}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"","section_duration":0,"critical":[],"critical_id":null,"duration":0},{"id":898194,"guid":"1B827380688311EAAD78C19B3B28CFC1","previous_id":898174,"previous_guid":"5ACBC790687811EAAD78C19B3B28CFC1","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"69C64C25599944B9B1F694975B182FDE","order_id":1,"type_id":6,"title":"Section","source":{"title":""}},{"id":1054724,"guid":"943A1FE7F78748C7A8A81FA17C005963","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Isolate selected size ranges of genomic DNA and sequence. <\/div><\/div>"}},{"id":1054725,"guid":"AA33E24FB0E64E12A7813B2B7DA835E5","order_id":2,"type_id":26,"title":"notes","source":{"id":0,"parent_id":0,"uri":"","title":"","body":"<div class = \"text-blocks\"><div class = \"text-block\"><span>The wet bench methods for genomic DNA isolation and concentration suitable for restriction digestion can be found here: <\/span><a href=\"https:\/\/dx.doi.org\/10.17504\/protocols.io.bdg9i3z6\" style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">https:\/\/dx.doi.org\/10.17504\/protocols.io.bdg9i3z6<\/span><\/a><span>. DNA was isolated from an agarose gel to produce the data described in this protocol.  Library preparation, DNA sequencing, de-multiplexing (if required) and trimming is carried out by the DNA sequencing service provider. <\/span><\/div><\/div>","created_on":0,"changed_on":0,"creator":{"name":" ","affiliation":null,"affiliations":[],"username":"","link":null,"image":{"source":"","placeholder":""},"badges":[],"verified":0,"is_verified_user":false,"research_interests":null,"blocked_by_you":false,"blocked_you":false,"hide_following":false},"comments":[]}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"","section_duration":0,"critical":[],"critical_id":null,"duration":0},{"id":898486,"guid":"AFFA11A0692111EA9D8675F7423F1BFD","previous_id":898194,"previous_guid":"1B827380688311EAAD78C19B3B28CFC1","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"52C72703F8A74180A42063DA27F7F516","order_id":1,"type_id":6,"title":"Section","source":{"title":""}},{"id":1054724,"guid":"4C2997C8C1A14A04A183689E5967996E","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Evaluate fastq data.  <\/div><\/div>"}},{"id":1054725,"guid":"6317C9E4B6284312BD2E4B3DB8F3154C","order_id":2,"type_id":26,"title":"notes","source":{"id":0,"parent_id":0,"uri":"","title":"","body":"<div class = \"text-blocks\"><div class = \"text-block\">Most sequencing service providers will deliver raw sequencing data in a compressed fastq format (fastq.gz or fq.gz). If you have performed a paired-end sequencing, you will get two files, one for each read.  It is useful to evaluate the quality if this data prior to proceeding further. The pipeline used in this protocol is also simplified if each read file from a single sample is combined (interleaved) after pre-processing of the data.  <\/div><\/div>","created_on":0,"changed_on":0,"creator":{"name":" ","affiliation":null,"affiliations":[],"username":"","link":null,"image":{"source":"","placeholder":""},"badges":[],"verified":0,"is_verified_user":false,"research_interests":null,"blocked_by_you":false,"blocked_you":false,"hide_following":false},"comments":[]}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"","section_duration":0,"critical":[],"critical_id":null,"duration":0},{"id":898487,"guid":"4DE8AC00692211EA9D8675F7423F1BFD","previous_id":898486,"previous_guid":"AFFA11A0692111EA9D8675F7423F1BFD","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"E3094DC9F28E4AE291D46378945FC3A5","order_id":1,"type_id":6,"title":"Section","source":{"title":""}},{"id":1054724,"guid":"E94A7EAD56DE44D1930B375DAC211D74","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Evaluate fastq data with FastQC.<\/div><div class = \"text-block\">Follow instructions for installing and using the graphical user interface (GUI) software.  Sequence quality scores should match expectations for the sequencing chemistry and read length used.  Note that some metrics will produce warnings when evaluating RADseq type data (e.g. over-represented sequences).  <\/div><\/div>"}},{"id":1054725,"guid":"E3DDF440692211EA9D8675F7423F1BFD","order_id":2,"type_id":8,"title":"software","source":{"name":"FastQC","developer":"Simon Andrews","repository":null,"link":"http:\/\/www.bioinformatics.babraham.ac.uk\/projects\/fastqc\/","os_name":null,"os_version":null}},{"id":1054726,"guid":"29DF8CB06EAF11EA8F7947C31C0DED52","order_id":3,"type_id":4,"title":"duration","source":{"duration":300,"title":"8 Gb RAM, quad-core processor"}},{"id":1054727,"guid":"047775C5DDBE45B0BE2856F538BA89BA","order_id":4,"type_id":17,"title":"result","source":{"body":"<div class = \"text-blocks\"><div class = \"text-block\">Figure shows FastQC data for quality scores across all bases for read 1(left) and read 2 (right) of the 2x150PE run.  <\/div><div style = \"text-align :; float : ;\"><img style = \"\" src = \"https:\/\/s3.amazonaws.com\/protocols-files\/public\/cdfc1ba030324f7d9fb17b938d15ff8b6941b5392a3160d05817f652c8040640\/b3mfbb2s7.png\" \/><\/div><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"","section_duration":0,"critical":[],"critical_id":null,"duration":0},{"id":898490,"guid":"8BA42BC0692511EA9D8675F7423F1BFD","previous_id":898487,"previous_guid":"4DE8AC00692211EA9D8675F7423F1BFD","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"6972F4B2B9EC4B79A9C13492F930B5E1","order_id":1,"type_id":6,"title":"Section","source":{"title":""}},{"id":1054724,"guid":"F09DEDFBC00F45BD861810077CE0C907","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Perform the reference-independent Stacks pipeline on a single sample.  <\/div><div class = \"text-block\">Download and install Stacks following the instructions (<\/div><div class = \"text-block\"><a href=\"http:\/\/catchenlab.life.illinois.edu\/stacks\/manual\" style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">http:\/\/catchenlab.life.illinois.edu\/stacks\/manual\/<\/span><\/a><\/div><div class = \"text-block\">).  <\/div><div class = \"text-block\">If running Ubuntu, you may need to install a C++ compiler and zlib before it is possible to install Stacks.  <\/div><\/div>"}},{"id":1054725,"guid":"E527FE87F77A42A9A526E38C384155FE","order_id":2,"type_id":26,"title":"notes","source":{"id":0,"parent_id":0,"uri":"","title":"","body":"<div class = \"text-blocks\"><div class = \"text-block\"><span>For the single Berberis sample example described in this protocol, the Stacks pipeline was chosen.  Stacks was specifically developed to work with sequence data from restriction enzyme digested DNA to build genetic maps and perform population genomic analysis (see <\/span><a href=\"http:\/\/catchenlab.life.illinois.edu\/stacks\" style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">http:\/\/catchenlab.life.illinois.edu\/stacks\/<\/span><\/a><span>).  For the single Berberis sample, each step in the pipeline was executed independently. <\/span><\/div><\/div>","created_on":0,"changed_on":0,"creator":{"name":" ","affiliation":null,"affiliations":[],"username":"","link":null,"image":{"source":"","placeholder":""},"badges":[],"verified":0,"is_verified_user":false,"research_interests":null,"blocked_by_you":false,"blocked_you":false,"hide_following":false},"comments":[]}},{"id":1054726,"guid":"8C470600692611EA9D8675F7423F1BFD","order_id":3,"type_id":8,"title":"software","source":{"name":"Stacks","developer":"Julian Catchen, Nicolas Rochette, Angel Amores, Paul Hohenlohe, Bill Cresko","repository":null,"link":"http:\/\/catchenlab.life.illinois.edu\/stacks\/","os_name":null,"os_version":null}},{"id":1054727,"guid":"39449400692A11EA9D8675F7423F1BFD","order_id":4,"type_id":15,"title":"command","source":{"id":7201,"name":"sudo apt install gobjc++","command_name":"Installing C++ compiler on Ubuntu.","command":null,"os_name":"Ubuntu","os_version":"18.04"}},{"id":1054728,"guid":"6A54B2A0692A11EA9D8675F7423F1BFD","order_id":5,"type_id":15,"title":"command","source":{"id":7202,"name":"sudo apt-get install zlib1g-dev","command_name":"Install zlib on Ubuntu.","command":null,"os_name":"Ubuntu","os_version":"18.04"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"","section_duration":0,"critical":[],"critical_id":null,"duration":0},{"id":898492,"guid":"B14AE250692611EA9D8675F7423F1BFD","previous_id":898490,"previous_guid":"8BA42BC0692511EA9D8675F7423F1BFD","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"D19936EE8ADF4527A13E108E9A1CED3C","order_id":1,"type_id":6,"title":"Section","source":{"title":""}},{"id":1054724,"guid":"41D260EFCCCE4E3B8FFDE7C3B5ECC975","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Process the fastq files for Stacks.  <\/div><div class = \"text-block\">Move the fq.gz files into the Stacks directory.  Create an output directory within the Stacks directory (here called radtagsoutputdirectory).  Open a terminal window and enter (cd) into the Stacks directory. Make sure to define the restriction enzyme used (in the protocol example it is haeIII). This program includes a check for the presence of the enzyme cut site and provides a filtration based on quality. If you are using the test data, replace read1.fq.gz and read2.fq.gz with W2_L1_1.fq.gz and W2_L1_2.fq.gz, respectively.  <\/div><\/div>"}},{"id":1054725,"guid":"09365830692E11EA9D8675F7423F1BFD","order_id":2,"type_id":15,"title":"command","source":{"id":7203,"name":"process_radtags -1  read1.fq.gz -2 read2.fq.gz  -o .\/radtagsoutputdirectory -c -q -r -e haeIII","command_name":"Process radtags for Stacks.","command":null,"os_name":null,"os_version":null}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"","section_duration":0,"critical":[],"critical_id":null,"duration":0},{"id":898570,"guid":"66783EF0692E11EA9D8675F7423F1BFD","previous_id":898492,"previous_guid":"B14AE250692611EA9D8675F7423F1BFD","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"A5D99A90E17142409E187A298636F1A0","order_id":1,"type_id":6,"title":"Section","source":{"title":""}},{"id":1054724,"guid":"11DC6127B7194B75A1B906C632DEF893","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Interleave the two fastq files from a paired end read of a single sample.<\/div><div class = \"text-block\">Follow the installation guide at <\/div><div class = \"text-block\"><a href=\"https:\/\/jgi.doe.gov\/data-and-tools\/bbtools\/bb-tools-user-guide\/installation-guide\" style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">https:\/\/jgi.doe.gov\/data-and-tools\/bbtools\/bb-tools-user-guide\/installation-guide\/<\/span><\/a><\/div><div class = \"text-block\">. Place the processed fastq.gz files from step 3.1 into the bbmap directory (do not take the files with \"rem\" in the title; you should move only two files for a single sample paired end read).  Enter (cd) the bbmap directory and then execute the reformat software.  (note if you are using the example data, read1.fastq.gz is W2_L1_1.1.fa.gz and read2.fastq.gz is W2_L1_L2.2.fq.gz). <\/div><div class = \"text-block\">It is useful to choose a short and descriptive name for your output file.  For the Berberis example described in this protocol, we chose W2pi.fq.gz.  W2 for the unique plant and sample name, pi for processed radtags & interleaved. <\/div><\/div>"}},{"id":1054725,"guid":"74A5DAA0692E11EA9D8675F7423F1BFD","order_id":2,"type_id":8,"title":"software","source":{"name":"BBmap","developer":"Brian Bushnell at the Joint Genome Institute","repository":"sourceforge","link":"https:\/\/sourceforge.net\/projects\/bbmap\/files\/","os_name":null,"os_version":null}},{"id":1054726,"guid":"2B8D4A706EB411EA8F7947C31C0DED52","order_id":3,"type_id":4,"title":"duration","source":{"duration":300,"title":"Performed on 8 Gb RAM quad-core desktop"}},{"id":1054727,"guid":"9DCAD7F0692E11EA9D8675F7423F1BFD","order_id":4,"type_id":15,"title":"command","source":{"id":7200,"name":".\/reformat.sh in1=read1.fastq.gz in2=read2.fastq.gz out=interleaved.fq.gz","command_name":"Interleave fastq files.","command":null,"os_name":null,"os_version":null}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"","section_duration":0,"critical":[],"critical_id":null,"duration":0},{"id":898571,"guid":"540CB600692F11EA9D8675F7423F1BFD","previous_id":898570,"previous_guid":"66783EF0692E11EA9D8675F7423F1BFD","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"120EC84E51114BECA6DC481B99BA8F57","order_id":1,"type_id":6,"title":"Section","source":{"title":""}},{"id":1054724,"guid":"E3BC6C2E974F4620974526C68708A0D4","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Create loci with ustacks. <\/div><div class = \"text-block\">Move the interleaved.fq.gz file (titled W2pi.fq.gz in the example) to the Stacks directory.  Create an output directory within the Stacks directory titled stacksout. Open a terminal window and move (cd) to the Stacks directory. Then execute ustacks.  <\/div><div class = \"text-block\">Note that -p defines the number of threads.  Check the number of processors on your computer and adjust accordingly.  <\/div><\/div>"}},{"id":1054725,"guid":"D9D425C0692F11EA9D8675F7423F1BFD","order_id":2,"type_id":15,"title":"command","source":{"id":7204,"name":"ustacks -f  W2pi.fq.gz -o .\/stacksout -i 1 -p 64","command_name":"ustacks","command":null,"os_name":null,"os_version":null}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"","section_duration":0,"critical":[],"critical_id":null,"duration":0},{"id":898572,"guid":"0971EFB0693011EA9D8675F7423F1BFD","previous_id":898571,"previous_guid":"540CB600692F11EA9D8675F7423F1BFD","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"04CA4BF081364CB2B4E1E26E362E6FB6","order_id":1,"type_id":6,"title":"Section","source":{"title":""}},{"id":1054724,"guid":"16F5627678B343CA8C5DA45EE659B50B","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Create a popmap file and run cstacks to create a catalog of loci.  <\/div><div class = \"text-block\">For cstacks to run, a population map file must be prepared.  This is a plain text file.  For the single Berberis sample, this was a single row, two column tab delimited text file in the following format:<\/div><div class = \"text-block\">W2pi\t\t1<\/div><div class = \"text-block\">This can be created using Text Edit in Ubuntu.  It needs to be a plain text tab delimited file and may not work properly if it contains special characters that are inserted by some word processing programs.  <\/div><div class = \"text-block\">This file is saved with the title popmap and placed in the Stacks directory.  This is followed by running cstacks from the command line while in the Stacks directory.  <\/div><\/div>"}},{"id":1054725,"guid":"9C7E96F0693011EA9D8675F7423F1BFD","order_id":2,"type_id":15,"title":"command","source":{"id":7205,"name":"cstacks -P .\/stacksout -M .\/popmap -n 4 -p 64","command_name":"cstacks","command":null,"os_name":null,"os_version":null}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"","section_duration":0,"critical":[],"critical_id":null,"duration":0},{"id":898574,"guid":"A412BEA0693011EA9D8675F7423F1BFD","previous_id":898572,"previous_guid":"0971EFB0693011EA9D8675F7423F1BFD","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"FFD2FEBA78254426A4A3C571BCE12300","order_id":1,"type_id":6,"title":"Section","source":{"title":""}},{"id":1054724,"guid":"20724618F56C4BEDBA200FF8B6538B99","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Search the consensus loci created with ustacks against the catalog from cstaks using sstacks. The following command is executed in the terminal window while in the Stacks directory.  <\/div><\/div>"}},{"id":1054725,"guid":"ECC2D680693011EA9D8675F7423F1BFD","order_id":2,"type_id":15,"title":"command","source":{"id":7206,"name":"sstacks -P .\/stacksout -M .\/popmap -p 64","command_name":"sstacks","command":null,"os_name":null,"os_version":null}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"","section_duration":0,"critical":[],"critical_id":null,"duration":0},{"id":898575,"guid":"FA79BB90693011EA9D8675F7423F1BFD","previous_id":898574,"previous_guid":"A412BEA0693011EA9D8675F7423F1BFD","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"E175E63204CB49818CFD4C1FF8EE0BED","order_id":1,"type_id":6,"title":"Section","source":{"title":""}},{"id":1054724,"guid":"518F4E89F147467EA74A7FD0502BF313","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Create a BAM formatted alignment file using tsv2bam. <\/div><div class = \"text-block\">Note that the thread option changes from -p to -t in this command.  <\/div><\/div>"}},{"id":1054725,"guid":"271DA670693111EA9D8675F7423F1BFD","order_id":2,"type_id":15,"title":"command","source":{"id":7207,"name":"tsv2bam -P .\/ustacksout -M .\/popmap\/popmap -t 64","command_name":"tsv2bam","command":null,"os_name":null,"os_version":null}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"","section_duration":0,"critical":[],"critical_id":null,"duration":0},{"id":898576,"guid":"3A4EACD0693111EA9D8675F7423F1BFD","previous_id":898575,"previous_guid":"FA79BB90693011EA9D8675F7423F1BFD","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"CD90AB56033045A595086B8B98CCCE86","order_id":1,"type_id":6,"title":"Section","source":{"title":""}},{"id":1054724,"guid":"D7A4BFA0F32F48DFBCC13A655B246183","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Identify SNPs with gstacks.<\/div><\/div>"}},{"id":1054725,"guid":"72D2E800693111EA9D8675F7423F1BFD","order_id":2,"type_id":15,"title":"command","source":{"id":7208,"name":"gstacks -P .\/ustacksout -M .\/popmap\/popmap -t 64","command_name":"gstacks","command":null,"os_name":null,"os_version":null}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"","section_duration":0,"critical":[],"critical_id":null,"duration":0},{"id":898577,"guid":"970AE8D0693111EA9D8675F7423F1BFD","previous_id":898576,"previous_guid":"3A4EACD0693111EA9D8675F7423F1BFD","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"00E23FA2A39A4A4483911A1C71D852E4","order_id":1,"type_id":6,"title":"Section","source":{"title":""}},{"id":1054724,"guid":"AC5A4DDD1B12489DAA6182DBA8A58A8A","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Create a standard Variant Call Format (VCF) file with the populations tool. <\/div><div class = \"text-block\">VCF files are compatible with many tools for the analysis of nucleotide variants from sequencing data.  <\/div><\/div>"}},{"id":1054725,"guid":"BFFE27C0693111EA9D8675F7423F1BFD","order_id":2,"type_id":15,"title":"command","source":{"id":7209,"name":"populations -P .\/ustacksout --vcf -t 64","command_name":"Create a VCF file using populations.","command":null,"os_name":null,"os_version":null}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"","section_duration":0,"critical":[],"critical_id":null,"duration":0},{"id":898578,"guid":"C2C7A800693111EA9D8675F7423F1BFD","previous_id":898577,"previous_guid":"970AE8D0693111EA9D8675F7423F1BFD","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"37FBB81720794AC2AA5F69574C3A220B","order_id":1,"type_id":6,"title":"Section","source":{"title":""}},{"id":1054724,"guid":"5C0282D38D0E428FB9939B6FC4C8444C","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Create a reference sequence in fasta format using the populations tool.  <\/div><div class = \"text-block\">The fasta file contains the genomic sequence from the experiment in a format compatible with many bioinformatics tools.  This file can be used with the fastq data to perform additional analyses.  <\/div><\/div>"}},{"id":1054725,"guid":"16A736C0693211EA9D8675F7423F1BFD","order_id":2,"type_id":15,"title":"command","source":{"id":7210,"name":"populations -P .\/ustacksout --fasta-loci t 64","command_name":"Create a fasta file using populations.","command":null,"os_name":null,"os_version":null}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"","section_duration":0,"critical":[],"critical_id":null,"duration":0},{"id":898579,"guid":"916AD380693211EA9D8675F7423F1BFD","previous_id":898578,"previous_guid":"C2C7A800693111EA9D8675F7423F1BFD","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"09AB7AFDE2704F59B5D3A3E4A337ADDB","order_id":1,"type_id":6,"title":"Section","source":{"title":""}},{"id":1054724,"guid":"534547E5F7D44D119BC1B775CA3CC0A2","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Preliminary analysis of data.  <\/div><div class = \"text-block\">Results can be found in log files produced by the various Stacks commands. The gstacks.log file provides the number of loci and mean loci size that can be used to calculate the number of base pairs in the experiment. The file also provides mean coverage for the experiment.  The populations.log file reports unique base pairs (this should be similar to that calculated from gstacks.log) and also heterozygous variation (all variants reported in the Berberis darwinii example are heterozygous because a single diploid sample was evaluated).  This experiment produced 84 Mbps of unique sequence with a mean coverage post-filtering of 8.7x.  More than 25,000 candidate SNP variants were also discovered.  <\/div><\/div>"}},{"id":1054725,"guid":"3BE500773FA74214A4F2AF04B18695D7","order_id":2,"type_id":26,"title":"notes","source":{"id":0,"parent_id":0,"uri":"","title":"","body":"<div class = \"text-blocks\"><div class = \"text-block\">The goal of evaluating a single sample is to calculate the number of unique base pairs produced from the chosen experimental design (restriction enzyme, size range, sequencing chemistry, and read length), determine read coverage, and to obtain an initial estimation of heterozygous nucleotide variation. <\/div><\/div>","created_on":0,"changed_on":0,"creator":{"name":" ","affiliation":null,"affiliations":[],"username":"","link":null,"image":{"source":"","placeholder":""},"badges":[],"verified":0,"is_verified_user":false,"research_interests":null,"blocked_by_you":false,"blocked_you":false,"hide_following":false},"comments":[]}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"","section_duration":0,"critical":[],"critical_id":null,"duration":0}],"document":null,"materials":[],"description":"<div class = \"text-blocks\"><div class = \"text-block\"><span>This protocol describes the use of freely available software for the reference-independent analysis of RADseq data produced from a single sample.  It is useful to perform a pilot experiment on a single sample for species lacking a reference genome sequence in order to facilitate proper experimental design for a larger-scale experiment.  The example data used in this protocol is from a wild Berberis darwinii plant growing in Chile. The protocol produces data that provides an estimation of the number of unique base pairs recovered from a size selection of restriction endonuclease digested genomic DNA, and also an estimation of the frequency of heterozygous polymorphisms in the plant.  Evaluation of sequence quality also provides a validation of the methodologies used for tissue collection, DNA extraction, restriction digestion, and size selection (see <\/span><a href=\"https:\/\/dx.doi.org\/10.17504\/protocols.io.bdg9i3z6\" style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">https:\/\/dx.doi.org\/10.17504\/protocols.io.bdg9i3z6<\/span><\/a><span>).  In addition, the discovered heterozyygous polymorphisms serve as markers to evaluate natural propagation (e.g. self-fertilization versus outcrossing versus clonal propagation) and also for use in tracking the success of human-directed crosses for breeding.    <\/span><\/div><\/div>","changed_on":1592921677}