{"id":29591,"title":"construct a taro linkage map using onemap","title_html":"<p>construct a taro linkage map using onemap<\/p>","image":{"source":"https:\/\/www.protocols.io\/img\/default_protocol.png","placeholder":"https:\/\/www.protocols.io\/img\/default_protocol.png"},"doi":"dx.doi.org\/10.17504\/protocols.io.85xhy7n","doi_status":2,"uri":"construct-a-taro-linkage-map-using-onemap-85xhy7n","type_id":1,"template_id":1,"published_on":1596127848,"parent_protocols":[],"parent_collections":[],"cited_protocols":[],"version_id":0,"created_on":1573173125,"categories":null,"creator":{"name":"M Renee Bellinger","affiliation":"University of Hawaii at Hilo","affiliations":[{"affiliation":"University of Hawaii at Hilo","url":"","is_default":1}],"username":"m-renee-bellinger","link":null,"image":{"source":"\/img\/avatars\/015.png","placeholder":"\/img\/avatars\/015.png"},"badges":[{"id":2,"image":{"source":"\/img\/badges\/bronze.svg","placeholder":"\/img\/badges\/bronze.svg"},"name":"Author"}],"verified":0,"is_verified_user":false,"research_interests":null,"blocked_by_you":false,"blocked_you":false,"hide_following":false},"journal":null,"journal_name":null,"journal_link":null,"article_citation":null,"public":1,"has_versions":0,"link":null,"total_collections":0,"number_of_steps":1,"authors":[{"name":" Michael Kantar","affiliation":"University of Hawaii at Manoa","affiliations":[],"username":"w2y24403r213","link":null,"image":{"source":"\/img\/avatars\/004.png","placeholder":"\/img\/avatars\/004.png"},"badges":[],"verified":0,"is_verified_user":false,"research_interests":null,"blocked_by_you":false,"blocked_you":false,"hide_following":false},{"name":"M Renee Bellinger","affiliation":"University of Hawaii at Hilo","affiliations":[],"username":"m-renee-bellinger","link":null,"image":{"source":"\/img\/avatars\/015.png","placeholder":"\/img\/avatars\/015.png"},"badges":[],"verified":1,"is_verified_user":true,"research_interests":null,"blocked_by_you":false,"blocked_you":false,"hide_following":false},{"name":"Roshan Paudel","affiliation":"University of Hawaii at Manoa","affiliations":[],"username":null,"link":null,"image":{"source":null,"placeholder":null},"badges":[],"verified":0,"is_verified_user":false,"research_interests":null,"blocked_by_you":false,"blocked_you":false,"hide_following":false}],"versions":[],"groups":[],"is_owner":1,"has_subprotocols":0,"is_subprotocol":0,"is_bookmarked":0,"can_claim_authorship":0,"can_accept_authorship":0,"can_be_copied":1,"can_remove_fork":1,"fork_id":null,"url":"https:\/\/www.protocols.io\/view\/construct-a-taro-linkage-map-using-onemap-85xhy7n","forks_count":{"private":0,"public":0},"access":{"can_view":1,"can_remove":0,"can_add":0,"can_edit":0,"can_publish":0,"can_get_doi":0,"can_share":1,"can_move":1,"can_move_outside":1,"can_transfer":1,"can_download":1,"is_locked":0},"guid":"D1FFE48001B811EAAFBE73094787E5AB","state_version_id":311,"steps":[{"id":844060,"guid":"A3D6DC1001BF11EAAFBE73094787E5AB","previous_id":null,"previous_guid":null,"modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"4A7A102446AD476DAD766588D6207741","order_id":1,"type_id":6,"title":"Section","source":{"title":"Set up your R working environment"}},{"id":1054724,"guid":"582CEBEAF750487EA8F223EB1EB4DD65","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">### There are two ways to install onemap<\/div><div class = \"text-block\">###-------------------###<\/div><div class = \"text-block\">### Option 1. <\/div><div class = \"text-block\">####Download and install Rtools in your computer before running this script<\/div><div class = \"text-block\">###<\/div><div class = \"text-block\"><a href=\"https:\/\/cran.r-project.org\/bin\/windows\/Rtools\" style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">https:\/\/cran.r-project.org\/bin\/windows\/Rtools<\/span><\/a><\/div><div class = \"text-block\">find_rtools(debug = TRUE)<\/div><div class = \"text-block\">###Install required packages<\/div><div class = \"text-block\">install.packages(\"devtools\")<\/div><div class = \"text-block\">library(devtools)<\/div><div class = \"text-block\">### The above installation is supposed to run in R version to 3.5 but I had issue with getting it to install.<\/div><div class = \"text-block\">devtools::install_github(\"Cristianetaniguti\/onemap\")<\/div><div class = \"text-block\">library(\"onemap\")<\/div><div class = \"text-block\">###-------------------###<\/div><div class = \"text-block\">### Option 2. If using R 5.6 this package is compatible with the CRAN version<\/div><div class = \"text-block\">### <\/div><div class = \"text-block\">install.packages(onemap)<\/div><div class = \"text-block\">libarary(onemap)<\/div><div class = \"text-block\">install.packages(\"vcfR\")<\/div><div class = \"text-block\">library(\"vcfR\")<\/div><div class = \"text-block\">#######Set working directory<\/div><div class = \"text-block\">setwd(\"\/your\/working\/directory\/\")<\/div><div class = \"text-block\">#####Convert the vcf file into onemap format.<\/div><div class = \"text-block\">## BE SURE THE txt is removed from the end of the vcf file name<\/div><div class = \"text-block\">vcfR.object <- read.vcfR(\"imputed_loci_06052019.vcf\")<\/div><div class = \"text-block\">example_out <- onemap_read_vcfR(vcfR.object = vcfR.object,<\/div><div class = \"text-block\">                                    parent1 = \"P230.sam.mapped.bam\", <\/div><div class = \"text-block\">                                    parent2 = \"P255.sam.mapped.bam\", <\/div><div class = \"text-block\">                                    cross = \"outcross\")<\/div><div class = \"text-block\">####Get the information on marker genotypes.<\/div><div class = \"text-block\">plot(example_out)<\/div><div class = \"text-block\">###Number of markers by segregation type<\/div><div class = \"text-block\">plot_by_segreg_type(example_out)<\/div><div class = \"text-block\">###Find redundant markers<\/div><div class = \"text-block\">bins <- find_bins(example_out, exact = FALSE)<\/div><div class = \"text-block\">bins<\/div><div class = \"text-block\">###Create onemap file after removing redundant markers<\/div><div class = \"text-block\">bins_example <- create_data_bins(example_out, bins)<\/div><div class = \"text-block\">bins_example<\/div><div class = \"text-block\">###testing segregation pattern of the markers<\/div><div class = \"text-block\">segreg_test <- test_segregation(bins_example)<\/div><div class = \"text-block\">print(segreg_test)<\/div><div class = \"text-block\">#####to show the markers names with segregation distortion<\/div><div class = \"text-block\">select_segreg(segreg_test, distorted = TRUE)<\/div><div class = \"text-block\">###to show the markers numbers with segregation distortion<\/div><div class = \"text-block\">dist <- select_segreg(segreg_test, distorted = TRUE, numbers = TRUE)<\/div><div class = \"text-block\">#to show the markers numbers without segregation distortion<\/div><div class = \"text-block\">no_dist <- select_segreg(segreg_test, distorted = FALSE, numbers = TRUE) <\/div><div class = \"text-block\">no_dist<\/div><div class = \"text-block\">####See the segregation test graphically<\/div><div class = \"text-block\">plot(segreg_test)<\/div><div class = \"text-block\">##calculate a suggested LOD score<\/div><div class = \"text-block\">LOD_sug <- suggest_lod(bins_example)<\/div><div class = \"text-block\">LOD_sug<\/div><div class = \"text-block\">###Estimating two-point recombination fractions<\/div><div class = \"text-block\">twopts <- rf_2pts(bins_example, LOD = LOD_sug, max.rf = 0.3)<\/div><div class = \"text-block\">twopts<\/div><div class = \"text-block\">###Create the sequences of markers without segregation distortion<\/div><div class = \"text-block\">mark_no_dist <- make_seq(twopts, c(no_dist))<\/div><div class = \"text-block\">###Number of linkage groups<\/div><div class = \"text-block\">lg <- group(mark_no_dist, LOD=LOD_sug, max.rf = 0.3)<\/div><div class = \"text-block\">print(lg, detailed = FALSE)<\/div><div class = \"text-block\">###Estimate a genetic map<\/div><div class = \"text-block\">maps<-vector(\"list\", lg$n.groups)<\/div><div class = \"text-block\">for(i in 1:lg$n.groups)<\/div><div class = \"text-block\">  maps[[i]]<- make_seq(order_seq(input.seq= make_seq(lg,i),twopt.alg =<\/div><div class = \"text-block\">                                   \"rcd\"), \"force\")<\/div><div class = \"text-block\">##Draw the maps<\/div><div class = \"text-block\">##Draw the maps<\/div><div class = \"text-block\">draw_map(maps, names = FALSE, grid = TRUE, cex.mrk = 0.7)<\/div><div class = \"text-block\">draw_map2(maps,output=\"maps.png\")<\/div><div class = \"text-block\">####Name the map and extract it into external file<\/div><div class = \"text-block\">file.out<-\"map_LOD=5.97,max.rf=0.3.csv\"<\/div><div class = \"text-block\">write_map(map1, file.out)<\/div><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#A492FF","section_duration":0,"critical":[],"critical_id":null,"duration":0}],"document":null,"materials":[],"description":"<div class = \"text-blocks\"><div class = \"text-block\">R script for taro linkage mapping using program onemap. <\/div><div class = \"text-block\">This script was applied to create a linkage map for a taro mapping population resistant to taro leaf blight. <\/div><div class = \"text-block\">The genotype file was constructed by calling SNPs using genotyping by sequencing data set using a taro genome reference genome available from NCBI's genbank under Bioproject PRJNA567267.<\/div><\/div>","changed_on":1596127848}