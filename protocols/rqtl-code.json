{"id":42675,"title":"Rqtl_code","title_html":"<p>Rqtl_code<\/p>","image":{"source":"https:\/\/www.protocols.io\/img\/default_protocol.png","placeholder":"https:\/\/www.protocols.io\/img\/default_protocol.png"},"doi":"dx.doi.org\/10.17504\/protocols.io.bmwtk7en","doi_status":2,"uri":"rqtl-code-bmwtk7en","type_id":4,"template_id":3,"published_on":1601932115,"parent_protocols":[],"parent_collections":[],"cited_protocols":[],"version_id":2,"version_data":{"id":"2","code":"bmwtk7en","parent_id":42516,"parent_uri":"rqtl-code-bmruk56w","is_same_owner":true,"has_pending_merge_request":false,"has_approved_merge_request":true},"created_on":1601481781,"modified_on":null,"categories":null,"public":1,"is_unlisted":0,"creator":{"name":"Anna Miller","affiliation":null,"affiliations":[],"username":"m4ule1y1t1y4qle1","note":null,"link":null,"image":{"source":"\/img\/avatars\/003.png","placeholder":"\/img\/avatars\/003.png"},"badges":[{"id":2,"image":{"source":"\/img\/badges\/bronze.svg","placeholder":"\/img\/badges\/bronze.svg"},"name":"Author"}],"verified":0,"is_verified_user":false,"research_interests":null,"blocked_by_you":false,"blocked_you":false,"hide_following":false},"journal":null,"journal_name":null,"journal_link":null,"article_citation":null,"has_versions":0,"link":null,"total_collections":0,"number_of_steps":0,"authors":[{"name":"Anna Miller","affiliation":"Case Western Reserve University","affiliations":[],"username":"m4ule1y1t1y4qle1","note":null,"link":null,"image":{"source":"\/img\/avatars\/003.png","placeholder":"\/img\/avatars\/003.png"},"badges":[],"verified":1,"is_verified_user":true,"research_interests":null,"blocked_by_you":false,"blocked_you":false,"hide_following":false}],"versions":[],"groups":[],"is_owner":1,"has_subprotocols":0,"is_subprotocol":0,"is_bookmarked":0,"can_claim_authorship":0,"can_accept_authorship":0,"can_be_copied":1,"can_remove_fork":1,"fork_id":null,"url":"https:\/\/www.protocols.io\/view\/rqtl-code-bmwtk7en","forks_count":{"private":0,"public":0},"access":{"can_view":1,"can_remove":0,"can_add":0,"can_edit":0,"can_publish":0,"can_get_doi":0,"can_share":1,"can_move":1,"can_move_outside":1,"can_transfer":1,"can_download":1,"is_locked":0},"guid":"7CB869AFB561410C87241562155092FC","state_version_id":5,"steps":[],"document":"<div class = \"text-blocks\"><div class = \"text-block\">##Install_rqtl<\/div><div class = \"text-block\">install.packages(\"qtl\")<\/div><div class = \"text-block\">##load_package<\/div><div class = \"text-block\">library(qtl)<\/div><div class = \"text-block\">##Trait_data<\/div><div class = \"text-block\">mycross <- read.cross(\"csv\", file = \"trait_data.csv\")<\/div><div class = \"text-block\">mycross <- jittermap(mycross)<\/div><div class = \"text-block\">mycross <- calc.genoprob(mycross, step=1.0, off.end=0.0, error.prob=1.0e-4, map.function =\"haldane\", stepwidth = \"fixed\")<\/div><div class = \"text-block\">mycross <-sim.geno(mycross, n.draws=10000, step =1.0, off.end=0.0, error.prob=1.0e-4, map.function=\"haldane\", stepwidth =\"fixed\")<\/div><div class = \"text-block\">##Covariate_sex<\/div><div class = \"text-block\">ac <- pull.pheno(mycross, c(\"sex\"))<\/div><div class = \"text-block\">#Main_effect_sex<\/div><div class = \"text-block\">out.covar<- scanone(mycross, addcovar=ac, pheno.col=1, model =\"normal\", method =\"hk\")<\/div><div class = \"text-block\">out.covar.perm <- scanone(mycross,addcovar=ac, model=\"normal\", method=\"hk\", n.perm=10000)<\/div><div class = \"text-block\">summary(out.covar, perms=out.covar.perm, pvalues=TRUE)<\/div><div class = \"text-block\">#Epistatic_effect_sex<\/div><div class = \"text-block\">out.covar<- scantwo(mycross, addcovar=ac, pheno.col=1, model =\"normal\", method =\"em\")<\/div><div class = \"text-block\">out.covar.perm <- scantwo(mycross,addcovar=ac, model=\"normal\", method=\"em\", n.perm=10000)<\/div><div class = \"text-block\">summary(out.covar, perms=out.covar.perm, pvalues=TRUE)<\/div><div class = \"text-block\">##RNA_Seq<\/div><div class = \"text-block\">mycross <- read.cross(\"csv\", file = \"RNA_SEQ.csv\")<\/div><div class = \"text-block\">mycross <- calc.genoprob(mycross, step=1.0, off.end=0.0, error.prob=1.0e-4, map.function =\"haldane\", stepwidth = \"fixed\")<\/div><div class = \"text-block\">mycross <-sim.geno(mycross, n.draws=10000, step =1.0, off.end=0.0, error.prob=1.0e-4, map.function=\"haldane\", stepwidth =\"fixed\")<\/div><div class = \"text-block\">##Covariate_sex<\/div><div class = \"text-block\">ac <- pull.pheno(mycross, c(\"sex\"))<\/div><div class = \"text-block\">##Main_effect<\/div><div class = \"text-block\">operm1 <- scanone(mycross, addcovar=ac, method=\"hk\", n.perm=10000)<\/div><div class = \"text-block\">n=1<\/div><div class = \"text-block\">c<-a <- scanone(mycross, pheno.col = 1, method = \"hk\")<\/div><div class = \"text-block\">for (n in 1:2180){<\/div><div class = \"text-block\">  a <- scanone(mycross, pheno.col = n, method = \"hk\")<\/div><div class = \"text-block\">  c <- append(c,a)<\/div><div class = \"text-block\">  n+1}<\/div><div class = \"text-block\">print(c)<\/div><div class = \"text-block\">##Epistatic_effect<\/div><div class = \"text-block\">operm2 <- scantwo(mycross, addcovar= ac, method=\"em\", n.perm=10000)<\/div><div class = \"text-block\">n=1<\/div><div class = \"text-block\">c<-a <- scantwo(mycross, pheno.col = 1, method = \"em\")<\/div><div class = \"text-block\">for (n in 1:2180){<\/div><div class = \"text-block\">  a <- scantwo(mycross, pheno.col = n, method = \"em\")<\/div><div class = \"text-block\">  c <- append(c,a)<\/div><div class = \"text-block\">  n+1}<\/div><div class = \"text-block\">print(c)<\/div><div class = \"text-block\">##Visualizations<\/div><div class = \"text-block\">mname1 <- find.marker(mycross, chr=X, pos=X)<\/div><div class = \"text-block\">mname2 <- find.marker(mycross, chr=Y, pos=Y)<\/div><div class = \"text-block\">###Genotype Plot 1<\/div><div class = \"text-block\">plotPXG(mycross, pheno.col=1, c(mname1))<\/div><div class = \"text-block\">##Genotype Plot 2<\/div><div class = \"text-block\">plotPXG(mycross, pheno.col=1, c(mname2))<\/div><div class = \"text-block\">###Main Effect<\/div><div class = \"text-block\">thresh1 <- summary(out.covar.perm, alpha=c(0.05))<\/div><div class = \"text-block\">plot(out.covar, main= \"Mainscan plot of GENE\", ylim = c(0,6))<\/div><div class = \"text-block\">abline(h=thresh1, lty=\"dotted\", lwd=1)<\/div><div class = \"text-block\">###Genotype Interactions<\/div><div class = \"text-block\">chr <- c(\"chrx\", \"chry\")<\/div><div class = \"text-block\">pos <- c(posx,posy)<\/div><div class = \"text-block\">qtl <- makeqtl(mycross, chr, pos, what=\"prob\")<\/div><div class = \"text-block\">rqtl <- refineqtl(mycross, qtl=qtl, formula = y~Q1+Q2+Q1:Q2)<\/div><div class = \"text-block\">plotLodProfile(rqtl)<\/div><div class = \"text-block\">###Interaction effects<\/div><div class = \"text-block\">plotPXG(mycross, pheno.col=1, c(mname1, mname2))<\/div><div class = \"text-block\">###Context Dependent Genotype Effects<\/div><div class = \"text-block\">effectplot(mycross, pheno.col=1, mname1=mname1, mname2=mname2)<\/div><div class = \"text-block\">##LOD intervals<\/div><div class = \"text-block\">lodint(rqtl, qtl.index=2)<\/div><div class = \"text-block\">##Overall interaction RNA-Seq<\/div><div class = \"text-block\">library(tidyverse)<\/div><div class = \"text-block\">library(car)<\/div><div class = \"text-block\">library(rgl)<\/div><div class = \"text-block\">ggplot(data = RNA_SEQ_Plot) + <\/div><div class = \"text-block\">  geom_point(aes(x = RNA_SEQ_Plot$`Main 1`, y = RNA_SEQ_Plot$Epistatic), col = \"midnightblue\") +<\/div><div class = \"text-block\">  theme_bw() + xlim(0, 15) + ylim(0, 15) +<\/div><div class = \"text-block\">  labs( x= \"Main Effect 1\", y = \"Epistatic\")<\/div><div class = \"text-block\">ggplot(data = RNA_SEQ_Plot) + <\/div><div class = \"text-block\">  geom_point(aes(x = RNA_SEQ_Plot$`Main 2`, y = RNA_SEQ_Plot$Epistatic), col = \"midnightblue\") +<\/div><div class = \"text-block\">  theme_bw() + xlim(0, 15) + ylim(0, 15) +<\/div><div class = \"text-block\">  labs( x= \"Main Effect 2\", y = \"Epistatic\")<\/div><div class = \"text-block\">ggplot(data = RNA_SEQ_MAIN_EFFECTS_FOR_PLOTS_4_2) +<\/div><div class = \"text-block\">  geom_point(aes(x = RNA_SEQ_MAIN_EFFECTS_FOR_PLOTS_4_2$main_LOD, y =<\/div><div class = \"text-block\">RNA_SEQ_MAIN_EFFECTS_FOR_PLOTS_4_2$`Epistatic P`), col = \"midnightblue\") +<\/div><div class = \"text-block\">  theme_bw() + xlim(0, 15) + ylim(0, 15) + labs( x= \"Main Effect\", y = \"Epistatic\")<\/div><div class = \"text-block\">##Circos Plot<\/div><div class = \"text-block\">library(circlize)<\/div><div class = \"text-block\">df <- circose_inr<\/div><div class = \"text-block\">circos.par(\"track.height\" = 0.1)<\/div><div class = \"text-block\">circos.initialize(factors = df$chr, x = df$pos)<\/div><div class = \"text-block\">circos.track(factors = df$chr, y = df$pos, bg.col=c(\"blue\", \"red\"),<\/div><div class = \"text-block\">             panel.fun = function(x, y) {<\/div><div class = \"text-block\">               circos.text(CELL_META$xcenter, CELL_META$cell.ylim[2] + uy(5, \"mm\"), <\/div><div class = \"text-block\">                           CELL_META$sector.index)<\/div><div class = \"text-block\">               circos.axis(labels.cex = 0.6) })<\/div><div class = \"text-block\">circos.link(chr1,position,chr2,position,col = \"color\")<\/div><div class = \"text-block\">circos.link(chr1,position,chr2,position,col = \"color\")<\/div><\/div>","materials":[],"description":null,"changed_on":1601932115}