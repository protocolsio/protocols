{"id":46198,"title":"Evolution of Viral Genomes: Interplay Between Selection, Recombination, and Other Forces","title_html":"<p>Evolution of Viral Genomes: Interplay Between Selection, Recombination, and Other Forces<\/p>","image":{"source":"https:\/\/s3.amazonaws.com\/protocols-files\/files\/ebgc9nan.jpg","placeholder":"https:\/\/s3.amazonaws.com\/protocols-files\/files\/ebgc9nan.jpg"},"doi":"dx.doi.org\/10.17504\/protocols.io.brcwm2xe","doi_status":2,"uri":"evolution-of-viral-genomes-interplay-between-selec-brcwm2xe","type_id":1,"template_id":4,"published_on":1630617679,"parent_protocols":[],"parent_collections":[],"cited_protocols":[],"version_id":0,"version_data":{"id":0,"code":"brcwm2xe","parent_id":0,"parent_uri":null,"has_pending_merge_request":0,"has_approved_merge_request":0},"created_on":1610407215,"modified_on":null,"categories":null,"public":1,"is_unlisted":0,"creator":{"name":" ","affiliation":null,"affiliations":[],"username":null,"note":null,"link":null,"image":{"source":null,"placeholder":null},"badges":[],"verified":0,"is_verified_user":false,"research_interests":null,"blocked_by_you":false,"blocked_you":false,"hide_following":false},"journal":null,"journal_name":null,"journal_link":null,"article_citation":null,"has_versions":0,"link":"https:\/\/link.springer.com\/protocol\/10.1007\/978-1-4939-9074-0_14","total_collections":0,"number_of_steps":48,"authors":[{"name":"Stephanie J. Spielman","affiliation":"Institute for Genomics and Evolutionary Medicine, Temple University, Philadelphia, USA","affiliations":[],"username":null,"note":"","link":null,"image":{"source":null,"placeholder":null},"badges":[],"verified":0,"is_verified_user":false,"research_interests":null,"blocked_by_you":false,"blocked_you":false,"hide_following":false},{"name":"Steven Weaver","affiliation":"Institute for Genomics and Evolutionary Medicine, Temple University, Philadelphia, USA","affiliations":[],"username":null,"note":"","link":null,"image":{"source":null,"placeholder":null},"badges":[],"verified":0,"is_verified_user":false,"research_interests":null,"blocked_by_you":false,"blocked_you":false,"hide_following":false},{"name":"Stephen D. Shank","affiliation":"Institute for Genomics and Evolutionary Medicine, Temple University, Philadelphia, USA","affiliations":[],"username":null,"note":"","link":null,"image":{"source":null,"placeholder":null},"badges":[],"verified":0,"is_verified_user":false,"research_interests":null,"blocked_by_you":false,"blocked_you":false,"hide_following":false},{"name":"Brittany Rife Magalis","affiliation":"Institute for Genomics and Evolutionary Medicine, Temple University, Philadelphia, USA","affiliations":[],"username":null,"note":"","link":null,"image":{"source":null,"placeholder":null},"badges":[],"verified":0,"is_verified_user":false,"research_interests":null,"blocked_by_you":false,"blocked_you":false,"hide_following":false},{"name":"Michael Li","affiliation":"Institute for Genomics and Evolutionary Medicine, Temple University, Philadelphia, USA","affiliations":[],"username":null,"note":"","link":null,"image":{"source":null,"placeholder":null},"badges":[],"verified":0,"is_verified_user":false,"research_interests":null,"blocked_by_you":false,"blocked_you":false,"hide_following":false},{"name":"Sergei L. Kosakovsky Pond","affiliation":"Institute for Genomics and Evolutionary Medicine, Temple University, Philadelphia, USA","affiliations":[],"username":null,"note":"","link":null,"image":{"source":null,"placeholder":null},"badges":[],"verified":0,"is_verified_user":false,"research_interests":null,"blocked_by_you":false,"blocked_you":false,"hide_following":false}],"versions":[],"groups":[{"id":27553,"uri":"springer-nature-books","title":"Springer Nature Books","image":{"source":"https:\/\/s3.amazonaws.com\/protocols-files\/files\/duwxbaca7.png","placeholder":"https:\/\/s3.amazonaws.com\/protocols-files\/files\/duwxbaca7.png"},"tech_support":{"email":null,"phone":null,"hide_contact":0,"use_email":0,"url":null},"is_member":1,"request":{"id":27553,"uri":"springer-nature-books","title":"Springer Nature Books","image":{"source":"https:\/\/s3.amazonaws.com\/protocols-files\/files\/duwxbaca7.png","placeholder":"https:\/\/s3.amazonaws.com\/protocols-files\/files\/duwxbaca7.png"},"tech_support":{"email":null,"phone":null,"hide_contact":0,"use_email":0,"url":null},"is_member":1,"description":null,"research_interests":null,"website":null,"location":null,"affiliation":null,"status":{"is_visible":true,"access_level":0},"stats":{"files":[],"total_members":0,"total_followers":0,"total_child_groups":0,"total_parent_groups":0,"has_collaborations":0},"user_status":{"is_member":true,"is_confirmed":true,"is_invited":false,"is_owner":false,"is_admin":false,"is_following":false},"join_link":null,"token":null,"owner":{"name":" ","affiliation":null,"affiliations":[],"username":null,"note":null,"link":null,"image":{"source":null,"placeholder":null},"badges":[],"verified":0,"is_verified_user":false,"research_interests":null,"blocked_by_you":false,"blocked_you":false,"hide_following":false},"is_protocol_requested":0,"is_group_requested":0,"is_my":false,"is_request":false,"is_confirmed":1,"is_declined":0,"requester":{"name":" ","affiliation":null,"affiliation_url":null,"username":null,"link":null},"protocol":{"id":0,"title":"Evolution of Viral Genomes: Interplay Between Selection, Recombination, and Other Forces","title_html":"Evolution of Viral Genomes: Interplay Between Selection, Recombination, and Other Forces","image":{"source":null,"placeholder":null},"doi":null,"doi_status":0,"uri":"evolution-of-viral-genomes-interplay-between-selec-brcwm2xe","type_id":1,"template_id":0,"published_on":null,"stats":{"number_of_views":0,"number_of_steps":0,"number_of_bookmarks":0,"number_of_comments":0,"number_of_exports":0,"number_of_runs":0,"number_of_votes":0,"is_voted":0},"parent_protocols":[],"parent_collections":[],"cited_protocols":[]},"created_on":1630685707,"resolve_on":0,"resolved_user":{"name":" ","affiliation":null,"affiliations":[],"username":null,"note":null,"link":null,"image":{"source":null,"placeholder":null},"badges":[],"verified":0,"is_verified_user":false,"research_interests":null,"blocked_by_you":false,"blocked_you":false,"hide_following":false},"shared":false}}],"is_owner":1,"has_subprotocols":0,"is_subprotocol":0,"is_bookmarked":0,"can_claim_authorship":0,"can_accept_authorship":0,"can_be_copied":1,"can_remove_fork":1,"fork_id":null,"url":"https:\/\/www.protocols.io\/view\/evolution-of-viral-genomes-interplay-between-selec-brcwm2xe","forks_count":{"private":0,"public":0},"access":{"can_view":1,"can_remove":0,"can_add":0,"can_edit":0,"can_publish":0,"can_get_doi":0,"can_share":1,"can_move":1,"can_move_outside":1,"can_transfer":1,"can_download":1,"is_locked":0},"guid":"9D7A5E30546311EB951D73E5B604C86E","state_version_id":2418,"steps":[{"id":1103312,"guid":"2EB4E0B0546811EBA3A9CD7ECE8FB1F1","previous_id":null,"previous_guid":null,"modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"310942373D5E4BFF859306EE66D7C095","order_id":1,"type_id":6,"title":"Section","source":{"title":"3.1 How to Run a Selection Analysis"}},{"id":1054724,"guid":"E0E16A04AD5A4A1D9AF4323BA39A2B90","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><br\/><br\/><div class = \"text-block\">To execute a selection analysis locally, the following steps will need to be taken:<\/div><\/div>"}},{"id":1054725,"guid":"7226AC9850C64DFCB6364C34C756B652","order_id":2,"type_id":26,"title":"notes","source":{"id":0,"parent_id":0,"uri":"","title":"","body":"<div class = \"text-blocks\"><div class = \"text-block\"><span>There is a uniform workflow to run any of the described methods, either locally (on one\u2019s own computer and\/or a high-performance computing environment) in HyPhy or using the Datamonkey web-service, available at <\/span><a href=\"http:\/\/www.datamonkey.org\" style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;:UNDERLINE;\">www.datamonkey.org<\/span><\/a><span>. The version of HyPhy that supports all of the analyses is a command-line program, i.e., it must be run from a terminal prompt (similar to most other bioinformatics packages) in Linux or Mac OS X. It is also possible to run the program in Windows, with an appropriate POSIX emulation environment (e.g., MinGW) installed.<\/span><\/div><\/div>","created_on":0,"changed_on":0,"creator":{"name":"","affiliation":null,"affiliations":[],"username":"","note":null,"link":null,"image":{"source":"","placeholder":""},"badges":[],"verified":0,"is_verified_user":false,"research_interests":null,"blocked_by_you":false,"blocked_you":false,"hide_following":false},"comments":[]}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#A492FF","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1114154,"guid":"FBABBCF060B711EB8967637CBE246260","previous_id":1103312,"previous_guid":"2EB4E0B0546811EBA3A9CD7ECE8FB1F1","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"46DA9FA8A46C4D6E898DF46E71DAB329","order_id":1,"type_id":6,"title":"Section","source":{"title":"3.1 How to Run a Selection Analysis"}},{"id":1054724,"guid":"BDD149706E564F39AF81CC18F5BD08A0","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Prepare your coding sequence alignment. In general, any duplicate sequences should be removed before analysis. Most importantly, it is imperative that the sequence alignment be in the correct reading frame, meaning that alignment must be performed with codon structure in mind. A common approach to ensure this criterion is met is to generate the alignment using translated amino-acid data and then back-translate to the original nucleotide sequences.<\/div><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#A492FF","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1114155,"guid":"009C14D060B811EB8967637CBE246260","previous_id":1114154,"previous_guid":"FBABBCF060B711EB8967637CBE246260","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"9ECF6BF55D7C446D89CE39910CC97CFF","order_id":1,"type_id":6,"title":"Section","source":{"title":"3.1 How to Run a Selection Analysis"}},{"id":1054724,"guid":"90063332014F48B8B7A53F20881B8158","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Prepare a phylogenetic tree from the multiple sequence alignment. Note that certain analyses may require a labeled phylogenetic tree, as indicated within each subsequent tutorial. Keep in mind that for most selection analyses, a tree topology is a nuisance parameter. Hence, while it is advisable to use good practices when inferring trees, minor errors in tree inference tend to have minor effects on gene- and site-level inference. A notable exception occurs when lineage-specific selection is investigated; in this case, ensuring high-quality tree topologies is important.<\/div><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#A492FF","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1114156,"guid":"0594F83060B811EB8967637CBE246260","previous_id":1114155,"previous_guid":"009C14D060B811EB8967637CBE246260","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"335C47BB52D1446593772F0E3AD994D5","order_id":1,"type_id":6,"title":"Section","source":{"title":"3.1 How to Run a Selection Analysis"}},{"id":1054724,"guid":"57C1BEE120F44CA38A4467FBC8A0EF3D","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\"><span>An essential and <\/span><span style = \"font-style:italic;\">strongly <\/span><span>recommended step before analyzing data for selection is to screen sequences for recombination. If recombinant sequences are naively analyzed without an appropriate phylogenetic correction, inference results are likely to be biased (Posada et al. [33]) (see the section on <\/span><span style = \"font-weight:bold;\">Screening sequences for recombination <\/span><span>later in this chapter).<\/span><\/div><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#A492FF","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1114157,"guid":"0DBE821060B811EB8967637CBE246260","previous_id":1114156,"previous_guid":"0594F83060B811EB8967637CBE246260","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"9AC25C19640D4DCBB3DE4946F7D7E520","order_id":1,"type_id":6,"title":"Section","source":{"title":"3.1 How to Run a Selection Analysis"}},{"id":1054724,"guid":"2CDFCB5724474DFF83FC4BCCA8188D6C","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Prepare your data (alignment and phylogeny) for input to HyPhy. There are three ways to provide a dataset for HyPhy analysis, each of which will trigger a different analysis prompt at runtime:<\/div><br\/><div class = \"text-block\"><ul style = \"list-style-type:disc;\"><li style = \"counter-reset:ol0;list-style-type:disc;\">Two separate files containing the alignment and phylogeny, respectively. In this circumstance, HyPhy issues two successive prompts: the first for the file containing the alignment, and the second for the file containing the tree.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span>A single file containing an alignment in one of the formats supported by <\/span><span style = \"font-style:italic;\">HyPhy<\/span><span> (FASTA, MEGA, and PHYLIP), with a Newick-formatted phylogeny included at the bottom of this file. In this circumstance, HyPhy issues two successive prompts: the first for the file containing the alignment, and the second asking whether to accept the tree found in the file (provide the affirmative response, e.g., \u201cy,\u201d to accept it).<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">A NEXUS file containing both the alignment and phylogeny. In this circumstance, HyPhy automatically accepts the provided phylogeny and therefore only issues a single prompt for the file containing the alignment. This is also the format that can be used to specify partitioned data, which is necessary to account for recombination.<\/li><\/ul><\/div><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#A492FF","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1114160,"guid":"24E553B060B811EB8967637CBE246260","previous_id":1114157,"previous_guid":"0DBE821060B811EB8967637CBE246260","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"52776231F86D46649C65F687AB31FFFE","order_id":1,"type_id":6,"title":"Section","source":{"title":"3.1 How to Run a Selection Analysis"}},{"id":1054724,"guid":"D5411EB6777448A19FED7B171FE8DB6B","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Execute the appropriate method in HyPhy, selecting options suitable for the specific analysis.<\/div><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#A492FF","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1114161,"guid":"2A87BD8060B811EB8967637CBE246260","previous_id":1114160,"previous_guid":"24E553B060B811EB8967637CBE246260","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"3A5333F4DDA046C1AE3FA96032A80577","order_id":1,"type_id":6,"title":"Section","source":{"title":"3.1 How to Run a Selection Analysis"}},{"id":1054724,"guid":"58AA119662EE418AA75BECD584438B01","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><br\/><br\/><\/div>"}},{"id":1054725,"guid":"84057AEC8A1C4C1F98C442525B13084C","order_id":2,"type_id":26,"title":"notes","source":{"id":0,"parent_id":0,"uri":"","title":"","body":"<div class = \"text-blocks\"><div class = \"text-block\"><span>Each method will provide live on-the-screen progress updates and, when finished, a text summary of the analysis. The output is generated in Markdown (<\/span><span style = \"font-style:italic;\">see<\/span><span> footnote 2), which can either be read directly as text or formatted using one of many Markdown viewers.<\/span><\/div><br\/><div class = \"text-block\"><span>When an analysis is finished, HyPhy will write a JSON file with numerous details about the analysis to disk. By convention, this file will be placed in the same directory as the input alignment file, with the added<\/span><span style = \"font-style:italic;\"> <method>.json <\/span><span>extension, e.g., <\/span><span style = \"font-style:italic;\">flu_ha.nex.BUSTED.json<\/span><span> for an input alignment named <\/span><span style = \"font-style:italic;\">flu_ha.nex<\/span><span> analyzed by the method BUSTED. All results contained in this JSON file can be explored visually within a web browser using a web application from the <\/span><span style = \"font-style:italic;\">hyphy-vision<\/span><span> suite of tools, accessible at <\/span><a href=\"http:\/\/vision.hyphy.org\" style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;:UNDERLINE;\">vision.hyphy.org<\/span><\/a><span>. Since JSON files can be easily accessed by scripting and data-analysis languages, these are also well-suited for incorporation into pipelines (<\/span><span style = \"font-style:italic;\">see<\/span><span> footnote 3).<\/span><\/div><br\/><div class = \"text-block\"><span>When run through <\/span><a href=\"http:\/\/www.datamonkey.org\" style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;:UNDERLINE;\">www.datamonkey.org<\/span><\/a><span>, this entire workflow is automated: one simply uploads an alignment, selects options for the analysis, and waits for the job to finish. Once the job has completed, the results will be displayed in an interactive application within the web browser. Note that Datamonkey will automatically remove duplicate sequences before executing any analysis.<\/span><\/div><\/div>","created_on":0,"changed_on":0,"creator":{"name":"","affiliation":null,"affiliations":[],"username":"","note":null,"link":null,"image":{"source":"","placeholder":""},"badges":[],"verified":0,"is_verified_user":false,"research_interests":null,"blocked_by_you":false,"blocked_you":false,"hide_following":false},"comments":[]}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#A492FF","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1114162,"guid":"719548F060B811EB8967637CBE246260","previous_id":1114161,"previous_guid":"2A87BD8060B811EB8967637CBE246260","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"3DFE45AF23334D0D9AEF5C206F1CD386","order_id":1,"type_id":6,"title":"Section","source":{"title":"3.2 BUSTED"}},{"id":1054724,"guid":"CFAEAE03D70B42EDB3CC6163586D3B6D","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><br\/><br\/><\/div>"}},{"id":1054725,"guid":"DE871DC1FD474FC69E8D6923399AA41D","order_id":2,"type_id":26,"title":"notes","source":{"id":0,"parent_id":0,"uri":"","title":"","body":"<div class = \"text-blocks\"><div class = \"text-block\"><span style = \"font-weight:bold;\">What Biological Question Is the Method Designed to Answer?<\/span><\/div><br\/><div class = \"text-block\">Is there evidence that some sites in the alignment have been subject to positive diversifying selection, either pervasive (throughout the evolutionary tree) or episodic (only on some lineages)? In other words, BUSTED asks whether a given gene has been subject to positive, diversifying selection at any site, at any time [26]. If a priori information about lineages of interest is available (e.g., due to migration, change in the environment, etc.), then BUSTED can be restricted to test for selection only on a subset of tree lineages, potentially boosting power.<\/div><br\/><div class = \"text-block\">Recommended Applications<\/div><br\/><div class = \"text-block\"><ol style = \"list-style-type: decimal;\"><li style = \"counter-reset:ol0;\"><span style = \"font-weight:bold;\">Annotating <\/span><span>a collection of alignments with a binary attribute: Has this alignment been subject to positive diversifying selection (yes\/no)? [34].<\/span><\/li><li style = \"counter-reset:ol0;\"><span>Testing <\/span><span style = \"font-weight:bold;\">small- or low-divergence alignments <\/span><span>(i.e., \u2264\u223c\u200910 sequences) for evidence of positive diversifying selection, where neither branch- nor site-level methods have sufficient power to detect weak, but present, signal.<\/span><\/li><\/ol><\/div><\/div>","created_on":0,"changed_on":0,"creator":{"name":"","affiliation":null,"affiliations":[],"username":"","note":null,"link":null,"image":{"source":"","placeholder":""},"badges":[],"verified":0,"is_verified_user":false,"research_interests":null,"blocked_by_you":false,"blocked_you":false,"hide_following":false},"comments":[]}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#94EBFF","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1114163,"guid":"97F92A7060B811EB8967637CBE246260","previous_id":1114162,"previous_guid":"719548F060B811EB8967637CBE246260","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"28DACAB2342D458896E6FCEDF384FA27","order_id":1,"type_id":6,"title":"Section","source":{"title":"3.2 BUSTED"}},{"id":1054724,"guid":"DC572C33B1F645259FDE2A8AE567ED84","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><br\/><br\/><\/div>"}},{"id":1054725,"guid":"8D0712E178E849BCAF5A41CB4AF10739","order_id":2,"type_id":26,"title":"notes","source":{"id":0,"parent_id":0,"uri":"","title":"","body":"<div class = \"text-blocks\"><div class = \"text-block\"><span style = \"font-weight:bold;\">Statistical Test Procedure<\/span><\/div><br\/><div class = \"text-block\"><span>Each (branch, site) pair evolves with <\/span><span style = \"font-style:italic;vertical-align:sub;\">\u03c9<\/span><span style = \"font-style:italic;vertical-align:sub;\">1<\/span><span>\u2009\u2264\u2009<\/span><span style = \"font-style:italic;vertical-align:sub;\">\u03c9<\/span><span style = \"font-style:italic;vertical-align:sub;\">2<\/span><span>\u2009\u2264\u20091, or <\/span><span style = \"font-style:italic;vertical-align:sub;\">\u03c9<\/span><span style = \"font-style:italic;vertical-align:sub;\">3<\/span><span>\u2009\u2265\u20091, with the ratio chosen independently of other (branch, site) pairs with probability <\/span><span style = \"font-style:italic;vertical-align:sub;\">p<\/span><span style = \"font-style:italic;vertical-align:sub;\">1<\/span><span>, <\/span><span style = \"font-style:italic;vertical-align:sub;\">p<\/span><span style = \"font-style:italic;vertical-align:sub;\">2<\/span><span>, <\/span><span style = \"font-style:italic;vertical-align:sub;\">p<\/span><span style = \"vertical-align:sub;\">3 <\/span><span>(normalized to sum to 1). The three-rate <\/span><span style = \"font-style:italic;\">\u03c9 <\/span><span>distribution is estimated jointly from the entire alignment, i.e., rates are shared by all (branch,site) combinations. Therefore, BUSTED is technically a \u201cbranch-site\u201d model [16], although it is not intended to detect individual sites which drive signal of selection.<\/span><\/div><br\/><div class = \"text-block\"><span>The test for episodic diversifying selection is performed by comparing the full model versus the nested null model, where <\/span><span style = \"font-style:italic;vertical-align:sub;\">\u03c9<\/span><span style = \"vertical-align:sub;\">3 <\/span><span>is constrained to 1. Statistical significance is obtained by the likelihood ratio test, assuming the <\/span><a href=\"#\" style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\"> <\/span><\/a><span> asymptotic distribution of the likelihood ratio statistic under the null model.<\/span><\/div><div style = \"text-align :; float : ;\"><span style = \"\">\u03c7^2_2<\/span><\/div><br\/><div class = \"text-block\"><span>When only some of the branches are chosen for testing, and the remainder are designated as the background, two independent three-rate <\/span><span style = \"font-style:italic;\">\u03c9 <\/span><span>distributions are fitted: one for the test branches, and one for the background branches. Testing for selection is carried out by constraining the distribution on the test branches as described above.<\/span><\/div><\/div>","created_on":0,"changed_on":0,"creator":{"name":"","affiliation":null,"affiliations":[],"username":"","note":null,"link":null,"image":{"source":"","placeholder":""},"badges":[],"verified":0,"is_verified_user":false,"research_interests":null,"blocked_by_you":false,"blocked_you":false,"hide_following":false},"comments":[]}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#94EBFF","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1114165,"guid":"EA5EC36060B811EB8967637CBE246260","previous_id":1114163,"previous_guid":"97F92A7060B811EB8967637CBE246260","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"AA00CAFE25E041178BB091DAB4A9E489","order_id":1,"type_id":6,"title":"Section","source":{"title":"3.2 BUSTED"}},{"id":1054724,"guid":"6F3159199B364A638D67F6CF366A77BD","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><br\/><br\/><div class = \"text-block\"><span>To run BUSTED, open a terminal session and enter <\/span><span style = \"font-style:italic;\">HYPHYMP <\/span><span>from the command line to launch the HyPhy analysis menu. Enter <\/span><span style = \"font-style:italic;\">1<\/span><span> (Selection Analyses) and then <\/span><span style = \"font-style:italic;\">5 <\/span><span>to reach the BUSTED analysis menu, and supply values for the following prompts:<\/span><\/div><br\/><div class = \"text-block\"><ol style = \"list-style-type: decimal;\"><li style = \"counter-reset:ol0;\"><span style = \"font-weight:bold;\">Choose genetic code. <\/span><span>This option tells HyPhy which translation table to use for codon-level analyses. Enter <\/span><span style = \"font-style:italic;\">1<\/span><span> to use the Universal genetic code.<\/span><\/li><li style = \"counter-reset:ol0;\"><span style = \"font-weight:bold;\">Select a coding sequence alignment file. <\/span><span>Provide the full path to the dataset of interest:         <\/span><span style = \"font-style:italic;\">\/path\/to\/data\/ksr2.fna<\/span><span style = \"font-style:italic;\">.<\/span><\/li><li style = \"counter-reset:ol0;\"><span style = \"font-weight:bold;\">A tree was found in the data file\u2026Would you like to use it (y\/n)? <\/span><span>Enter \u201cy\u201d to use the tree.<\/span><\/li><li style = \"counter-reset:ol0;\"><span style = \"font-weight:bold;\">Choose the set of branches to test for selection. <\/span><span>Enter<\/span><span style = \"font-style:italic;\">1 <\/span><span>to test all branches for selection.<\/span><\/li><\/ol><\/div><br\/><div class = \"text-block\">BUSTED will now run to completion, printing status indicators to screen while it runs. For an example of how this output will look when rendered into HTML (or similarly, PDF), see this link: <\/div><div class = \"text-block\"><a href=\"http:\/\/bit.ly\/2vsRZrh\" style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">http:\/\/bit.ly\/2vsRZrh<\/span><\/a><\/div><div class = \"text-block\">.<\/div><\/div>"}},{"id":1054725,"guid":"F619DBA628F742FE815D431C22C1E7A3","order_id":2,"type_id":26,"title":"notes","source":{"id":0,"parent_id":0,"uri":"","title":"","body":"<div class = \"text-blocks\"><div class = \"text-block\"><span style = \"font-weight:bold;\">Example Analysis<\/span><\/div><br\/><div class = \"text-block\">To begin, we will perform a BUSTED analysis using a dataset of primate-specific KSR2, kinase suppressor of RAS2, genes from Enard et al. [5]. This gene has been implicated as a so-called \u2018virus-interacting protein,\u2019 and previous work has suggested it has experienced adaptation in mammalian lineages due to selective pressures exerted by viruses [5]. We will test all lineages for positive selection (rather than specifying a subset of \u201ctest\u201d branches), thereby asking the question: \u201cHas KSR2 been subject to diversifying selection at some time during evolution in primates?\u201d<\/div><\/div>","created_on":0,"changed_on":0,"creator":{"name":"","affiliation":null,"affiliations":[],"username":"","note":null,"link":null,"image":{"source":"","placeholder":""},"badges":[],"verified":0,"is_verified_user":false,"research_interests":null,"blocked_by_you":false,"blocked_you":false,"hide_following":false},"comments":[]}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#94EBFF","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1114168,"guid":"70EC1B3060B911EB8967637CBE246260","previous_id":1114165,"previous_guid":"EA5EC36060B811EB8967637CBE246260","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"6C3A7C55378A4BCCA067C5EF3C119CFB","order_id":1,"type_id":6,"title":"Section","source":{"title":"3.2 BUSTED"}},{"id":1054724,"guid":"FA4C512B70CE485D93C6B76915204569","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Listing 1 Partial BUSTED screen output<\/div><br\/><div class = \"text-block\"><pre><code><div class = \"text-blocks\"><div class = \"text-block\">### \u00a0 Branches \u00a0 to \u00a0 test \u00a0 for \u00a0 selection\u00a0in\u00a0the\u00a0BUSTED\u00a0analysis\n* \u00a0 Selected \u00a0 15 \u00a0 branches \u00a0 to \u00a0 test \u00a0in\u00a0the\u00a0BUSTED\u00a0analysis:\u00a0\u2018HUM,\u00a0PAN,\u00a0Node6,\u00a0GOR,\u00a0Node5,\u00a0PON,\u00a0Node4,\u00a0GIB,\u00a0Node3,\u00a0MAC,\u00a0BAB,\u00a0Node12,\u00a0Node2,\u00a0MAR,\u00a0BUS\u2018<\/div><br\/><div class = \"text-block\">### \u00a0 Obtaining \u00a0 branch \u00a0 lengths \u00a0 and\u00a0nucleotide\u00a0substitution\u00a0biases\u00a0under\u00a0the\u00a0nucleotide\u00a0GTR\u00a0model\n* \u00a0 Log ( L ) \u00a0 = \u00a0 -5768.01, \u00a0 AIC - c \u00a0 = \u00a0 11582.06\u00a0(23\u00a0estimated\u00a0parameters)<\/div><br\/><div class = \"text-block\">### \u00a0 Obtaining \u00a0 the \u00a0 global \u00a0 omega \u00a0estimate\u00a0based\u00a0on\u00a0relative\u00a0GTR\u00a0branch\u00a0lengths\u00a0and\u00a0nucleotide\u00a0substitution\u00a0biases\n* \u00a0 Log ( L ) \u00a0 = \u00a0 -5342.48, \u00a0 AIC - c \u00a0 = \u00a0 10745.17\u00a0(30\u00a0estimated\u00a0parameters)\n* \u00a0 non - synonymous \/ synonymous \u00a0 rate\u00a0ratio\u00a0for\u00a0*test*\u00a0=\u00a0\u00a0\u00a00.0342<\/div><br\/><div class = \"text-block\">### \u00a0 Improving \u00a0 branch \u00a0 lengths , \u00a0 nucleotide\u00a0substitution\u00a0biases,\u00a0and\u00a0global\u00a0dN\/dS\u00a0ratios\u00a0under\u00a0a\u00a0full\u00a0codon\u00a0model\n* \u00a0 Log ( L ) \u00a0 = \u00a0 -5333.46, \u00a0 AIC - c \u00a0 = \u00a0 10727.13\u00a0(30\u00a0estimated\u00a0parameters)\n* \u00a0 non - synonymous \/ synonymous \u00a0 rate\u00a0ratio\u00a0for\u00a0*test*\u00a0=\u00a0\u00a0\u00a00.0307<\/div><br\/><div class = \"text-block\">### \u00a0 Performing \u00a0 the \u00a0 full \u00a0 ( dN \/ dS \u00a0>\u00a01\u00a0allowed)\u00a0branch-site\u00a0model\u00a0fit\n* \u00a0 Log ( L ) \u00a0 = \u00a0 -5319.67, \u00a0 AIC - c \u00a0 = \u00a0 10707.62\u00a0(34\u00a0estimated\u00a0parameters)\n* \u00a0 For \u00a0 * test * \u00a0 branches , \u00a0 the \u00a0 following\u00a0rate\u00a0distribution\u00a0for\u00a0branch-site\u00a0combinations\u00a0was\u00a0inferred<\/div><br\/><div class = \"text-block\">| \u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Selection \u00a0 mode\u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a0dN\/dS\u00a0\u00a0\u00a0\u00a0\u00a0|Proportion,\u00a0%|\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Notes |\n|----------------------------------|--------------|-------------|------------------|\n| \u00a0 \u00a0\u00a0\u00a0 Negative selection \u00a0 \u00a0\u00a0|\u00a0\u00a0 \u00a0 0.024\u00a0 \u00a0\u00a0|\u00a0\u00a0\u00a099.151\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0|\n| \u00a0 \u00a0\u00a0\u00a0 Negative selection \u00a0 \u00a0\u00a0|\u00a0\u00a0 \u00a0 0.085\u00a0 \u00a0\u00a0|\u00a0\u00a0\u00a00.812\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0|\n| \u00a0 \u00a0 Diversifying selection \u00a0 \u00a0\u00a0|\u00a0\u00a0 \u00a0 118.143\u00a0 \u00a0\u00a0|\u00a0\u00a0\u00a00.037\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0|<\/div><br\/><div class = \"text-block\">### \u00a0 Performing \u00a0 the \u00a0 constrained \u00a0(dN\/dS\u00a0>\u00a01\u00a0not\u00a0allowed)\u00a0model\u00a0fit\n* \u00a0 Log ( L ) \u00a0 = \u00a0 -5326.18, \u00a0 AIC - c \u00a0 = \u00a0 10718.63\u00a0(33\u00a0estimated\u00a0parameters)\n* \u00a0 For \u00a0 * test * \u00a0 branches \u00a0 under \u00a0 the\u00a0null\u00a0(no\u00a0dN\/dS\u00a0>\u00a01\u00a0model),\u00a0the\u00a0following\u00a0rate\u00a0distribution\u00a0for\u00a0branch-site\u00a0combinations\u00a0was\u00a0inferred<\/div><br\/><div class = \"text-block\">| \u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0 Selection mode \u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a0dN\/dS\u00a0\u00a0\u00a0|Proportion,\u00a0%|\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Notes\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0|\n|-----------------------------|--------------|-------------|-------------------------|\n| \u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 Negative selection \u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a00.000\u00a0\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a010.598\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0|\n| \u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 Negative selection \u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a00.000\u00a0\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a086.086\u00a0\u00a0\u00a0\u00a0| Collapsed\u00a0rate\u00a0class\u00a0\u00a0|\n| \u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 Neutral evolution \u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a01.000\u00a0\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a03.316\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0|<\/div><br\/><div class = \"text-block\">----\n## \u00a0 Branch - site \u00a0 unrestricted \u00a0 statistical\u00a0test\u00a0of\u00a0episodic\u00a0diversification\u00a0[BUSTED]\nLikelihood \u00a0 ratio \u00a0 test \u00a0 for \u00a0 episodic\u00a0diversifying\u00a0positive\u00a0selection,\u00a0**p\u00a0=\u00a0\u00a0\u00a00.0015**.<\/div><\/div><\/code><\/pre><\/div><br\/><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#94EBFF","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1114169,"guid":"9E1318C060B911EB8967637CBE246260","previous_id":1114168,"previous_guid":"70EC1B3060B911EB8967637CBE246260","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"4AD046568DEA4C428534C3B0F9E3AFFD","order_id":1,"type_id":6,"title":"Section","source":{"title":"3.2 BUSTED"}},{"id":1054724,"guid":"11D70264926640F780EBF0AA2ADE956A","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><br\/><br\/><\/div>"}},{"id":1054725,"guid":"AE54066B2FF7434E9A7A3E60C95AE50B","order_id":2,"type_id":26,"title":"notes","source":{"id":0,"parent_id":0,"uri":"","title":"","body":"<div class = \"text-blocks\"><div class = \"text-block\"><span style = \"font-weight:bold;\">Interpreting Results<\/span><\/div><br\/><div class = \"text-block\"><span>The results printed to the terminal indicate a highly significant result (<\/span><span style = \"font-style:italic;\">P<\/span><span>\u2009=\u20090.0015) in the test for whole-gene selection. Analysis with BUSTED therefore provides robust evidence that KSR2 experienced episodic positive selection in the primates. Because we performed the original BUSTED analysis on the entire tree (i.e., without a specified set of test branches), we do not know from this result along which lineages KSR2 was subject to positive selection. We can conclude only that a non-zero proportion of sites on some lineage(s) in the primate tree experienced diversifying selection pressure.<\/span><\/div><br\/><div class = \"text-block\"><span>The output additionally provided information about the specific BUSTED model fits to the test data, including the inferred<\/span><span style = \"font-style:italic;\">\u03c9<\/span><span>distributions and corresponding weights. The BUSTED alternative model (shown under the output header <\/span><span style = \"font-style:italic;\">Performing the full ( dN\/dS >1 allowed) branch-site model fit<\/span><span>) found that a very small proportion (only \u223c0.037%) of sites evolved under a very large <\/span><span style = \"font-style:italic;\">\u03c9 <\/span><span>of over 100 (118.143 ). Importantly, neither of these estimates is precise because they were derived from a small subset of the data. As such, all the BUSTED tests establish the fact that the proportion of sites along test lineages (here, the entire phylogeny) with <\/span><span style = \"font-style:italic;\">\u03c9<\/span><span>\u2009>\u20091 is non-zero. For example, if BUSTED had inferred a rate category of <\/span><span style = \"font-style:italic;\">\u03c9<\/span><span>\u2009=\u200910 on a different gene, it would <\/span><span style = \"font-style:italic;\">not <\/span><span>be correct to claim that this gene evolves under weaker selection than does KSR2. A formal statistical test would have to be carried out to establish such a claim.<\/span><\/div><br\/><div class = \"text-block\"><span>Conversely, had the result not been statistically significant, we would not be able to reject the null hypothesis that no positive selection had occurred in KSR2. Importantly, however, a negative finding <\/span><span style = \"font-style:italic;\">would not <\/span><span>unequivocally rule out the presence of positive selection. This outcome could be due to a lack of statistical power wherein the provided data did not contain a sufficiently strong selection.<\/span><\/div><div class = \"text-block\"><span>BUSTED\u2019s fixed a priori assumption of model complexity (a three-rate <\/span><span style = \"font-style:italic;\">\u03c9 <\/span><span>distribution) may lead to over-parameterized (or under-parameterized) models. For example, in the constrained model for KSR2, two of the three rate classes have the same value of <\/span><span style = \"font-style:italic;\">\u03c9<\/span><span>(0.0), implying that one of them is unnecessary. HyPhy will report this to the screen as a diagnostic message <\/span><span style = \"font-style:italic;\">\u2018\u2018Collapsed rate class,\u2019\u2019 <\/span><span>but there is no corrective action that needs to be taken. These messages simply point to <\/span><span style = \"font-style:italic;\">low-complexity <\/span><span>data.<\/span><\/div><br\/><div class = \"text-block\"><span>We will additionally take this opportunity to showcase the visual power of our accompanying web browser, HyPhy-Vision. Figure 1 displays the rendering of the output <\/span><span style = \"font-style:italic;\">ksr2.fna.BUSTED.json<\/span><span> as it appears in HyPhy-Vision. On this site, users can interactively view and explore inference results, view figures and charts, and perform other tasks.<\/span><\/div><br\/><div style = \"text-align :; float : ;\"><img style = \"\" src = \"https:\/\/s3.amazonaws.com\/protocols-files\/files\/ebhaba7dp.jpg\" \/><\/div><br\/><div class = \"text-block\">Rules of Thumb for BUSTED Use<\/div><br\/><div class = \"text-block\"><ol style = \"list-style-type: decimal;\"><li style = \"counter-reset:ol0;\">Best applied to small- or medium-sized datasets (e.g., up to 100 sequences). Larger datasets will take longer to run and may not be well described by a fixed complexity model.<\/li><li style = \"counter-reset:ol0;\">If one suspects that only a small subset of lineages is subject to selection, e.g., because the phenotype, environment, or fitness changed along those branches, designating those a priori as the test set will significantly boost power.<\/li><li style = \"counter-reset:ol0;\"><span>In simulation studies, BUSTED performs best when a sufficient proportion (5\u201310%) of branch site combinations is subject to positive diversifying selection, and the effect size (<\/span><span style = \"font-style:italic;\">\u03c9 <\/span><span>value) is reasonably large (e.g., \u2265\u20093).<\/span><\/li><\/ol><\/div><\/div>","created_on":0,"changed_on":0,"creator":{"name":"","affiliation":null,"affiliations":[],"username":"","note":null,"link":null,"image":{"source":"","placeholder":""},"badges":[],"verified":0,"is_verified_user":false,"research_interests":null,"blocked_by_you":false,"blocked_you":false,"hide_following":false},"comments":[]}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#94EBFF","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1114171,"guid":"58534D9060BA11EB8967637CBE246260","previous_id":1114169,"previous_guid":"9E1318C060B911EB8967637CBE246260","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"B0C329D0033E43FAA975ABC355C93BFA","order_id":1,"type_id":6,"title":"Section","source":{"title":"3.3 RELAX"}},{"id":1054724,"guid":"73AD8923147B4FBB8AA7D613CA849AA7","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><br\/><br\/><\/div>"}},{"id":1054725,"guid":"2EC1CD20AF224D08A4A29A66277FD4EE","order_id":2,"type_id":26,"title":"notes","source":{"id":0,"parent_id":0,"uri":"","title":"","body":"<div class = \"text-blocks\"><div class = \"text-block\"><span style = \"font-weight:bold;\">What Biological Question Is the Method Designed to Answer?<\/span><\/div><br\/><div class = \"text-block\"><span>Is there evidence that the strength of selection has been relaxed (or conversely intensified) on a specified group of lineages (<\/span><span style = \"font-style:italic;\">Test<\/span><span>) relative to a set of reference lineages (<\/span><span style = \"font-style:italic;\">Reference<\/span><span>)? We note that the RELAX framework can perform this specific hypothesis test as well as fit a suite of descriptive models which address, for example, overall rate differences between test and reference branches or lineage-specific inferences of selection relaxation. We focus our attention here on RELAX\u2019s hypothesis testing abilities. More information about descriptive analyses is available on <\/span><a href=\"http:\/\/hyphy.org\" style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;:UNDERLINE;\">hyphy.org<\/span><\/a><span style = \":;:UNDERLINE;\"> <\/span><span>as well as in RELAX\u2019s primary publication [43]. Importantly, RELAX <\/span><span style = \"font-style:italic;\">is not <\/span><span>designed to detect diversifying selection specifically.<\/span><\/div><br\/><div class = \"text-block\">Recommended Applications<\/div><div class = \"text-block\"><ol style = \"list-style-type: decimal;\"><li style = \"counter-reset:ol0;\"><span>Testing for a <\/span><span style = \"font-weight:bold;\">systematic shift <\/span><span>(relaxation\/intensification) in the distribution of selection pressure associated with major biological transitions such as hosting switching in viruses [6] or lifestyle evolution in bacteria (i.e., transition from free-living to endosymbiotic lifestyle [43]).<\/span><\/li><li style = \"counter-reset:ol0;\"><span style = \"font-weight:bold;\">Comparing selective regimes <\/span><span>between two subsets of branches in the tree, e.g., to investigate selective differences among transmission routes in HIV-1 [42].<\/span><\/li><\/ol><\/div><\/div>","created_on":0,"changed_on":0,"creator":{"name":"","affiliation":null,"affiliations":[],"username":"","note":null,"link":null,"image":{"source":"","placeholder":""},"badges":[],"verified":0,"is_verified_user":false,"research_interests":null,"blocked_by_you":false,"blocked_you":false,"hide_following":false},"comments":[]}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#84CE84","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1114172,"guid":"8B03609060BA11EB8967637CBE246260","previous_id":1114171,"previous_guid":"58534D9060BA11EB8967637CBE246260","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"BA8033EE0CA9489AAF5CF5ABB8EF5695","order_id":1,"type_id":6,"title":"Section","source":{"title":"3.3 RELAX"}},{"id":1054724,"guid":"7E0509AF14DC43589D1BD9248ABC222C","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><br\/><br\/><\/div>"}},{"id":1054725,"guid":"44396E2FEF3E439FB5D1B3C86BD0F757","order_id":2,"type_id":26,"title":"notes","source":{"id":0,"parent_id":0,"uri":"","title":"","body":"<div class = \"text-blocks\"><div class = \"text-block\"><span style = \"font-weight:bold;\">Statistical Test Procedure<\/span><\/div><br\/><div class = \"text-block\"><span>Given a tree with at least two sets of branches, one of which is designated as <\/span><span style = \"font-style:italic;\">Test<\/span><span>, and the other as <\/span><span style = \"font-style:italic;\">Reference<\/span><span>, the core version of RELAX compares two nested models, which follow the same general framework as BUSTED. Each (branch, site) combination is drawn independently from a 3-rate <\/span><span style = \"font-style:italic;\">\u03c9 <\/span><span>distribution. The evolutionary rates for <\/span><span style = \"font-style:italic;\">Test <\/span><span>branches are functions of those for <\/span><span style = \"font-style:italic;\">Reference <\/span><span>branches. Specifically, <\/span><a href=\"#\" style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\"> <\/span><\/a><span> , where <\/span><span style = \"font-style:italic;\">K <\/span><span>is the relaxation or intensification parameter. The alternative model infers <\/span><span style = \"font-style:italic;\">K <\/span><span>from the data, and the null model sets <\/span><span style = \"font-style:italic;\">K<\/span><span>\u2009=\u20091. Statistical significance is obtained by the likelihood ratio test, assuming the <\/span><a href=\"#\" style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \"font-style:italic;\"> <\/span><\/a><span>  asymptotic distribution under the null model. A significant result of <\/span><span style = \":;\">K<\/span><span>\u2009>\u20091 indicates that selection strength has been <\/span><span style = \"font-style:italic;\">intensified <\/span><span>along the test branches, and a significant result of <\/span><span style = \"font-style:italic;\">K<\/span><span>\u2009<\u20091 indicates that selection strength has been  <\/span><span style = \"font-style:italic;\">relaxed <\/span><span>along the test branches. In other words, for <\/span><span style = \"font-style:italic;\">K<\/span><span>\u2009<\u20091 the <\/span><span style = \"font-style:italic;\">Test \u03c9 <\/span><span>values shrink toward neutrality (<\/span><span style = \"font-style:italic;\">\u03c9<\/span><span>\u2009=\u20091) relative to <\/span><span style = \"font-style:italic;\">Reference<\/span><span>, and for <\/span><span style = \"font-style:italic;\">K<\/span><span>\u2009>\u20091 they move away from neutrality.<\/span><\/div><div style = \"text-align :; float : ;\"><span style = \"\">\u03c9_{Test}=\u03c9^K_{Reference}<\/span><\/div><div style = \"text-align :; float : ;\"><span style = \"\">\u03c7^2_1<\/span><\/div><br\/><div class = \"text-block\"><span>If some branches in the tree belong to neither the <\/span><span style = \"font-style:italic;\">T<\/span><span>est or the <\/span><span style = \"font-style:italic;\">R<\/span><span>eference set, they are allocated to a group with its own (<\/span><span style = \"font-style:italic;\">Unclassified<\/span><span>) distribution of <\/span><span style = \"font-style:italic;\">\u03c9<\/span><span>, which is uncoupled from the testing procedure.<\/span><\/div><\/div>","created_on":0,"changed_on":0,"creator":{"name":"","affiliation":null,"affiliations":[],"username":"","note":null,"link":null,"image":{"source":"","placeholder":""},"badges":[],"verified":0,"is_verified_user":false,"research_interests":null,"blocked_by_you":false,"blocked_you":false,"hide_following":false},"comments":[]}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#84CE84","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1114173,"guid":"0F5B88E060BB11EB8967637CBE246260","previous_id":1114172,"previous_guid":"8B03609060BA11EB8967637CBE246260","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"D3B993A564AF469D932624DC54C31B48","order_id":1,"type_id":6,"title":"Section","source":{"title":"3.3 RELAX"}},{"id":1054724,"guid":"F8E79F86EFCD44909C7FD9D863A9DEB0","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><br\/><br\/><div class = \"text-block\"><span>To run RELAX, open a terminal session and enter <\/span><span style = \"font-style:italic;\">HYPHYMP <\/span><span>from the command line to launch the HyPhy analysis menu. Enter <\/span><span style = \"font-style:italic;\">1 <\/span><span>(Selection Analyses) and then <\/span><span style = \"font-style:italic;\">7 <\/span><span>to reach the RELAX analysis menu, and supply values for the following prompts:<\/span><\/div><br\/><div class = \"text-block\"><ol style = \"list-style-type: decimal;\"><li style = \"counter-reset:ol0;\"><span style = \"font-weight:bold;\">Choose genetic code. <\/span><span>Enter <\/span><span style = \"font-style:italic;\">1<\/span><span> to use the Universal genetic code.<\/span><\/li><li style = \"counter-reset:ol0;\"><span style = \"font-weight:bold;\">Select a coding sequence alignment file. <\/span><span>Provide the full path to the dataset of interest:          <\/span><span style = \"font-style:italic;\">\/path\/to\/data\/pb2.fna<\/span><span style = \"font-style:italic;\">.<\/span><\/li><li style = \"counter-reset:ol0;\"><span style = \"font-weight:bold;\">A tree was found in the data file\u2026Would you like to use it (y\/n)? <\/span><span>Enter \u201cy\u201d to use the tree.<\/span><\/li><li style = \"counter-reset:ol0;\"><span style = \"font-weight:bold;\">Choose the set of branches to test for selection. <\/span><span>This option asks you to specify the <\/span><span style = \"font-style:italic;\">label <\/span><span>inside your tree used to specify the test lineages. You can either select all unlabeled branches, or HyPhy will show all labels it found in the tree you provided. Enter1to select the branches labeled as \u201ctest\u201d as the test set in RELAX analysis. Note that when multiple labels are present in your tree, HyPhy will issue an additional prompt to choose the set of <\/span><span style = \"font-style:italic;\">Reference <\/span><span>branches, in the event that some branches should remain <\/span><span style = \"font-style:italic;\">Unclassified<\/span><span>.<\/span><\/li><li style = \"counter-reset:ol0;\"><span style = \"font-weight:bold;\">Analysis type. <\/span><span>This option asks you to specify the scope of RELAX analysis. Selecting \u201cMinimal\u201d will run the RELAX hypothesis test, and selecting \u201cAll\u201d will run hypothesis testing and fit two additional descriptive models, described earlier. Here, we will perform only hypothesis testing to determine whether the data shows evidence for a relaxation or intensification of selection intensity between the test and reference lineages. Enter the option <\/span><span style = \"font-style:italic;\">2<\/span><span> to run the \u201cMinimal\u201d analysis.<\/span><\/li><\/ol><\/div><br\/><div class = \"text-block\">RELAX will now run to completion, printing status indicators to screen while it runs.<\/div><\/div>"}},{"id":1054725,"guid":"E0C6B01687564F34B6C30C980966CD93","order_id":2,"type_id":26,"title":"notes","source":{"id":0,"parent_id":0,"uri":"","title":"","body":"<div class = \"text-blocks\"><div class = \"text-block\"><span style = \"font-weight:bold;\">Example Analysis<\/span><\/div><br\/><div class = \"text-block\"><span>We will perform a RELAX analysis using a dataset of Influenza A PB2 subunit sequences from Tamuri et al. [41]. The PB2 subunit, which is part of influenza\u2019s RNA polymerase complex, has emerged as a critical determinant of influenza infectivity and, as a consequence, host range [9, 18]. The dataset we examine here contains sequences from both avian host and human host strains (<\/span><span style = \"font-style:italic;\">see<\/span><span> footnote 4). Previous studies have shown that this host switch is correlated with significant shifts in selection pressures and preferred amino acids at key sites in PB2 [36, 40, 41]. We now re-analyze this dataset using RELAX to ask a different but related question: \u201cWas the shift from avian to human hosts associated with a relaxation of selection pressures in Influenza A PB2?\u201d<\/span><\/div><br\/><div class = \"text-block\"><span>RELAX requires an a priori specification of test and reference lineages, although not all lineages in a tree need to be classified. As such, you must label your test (and reference, if desired) branches in the input phylogeny. We provide an online widget to assist with tree labeling at <\/span><a href=\"http:\/\/phylotree.hyphy.org\" style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;:UNDERLINE;\">http:\/\/phylotree.hyphy.org<\/span><\/a><span>. The dataset we have provided for this analysis already has a labeled phylogeny, with the human host lineages labeled as \u201ctest.\u201d<\/span><\/div><\/div>","created_on":0,"changed_on":0,"creator":{"name":"","affiliation":null,"affiliations":[],"username":"","note":null,"link":null,"image":{"source":"","placeholder":""},"badges":[],"verified":0,"is_verified_user":false,"research_interests":null,"blocked_by_you":false,"blocked_you":false,"hide_following":false},"comments":[]}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#84CE84","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1114174,"guid":"7A00685060BB11EB8967637CBE246260","previous_id":1114173,"previous_guid":"0F5B88E060BB11EB8967637CBE246260","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"EAADA6F04CF04A4F9879DE4E3E13CCD7","order_id":1,"type_id":6,"title":"Section","source":{"title":"3.3 RELAX"}},{"id":1054724,"guid":"19FA876A886B4185B1ED8E133B7222A6","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Listing 2 Partial RELAX screen output<\/div><br\/><div class = \"text-block\"><pre><code><div class = \"text-blocks\"><div class = \"text-block\">### \u00a0 Obtaining \u00a0 branch \u00a0 lengths \u00a0 and\u00a0nucleotide\u00a0substitution\u00a0biases\u00a0under\u00a0the\u00a0nucleotide\u00a0GTR\u00a0model\n* \u00a0 Log ( L ) \u00a0 = \u00a0 -16755.26, \u00a0 AIC - c \u00a0 = \u00a0 33660.66\u00a0(75\u00a0estimated\u00a0parameters)<\/div><br\/><div class = \"text-block\">### \u00a0 Obtaining \u00a0 the \u00a0 global \u00a0 omega \u00a0estimate\u00a0based\u00a0on\u00a0relative\u00a0GTR\u00a0branch\u00a0lengths\u00a0and\u00a0nucleotide\u00a0substitution\u00a0biases\n* \u00a0 Log ( L ) \u00a0 = \u00a0 -14410.97, \u00a0 AIC - c \u00a0 = \u00a0 28988.46\u00a0(83\u00a0estimated\u00a0parameters)\n* \u00a0 non - synonymous \/ synonymous \u00a0 rate\u00a0ratio\u00a0for\u00a0*Reference*\u00a0=\u00a0\u00a0\u00a00.0401\n* \u00a0 non - synonymous \/ synonymous \u00a0 rate\u00a0ratio\u00a0for\u00a0*Test*\u00a0=\u00a0\u00a0\u00a00.0604<\/div><br\/><div class = \"text-block\">### \u00a0 Improving \u00a0 branch \u00a0 lengths , \u00a0 nucleotide\u00a0substitution\u00a0biases,\u00a0and\u00a0global\u00a0dN\/dS\u00a0ratios\u00a0under\u00a0a\u00a0full\u00a0codon\u00a0model\n* \u00a0 Log ( L ) \u00a0 = \u00a0 -14354.67, \u00a0 AIC - c \u00a0 = \u00a0 28875.86\u00a0(83\u00a0estimated\u00a0parameters)\n* \u00a0 non - synonymous \/ synonymous \u00a0 rate\u00a0ratio\u00a0for\u00a0*Reference*\u00a0=\u00a0\u00a0\u00a00.0358\n* \u00a0 non - synonymous \/ synonymous \u00a0 rate\u00a0ratio\u00a0for\u00a0*Test*\u00a0=\u00a0\u00a0\u00a00.0609<\/div><br\/><div class = \"text-block\">### \u00a0 Fitting \u00a0 the \u00a0 alternative \u00a0 model\u00a0to\u00a0test\u00a0K\u00a0!=\u00a01\n* \u00a0 Log ( L ) \u00a0 = \u00a0 -14337.22, \u00a0 AIC - c \u00a0 = \u00a0 28849.02\u00a0(87\u00a0estimated\u00a0parameters)\n* \u00a0 Relaxation \/ intensification \u00a0 parameter\u00a0(K)\u00a0=\u00a0\u00a0\u00a0\u00a0\u00a00.73\n* \u00a0 The \u00a0 following \u00a0 rate \u00a0 distribution\u00a0was\u00a0inferred\u00a0for\u00a0**test**\u00a0branches<\/div><br\/><div class = \"text-block\">| \u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 Selection mode \u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a0dN\/dS\u00a0\u00a0\u00a0\u00a0\u00a0|Proportion,\u00a0%|Notes\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0|\n|---------------------------------|--------------|-------------|--------------------|\n| \u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 Negative selection \u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a00.031\u00a0\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a094.752\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0|\n| \u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 Negative selection \u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a00.086\u00a0\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a02.951\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0|\n| \u00a0 \u00a0 Diversifying selection \u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a01.406\u00a0\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a02.297\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0|<\/div><br\/><div class = \"text-block\">* \u00a0 The \u00a0 following \u00a0 rate \u00a0 distribution\u00a0was\u00a0inferred\u00a0for\u00a0**reference**\u00a0branches<\/div><br\/><div class = \"text-block\">| \u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 Selection mode \u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a0dN\/dS\u00a0\u00a0\u00a0\u00a0\u00a0|Proportion,\u00a0%|\u00a0\u00a0Notes\u00a0 \u00a0\u00a0\u00a0\u00a0 |\n|---------------------------------|--------------|-------------|--------------------|\n| \u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 Negative selection \u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a00.009\u00a0\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a094.752\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0|\n| \u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 Negative selection \u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a00.035\u00a0\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a02.951\u00a0\u00a0\u00a0\u00a0| \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0|\n| \u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0 Diversifying selection \u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a01.591\u00a0\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a02.297\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0|<\/div><br\/><div class = \"text-block\">### \u00a0 Fitting \u00a0 the \u00a0 null \u00a0 ( K \u00a0 := \u00a0 1) \u00a0 model\n* \u00a0 Log ( L ) \u00a0 = \u00a0 -14342.33, \u00a0 AIC - c \u00a0 = \u00a0 28857.22\u00a0(86\u00a0estimated\u00a0parameters)\n* \u00a0 The \u00a0 following \u00a0 rate \u00a0 distribution\u00a0for\u00a0test\/reference\u00a0branches\u00a0was\u00a0inferred<\/div><br\/><div class = \"text-block\">| \u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 Selection mode \u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a0dN\/dS\u00a0\u00a0\u00a0\u00a0\u00a0|Proportion,\u00a0%|Notes\u00a0\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0|\n|---------------------------------|--------------|-------------|--------------------|\n| \u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 Negative selection \u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a00.010\u00a0\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a094.149\u00a0\u00a0\u00a0\u00a0| \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0|\n| \u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 Negative selection \u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a00.021\u00a0\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a03.391\u00a0\u00a0\u00a0\u00a0| \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0|\n| \u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0 Diversifying selection \u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a01.735\u00a0\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a02.460\u00a0\u00a0\u00a0\u00a0| \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0|<\/div><br\/><div class = \"text-block\">----\n## \u00a0 Test \u00a0 for \u00a0 relaxation \u00a0 ( or \u00a0 intensification)\u00a0of\u00a0selection\u00a0[RELAX]\nLikelihood \u00a0 ratio \u00a0 test \u00a0 ** p \u00a0 = \u00a0 \u00a0\u00a0 0.0014**.\n> Evidence \u00a0 for \u00a0 * relaxation \u00a0 of \u00a0 selection*\u00a0among\u00a0**test**\u00a0branches\u00a0_relative_\u00a0to\u00a0the\u00a0**reference**\u00a0branches\u00a0at\u00a0P<=0.05\n---- \u2003<\/div><\/div><\/code><\/pre><\/div><br\/><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#84CE84","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1114175,"guid":"CE95646060BB11EB8967637CBE246260","previous_id":1114174,"previous_guid":"7A00685060BB11EB8967637CBE246260","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"60EC1D629ECA481589901B98559A5286","order_id":1,"type_id":6,"title":"Section","source":{"title":"3.3 RELAX"}},{"id":1054724,"guid":"594F1A4DAE1A43A69A6B99B2C8E9D3F1","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><br\/><br\/><\/div>"}},{"id":1054725,"guid":"B03F5C9A25BD4612991F11F787865618","order_id":2,"type_id":26,"title":"notes","source":{"id":0,"parent_id":0,"uri":"","title":"","body":"<div class = \"text-blocks\"><div class = \"text-block\"><span style = \"font-weight:bold;\">Interpreting Results<\/span><\/div><br\/><div class = \"text-block\"><span>On this data, RELAX has inferred a relaxation parameter <\/span><span style = \"font-style:italic;\">K<\/span><span>\u2009=\u20090.73 with a highly significant <\/span><span style = \"font-style:italic;\">P<\/span><span>\u2009=\u20090.0014. Therefore, there is evidence to reject the null hypothesis that selection pressure has not been shifted in the test (here, human host) lineages. We instead have strong evidence that selection has been <\/span><span style = \"font-style:italic;\">relaxed <\/span><span>(because the inferred <\/span><span style = \"font-style:italic;\">K<\/span><span>\u2009<\u20091) in the human host lineages. In other words, selection in the test branches has generally moved towards neutrality (<\/span><span style = \"font-style:italic;\">\u03c9<\/span><span>\u2009=\u20091) compared to the reference branches. This finding is consistent with the evolutionary changes that typically occur during a virus host-switching event, wherein selection stringency will be reduced to facilitate viral adaptation.<\/span><\/div><br\/><div class = \"text-block\"><span>Keep in mind that RELAX defines relaxation (or intensification) in a fairly restrictive fashion. In other words, all selective regimes (i.e., all <\/span><span style = \"font-style:italic;\">\u03c9 <\/span><span>rates), both negative and positive, must weaken or strengthen. Therefore, certain relaxation scenarios, for example, when only positive selection is relaxed but negative selection is maintained, may result in a non-significant RELAX test even though selection has changed.<\/span><\/div><br\/><div class = \"text-block\">Rules of Thumb for RELAX Use<\/div><br\/><div class = \"text-block\"><ol style = \"list-style-type: decimal;\"><\/ol><\/div><\/div>","created_on":0,"changed_on":0,"creator":{"name":"","affiliation":null,"affiliations":[],"username":"","note":null,"link":null,"image":{"source":"","placeholder":""},"badges":[],"verified":0,"is_verified_user":false,"research_interests":null,"blocked_by_you":false,"blocked_you":false,"hide_following":false},"comments":[]}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#84CE84","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1114176,"guid":"028179D060BC11EB8967637CBE246260","previous_id":1114175,"previous_guid":"CE95646060BB11EB8967637CBE246260","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"11108290ECD44F12991EA137FAEA5937","order_id":1,"type_id":6,"title":"Section","source":{"title":"3.4 aBSREL"}},{"id":1054724,"guid":"4305167D2A134518B3C59A8ED7C50A1D","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><br\/><br\/><\/div>"}},{"id":1054725,"guid":"06426622675147F5BB1DEFDB9B30F541","order_id":2,"type_id":26,"title":"notes","source":{"id":0,"parent_id":0,"uri":"","title":"","body":"<div class = \"text-blocks\"><div class = \"text-block\"><span>It is often of interest to determine whether a specific lineage or lineage(s) have been subject to selection. Such analyses have historically been performed using the so-called branch or branch-site class of models, which allow evolutionary rates to vary across branches or across sites <\/span><span style = \"font-weight:bold;\">and <\/span><span>branches [16, 45, 46]. Early versions of branch-site models allowed users to compare selection pressure on a pre-selected branch sets of \u201cforeground\u201d branches to a pre-selected set of \u201cbackground\u201d branches, on which positive selection was disallowed [45,46]. (Note that this approach is similar to how BUSTED performs gene-wide selection inference [26].) Later efforts demonstrated that disallowing positive selection on background branches could lead to highly elevated false positive rates and advocated a strategy wherein any branch, regardless of data partition, could evolve at any rate [16]. This strategy has been described as the BS-REL model in HyPhy [16]. However, in BS-REL, each branch was constrained to have three rate categories, an assumption with little justification.<\/span><\/div><br\/><div class = \"text-block\">Since then, we have developed a greatly improved branch-site model called aBSREL (\u201cadaptive branch-site random effects likelihood\u201d). Rather than assuming that each branch should be fit with three rate classes, aBSREL infers, using small-sample Akaike Information Criterion correction (AICc), the optimal number of rate categories per branch. In this manner, computational complexity and the number of parameters are greatly reduced, leading to a tractable runtime for larger datasets that could not otherwise be studied with earlier branch-site models.<\/div><\/div>","created_on":0,"changed_on":0,"creator":{"name":"","affiliation":null,"affiliations":[],"username":"","note":null,"link":null,"image":{"source":"","placeholder":""},"badges":[],"verified":0,"is_verified_user":false,"research_interests":null,"blocked_by_you":false,"blocked_you":false,"hide_following":false},"comments":[]}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#FFED92","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1114177,"guid":"1E28CA8060BC11EB8967637CBE246260","previous_id":1114176,"previous_guid":"028179D060BC11EB8967637CBE246260","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"D651254A14F646AD925C55EFC7F9ADE3","order_id":1,"type_id":6,"title":"Section","source":{"title":"3.4 aBSREL"}},{"id":1054724,"guid":"5D94B6D4D3AD438E88F763B53E689639","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><br\/><br\/><\/div>"}},{"id":1054725,"guid":"2996EB73600A4C31B7A8AB539171F3A7","order_id":2,"type_id":26,"title":"notes","source":{"id":0,"parent_id":0,"uri":"","title":"","body":"<div class = \"text-blocks\"><div class = \"text-block\"><span style = \"font-weight:bold;\">What Biological Question Is the Method Designed to Answer?<\/span><\/div><br\/><div class = \"text-block\">Like classical branch-site models, aBSREL asks whether some proportion of sites is subject to positive selection along specific branches or lineages of a phylogeny.<\/div><br\/><div class = \"text-block\">Recommended Applications<\/div><br\/><div class = \"text-block\"><ol style = \"list-style-type: decimal;\"><li style = \"counter-reset:ol0;\"><span style = \"font-weight:bold;\">Exploratory testing <\/span><span>for evidence of lineage-specific positive diversifying selection in small- to medium-sized alignments (up to 100 sequences).<\/span><\/li><li style = \"counter-reset:ol0;\"><span style = \"font-weight:bold;\">Targeted testing <\/span><span>of branches selected a priori for positive diversifying selection. This includes alignments with prohibitive runtimes under older branch-site models (up to \u223c1000 sequences) [37].<\/span><\/li><\/ol><\/div><\/div>","created_on":0,"changed_on":0,"creator":{"name":"","affiliation":null,"affiliations":[],"username":"","note":null,"link":null,"image":{"source":"","placeholder":""},"badges":[],"verified":0,"is_verified_user":false,"research_interests":null,"blocked_by_you":false,"blocked_you":false,"hide_following":false},"comments":[]}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#FFED92","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1114178,"guid":"365D148060BC11EB8967637CBE246260","previous_id":1114177,"previous_guid":"1E28CA8060BC11EB8967637CBE246260","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"B5FA61AF7B9942BC98AC921100CB1C5B","order_id":1,"type_id":6,"title":"Section","source":{"title":"3.4 aBSREL"}},{"id":1054724,"guid":"7DD21FFE45B449EBAA3461CF926F9E74","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><br\/><br\/><\/div>"}},{"id":1054725,"guid":"7156EAAD1CA44136BD71AB2D1113B4FB","order_id":2,"type_id":26,"title":"notes","source":{"id":0,"parent_id":0,"uri":"","title":"","body":"<div class = \"text-blocks\"><div class = \"text-block\"><span style = \"font-weight:bold;\">Statistical Test Procedure<\/span><\/div><br\/><div class = \"text-block\"><span>aBSREL uses the information-theoretic criterion AIC<\/span><span style = \"vertical-align:sub;font-style:italic;\">c <\/span><span>to automatically determine the complexity of the evolutionary process at every branch [37]. As a heuristic optimization, aBSREL will always examine branches in order from longest to shortest, because longer branches tend to be the ones requiring more complex models. In this adaptive model, one rate class is allowed to assume any value of <\/span><span style = \"font-style:italic;\">\u03c9<\/span><span>\u2009>\u20091, whereas for any other inferred rate class is constrained as <\/span><span style = \"font-style:italic;\">\u03c9<\/span><span>\u2009\u2264\u20091. In the null model, all <\/span><span style = \"font-style:italic;\">\u03c9 <\/span><span>categories are constrained as <\/span><span style = \"font-style:italic;\">\u03c9<\/span><span>\u2009\u2264\u20091. For any branch inferred to have sufficient rate variation (i.e., more than one rate category) where one rate category is described by <\/span><span style = \"font-style:italic;\">\u03c9<\/span><span>\u2009>\u20091, aBSREL will proceed to fit a null model to this branch. In other words, if the maximum-inferred <\/span><span style = \"font-style:italic;\">\u03c9<\/span><span>\u2009\u2264\u20091 on a branch, the null model will have the same exact fit as the alternative model, and the resulting <\/span><span style = \"font-style:italic;\">P<\/span><span>-value is 1. The test for lineage-specific diversifying selection is performed by comparing the full model versus the nested null model, and statistical significance is obtained by the likelihood ratio test. Significance is evaluated using a mixture of <\/span><a href=\"#\" style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\"> <\/span><\/a><span>, <\/span><a href=\"#\" style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\"> <\/span><\/a><span>, and <\/span><a href=\"#\" style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\"> <\/span><\/a><span> distributions (proportions determined via simulations Smith et al. [37]). Finally, aBSREL will correct all <\/span><span style = \"font-style:italic;\">P<\/span><span>-values obtained from individual tests for multiple comparisons using the Bonferroni\u2013Holm procedure to control family-wise false-positive rates (i.e., the probability of generating one or more false positives, when all null hypotheses are correct).<\/span><\/div><div style = \"text-align :; float : ;\"><span style = \"\">50\\%\u03c7^2_0<\/span><\/div><div style = \"text-align :; float : ;\"><span style = \"\">20\\%\u03c7^2_1<\/span><\/div><div style = \"text-align :; float : ;\"><span style = \"\">30\\%\u03c7^2_2<\/span><\/div><br\/><div class = \"text-block\">One can either select a specific set of branches in order to test a specific a priori hypothesis or one can perform an exploratory analysis across the entire phylogeny by testing all branches for selection. The former approach may have substantially more power to detect selection, especially if only a few branches in a large tree are chosen, due to the decreased volume of multiple testing. However, the approach does carry the risk of failing to identify branches subject to positive selection that have not been included in the test set.<\/div><\/div>","created_on":0,"changed_on":0,"creator":{"name":"","affiliation":null,"affiliations":[],"username":"","note":null,"link":null,"image":{"source":"","placeholder":""},"badges":[],"verified":0,"is_verified_user":false,"research_interests":null,"blocked_by_you":false,"blocked_you":false,"hide_following":false},"comments":[]}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#FFED92","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1114179,"guid":"C6BB3D9060BC11EB96D2EBAE0011895C","previous_id":1114178,"previous_guid":"365D148060BC11EB8967637CBE246260","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"E5164EB2704D4DF7AD6A5281C26EDAF3","order_id":1,"type_id":6,"title":"Section","source":{"title":"3.4 aBSREL"}},{"id":1054724,"guid":"E3BC2E00B1C5410B8BD22FD5498E2546","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><br\/><br\/><div class = \"text-block\"><span>To run aBSREL, open a terminal session and enter <\/span><span style = \"font-style:italic;\">HYPHYMP <\/span><span>from the command line to launch the HyPhy analysis menu. Enter <\/span><span style = \"font-style:italic;\">1 <\/span><span>(Selection Analyses) and then <\/span><span style = \"font-style:italic;\">6 <\/span><span>to reach the aBSREL analysis menu, and supply values for the following prompts:<\/span><\/div><br\/><div class = \"text-block\"><ol style = \"list-style-type: decimal;\"><li style = \"counter-reset:ol0;\"><span style = \"font-weight:bold;\">Choose genetic code. <\/span><span>This option tells HyPhy which translation table to use for codon-level analyses. Enter <\/span><span style = \"font-style:italic;\">1 <\/span><span>to use the Universal genetic code.<\/span><\/li><li style = \"counter-reset:ol0;\"><span style = \"font-weight:bold;\">Select a coding sequence alignment file. <\/span><span>Provide the full path to the dataset of interest: <\/span><span style = \"font-style:italic;\">\/path\/to\/hiv1_transmission.fna<\/span><span style = \"font-style:italic;\">.<\/span><\/li><li style = \"counter-reset:ol0;\"><span style = \"font-weight:bold;\">A tree was found in the data file\u2026Would you like to use it (y\/n)? <\/span><span>Enter \u201cy\u201d to use the included tree.<\/span><\/li><li style = \"counter-reset:ol0;\"><span style = \"font-weight:bold;\">Choose the set of branches to test for selection. <\/span><span>You can now select on which branches aBSREL should conduct a formal hypothesis test for positive selection. Enter <\/span><span style = \"font-style:italic;\">1<\/span><span> to test all branches for selection.<\/span><\/li><\/ol><\/div><br\/><div class = \"text-block\">aBSREL will now run to completion, printing status indicators to screen while it runs (some output abbreviated).<\/div><\/div>"}},{"id":1054725,"guid":"74FAE0DB160A4A93AFFD19D95F331B6A","order_id":2,"type_id":26,"title":"notes","source":{"id":0,"parent_id":0,"uri":"","title":"","body":"<div class = \"text-blocks\"><div class = \"text-block\"><span style = \"font-weight:bold;\">Example Analysis<\/span><\/div><br\/><div class = \"text-block\"><span>Here, we will demonstrate aBSREL use and interpretation using a dataset of HIV-1 <\/span><span style = \"font-style:italic;\">env <\/span><span>sequences collected from an epidemiologically linked donor\u2013recipient transmission pair [7]. This dataset can be found in the provided file<\/span><span style = \"font-style:italic;\"> hiv1_transmission.fna<\/span><span>.<\/span><\/div><\/div>","created_on":0,"changed_on":0,"creator":{"name":"","affiliation":null,"affiliations":[],"username":"","note":null,"link":null,"image":{"source":"","placeholder":""},"badges":[],"verified":0,"is_verified_user":false,"research_interests":null,"blocked_by_you":false,"blocked_you":false,"hide_following":false},"comments":[]}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#FFED92","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1114180,"guid":"1B75EA1060BD11EB96D2EBAE0011895C","previous_id":1114179,"previous_guid":"C6BB3D9060BC11EB96D2EBAE0011895C","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"13F478B892BB4F20BB1C520D76876002","order_id":1,"type_id":6,"title":"Section","source":{"title":"3.4 aBSREL"}},{"id":1054724,"guid":"95CACDB56155491E84CCF1485B86492D","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Listing 3 Partial aBSREL screen output<\/div><br\/><div class = \"text-block\"><pre><code><div class = \"text-blocks\"><div class = \"text-block\">### \u00a0 Obtaining \u00a0 branch \u00a0 lengths \u00a0 and\u00a0nucleotide\u00a0substitution\u00a0biases\u00a0under\u00a0the\u00a0nucleotide\u00a0GTR\u00a0model\n* \u00a0 Log ( L ) \u00a0 = \u00a0 -5524.50, \u00a0 AIC - c \u00a0 = \u00a0 11153.08\u00a0(52\u00a0estimated\u00a0parameters)<\/div><br\/><div class = \"text-block\">### \u00a0 Fitting \u00a0 the \u00a0 baseline \u00a0 model \u00a0with\u00a0a\u00a0single\u00a0dN\/dS\u00a0class\u00a0per\u00a0branch,\u00a0and\u00a0no\u00a0site-to-site\u00a0variation.\n* \u00a0 Log ( L ) \u00a0 = \u00a0 -5402.40, \u00a0 AIC - c \u00a0 = \u00a0 11009.72\u00a0(102\u00a0estimated\u00a0parameters)\n* \u00a0 Branch - level \u00a0 non - synonymous \/ synonymous\u00a0rate\u00a0ratio\u00a0distribution\u00a0has\u00a0median\u00a0\u00a00.66,\u00a0and\u00a095%\u00a0of\u00a0the\u00a0weight\u00a0in\u00a0\u00a00.00--5.41<\/div><br\/><div class = \"text-block\">### \u00a0 Determining \u00a0 the \u00a0 optimal \u00a0 number\u00a0of\u00a0rate\u00a0classes\u00a0per\u00a0branch\u00a0using\u00a0a\u00a0step\u00a0up\u00a0procedure<\/div><br\/><div class = \"text-block\">| \u00a0 \u00a0\u00a0 Branch | Length \u00a0 | \u00a0 \u00a0 Rates\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a0Max.\u00a0dN\/dS\u00a0\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0Log(L)\u00a0\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a0AIC-c\u00a0\u00a0\u00a0\u00a0\u00a0|Best AIC-c so far|\n|-----------|-------|-----|------------------|------------|---------|-----------------|\n| \u00a0 \u00a0\u00a0 0564 _22| \u00a0 \u00a0\u00a0 0.01 \u00a0 \u00a0\u00a0 | \u00a0 \u00a0\u00a0\u00a0 2 \u00a0 \u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a01.96\u00a0(52.27%)\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0-5402.41\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a011013.78\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a011009.72\u00a0\u00a0\u00a0\u00a0\u00a0|\n| \u00a0 \u00a0\u00a0 0564 _7 \u00a0 \u00a0\u00a0\u00a0 | \u00a0 \u00a0\u00a0 0.01 \u00a0 \u00a0\u00a0 | \u00a0 \u00a0\u00a0\u00a0 2 \u00a0 \u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a00.74\u00a0(\u00a05.19%)\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0-5402.40\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a011013.76\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a011009.72\u00a0\u00a0\u00a0\u00a0\u00a0|\n| \u00a0 \u00a0 Separator \u00a0 \u00a0 | \u00a0 \u00a0\u00a0 0.01 \u00a0 \u00a0\u00a0 | \u00a0 \u00a0\u00a0\u00a0 2 \u00a0 \u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0197.32\u00a0(\u00a03.95%)\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0-5397.53\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a011004.02\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a011004.02\u00a0\u00a0\u00a0\u00a0\u00a0|\n| \u00a0 \u00a0 Separator \u00a0 \u00a0 | \u00a0 \u00a0\u00a0 0.01 \u00a0 \u00a0\u00a0 | \u00a0 \u00a0\u00a0\u00a0 3 \u00a0 \u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0180.22\u00a0(\u00a04.08%)\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0-5397.53\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a011008.06\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a011004.02\u00a0\u00a0\u00a0\u00a0\u00a0|\n| \u00a0 \u00a0\u00a0 0564 _4 \u00a0 \u00a0\u00a0\u00a0 | \u00a0 \u00a0\u00a0 0.01 \u00a0 \u00a0\u00a0 | \u00a0 \u00a0\u00a0\u00a0 2 \u00a0 \u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a029.79\u00a0(\u00a02.15%)\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0-5394.37\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a011001.74\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a011001.74 \u00a0\u00a0\u00a0|\n| \u00a0 \u00a0\u00a0 0564 _4 \u00a0 \u00a0\u00a0\u00a0 | \u00a0 \u00a0\u00a0 0.01 \u00a0 \u00a0\u00a0 | \u00a0 \u00a0\u00a0\u00a0 3 \u00a0\u00a0|\u00a0\u00a0\u00a029.78\u00a0(\u00a02.15%)\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0-5394.37\u00a0\u00a0\u00a0\u00a0|\u00a011005.78\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a011001.74 \u00a0\u00a0|\n| \u00a0 \u00a0\u00a0 0564 _3 \u00a0 \u00a0\u00a0\u00a0 | \u00a0 \u00a0\u00a0 0.01 \u00a0 \u00a0\u00a0 | \u00a0 \u00a0 2 \u00a0 \u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0126.86\u00a0(\u00a03.14%)\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0-5388.59\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a010994.22\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a010994.22\u00a0\u00a0\u00a0\u00a0\u00a0|\n| \u00a0 \u00a0\u00a0 0564 _3 \u00a0 \u00a0\u00a0\u00a0 | \u00a0 \u00a0\u00a0 0.01 \u00a0 \u00a0\u00a0 | \u00a0 \u00a0\u00a0\u00a0 3 \u00a0 \u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0135.96\u00a0(\u00a03.05%)\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0-5388.59\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a010998.25\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a010994.22\u00a0\u00a0\u00a0\u00a0\u00a0|\n| \u00a0 \u00a0\u00a0 0564 _9 | \u00a0 \u00a0\u00a0 0.01 \u00a0 \u00a0\u00a0 | \u00a0 \u00a0\u00a0\u00a0 2 \u00a0 \u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a010.01\u00a0(\u00a08.61%)\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0-5388.37\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a010997.82\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a010994.22\u00a0\u00a0\u00a0\u00a0\u00a0|\n\u2003...\n| \u00a0 \u00a0\u00a0 Node53 \u00a0 \u00a0\u00a0\u00a0 | \u00a0 \u00a0\u00a0 0.00 \u00a0 \u00a0\u00a0 | \u00a0 \u00a0\u00a0\u00a0 2 \u00a0 \u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a01.00\u00a0(100.00%)\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0-5371.63\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a010976.46\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a010971.76\u00a0\u00a0\u00a0\u00a0\u00a0|\n| \u00a0 \u00a0\u00a0 0557 _6 \u00a0 \u00a0\u00a0\u00a0 | \u00a0 \u00a0\u00a0 0.00 \u00a0 \u00a0\u00a0 | \u00a0 \u00a0\u00a0\u00a0 2 \u00a0 \u00a0\u00a0\u00a0\u00a0|\u00a0\u00a027.66\u00a0(100.00%)\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0-5371.32\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a010975.83\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a010971.76\u00a0\u00a0\u00a0\u00a0\u00a0|\n| \u00a0 \u00a0\u00a0 0557 _21 \u00a0 \u00a0\u00a0 | \u00a0 \u00a0\u00a0 0.00 \u00a0 \u00a0\u00a0 | \u00a0 \u00a0\u00a0\u00a0 2 \u00a0 \u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a00.25\u00a0(\u00a01.96%)\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0-5371.30\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a010975.80\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a010971.76\u00a0\u00a0\u00a0\u00a0\u00a0|\n| \u00a0 \u00a0\u00a0 0557 _7 \u00a0 \u00a0\u00a0\u00a0 | \u00a0 \u00a0\u00a0 0.00 \u00a0 \u00a0\u00a0 | \u00a0 \u00a0\u00a0\u00a0 2 \u00a0 \u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a00.25\u00a0(\u00a01.96%)\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0-5371.30\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a010975.80\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a010971.76\u00a0\u00a0\u00a0\u00a0\u00a0|<\/div><br\/><div class = \"text-block\">### \u00a0 Rate \u00a0 class \u00a0 analyses \u00a0 summary\n* \u00a0 \u00a0 38 \u00a0 branches \u00a0 with \u00a0 **1** \u00a0 rate \u00a0classes\n* \u00a0 \u00a0 6 \u00a0 branches \u00a0 with \u00a0 **2** \u00a0 rate \u00a0 classes<\/div><br\/><div class = \"text-block\">### \u00a0 Improving \u00a0 parameter \u00a0 estimates\u00a0of\u00a0the\u00a0adaptive\u00a0rate\u00a0class\u00a0model\n* \u00a0 Log ( L ) \u00a0 = \u00a0 -5370.66, \u00a0 AIC - c \u00a0 = \u00a0 10970.49\u00a0(114\u00a0estimated\u00a0parameters)<\/div><br\/><div class = \"text-block\">### \u00a0 Testing \u00a0 selected \u00a0 branches \u00a0 for\u00a0selection<\/div><br\/><div class = \"text-block\">| \u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 Branch \u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0Rates\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a0Max.\u00a0dN\/dS\u00a0\u00a0\u00a0\u00a0\u00a0|\u00a0Test\u00a0LRT\u00a0|Uncorrected\u00a0p-value|\n|-------------------|---------|----------------------|----------|--------------------|\n| \u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 0564 _22 \u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a01\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a01.22\u00a0(100.00%)\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a00.11\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a00.43015\u00a0\u00a0\u00a0\u00a0|\n| \u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 0564 _7 \u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a01\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a00.61\u00a0(100.00%)\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a00.00\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a01.00000\u00a0\u00a0\u00a0\u00a0|\n| \u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 Separator \u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a02\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0197.72\u00a0(\u00a03.95%)\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a014.13\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a00.00029\u00a0\u00a0\u00a0\u00a0|\n| \u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 0564 _4 \u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a02\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a028.89\u00a0(\u00a02.15%)\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a04.81\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a00.03281\u00a0\u00a0\u00a0\u00a0|\n| \u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 0564 _3 \u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a02\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0127.66\u00a0(\u00a03.14%)\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a014.06\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a00.00030\u00a0\u00a0\u00a0\u00a0|\n| \u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 0564 _9 \u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a01\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a00.72\u00a0(100.00%)\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a00.00\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a01.00000\u00a0\u00a0\u00a0\u00a0|\n| \u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 0564 _1 \u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a01\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a01.07\u00a0(100.00%)\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a00.01\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a00.48208\u00a0\u00a0\u00a0\u00a0|\n...\n| \u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 0557 _21 \u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a01\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a01.00\u00a0(100.00%)\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a00.00\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a01.00000\u00a0\u00a0\u00a0\u00a0|\n| \u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 0557 _7 \u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a01\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a01.00\u00a0(100.00%)\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a00.00\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a01.00000\u00a0\u00a0\u00a0\u00a0|\n----\n### \u00a0 Adaptive \u00a0 branch \u00a0 site \u00a0 random\u00a0effects\u00a0likelihood\u00a0test\nLikelihood \u00a0 ratio \u00a0 test \u00a0 for \u00a0 episodic\u00a0diversifying\u00a0positive\u00a0selection\u00a0at\u00a0Holm-Bonferroni\u00a0corrected\u00a0_p\u00a0=\u00a0\u00a0\u00a00.0500_\u00a0found\u00a0**3**\u00a0branches\u00a0under\u00a0selection\u00a0among\u00a0**44**\u00a0tested.<\/div><br\/><div class = \"text-block\">* \u00a0 Node35 , \u00a0 p - value \u00a0 = \u00a0 \u00a0 0.00018\n* \u00a0 Separator , \u00a0 p - value \u00a0 = \u00a0 \u00a0 0.01251\n* \u00a0 0564 _3 , \u00a0 p - value \u00a0 = \u00a0 \u00a0 0.01266<\/div><\/div><\/code><\/pre><\/div><br\/><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#FFED92","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1114182,"guid":"457EB7B060BD11EB96D2EBAE0011895C","previous_id":1114180,"previous_guid":"1B75EA1060BD11EB96D2EBAE0011895C","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"C97CD038F91B4847AA2D5448A45E3557","order_id":1,"type_id":6,"title":"Section","source":{"title":"3.4 aBSREL"}},{"id":1054724,"guid":"D229BCFDF30E4E7AAFB2FE6EA63EAB75","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><br\/><br\/><\/div>"}},{"id":1054725,"guid":"7BF9DF0B81A740DDBE3541DB1D5060EA","order_id":2,"type_id":26,"title":"notes","source":{"id":0,"parent_id":0,"uri":"","title":"","body":"<div class = \"text-blocks\"><div class = \"text-block\"><span style = \"font-weight:bold;\">Interpreting Results<\/span><\/div><br\/><div class = \"text-block\"><span>The first printed markdown table (<\/span><span style = \"font-style:italic;\">\"Determining the optimal number of rate classes per branch using a step up procedure\"<\/span><span>) summarizes the model selection process. For example, when two <\/span><span style = \"font-style:italic;\">\u03c9 <\/span><span>rates were assigned to branch <\/span><span style = \"font-style:italic;\">Separator<\/span><span>, this improved the <\/span><span style = \"font-style:italic;\">AIC<\/span><span style = \"font-style:italic;vertical-align:sub;\">c <\/span><span>score of the fit (compared to the single-rate model) from 11, 009.72 to 11, 004.02. However, allocating three <\/span><span style = \"font-style:italic;\">\u03c9 <\/span><span>rates to the same branch worsens the score to 11, 008.06. Therefore the aBSREL model will use two <\/span><span style = \"font-style:italic;\">\u03c9 <\/span><span>rates at the branch.<\/span><\/div><br\/><div class = \"text-block\"><span>The second printed markdown table (<\/span><span style = \"font-style:italic;\">\"Testing selected branches for selection\"<\/span><span>) shows the results of tests for episodic selection on individual branches. At branch <\/span><span style = \"font-style:italic;\">0564_4<\/span><span>, for example, the tested model includes two <\/span><span style = \"font-style:italic;\">\u03c9 <\/span><span>rates, with the positive selection class taking on value 28.89 (2.15<\/span><span style = \"font-style:italic;\">% <\/span><span>proportion of the mixture). Constraining this rate to range between 0 and 1 yields the likelihood ratio test statistic of 4.81, which maps to a <\/span><span style = \"font-style:italic;\">P<\/span><span>-value (before multiple test correction) of 0.03281.<\/span><\/div><br\/><div class = \"text-block\"><span>Finally, aBSREL reports three branches under episodic diversifying selection pressure. Further examination of results using HyPhy-Vision shows that these branches are found (a) along the transmission event from donor to recipient, and (b) within a highly diverged clade in the donor (Fig. 2). The first finding is consistent with an expected increase in evolutionary rate when a virus infects a new host and encounters novel host immunity, and the second finding is consistent with intrahost adaptive dynamics of the donor\u2019s long-term HIV infection. Importantly, a close examination of the markdown-output table under the header <\/span><span style = \"font-style:italic;\">\"Testing selected branches for selection\" <\/span><span>reveals several nodes with uncorrected <\/span><span style = \"font-style:italic;\">P<\/span><span>-values whose significance was lost upon applying the Bonferroni\u2013Holm correction, e.g.,0564_4whose uncorrected <\/span><span style = \"font-style:italic;\">P<\/span><span>\u2009=\u20090.03281. This result illustrates the potential loss of power incurred by this aBSREL exploratory analysis. <\/span><\/div><br\/><div class = \"text-block\"><span style = \"font-weight:bold;\">Rules of Thumb for aBSREL Use<\/span><\/div><br\/><div class = \"text-block\"><ol style = \"list-style-type: decimal;\"><li style = \"counter-reset:ol0;\"><span>A priori identification of branches to test for selection will generally increase power to detect selection on those branches. That said, to maintain statistical robustness, we <\/span><span style = \"font-style:italic;\">strongly discourage <\/span><span>performing multiple separate tests for selection on different branch sets. Such an approach will necessarily introduce false positives. In such a case, we recommend performing an exploratory analysis wherein all branches are considered.<\/span><\/li><li style = \"counter-reset:ol0;\">Exploratory analyses of very large datasets are unlikely to yield many significant results, because correcting for multiple testing will reduce power as the number of branches grows, while the amount of statistical signal does not increase for larger datasets. One option is to thin out large phylogenies (before performing any testing), retaining major clades and lineages of interest.<\/li><\/ol><\/div><br\/><br\/><div style = \"text-align :; float : ;\"><img style = \"\" src = \"https:\/\/s3.amazonaws.com\/protocols-files\/files\/ebhwba7dp.jpg\" \/><\/div><br\/><\/div>","created_on":0,"changed_on":0,"creator":{"name":"","affiliation":null,"affiliations":[],"username":"","note":null,"link":null,"image":{"source":"","placeholder":""},"badges":[],"verified":0,"is_verified_user":false,"research_interests":null,"blocked_by_you":false,"blocked_you":false,"hide_following":false},"comments":[]}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#FFED92","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1114183,"guid":"D79F514060BD11EB96D2EBAE0011895C","previous_id":1114182,"previous_guid":"457EB7B060BD11EB96D2EBAE0011895C","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"8CD46D12BA9C42E7B0DF569FFF6B6973","order_id":1,"type_id":6,"title":"Section","source":{"title":"3.5 Site-Level Selection: MEME, FEL, SLAC, and FUBAR"}},{"id":1054724,"guid":"9E18D934EE524775B0AA1185CF0FD144","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><br\/><br\/><\/div>"}},{"id":1054725,"guid":"984F2B410D1A4BAC812F2E47B024008E","order_id":2,"type_id":26,"title":"notes","source":{"id":0,"parent_id":0,"uri":"","title":"","body":"<div class = \"text-blocks\"><div class = \"text-block\"><span style = \"font-weight:bold;\">What Biological Question Is the Method Designed to Answer?<\/span><\/div><br\/><div class = \"text-block\"><span>The methods FEL, SLAC, and FUBAR address the question: Which site(s) in a gene are subject to <\/span><span style = \"font-style:italic;\">pervasive<\/span><span>, i.e., consistently across the entire phylogeny, diversifying selection? MEME addresses a more general question: Which site(s) in a gene are subject to pervasive or <\/span><span style = \"font-style:italic;\">episodic<\/span><span>, i.e., only on a single lineage or subset of lineages, diversifying selection?<\/span><\/div><br\/><div class = \"text-block\">Recommended Applications<\/div><br\/><div class = \"text-block\"><ol style = \"list-style-type: decimal;\"><li style = \"counter-reset:ol0;\"><span style = \"font-weight:bold;\">MEME <\/span><span>is the sole method in HyPhy for detecting selection at individual sites that considers both pervasive and episodic selection. MEME is therefore our recommended method if maximum power is desired.<\/span><\/li><li style = \"counter-reset:ol0;\">The phenomenon of pervasive selection is generally most prevalent in pathogen evolution and any biological system influenced by evolutionary arms race dynamics (or balancing selection), including adaptive immune escape by viruses. As such, FEL, SLAC, and FUBAR are ideally suited to identify sites under positive selection which represent candidate sites subject to strong selective pressures across the entire phylogeny. Each of these methods has a particular use case as well:<\/li><\/ol><\/div><div class = \"text-block\"><ul style = \"list-style-type:disc;\"><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">FEL <\/span><span>is our recommended method for analyzing small-to-medium size datasets when one wishes only to study pervasive selection at individual sites.<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">FUBAR <\/span><span>is our recommended method for detecting pervasive selection at individual sites on large (>\u2009500 sequences) datasets for which other methods have prohibitive runtimes, unless you have access to a computer cluster.<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">SLAC <\/span><span>provides legacy functionality as a counting-based method adapted for phylogenetic applications. In general, this method will be the least statistically robust.<\/span><\/li><\/ul><\/div><\/div>","created_on":0,"changed_on":0,"creator":{"name":"","affiliation":null,"affiliations":[],"username":"","note":null,"link":null,"image":{"source":"","placeholder":""},"badges":[],"verified":0,"is_verified_user":false,"research_interests":null,"blocked_by_you":false,"blocked_you":false,"hide_following":false},"comments":[]}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#EA9F6C","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1114185,"guid":"18A2142060BE11EB96D2EBAE0011895C","previous_id":1114183,"previous_guid":"D79F514060BD11EB96D2EBAE0011895C","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"18B6CF8BE3544147910FEEA4818A2B5F","order_id":1,"type_id":6,"title":"Section","source":{"title":"3.5 Site-Level Selection: MEME, FEL, SLAC, and FUBAR"}},{"id":1054724,"guid":"72342DFC81E44883A505793D083883C9","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><br\/><br\/><\/div>"}},{"id":1054725,"guid":"FDCF62AD059D4C5F93C53F197FC958FB","order_id":2,"type_id":26,"title":"notes","source":{"id":0,"parent_id":0,"uri":"","title":"","body":"<div class = \"text-blocks\"><div class = \"text-block\"><span style = \"font-weight:bold;\">Statistical Test Procedure<\/span><\/div><br\/><div class = \"text-block\"><span>Each method presented here employs a distinct algorithmic approach to inferring selection. FEL uses maximum likelihood to fit a codon model to each site, thereby estimating a value for <\/span><span style = \"font-style:italic;\">dN <\/span><span>and <\/span><span style = \"font-style:italic;\">dS <\/span><span>at each site. FEL tests for selection with the likelihood ratio test using the <\/span><a href=\"#\" style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\"> <\/span><\/a><span> distribution, asking whether the <\/span><span style = \"font-style:italic;\">dN <\/span><span>estimate is significantly greater than the inferred <\/span><span style = \"font-style:italic;\">dS <\/span><span>estimate.<\/span><\/div><div style = \"text-align :; float : ;\"><span style = \"\">\u03c7^2_1<\/span><\/div><div class = \"text-block\">\nSLAC represents the most basic inference method and is an extension of the Suzuki\u2013Gojobori counting-based method [39] for phylogenetically related sequences (as opposed to sequence pairs). SLAC uses maximum likelihood to infer ancestral characters for each site across the phylogeny and then directly counts the number of synonymous and non-synonymous changes which have occurred at each site over evolutionary time. SLAC then tests for selection by testing whether or not there are too many or too few non-synonymous changes compared to what is expected under neutrality. The neutral expectation is derived based on the phylogeny-wide estimated numbers of synonymous and non-synonymous nucleotide sites at a given codon. The statistical test employs the binomial distribution to compute significance, e.g., how likely is it to observe 13 non-synonymous and 1 synonymous substitutions at a site, if the expected synonymous to non-synonymous substitution count ratio under neutrality is 1:4?<\/div><div class = \"text-block\"><span>\nMEME employs a mixed-effects maximum likelihood approach. For each site, MEME infers two <\/span><span style = \"vertical-align:sub;\">\u03c9 <\/span><span>rate classes and corresponding weights representing the probability that the site evolves under each rate class at a given branch. To this end, MEME infers a single <\/span><span style = \"vertical-align:sub;\">\u03b1 <\/span><span style = \"vertical-align:sub;vertical-align:sub;\">(<\/span><span style = \"vertical-align:sub;\">dS<\/span><span>) parameter and two separate <\/span><span style = \"vertical-align:sub;\">\u03b2 <\/span><span style = \"vertical-align:sub;vertical-align:sub;\">(<\/span><span style = \"vertical-align:sub;\">dN<\/span><span>) parameters, <\/span><span style = \"font-style:italic;font-style:italic;\">\u03b2<\/span><span style = \"font-style:italic;\">\u2212 <\/span><span>and <\/span><span style = \"font-style:italic;font-style:italic;\">\u03b2<\/span><span style = \"font-style:italic;font-style:italic;\">+<\/span><span>. The <\/span><span style = \"font-style:italic;\">\u03c9 <\/span><span>rates per site, therefore, consist of <\/span><span style = \"font-style:italic;font-style:italic;\">\u03b2<\/span><span style = \"font-style:italic;font-style:italic;\">+<\/span><span style = \"font-style:italic;font-style:italic;\">\u2215<\/span><span style = \"font-style:italic;\">\u03b1 <\/span><span>and <\/span><span style = \"font-style:italic;font-style:italic;\">\u03b2<\/span><span style = \"font-style:italic;font-style:italic;\">\u2212<\/span><span style = \":;font-style:italic;\">\u2215<\/span><span style = \":;\">\u03b1<\/span><span>. MEME uses this framework to fit a null and alternative model each, both models enforcing the constraint <\/span><span style = \"font-style:italic;font-style:italic;\">\u03b2<\/span><span style = \"font-style:italic;font-style:italic;\">\u2212<\/span><span>\u2264\u2009<\/span><span style = \"font-style:italic;\">\u03b1<\/span><span>. The null model disallows positive selection by enforcing the constraint <\/span><span style = \":;font-style:italic;\">\u03b2<\/span><span style = \":;font-style:italic;\">+<\/span><span>\u2009\u2264\u2009<\/span><span style = \"font-style:italic;\">\u03b1<\/span><span>, whereas the alternative model places no constraint on <\/span><span style = \"font-style:italic;vertical-align:sub;\">\u03b2<\/span><span style = \"font-style:italic;vertical-align:sub;\">+<\/span><span>. MEME uses the likelihood ratio test to compare between null and alternative model fits, with significance assessed using the mixture of <\/span><a href=\"#\" style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\"> <\/span><\/a><span>, <\/span><a href=\"#\" style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \"font-style:italic;\"> <\/span><\/a><span>, and <\/span><a href=\"#\" style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \"vertical-align:sub;\"> <\/span><\/a><span>.<\/span><\/div><div style = \"text-align :; float : ;\"><span style = \"\">33\\%\u03c7^2_0<\/span><\/div><div style = \"text-align :; float : ;\"><span style = \"\">30\\%\u03c7^2_1<\/span><\/div><div style = \"text-align :; float : ;\"><span style = \"\">37\\%\u03c7^2_2<\/span><\/div><div class = \"text-block\"><span>\nFUBAR takes a Bayesian approach to selection inference and is a particular case of statistical models developed in the context of document classification (latent Dirichlet allocation). The key innovation to FUBAR\u2019s approach is its use of an a priori specified grid of <\/span><span style = \"font-style:italic;\">dN <\/span><span>and <\/span><span style = \"font-style:italic;\">dS <\/span><span>values (typically 20\u2009\u00d7\u200920), spanning the range of negative, neutral, and positive selection regimes, whose likelihoods can be pre-computed and used throughout analysis (rather than having to re-compute likelihoods during optimization as traditional random-effects approaches do [12, 29]). This approach, combined with other algorithmic advances, speeds computation time by at least an order of magnitude compared to FEL, while yielding comparable statistical performance. FUBAR estimates every model parameter except the proportion of sites allocated to each grid point using simple (and fast) nucleotide models. The proportions are estimated using an MCMC procedure, and non-neutral evolution at each site is inferred using a straightforward naive empirical Bayes approach [29]. Sites are called positively or negatively selected if the corresponding posterior probabilities are sufficiently high.<\/span><\/div><br\/><div class = \"text-block\">Note that FEL and SLAC report both positively and negatively selected sites, but MEME and FUBAR report only sites under positive selection.<\/div><\/div>","created_on":0,"changed_on":0,"creator":{"name":"","affiliation":null,"affiliations":[],"username":"","note":null,"link":null,"image":{"source":"","placeholder":""},"badges":[],"verified":0,"is_verified_user":false,"research_interests":null,"blocked_by_you":false,"blocked_you":false,"hide_following":false},"comments":[]}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#EA9F6C","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1114188,"guid":"A34FA29060BE11EB96D2EBAE0011895C","previous_id":1114185,"previous_guid":"18A2142060BE11EB96D2EBAE0011895C","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"62ADB2BC7E37433C99C1AE1EBBBC45AF","order_id":1,"type_id":6,"title":"Section","source":{"title":"3.5 Site-Level Selection: MEME, FEL, SLAC, and FUBAR"}},{"id":1054724,"guid":"4081E83D82E34A65AE5E16F632B23B85","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><br\/><br\/><br\/><div style = \"text-align :; float : ;\"><img style = \"\" src = \"https:\/\/s3.amazonaws.com\/protocols-files\/files\/ebh6ba7dp.jpg\" \/><\/div><br\/><div style = \"text-align :; float : ;\"><img style = \"\" src = \"https:\/\/s3.amazonaws.com\/protocols-files\/files\/ebiaba7dp.jpg\" \/><\/div><br\/><br\/><div class = \"text-block\"><span style = \"font-weight:bold;\">FEL: <\/span><span>Launch HyPhy from the command line, and enter options <\/span><span style = \"font-style:italic;\">1<\/span><span> (Selection Analyses) and then <\/span><span style = \"font-style:italic;\">2<\/span><span> to reach the FEL analysis menu, and supply values for the following prompts:<\/span><\/div><div class = \"text-block\"><ol style = \"list-style-type: decimal;\"><li style = \"counter-reset:ol0;\"><span style = \"font-weight:bold;\">Choose genetic code<\/span><span>. Enter <\/span><span style = \"font-style:italic;\">1<\/span><span> to use the Universal genetic code.<\/span><\/li><li style = \"counter-reset:ol0;\"><span style = \"font-weight:bold;\">Select a coding sequence alignment file<\/span><span>. Provide the full path to the dataset of interest: <\/span><span style = \"font-style:italic;\">\/path\/to\/data\/h3_trunk.fna<\/span><span style = \"font-style:italic;\">.<\/span><\/li><li style = \"counter-reset:ol0;\"><span style = \"font-weight:bold;\">A tree was found in the data file\u2026Would you like to use it (y\/n)?<\/span><span>. Enter \u201cy\u201d to use the tree.<\/span><\/li><li style = \"counter-reset:ol0;\"><span style = \"font-weight:bold;\">Choose the set of branches to test for selection<\/span><span>. This option allows you to specify which branches along which site-level inference should be performed. Enter <\/span><span style = \"font-style:italic;\">1<\/span><span> to test all branches for selection.<\/span><\/li><li style = \"counter-reset:ol0;\"><span style = \"font-weight:bold;\">Use synonymous rate variation?<\/span><span>. This option asks you to specify whether the <\/span><span style = \"font-style:italic;\">dS <\/span><span>parameter in the codon model should be allowed to vary across sites (\u201cYes\u201d) or be fixed to 1 at all sites (\u201cNo\u201d). Enter1to use a model with synonymous rate variation.<\/span><\/li><li style = \"counter-reset:ol0;\"><span style = \"font-weight:bold;\">Select the <\/span><span style = \"font-weight:bold;font-weight:bold;font-style:italic;\">P<\/span><span style = \"font-weight:bold;\">-value used to perform the test at (permissible range = [0,1], default value = 0.1)<\/span><span>. Provide the default threshold of <\/span><span style = \"font-style:italic;\">0.1<\/span><span style = \"font-style:italic;\">.<\/span><\/li><\/ol><\/div><br\/><div class = \"text-block\">FEL will now run to completion and print status indicators to the screen, including results for any site found to be under selection (either positive or negative). Abbreviated results are shown below.<\/div><\/div>"}},{"id":1054725,"guid":"85745AE0611D4455A22E5F96BADD249A","order_id":2,"type_id":26,"title":"notes","source":{"id":0,"parent_id":0,"uri":"","title":"","body":"<div class = \"text-blocks\"><div class = \"text-block\"><span style = \"font-weight:bold;\">Example Analysis<\/span><\/div><br\/><div class = \"text-block\">We will demonstrate the use and interpretation of site-level methods using data from influenza strain H3N2 (the \u201cHong Kong flu\u201d), the primary circulating strain of seasonal influenza since the late 1960s. We specifically will assess selection on the H3 hemagglutinin, the influenza surface protein which is responsible for host cell binding. Hemagglutinin experiences rapid evolution triggered by host immune escape, and previous studies have identified numerous signatures of positive diversifying selection in H3 sequences with a particular concentration around the host-binding domain [28].<\/div><br\/><div class = \"text-block\">We base analyses here on an alignment from Meyer and Wilke [22] of H3 sequences sampled over time since the 1991\u20131992 influenza season. We removed all partial and strongly outlying sequences (i.e., those with excessive divergence) from the original dataset before proceeding, yielding 2555 sequences to comprise our \u201cfull\u201d H3 dataset. We further subsetted this alignment to two smaller alignments with comparable numbers of taxa but spanning different evolutionary time frames: The first smaller alignment (\u201ctrunk\u201d) contains 163 sequences sampled along the influenza H3 trunk, whereas the second smaller alignment (\u201cshallow\u201d) contains 121 sequences sampled from a single clade (Fig. 3). Therefore, while these two smaller datasets contain a comparable number of sequences, the trunk dataset spans a much longer time frame and contains substantially more sequence divergence relative to the shallow dataset. Indeed, the trunk dataset has a total tree length (sum of branch lengths, in units substitutions\/site\/unit time) of 0.43, whereas the shallow dataset had a total tree length of 0.12, meaning that the trunk dataset contains nearly four times the amount of sequence divergence seen in the shallow dataset. We have compiled results for all three datasets analyzed with all four methods (Table 1). We now describe, using the trunk dataset as an example, how to run each of these analyses in HyPhy.<\/div><\/div>","created_on":0,"changed_on":0,"creator":{"name":"","affiliation":null,"affiliations":[],"username":"","note":null,"link":null,"image":{"source":"","placeholder":""},"badges":[],"verified":0,"is_verified_user":false,"research_interests":null,"blocked_by_you":false,"blocked_you":false,"hide_following":false},"comments":[]}},{"id":1054726,"guid":"6FCFF191FFEB4967ADB27E39B320C6A6","order_id":3,"type_id":1,"title":"description","source":{"description":"<div style = \"text-align :; float : ;\"><img style = \"\" src = \"https:\/\/s3.amazonaws.com\/protocols-files\/files\/ebh6ba7dp.jpg\" \/><\/div>"}},{"id":1054727,"guid":"533B5591BD8E4C33ABDB0B3348318AFD","order_id":4,"type_id":1,"title":"description","source":{"description":"<div style = \"text-align :; float : ;\"><img style = \"\" src = \"https:\/\/s3.amazonaws.com\/protocols-files\/files\/ebiaba7dp.jpg\" \/><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#EA9F6C","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1114191,"guid":"17182DE060C011EB96D2EBAE0011895C","previous_id":1114188,"previous_guid":"A34FA29060BE11EB96D2EBAE0011895C","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"B1353BE7FAFC4BC780BD5D760BD2DD68","order_id":1,"type_id":6,"title":"Section","source":{"title":"3.5 Site-Level Selection: MEME, FEL, SLAC, and FUBAR"}},{"id":1054724,"guid":"9EA28F3E9F034D0192C3CA6A5BF8B7A7","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Listing 4 Partial FEL screen output<\/div><br\/><div class = \"text-block\"><pre><code><div class = \"text-blocks\"><div class = \"text-block\">### \u00a0 Obtaining \u00a0 branch \u00a0 lengths \u00a0 and\u00a0nucleotide\u00a0rates\u00a0under\u00a0the\u00a0\u00a0GTR\u00a0model\n* \u00a0 Log ( L ) \u00a0 = \u00a0 -7506.06<\/div><br\/><div class = \"text-block\">### \u00a0 Obtaining \u00a0 the \u00a0 global \u00a0 omega \u00a0estimate\u00a0based\u00a0on\u00a0relative\u00a0GTR\u00a0branch\u00a0lengths\u00a0and\u00a0nucleotide\u00a0substitution\u00a0biases\n* \u00a0 Log ( L ) \u00a0 = \u00a0 -7302.10\n* \u00a0 non - synonymous \/ synonymous \u00a0 rate\u00a0ratio\u00a0for\u00a0*test*\u00a0=\u00a0\u00a0\u00a00.2923<\/div><br\/><div class = \"text-block\">### \u00a0 Improving \u00a0 branch \u00a0 lengths , \u00a0 nucleotide\u00a0substitution\u00a0biases,\u00a0and\u00a0global\u00a0dN\/dS\u00a0ratios\u00a0under\u00a0a\u00a0full\u00a0codon\u00a0model\n* \u00a0 Log ( L ) \u00a0 = \u00a0 -7289.65\n* \u00a0 non - synonymous \/ synonymous \u00a0 rate\u00a0ratio\u00a0=\u00a0\u00a0\u00a00.2598<\/div><br\/><div class = \"text-block\">### \u00a0 For \u00a0 partition \u00a0 1 \u00a0 these \u00a0 sites\u00a0are\u00a0significant\u00a0at\u00a0p\u00a0<=0.1<\/div><br\/><div class = \"text-block\">| \u00a0 \u00a0\u00a0\u00a0\u00a0 Codon \u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0 | \u00a0 \u00a0\u00a0 Partition \u00a0 \u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a0alpha\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0beta\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0LRT\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0|Selection\u00a0detected?|\n|:-----------:|:------------:|:----------:|:--------:|:-----------:|:-------------------:|\n...\n| \u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0 146 \u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 | \u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 1 \u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 |\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a03.818\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a0\u00a00.000\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a07.336\u00a0\u00a0\u00a0|\u00a0\u00a0Neg.\u00a0p\u00a0=\u00a00.0068\u00a0\u00a0|\n| \u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0 152 \u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 | \u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 1 \u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 |\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a01.968\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a00.000\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a03.634\u00a0\u00a0\u00a0|\u00a0\u00a0Neg.\u00a0p\u00a0=\u00a00.0566\u00a0\u00a0|\n| \u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0 154 \u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 | \u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 1 \u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 |\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a00.000\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a03.912\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a04.652\u00a0\u00a0\u00a0|\u00a0\u00a0Pos.\u00a0p\u00a0=\u00a00.0310\u00a0\u00a0|\n| \u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0 159 \u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 | \u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 1 \u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 |\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a04.413\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a00.716\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a02.972\u00a0\u00a0\u00a0|\u00a0\u00a0Neg.\u00a0p\u00a0=\u00a00.0847\u00a0\u00a0|\n| \u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0 164 \u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 | \u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 1 \u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 |\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a02.082\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a00.000\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a02.713\u00a0\u00a0\u00a0|\u00a0\u00a0Neg.\u00a0p\u00a0=\u00a00.0995\u00a0\u00a0|\n| \u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0 176 \u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 | \u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 1 \u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 |\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a01.659\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a00.000\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a02.986\u00a0\u00a0\u00a0|\u00a0\u00a0Neg.\u00a0p\u00a0=\u00a00.0840\u00a0\u00a0|\n| \u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0 177 \u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 | \u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 1 \u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 |\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a06.393\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a00.000\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a08.421\u00a0\u00a0\u00a0|\u00a0\u00a0Neg.\u00a0p\u00a0=\u00a00.0037\u00a0\u00a0|\n| \u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0 181 \u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 | \u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 1 \u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 |\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a01.928\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a00.000\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a03.286\u00a0\u00a0\u00a0|\u00a0\u00a0Neg.\u00a0p\u00a0=\u00a00.0699\u00a0\u00a0|\n| \u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0 190 \u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 | \u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 1 \u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 |\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a02.085\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a00.000\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a02.715\u00a0\u00a0\u00a0|\u00a0\u00a0Neg.\u00a0p\u00a0=\u00a00.0994\u00a0\u00a0|\n| \u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0 201 \u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 | \u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 1 \u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 |\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a01.645\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a00.000\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a03.370\u00a0\u00a0\u00a0|\u00a0\u00a0Neg.\u00a0p\u00a0=\u00a00.0664\u00a0\u00a0|\n| \u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0 208 \u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 | \u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 1 \u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 |\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a00.000\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a03.625\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a04.668\u00a0\u00a0\u00a0|\u00a0\u00a0Pos.\u00a0p\u00a0=\u00a00.0307\u00a0\u00a0|\n...<\/div><br\/><div class = \"text-block\">\u2003### \u00a0 ** \u00a0 Found \u00a0 _3_ \u00a0 sites \u00a0 under \u00a0 pervasive\u00a0positive\u00a0diversifying\u00a0and\u00a0_115_\u00a0sites\u00a0under\u00a0negative\u00a0selection\u00a0at\u00a0p\u00a0<=\u00a00.1**<\/div><\/div><\/code><\/pre><\/div><br\/><br\/><br\/><\/div>"}},{"id":1054725,"guid":"ED69B4A194974B51A67C24806378674A","order_id":2,"type_id":26,"title":"notes","source":{"id":0,"parent_id":0,"uri":"","title":"","body":"<div class = \"text-blocks\"><div class = \"text-block\">Inference details for codons with significant likelihood ratio tests for positive or negative selection are reported to the screen.<\/div><br\/><div class = \"text-block\"><span style = \"font-weight:bold;\">Codon<\/span><\/div><div class = \"text-block\">The codon where non-neutral evolution has been detected.<\/div><br\/><div class = \"text-block\"><span style = \"font-weight:bold;\">Partition<\/span><\/div><div class = \"text-block\">Allows one to keep track which subset of the alignment a particular site belongs to. This is important for recombination-corrected partition analyses.<\/div><br\/><div class = \"text-block\"><span style = \"font-weight:bold;\">alpha<\/span><\/div><div class = \"text-block\">Site-specific synonymous substitution rate<\/div><br\/><div class = \"text-block\"><span style = \"font-weight:bold;\">beta<\/span><\/div><div class = \"text-block\">Site-specific non-synonymous substitution rate<\/div><br\/><div class = \"text-block\"><span style = \"font-weight:bold;\">LRT<\/span><\/div><div class = \"text-block\">Site-specific likelihood ratio test statistic for non-neutral evolution (alpha\u2009\u2260\u2009beta)<\/div><br\/><div class = \"text-block\"><span style = \"font-weight:bold;\">Selection detected?<\/span><\/div><div class = \"text-block\"><span>Selection classification (positive or negative) and the corresponding <\/span><span style = \"font-style:italic;\">P<\/span><span>-value<\/span><\/div><br\/><div class = \"text-block\">Note that the \u201cCodon\u201d and \u201cPartition\u201d columns are common to all site-specific analyses.<\/div><br\/><br\/><div class = \"text-block\"><span style = \"font-weight:bold;\">MEME and SLAC: <\/span><span>SLAC and MEME follow identical menu prompts as FEL, with the exception that only FEL will prompt for synonymous rate variation. Instead, SLAC has a different prompt for Step 5: <\/span><span style = \"font-weight:bold;\">Select the number of samples used to assess ancestral reconstruction uncertainty<\/span><span>. If this number is positive, then HyPhy will draw samples from the distribution of ancestral states and use them to measure whether or not inference is sensitive to ancestral inference uncertainty. When you encounter this option, provide the default value of <\/span><span style = \"font-style:italic;\">100 <\/span><span>(or <\/span><span style = \"font-style:italic;\">0 <\/span><span>to forego sampling). MEME does not emit any additional prompts.<\/span><\/div><\/div>","created_on":0,"changed_on":0,"creator":{"name":"","affiliation":null,"affiliations":[],"username":"","note":null,"link":null,"image":{"source":"","placeholder":""},"badges":[],"verified":0,"is_verified_user":false,"research_interests":null,"blocked_by_you":false,"blocked_you":false,"hide_following":false},"comments":[]}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#EA9F6C","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1114192,"guid":"85DDB92060C011EB96D2EBAE0011895C","previous_id":1114191,"previous_guid":"17182DE060C011EB96D2EBAE0011895C","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"6ADDA27CCA4A4AABAD8C8FE332FDCD02","order_id":1,"type_id":6,"title":"Section","source":{"title":"3.5 Site-Level Selection: MEME, FEL, SLAC, and FUBAR"}},{"id":1054724,"guid":"9EF120CF660749BA80C004B6B594FE14","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Listing 5 Partial SLAC screen output<\/div><br\/><div class = \"text-block\"><pre><code><div class = \"text-blocks\"><div class = \"text-block\">...\n### \u00a0 For \u00a0 partition \u00a0 1 \u00a0 these \u00a0 sites\u00a0are\u00a0significant\u00a0at\u00a0p\u00a0<=0.1<\/div><br\/><div class = \"text-block\">| \u00a0 Codon \u00a0 | \u00a0 \u00a0\u00a0 Partition \u00a0 \u00a0\u00a0\u00a0 | \u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0S\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0N\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0dS\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0dN\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0|Selection\u00a0detected?|\n|:---------:|:--------:|:---------:|:-------:|:--------:|:--------:|:-----------------:|\n\u2003...\n| \u00a0 \u00a0 146 \u00a0 \u00a0 | \u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 1 \u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 | \u00a0 \u00a0\u00a0\u00a0\u00a0 3.000\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a00.000\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a03.000\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a00.000\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0Neg.\u00a0p\u00a0=\u00a00.037\u00a0\u00a0\u00a0|\n| \u00a0 \u00a0 154 \u00a0 \u00a0 | \u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 1 \u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 | \u00a0 \u00a0\u00a0\u00a0\u00a0 0.000\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a08.000\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a00.000\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a04.000\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0Pos.\u00a0p\u00a0=\u00a00.039\u00a0\u00a0\u00a0|\n| \u00a0 \u00a0 177 \u00a0 \u00a0 | \u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 1 \u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 | \u00a0 \u00a0\u00a0\u00a0\u00a0 3.000\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a00.000\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a04.038\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a00.000\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0Neg.\u00a0p\u00a0=\u00a00.020\u00a0\u00a0\u00a0|\n| \u00a0 \u00a0 208 \u00a0 \u00a0 | \u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 1 \u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 | \u00a0 \u00a0\u00a0\u00a0\u00a0 0.000\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a06.000\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a00.000\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a02.994\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0Pos.\u00a0p\u00a0=\u00a00.089\u00a0\u00a0\u00a0|<\/div><br\/><div class = \"text-block\">...\n### \u00a0 Ancestor \u00a0 sampling \u00a0 analysis<\/div><br\/><div class = \"text-block\">> Generating \u00a0 100 \u00a0 ancestral \u00a0 sequence\u00a0samples\u00a0to\u00a0obtain\u00a0confidence\u00a0intervals<\/div><br\/><div class = \"text-block\">Resampling \u00a0 results \u00a0 for \u00a0 partition\u00a01<\/div><br\/><div class = \"text-block\">|Codon|Part.|S [median,IQR]|N [median,\u00a0IQR]|dS\u00a0[median,\u00a0IQR]|dN\u00a0[median,\u00a0IQR]|p-value\u00a0[median,\u00a0IQR]|\n|:----:|:----:|:---------:|-----------:|----------:|-----------:|---------------------:|\n...\n| 146 | 1 | 3.00 [3.00-3.00]|\u00a00.00\u00a0[0.00-0.00]|\u00a03.00\u00a0[3.00-3.00]\u00a0|\u00a00.00\u00a0[0.00-0.00]\u00a0| 0.04\u00a0[0.04-0.04].|\n|154|1|0.00 [0.00-0.00]| 8.00\u00a0[8.00-8.00]|\u00a00.00\u00a0[0.00-0.00]|\u00a04.00\u00a0[4.00-4.00]| 0.04\u00a0[0.04-0.04] |\n| 177 | 1 | 3.00 [3.00-4.00]|\u00a00.00\u00a0[0.00-0.00]|\u00a04.04\u00a0[4.04-5.38]|\u00a00.00\u00a0[0.00-0.00]| 0.02\u00a0[0.01-0.02] |\n| 208 | 1| 0.00 [0.00-0.00]|\u00a06.00\u00a0[6.00-6.00]|\u00a00.00\u00a0[0.00-0.00]|\u00a02.99\u00a0[2.99-2.99]| 0.09\u00a0[0.09-0.09]|<\/div><br\/><div class = \"text-block\">\u2003...<\/div><\/div><\/code><\/pre><\/div><br\/><br\/><\/div>"}},{"id":1054725,"guid":"E8C8707FC71E404A854825F5C7632EBB","order_id":2,"type_id":26,"title":"notes","source":{"id":0,"parent_id":0,"uri":"","title":"","body":"<div class = \"text-blocks\"><div class = \"text-block\"><span>SLAC reports several key quantities for codons with significant <\/span><span style = \"font-style:italic;\">P<\/span><span>-values for positive or negative selection to the screen.<\/span><\/div><br\/><div class = \"text-block\"><span style = \"font-weight:bold;\">S<\/span><\/div><div class = \"text-block\">The number of synonymous substitutions inferred at this site<\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">NS<\/span><\/div><div class = \"text-block\">The number of non-synonymous substitutions inferred at this site<\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">dS<\/span><\/div><div class = \"text-block\">Estimated site-specific synonymous rate<\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">dN<\/span><\/div><div class = \"text-block\">Estimated site-specific non-synonymous rate<\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">Selection detected?<\/span><\/div><div class = \"text-block\"><span>Selection classification (positive or negative) and the corresponding<\/span><span style = \"font-style:italic;\">P<\/span><span>-value for the binomial test<\/span><\/div><br\/><div class = \"text-block\"><span>If the user elected to perform ancestral resampling, another table is reported, showing how much these quantities are affected by ancestral state reconstruction uncertainty. For example, at codon 177, some ancestral reconstructions yielded 3 synonymous substitutions, whereas others yielded 4; however, this was not sufficient to move the <\/span><span style = \"font-style:italic;\">P<\/span><span>-value on different sides of the threshold.<\/span><\/div><\/div>","created_on":0,"changed_on":0,"creator":{"name":"","affiliation":null,"affiliations":[],"username":"","note":null,"link":null,"image":{"source":"","placeholder":""},"badges":[],"verified":0,"is_verified_user":false,"research_interests":null,"blocked_by_you":false,"blocked_you":false,"hide_following":false},"comments":[]}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#EA9F6C","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1114193,"guid":"E21079D060C011EB96D2EBAE0011895C","previous_id":1114192,"previous_guid":"85DDB92060C011EB96D2EBAE0011895C","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"BA490B463EDC44D5908F344C499E5159","order_id":1,"type_id":6,"title":"Section","source":{"title":"3.5 Site-Level Selection: MEME, FEL, SLAC, and FUBAR"}},{"id":1054724,"guid":"6878DA7CF192421387E22607D382AD28","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Listing 6 Partial MEME screen output<\/div><br\/><div class = \"text-block\"><pre><code><div class = \"text-blocks\"><div class = \"text-block\">...\n| \u00a0 Codon \u00a0 \u00a0 | \u00a0 Partition \u00a0 | \u00a0 \u00a0 alpha \u00a0 \u00a0 |\u00a0\u00a0beta+\u00a0\u00a0|\u00a0\u00a0\u00a0p+\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0LRT\u00a0\u00a0\u00a0\u00a0|Episodic\u00a0selection\u00a0detected?|# branches|\n|:------:|:-------:|:----:|:----:|:---:|:---:|:-----------------------:|:--------:|\n| \u00a0 \u00a0\u00a0 64 \u00a0 \u00a0\u00a0 | \u00a0 \u00a0\u00a0\u00a0\u00a0 1 \u00a0 \u00a0\u00a0\u00a0\u00a0 | 0.000 \u00a0 \u00a0 | \u00a0\u00a014.717\u00a0|\u00a0\u00a00.204\u00a0\u00a0|\u00a0\u00a03.512\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Yes,\u00a0p\u00a0=\u00a00.0816\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a0\u00a05\u00a0\u00a0\u00a0\u00a0\u00a0|\n| \u00a0 \u00a0 154 \u00a0 \u00a0\u00a0 | \u00a0 \u00a0\u00a0\u00a0\u00a0 1 \u00a0 \u00a0\u00a0\u00a0\u00a0 | 0.000 \u00a0 \u00a0 | \u00a0\u00a035.302\u00a0|\u00a0\u00a00.145\u00a0\u00a0|\u00a0\u00a05.334\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Yes,\u00a0p\u00a0=\u00a00.0317\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a0\u00a08\u00a0\u00a0\u00a0\u00a0\u00a0|\n| \u00a0 \u00a0 171 \u00a0 \u00a0\u00a0 | \u00a0 \u00a0\u00a0\u00a0\u00a0 1 \u00a0 \u00a0\u00a0\u00a0\u00a0 | 0.000 \u00a0 \u00a0 | \u00a0\u00a045.005\u00a0|\u00a0\u00a00.017\u00a0\u00a0|\u00a0\u00a05.753\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Yes,\u00a0p\u00a0=\u00a00.0256\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a0\u00a01\u00a0\u00a0\u00a0\u00a0\u00a0|\n| \u00a0 \u00a0 208 \u00a0 \u00a0\u00a0 | \u00a0 \u00a0\u00a0\u00a0\u00a0 1 \u00a0 \u00a0\u00a0\u00a0\u00a0 | 0.000 \u00a0 \u00a0 | \u00a0\u00a059.749\u00a0|\u00a0\u00a00.089\u00a0\u00a0|\u00a0\u00a05.554\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Yes,\u00a0p\u00a0=\u00a00.0283\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a0\u00a06\u00a0\u00a0\u00a0\u00a0\u00a0|\n| \u00a0 \u00a0 242 \u00a0 \u00a0\u00a0 | \u00a0 \u00a0\u00a0\u00a0\u00a0 1 \u00a0 \u00a0\u00a0\u00a0\u00a0 | 1.839 \u00a0 \u00a0 | \u00a0\u00a034.114\u00a0|\u00a0\u00a00.216\u00a0\u00a0|\u00a0\u00a04.273\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Yes,\u00a0p\u00a0=\u00a00.0549\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a0\u00a07\u00a0\u00a0\u00a0\u00a0\u00a0|\n| \u00a0 \u00a0 402 \u00a0 \u00a0\u00a0 | \u00a0 \u00a0\u00a0\u00a0\u00a0 1 \u00a0 \u00a0\u00a0\u00a0\u00a0 | 0.000 \u00a0 \u00a0 | \u00a0\u00a010.476\u00a0|\u00a0\u00a00.091\u00a0\u00a0|\u00a0\u00a03.493\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Yes,\u00a0p\u00a0=\u00a00.0824\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a0\u00a02\u00a0\u00a0\u00a0\u00a0\u00a0|<\/div><br\/><div class = \"text-block\">### \u00a0 ** \u00a0 Found \u00a0 _6_ \u00a0 sites \u00a0 under \u00a0 episodic\u00a0diversifying\u00a0positive\u00a0selection\u00a0at\u00a0p\u00a0<=\u00a00.1**<\/div><\/div><\/code><\/pre><\/div><br\/><br\/><\/div>"}},{"id":1054725,"guid":"61D0253C929A4CCDA4CDAF5CF94146E7","order_id":2,"type_id":26,"title":"notes","source":{"id":0,"parent_id":0,"uri":"","title":"","body":"<div class = \"text-blocks\"><div class = \"text-block\">MEME prints information only about codons subject to positive selection, since MEME does not directly test for negative selection.<\/div><br\/><div class = \"text-block\"><span style = \"font-weight:bold;\">alpha<\/span><\/div><div class = \"text-block\">Site-specific synonymous substitution rate<\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">beta+<\/span><\/div><div class = \"text-block\">Site-specific non-synonymous substitution rate for the positive selection category<\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">p+<\/span><\/div><div class = \"text-block\">Site-specific weight (\u223c proportion of branches) assigned for the positive selection category<\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">LRT<\/span><\/div><div class = \"text-block\">Site-specific likelihood ratio test statistic for episodic diversifying selection (beta+\u2009>\u20091 and p+\u2009>\u20090)<\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">Episodic selection detected?<\/span><\/div><div class = \"text-block\"><span>Selection classification (yes) and the corresponding <\/span><span style = \"font-style:italic;\">P<\/span><span>-value<\/span><\/div><div class = \"text-block\"><span style = \"font-weight:bold;\"># branches<\/span><\/div><div class = \"text-block\">An exploratory estimate of the number of individual branches which have sufficient empirical Bayes support for positive selection; since MEME pools signal from multiple branches, there may be overall evidence for selection, without necessarily implicating any individual branches.<\/div><br\/><\/div>","created_on":0,"changed_on":0,"creator":{"name":"","affiliation":null,"affiliations":[],"username":"","note":null,"link":null,"image":{"source":"","placeholder":""},"badges":[],"verified":0,"is_verified_user":false,"research_interests":null,"blocked_by_you":false,"blocked_you":false,"hide_following":false},"comments":[]}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#EA9F6C","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1114195,"guid":"2DC482E060C111EB96D2EBAE0011895C","previous_id":1114193,"previous_guid":"E21079D060C011EB96D2EBAE0011895C","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"B29AED35CE5244CBBB4CBC559D342974","order_id":1,"type_id":6,"title":"Section","source":{"title":"3.5 Site-Level Selection: MEME, FEL, SLAC, and FUBAR"}},{"id":1054724,"guid":"7B88021EED164E33A01C0005862C5A74","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\"><span style = \"font-weight:bold;\">FUBAR: <\/span><span>To run FUBAR, launch HyPhy from the command line, and enter options <\/span><span style = \"font-style:italic;\">1<\/span><span> (Selection Analyses) and then <\/span><span style = \"font-style:italic;\">4 <\/span><span>to reach the FUBAR analysis menu, and supply values for the following prompts (<\/span><span style = \"font-style:italic;\">see<\/span><span> footnote 5):<\/span><\/div><br\/><div class = \"text-block\"><ol style = \"list-style-type: decimal;\"><li style = \"counter-reset:ol0;\"><span style = \"font-weight:bold;\">Choose genetic code<\/span><span>. Enter <\/span><span style = \"font-style:italic;\">1<\/span><span> to use the Universal genetic code.<\/span><\/li><li style = \"counter-reset:ol0;\"><span style = \"font-weight:bold;\">Select a coding sequence alignment file<\/span><span>. Provide the full path to the dataset of interest: <\/span><span style = \"font-style:italic;\">\/path\/to\/data\/h3_trunk.fna<\/span><span style = \"font-style:italic;\">.<\/span><\/li><li style = \"counter-reset:ol0;\"><span style = \"font-weight:bold;\">A tree was found in the data file\u2026Would you like to use it (y\/n)?<\/span><span>. Enter \u201cy\u201d to use the tree.<\/span><\/li><li style = \"counter-reset:ol0;\"><span style = \"font-weight:bold;\">Number of grid points per dimension. <\/span><span>This option controls how <\/span><span style = \"font-weight:bold;\">fine <\/span><span>the FUBAR analysis is by setting the range of possible <\/span><span style = \"font-style:italic;\">dN <\/span><span>and <\/span><span style = \"font-style:italic;\">dS <\/span><span>values that can be inferred, along an <\/span><span style = \"font-style:italic;\">N<\/span><span>\u2009\u00d7\u2009<\/span><span style = \"font-style:italic;\">N <\/span><span>grid. We will use the default value of <\/span><span style = \"font-style:italic;\">20 <\/span><span>(leading to a 20\u2009\u00d7\u200920 grid of <\/span><span style = \"font-style:italic;\">dN<\/span><span style = \"font-style:italic;font-style:italic;\">\u2215<\/span><span style = \"font-style:italic;\">dS <\/span><span>ratios). FUBAR will now pre-compute likelihoods for each value in the grid.<\/span><\/li><li style = \"counter-reset:ol0;\"><span style = \"font-weight:bold;\">Number of MCMC chains to run<\/span><span>. This option determines the number of Markov Chain Monte Carlo chains to run during Bayesian inference of evolutionary rates. Enter the default value of <\/span><span style = \"font-style:italic;\">5 <\/span><span>to run 5 chains.<\/span><\/li><li style = \"counter-reset:ol0;\"><span style = \"font-weight:bold;\">The length of each chain<\/span><span>. This option controls for how long each MCMC chain should be run. Enter the default value of <\/span><span style = \"font-style:italic;\">2000000 <\/span><span>to run each chain for two million generations (thus obtaining two million samples).<\/span><\/li><li style = \"counter-reset:ol0;\"><span style = \"font-weight:bold;\">Use this many samples as burn-in<\/span><span>. This option determines how many initial samples drawn from the MCMC chain should be discarded as burn-in, as is standard in Bayesian analyses. Enter the default value of <\/span><span style = \"font-style:italic;\">1000000<\/span><span>, leading to a final value of one-million draws per chain.<\/span><\/li><li style = \"counter-reset:ol0;\"><span style = \"font-weight:bold;\">How many samples should be drawn from each chain<\/span><span>. This option determines the final number of samples to draw from the full set of one-million draws per chain. Enter the default value of <\/span><span style = \"font-style:italic;\">100<\/span><span style = \"font-style:italic;\">.<\/span><\/li><li style = \"counter-reset:ol0;\"><span style = \"font-weight:bold;\">The concentration parameter of the Dirichlet prior<\/span><span>. This option controls the shape of the Dirichlet prior distribution. Enter the default value of <\/span><span style = \"font-style:italic;\">0.5<\/span><span style = \"font-style:italic;\">.<\/span><\/li><\/ol><\/div><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#EA9F6C","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1114206,"guid":"ACB0BAB060C111EB96D2EBAE0011895C","previous_id":1114195,"previous_guid":"2DC482E060C111EB96D2EBAE0011895C","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"BDE970C945DF44E9B361B28AB081196B","order_id":1,"type_id":6,"title":"Section","source":{"title":"3.5 Site-Level Selection: MEME, FEL, SLAC, and FUBAR"}},{"id":1054724,"guid":"B3429F5A496449D2BD4D2BB063752BA7","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Listing 7 Partial FUBAR screen output<\/div><br\/><div class = \"text-block\"><pre><code><div class = \"text-blocks\"><div class = \"text-block\">...<\/div><div class = \"text-block\">### \u00a0 Tabulating \u00a0 site - level \u00a0 results<\/div><div class = \"text-block\">| \u00a0 \u00a0 Codon \u00a0 \u00a0\u00a0\u00a0 | Partition \u00a0 | \u00a0 \u00a0\u00a0\u00a0\u00a0 alpha\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0beta\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a0N.eff\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0|Posterior\u00a0prob\u00a0for\u00a0positive\u00a0selection|<\/div><div class = \"text-block\">|:-------:|:--------:|:----:|:-----:|:--------:|:------------------------------------:|<\/div><div class = \"text-block\">| \u00a0 \u00a0\u00a0\u00a0 61 \u00a0 \u00a0\u00a0\u00a0\u00a0 | \u00a0 \u00a0\u00a0\u00a0 1 \u00a0 \u00a0\u00a0\u00a0\u00a0 | \u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 0.753\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a04.365\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a064.549\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Pos.\u00a0posterior\u00a0=\u00a00.9262\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0|<\/div><div class = \"text-block\">| \u00a0 \u00a0\u00a0\u00a0 64 \u00a0 \u00a0\u00a0\u00a0\u00a0 | \u00a0 \u00a0\u00a0\u00a0 1 \u00a0 \u00a0\u00a0\u00a0\u00a0 | \u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 0.753\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a03.920\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a077.106\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Pos.\u00a0posterior\u00a0=\u00a00.9095\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0|<\/div><div class = \"text-block\">| \u00a0 \u00a0\u00a0\u00a0 69 \u00a0 \u00a0\u00a0\u00a0\u00a0 | \u00a0 \u00a0\u00a0\u00a0 1 \u00a0 \u00a0\u00a0\u00a0\u00a0 | \u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 0.730\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a04.447\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a064.182\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Pos.\u00a0posterior\u00a0=\u00a00.9325\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0|<\/div><div class = \"text-block\">| \u00a0 \u00a0\u00a0 154 \u00a0 \u00a0\u00a0\u00a0\u00a0 | \u00a0 \u00a0\u00a0\u00a0 1 \u00a0 \u00a0\u00a0\u00a0\u00a0 | \u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 0.637\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a06.595\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a053.312\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Pos.\u00a0posterior\u00a0=\u00a00.9826\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0|<\/div><div class = \"text-block\">| \u00a0 \u00a0\u00a0 208 \u00a0 \u00a0\u00a0\u00a0\u00a0 | \u00a0 \u00a0\u00a0\u00a0 1 \u00a0 \u00a0\u00a0\u00a0\u00a0 | \u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 0.622\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a05.908\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a055.794\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Pos.\u00a0posterior\u00a0=\u00a00.9731\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0|<\/div><div class = \"text-block\">| \u00a0 \u00a0\u00a0 242 \u00a0 \u00a0\u00a0\u00a0\u00a0 | \u00a0 \u00a0\u00a0\u00a0 1 \u00a0 \u00a0\u00a0\u00a0\u00a0 | \u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 2.215\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a012.055\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a01489.879\u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Pos.\u00a0posterior\u00a0=\u00a00.9131\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0|<\/div><div class = \"text-block\">----<\/div><div class = \"text-block\">## \u00a0 FUBAR \u00a0 inferred \u00a0 6 \u00a0 sites \u00a0 subject\u00a0to\u00a0diversifying\u00a0positive\u00a0selection\u00a0at\u00a0posterior\u00a0probability\u00a0>=\u00a00.9<\/div><div class = \"text-block\">Of \u00a0 these , \u00a0 \u00a0 0.36 \u00a0 are \u00a0 expected \u00a0 to\u00a0be\u00a0false\u00a0positives\u00a0(95%\u00a0confidence\u00a0interval\u00a0of\u00a00-2\u00a0)<\/div><\/div><\/code><\/pre><\/div><br\/><br\/><\/div>"}},{"id":1054725,"guid":"D1B70042D55240F3A2918A24BD80252F","order_id":2,"type_id":26,"title":"notes","source":{"id":0,"parent_id":0,"uri":"","title":"","body":"<div class = \"text-blocks\"><div class = \"text-block\">Like other site analyses, FUBAR will print a number of inferences about each individual site detected to be under pervasive positive selection<\/div><br\/><div class = \"text-block\"><span style = \"font-weight:bold;\">alpha<\/span><\/div><div class = \"text-block\">The posterior estimate of the synonymous substitution rate at a site<\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">beta<\/span><\/div><div class = \"text-block\">The posterior estimate of the non-synonymous substitution rate at a site<\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">N.eff<\/span><\/div><div class = \"text-block\">An estimate of the effective sample size for inferring positive selection at this site; smaller values (e.g., <\u200920) imply that the MCMC procedure may have failed to sample the parameter space well, and longer chains (or more chains) might be warranted<\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">Posterior prob for positive selection<\/span><\/div><div class = \"text-block\"><span>The estimated posterior probability for pervasive diversifying selection (<\/span><span style = \"font-style:italic;\">dN<\/span><span style = \"font-style:italic;font-style:italic;\">\u2215<\/span><span style = \"font-style:italic;\">dS<\/span><span>\u2009>\u20091).<\/span><\/div><br\/><\/div>","created_on":0,"changed_on":0,"creator":{"name":"","affiliation":null,"affiliations":[],"username":"","note":null,"link":null,"image":{"source":"","placeholder":""},"badges":[],"verified":0,"is_verified_user":false,"research_interests":null,"blocked_by_you":false,"blocked_you":false,"hide_following":false},"comments":[]}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#EA9F6C","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1114216,"guid":"F46984D060C211EB96D2EBAE0011895C","previous_id":1114206,"previous_guid":"ACB0BAB060C111EB96D2EBAE0011895C","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"1161AB1B5100429F8578CAB432D991C7","order_id":1,"type_id":6,"title":"Section","source":{"title":"3.5 Site-Level Selection: MEME, FEL, SLAC, and FUBAR"}},{"id":1054724,"guid":"9ABCF6DF90BF401E9C493B3F64651BF0","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><br\/><br\/><\/div>"}},{"id":1054725,"guid":"818AA79C6AF8472E91A161FC42318DB1","order_id":2,"type_id":26,"title":"notes","source":{"id":0,"parent_id":0,"uri":"","title":"","body":"<div class = \"text-blocks\"><div class = \"text-block\"><span style = \"font-weight:bold;\">Interpreting Results<\/span><\/div><br\/><div class = \"text-block\">Sites identified as positively selected by each method, across all three datasets, are given in Table 1. In general, we expect MEME to be the most comprehensive and robust of all site-level methods because it uniquely considers both pervasive and episodic selection [24]. In addition, power studies have shown that FUBAR is expected to outperform FEL and SLAC under most circumstances [25]. Finally, we expect that SLAC will be the least robust method due to its reliance on a relatively naive counting-based approach [12].<\/div><br\/><div class = \"text-block\"><span>These expectations are generally borne out in the results obtained here in our brief study of H3 selection. For the full H3 dataset of 2555 sequences, MEME identified 16 sites, and FEL identified 15 sites under positive selection. All sites were identical except for the following: MEME uniquely identified sites 151 and 208, and FEL uniquely identified with 237. Interestingly, site 208 was additionally identified as positively selected by all methods on the trunk H3 dataset. Combined, these results demonstrate MEME\u2019s ability to identify sites subject to both pervasive and episodic selection, as site 208 appears to be under pervasive selection only along the H3 trunk. Because FEL uses a less stringent test statistic distribution (\ud835\udf12<\/span><span style = \"vertical-align:sub;vertical-align:super;\">1<\/span><span style = \"vertical-align:sub;vertical-align:super;\">2<\/span><span>) to call significance, occasionally sites subject to pervasive selection near the significance thresholds may be detected by FEL but missed by MEME (e.g., site 237, with FEL reporting <\/span><span style = \"font-style:italic;\">P<\/span><span>\u2009=\u20090.08 and MEME reporting <\/span><span style = \"font-style:italic;\">P<\/span><span>\u2009=\u20090.105).<\/span><\/div><br\/><div class = \"text-block\"><span>FUBAR identified two fewer selected sites in the full H3 alignment compared to FEL (which is a directly comparable test), missing sites 19 (posterior 0.83), 277 (posterior 0.59), and 292 (posterior 0.89) relative to FEL, but adding site 160 (FEL <\/span><span style = \"font-style:italic;\">P <\/span><span>= 0.8).<\/span><\/div><br\/><div class = \"text-block\">In addition to differences across methods, we expect to see some important differences for sites inferred across the full, shallow, and trunk H3 datasets. Because the trunk and full H3 datasets span similar time frames, we expect sites returned for these two datasets to have the most overlap. In addition, sites found to be under selection in the shallow lineage may not be detected across the full H3 phylogeny, as selection may have been fleeting, weak, or constrained to the specific shallow clade examined here. For example, site 49 was specifically selected in the shallow H3 lineage alone, as indicated by three of the four methods. In contrast, sites 19 and 241 were found to be selected in both the shallow and the full H3 datasets, but this signal was not apparent when the trunk lineage was examined independently, perhaps because these sites experience only transient changes that do not propagate along the trunk.<\/div><br\/><div class = \"text-block\">What are some potential reasons for seeing discrepancies in inferences across H3 datasets? The site 154, for example, is positively selected in both the full H3 phylogeny and the trunk H3 lineage, but not the shallow H3 lineage. This result suggests that site 154 may have experienced pervasive selection throughout H3 evolution, but its signal in the shallow clade alone was either too weak to detect or selection was attenuated in the shallow clade. In addition, sites which appeared only in the shallow clade analyses may have experienced lineage-specific selection where the signal was too weak to detect when the entire phylogeny was considered.<\/div><br\/><div class = \"text-block\"><span>Furthermore, while MEME, FEL, and FUBAR were able to detect selected sites in the shallow H3 lineage, SLAC did not identify any such sites. This is because SLAC requires a large number of substitutions, which are unlikely to have occurred in the shallow sample, to achieve significance. Overall, we emphasize that in many cases different site-level methods will <\/span><span style = \"font-weight:bold;\">not <\/span><span>identify exactly the same set of sites under selection, although, as the H3 example shows, the agreement between is typically good.<\/span><\/div><br\/><div class = \"text-block\"><span style = \"font-weight:bold;\">Rules of Thumb for Site-Level Detection of Selection<\/span><\/div><br\/><div class = \"text-block\"><ol style = \"list-style-type: decimal;\"><li style = \"counter-reset:ol0;\">Small datasets, i.e., \u2264\u200910 sequences (especially when coupled with low divergence), are unlikely to yield any sites under selection. Consider using gene-wide methods like BUSTED or aBSREL to look for selection in these cases.<\/li><li style = \"counter-reset:ol0;\">On large datasets (e.g., >\u2009500 sequences), all methods tend to give similar results (but see the MEME exception below), hence the default method of choice is FUBAR, since its run time is dramatically shorter than FEL or MEME, and its statistical performance is better than SLAC.<\/li><li style = \"counter-reset:ol0;\">MEME tends to be the most sensitive method, because it is the only one designed to detect episodic selection. Indeed, sometimes SLAC, FEL, or FUBAR may all call a site subject to episodic positive selection site negatively selected, if a burst of selection is followed by strong conservation. MEME is often able to tease the two processes apart and correctly call such sites positively selected. Hence, MEME should be the preferred method, unless computationally prohibitive.<\/li><li style = \"counter-reset:ol0;\">We cannot universally recommend running all the available methods on a given dataset and then aggregating the results, as done in Table 1, for several reasons. Firstly, while it may be tempting to use agreement between all methods as a hedge against false positives, i.e., calling a site selected only if all the methods agreed on it, reduces the power of the analysis to that of the least sensitive method. Secondly, while comparing the sites on which methods disagree can potentially reveal critical information (e.g., a site detected by MEME but not FUBAR may be under strong episodic selection), considerable effort and diligence must be put into disentangling meaningful biological differences from statistical artifacts. Thirdly, statistical strategy must be informed before the analysis commences by deciding which is more important to optimize: does one care more about specificity (reducing false positives) or sensitivity (reducing false negatives)? For example, if little is known about a gene, it may be advisable to generate the most inclusive list of sites that could be subject to selection for subsequent testing using other approaches; in this case, the most sensitive method or the union of all methods may be appropriate.<\/li><li style = \"counter-reset:ol0;\"><span>We strongly recommend against performing multiple testing or false discovery rate correction on individual site results. Firstly, methods are calibrated to not generate excessive false positives on strictly neutral data. In most genes, most sites will be under relatively strong negative selection, making the statistical testing procedure conservative. Secondly, multiple testing corrections will nearly always yield no significant results on small to moderate sized datasets. Thirdly, some key assumptions of methods for correcting false discovery rates are not applicable for site-level testing. For example, a typical collection of results from site-level testing will contain very few, if any, true sites with <\/span><span style = \"font-style:italic;\">P<\/span><span>-values supporting neutrality (<\/span><span style = \"font-style:italic;\">dN<\/span><span style = \"font-style:italic;font-style:italic;\">\u2215<\/span><span style = \"font-style:italic;\">dS<\/span><span>\u2009=\u20091).<\/span><\/li><\/ol><\/div><\/div>","created_on":0,"changed_on":0,"creator":{"name":"","affiliation":null,"affiliations":[],"username":"","note":null,"link":null,"image":{"source":"","placeholder":""},"badges":[],"verified":0,"is_verified_user":false,"research_interests":null,"blocked_by_you":false,"blocked_you":false,"hide_following":false},"comments":[]}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#EA9F6C","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1114224,"guid":"4D7AE14060C311EB96D2EBAE0011895C","previous_id":1114216,"previous_guid":"F46984D060C211EB96D2EBAE0011895C","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"A9E11843E9CF47A48471A1DB9749E428","order_id":1,"type_id":6,"title":"Section","source":{"title":"3.6 Screening Sequences for Recombination"}},{"id":1054724,"guid":"FF35F2711AE247C68A8E0D9A895F9075","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><br\/><br\/><\/div>"}},{"id":1054725,"guid":"CBB91ABD28DB487093AB971E8944CE72","order_id":2,"type_id":26,"title":"notes","source":{"id":0,"parent_id":0,"uri":"","title":"","body":"<div class = \"text-blocks\"><div class = \"text-block\"><span>A critical aspect of sequence analysis we have not yet covered is the detection of and correction for intragenic <\/span><span style = \"font-style:italic;\">recombination <\/span><span>in an alignment of homologous sequences. Because recombination is such a key biological process in many viral pathogens, we strongly advocate screening an alignment for recombination before proceeding with additional analyses, unless there is a sound biological reason to discount (i.e., intragenic recombination Influenza A is negligibly rare). Indeed, because recombination causes different regions of an alignment to be related by different phylogenies, its presence can heavily influence selection detection and other downstream applications.<\/span><\/div><br\/><div class = \"text-block\"><span>There are many computational approaches to finding evidence of recombination in a sequence alignment [32], however at their core, many such methods look for evidence of phylogenetic incongruence. Here, we demonstrate one such method, GARD (genetic algorithms for recombination detection) that we have found to perform very well among a wide range of approaches on simulated data [14]. Note that at this time, GARD will not produce a JSON file as output but instead several text files containing inference information, as well as a final <\/span><span style = \"font-style:italic;\">partitioned alignment <\/span><span>for downstream use if recombination was detected.<\/span><\/div><\/div>","created_on":0,"changed_on":0,"creator":{"name":"","affiliation":null,"affiliations":[],"username":"","note":null,"link":null,"image":{"source":"","placeholder":""},"badges":[],"verified":0,"is_verified_user":false,"research_interests":null,"blocked_by_you":false,"blocked_you":false,"hide_following":false},"comments":[]}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#E57785","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1114225,"guid":"753970C060C311EB96D2EBAE0011895C","previous_id":1114224,"previous_guid":"4D7AE14060C311EB96D2EBAE0011895C","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"5634BB37966A41F18BE7276AA28E62BE","order_id":1,"type_id":6,"title":"Section","source":{"title":"3.7 GARD"}},{"id":1054724,"guid":"9D7035CA7F47490A9C44A82D4E99C873","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><br\/><br\/><\/div>"}},{"id":1054725,"guid":"F3D60ABDD9C14A7A847DB9F430918718","order_id":2,"type_id":26,"title":"notes","source":{"id":0,"parent_id":0,"uri":"","title":"","body":"<div class = \"text-blocks\"><div class = \"text-block\"><span style = \"font-weight:bold;\">What Biological Question Is the Method Designed to Answer?<\/span><\/div><br\/><div class = \"text-block\">Have sequences in the given alignment undergone recombination, and if so what are the recombination breakpoints and segment-specific phylogenies?<\/div><br\/><div class = \"text-block\">Recommended Applications:<\/div><br\/><div class = \"text-block\">GARD is geared towards mapping the breakpoints and detecting segments of the alignment which can be adequately described by a single tree topology. Therefore, alignments, particularly alignments of viral sequences, should be screened for the presence of recombination before performing any selection inference. The NEXUS output from GARD can be directly used as input for most downstream selection detection analyses.<\/div><\/div>","created_on":0,"changed_on":0,"creator":{"name":"","affiliation":null,"affiliations":[],"username":"","note":null,"link":null,"image":{"source":"","placeholder":""},"badges":[],"verified":0,"is_verified_user":false,"research_interests":null,"blocked_by_you":false,"blocked_you":false,"hide_following":false},"comments":[]}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#EA94FF","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1114226,"guid":"A8329AB060C311EB96D2EBAE0011895C","previous_id":1114225,"previous_guid":"753970C060C311EB96D2EBAE0011895C","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"41DA2F2A6CBD4E0A85DA760B36CA75DA","order_id":1,"type_id":6,"title":"Section","source":{"title":"3.7 GARD"}},{"id":1054724,"guid":"7E6ADF17AEF74EED841AC146E0694CB2","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><br\/><br\/><div style = \"text-align :; float : ;\"><img style = \"\" src = \"https:\/\/s3.amazonaws.com\/protocols-files\/files\/ebieba7dp.jpg\" \/><\/div><br\/><br\/><\/div>"}},{"id":1054725,"guid":"D64C71FE782C42A6BD5DDC6B51A5DCCC","order_id":2,"type_id":26,"title":"notes","source":{"id":0,"parent_id":0,"uri":"","title":"","body":"<div class = \"text-blocks\"><div class = \"text-block\"><span style = \"font-weight:bold;\">Statistical Test Procedure<\/span><\/div><br\/><div class = \"text-block\"><span>GARD employs a genetic algorithm to find a solution to a complex optimization problem by mimicking processes of biological evolution (mutation, recombination, and selection) in a population of competing solutions. In this application of genetic algorithms, we are evolving a population of \u201cchromosomes\u201d that specify different numbers and locations of recombination breakpoints in the alignment with the objective of detecting topological incongruence, i.e., support for different phylogenies by separate regions of the alignment. The \u201cfitness\u201d of each chromosome is determined by using maximum likelihood methods to evaluate a separate phylogeny for each non-recombinant fragment defined by the breakpoints (e.g., to the left and to the right of a breakpoint in Fig. 4), and computing a goodness of fit (AIC<\/span><span style = \"vertical-align:sub;font-style:italic;\">c<\/span><span>) for each such model. The genetic algorithm searches for the number and placement of breakpoints yielding the best AIC<\/span><span style = \"vertical-align:sub;font-style:italic;\">c <\/span><span>and also reports confidence values for inferred breakpoint locations based on the contribution of each considered model weighted by how well the model fit the data. For computational expedience, the current implementation of GARD infers topologies for each segment using neighbor joining [37] based on the TN93 pairwise distance estimator [41] and then fits a user-specified nucleotide evolutionary model using maximum likelihood to obtain AIC<\/span><span style = \"vertical-align:sub;font-style:italic;\">c <\/span><span>scores.<\/span><\/div><\/div>","created_on":0,"changed_on":0,"creator":{"name":"","affiliation":null,"affiliations":[],"username":"","note":null,"link":null,"image":{"source":"","placeholder":""},"badges":[],"verified":0,"is_verified_user":false,"research_interests":null,"blocked_by_you":false,"blocked_you":false,"hide_following":false},"comments":[]}},{"id":1054726,"guid":"D29D587918AF4F9B8E925776051BCDC2","order_id":3,"type_id":1,"title":"description","source":{"description":"<div style = \"text-align :; float : ;\"><img style = \"\" src = \"https:\/\/s3.amazonaws.com\/protocols-files\/files\/ebieba7dp.jpg\" \/><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#EA94FF","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1114227,"guid":"ED386F4060C311EB8373EBA4E97E3F13","previous_id":1114226,"previous_guid":"A8329AB060C311EB96D2EBAE0011895C","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"F5A48D3B13D54519B2A1CDEA662B4D42","order_id":1,"type_id":6,"title":"Section","source":{"title":"3.7 GARD"}},{"id":1054724,"guid":"505964E8EA654E29A7B938CC7CD0C55D","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><br\/><br\/><div class = \"text-block\"><span>To run GARD, open a terminal session and start HYPHYMPI in the appropriate MPI environment (e.g., <\/span><span style = \"font-style:italic;\">MPIRUN <\/span><span>in OpenMPI) from the command line to launch the HyPhy analysis menu. Enter <\/span><span style = \"font-style:italic;\">12 <\/span><span>(Recombination) and then <\/span><span style = \"font-style:italic;\">1 <\/span><span>to reach the GARD analysis menu, and supply values for the following prompts:<\/span><\/div><br\/><div class = \"text-block\"><ol style = \"list-style-type: decimal;\"><li style = \"counter-reset:ol0;\"><span style = \"font-weight:bold;\">Nucleotide file to screen<\/span><span>: Provide the full path to the dataset of interest:<\/span><span style = \"font-style:italic;\"> \/path\/to\/data\/cvf.fna<\/span><span style = \"font-style:italic;\">.<\/span><\/li><li style = \"counter-reset:ol0;\"><span style = \"font-weight:bold;\">Please enter a 6-character model designation (e.g., 010010 defines HKY85)<\/span><span>. This option controls which nucleotide substitution model is to be used for analysis, using PAUP notational shorthand. The six-character shorthand allows the user to specify the entire spectrum from F81 (000000) to GTR (012345), which we recommend as default option. Provide the value <\/span><span style = \"font-style:italic;\">012345 <\/span><span>for this prompt.<\/span><\/li><li style = \"counter-reset:ol0;\"><span style = \"font-weight:bold;\">Rate variation options<\/span><span>. This option determines how site-to-site rate variation should be modeled. The option <\/span><span style = \"font-style:italic;\">None <\/span><span>will discount site-to-site rate variation, allowing the analysis to run several times faster than other options but also creating the risk of mistaking rate heterogeneity for recombination. As such, we can only recommend this option for extremely small alignments (i.e., 3\u20135 sequences). The option <\/span><span style = \"font-style:italic;\">General Discrete <\/span><span>(the default) models rate variation using an <\/span><span style = \"font-style:italic;\">N <\/span><span>bin general discrete distribution, and option <\/span><span style = \"font-style:italic;\">Beta-Gamma<\/span><span> models rate variation using an adaptively discretized distribution, a more flexible version of the standard Gamma+4 model. Enter option <\/span><span style = \"font-style:italic;\">2<\/span><span> to select the General Discrete model.<\/span><\/li><li style = \"counter-reset:ol0;\"><span style = \"font-weight:bold;\">How many distribution bins [2\u201332]?<\/span><span>. If rate variation was selected in the previous step, this option allows the user to decide how many different rate classes should be included in the model. We recommend using 3 rate classes by default, as both General Discrete and Beta-Gamma distributions are flexible enough to reliably capture rate variability in the majority of alignments with only a few rate classes. Therefore, enter the value <\/span><span style = \"font-style:italic;\">3<\/span><span>.<\/span><\/li><li style = \"counter-reset:ol0;\"><span style = \"font-weight:bold;\">Save results to<\/span><span>. For this option, provide a full path to the output file to which you would like GARD to write results. The supplied file name will ultimately contain an HTML-formatted summary of the analysis. HyPhy will generate several other files with names obtained by appending suffixes (as in<file name>_suffix) to the main result file. In particular, the <\/span><span style = \"font-style:italic;\">_finalout<\/span><span> file stores the original alignment in NEXUS format with inferred non-recombinant sections of the alignment saved in the <\/span><span style = \"font-style:italic;\">ASSUMPTIONS <\/span><span>block and trees inferred for each partition in the <\/span><span style = \"font-style:italic;\">TREES <\/span><span>block. This NEXUS file can be input into many recombination-aware analyses in HyPhy and other programs that can read NEXUS. The <\/span><span style = \"font-style:italic;\">_ga_details<\/span><span> file contains two lines of information about each model examined by the genetic algorithm: its AICc score and the location of breakpoints in the model. Finally, the<\/span><span style = \"font-style:italic;\"> _ga_splits<\/span><span> file stores information about the location of breakpoints and trees inferred for each alignment region under the best model found by the GA.<\/span><\/li><\/ol><\/div><br\/><div class = \"text-block\">GARD will now run to completion, printing status indicators to screen while it runs.<\/div><\/div>"}},{"id":1054725,"guid":"E05830885435469C84280A9734DE082B","order_id":2,"type_id":26,"title":"notes","source":{"id":0,"parent_id":0,"uri":"","title":"","body":"<div class = \"text-blocks\"><div class = \"text-block\"><span style = \"font-weight:bold;\">Example Analysis 1<\/span><\/div><br\/><div class = \"text-block\"><span>We will demonstrate the use of GARD, as well as its benefits for downstream analysis, using a dataset consisting of 13 glycoprotein sequences from Cache Valley Fever virus (<\/span><span style = \"font-style:italic;\">cvf.fna<\/span><span>). We will first use GARD to detect recombination in this dataset, and then we will process both the GARD-informed data and the original alignment (with no recombination assumed) with FEL to see how the presence of recombination may confound selection inference.<\/span><\/div><br\/><div class = \"text-block\"><span>Importantly, GARD specifically requires the use of HyPhy\u2019s MPI-enabled executable, HYPHYMPI. To run GARD from the command line, you will need an operating system with a MPI headers and libraries installed so that this executable can be compiled. Here, we will describe how to use GARD from the command line, but we emphasize that GARD is fully implemented and available on <\/span><a href=\"http:\/\/www.datamonkey.org\" style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;:UNDERLINE;\">www.datamonkey.org<\/span><\/a><span style = \":;:UNDERLINE;\"> <\/span><span>and takes the same input options described here.<\/span><\/div><\/div>","created_on":0,"changed_on":0,"creator":{"name":"","affiliation":null,"affiliations":[],"username":"","note":null,"link":null,"image":{"source":"","placeholder":""},"badges":[],"verified":0,"is_verified_user":false,"research_interests":null,"blocked_by_you":false,"blocked_you":false,"hide_following":false},"comments":[]}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#EA94FF","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1114231,"guid":"B8F2D2B060C411EB8373EBA4E97E3F13","previous_id":1114227,"previous_guid":"ED386F4060C311EB8373EBA4E97E3F13","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"85BDA2AACA254C9D9D035DC706DD1742","order_id":1,"type_id":6,"title":"Section","source":{"title":"3.7 GARD"}},{"id":1054724,"guid":"EA10C376CFD44132AA24C35422EEAF10","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Listing 8 Partial GARD output<\/div><br\/><div class = \"text-block\"><pre><code><div class = \"text-blocks\"><div class = \"text-block\">Fitting a baseline nucleotide model...\nDone with single partition analysis.\u00a0Log(L)\u00a0=\u00a0-5921.9511901113,\u00a0c-AIC\u00a0=\u00a011914.85153276497\nStarting the GA ...<\/div><br\/><div class = \"text-block\">GENERATION 2 with 1 breakpoints\u00a0(~0%\u00a0converged)\nBreakpoints \u00a0\u00a0\u00a0 c - AIC \u00a0 Delta c - AIC\u00a0[BP\u00a0 \u00a0\u00a0\u00a0\u00a01]\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 0 11914.85\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 1 11804.56 \u00a0 \u00a0\u00a0 110.291 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a01393\nGA has considered \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 92\/ \u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0328\u00a0(92\u00a0over\u00a0all\u00a0runs)\u00a0unique\u00a0models\nTotal run time \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 0 hrs 0 mins\u00a02\u00a0seconds\nThroughput \u00a0\u00a0 \u00a0\u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 \u00a0 46.00 models\/second\nAllocated time remaining 999 hrs\u00a059\u00a0mins\u00a058\u00a0seconds\u00a0(approx.\u00a0165599908\u00a0more\u00a0models.)\n...\nGENERATION 52 with 4 breakpoints\u00a0(~100%\u00a0converged)\nBreakpoints \u00a0\u00a0\u00a0 c - AIC \u00a0 Delta c - AIC\u00a0[BP\u00a0\u00a0\u00a0\u00a0\u00a0\u00a01]\u00a0[BP\u00a0\u00a0\u00a0\u00a0\u00a0\u00a02]\u00a0[BP\u00a0\u00a0\u00a0\u00a0\u00a0\u00a03]\u00a0[BP\u00a0\u00a0\u00a0\u00a0\u00a0\u00a04]\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 0 11914.85\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 1 11804.56 \u00a0 \u00a0\u00a0 110.291 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a01445\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 2 11783.92 \u00a0 \u00a0\u00a0\u00a0 20.638 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0\u00a0 617\u00a0 \u00a0\u00a0\u00a0\u00a0\u00a01490\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 3 11778.94 \u00a0 \u00a0\u00a0\u00a0\u00a0 4.978 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0\u00a0 587\u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 962\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a01475\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 4 11778.94 \u00a0 \u00a0\u00a0\u00a0\u00a0 0.000 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0\u00a0 587\u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 962\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a01475\nGA has considered \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 268\/ \u00a0\u00a0 473490550\u00a0(1356\u00a0over\u00a0all\u00a0runs)\u00a0unique\u00a0models\nTotal run time \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 0 hrs 4 \u00a0mins\u00a02\u00a0seconds\nThroughput \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 5.60 models\/second\nAllocated time remaining 999 hrs\u00a055\u00a0mins\u00a058\u00a0seconds\u00a0(approx.\u00a020170544.82644628\u00a0more\u00a0models.)\nPerforming the final optimization...<\/div><\/div><\/code><\/pre><\/div><br\/><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#EA94FF","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1114233,"guid":"CD3D5F6060C411EB8373EBA4E97E3F13","previous_id":1114231,"previous_guid":"B8F2D2B060C411EB8373EBA4E97E3F13","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"D1D1779C344F475698558D2AB0A0C53F","order_id":1,"type_id":6,"title":"Section","source":{"title":"3.7 GARD"}},{"id":1054724,"guid":"72E9B417751B457EAE23EDA5B988533B","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><br\/><br\/><\/div>"}},{"id":1054725,"guid":"D343D45F39FA4758A38D45BD718DCE32","order_id":2,"type_id":26,"title":"notes","source":{"id":0,"parent_id":0,"uri":"","title":"","body":"<div class = \"text-blocks\"><div class = \"text-block\"><span style = \"font-weight:bold;\">Interpreting Results<\/span><\/div><br\/><div class = \"text-block\"><span>GARD found evidence of recombination in this dataset with three breakpoints, yielding a 135.9 point AIC<\/span><span style = \"vertical-align:sub;font-style:italic;\">c <\/span><span>improvement over the model without recombination. Among all models with three breakpoints in the Cache Valley Virus glycoprotein alignment, the best model places them at nucleotides 587, 962, and 1475. Importantly, if GARD had reported that the best model had 0 breakpoints, we could conclude that no evidence of recombination had been found. Note that because genetic algorithms are stochastic, there is no guarantee that replicate runs will converge to exactly the same quantitative results. When there is a strong signal of recombination breakpoints in the data, however, the qualitative results (number and general location of breakpoints) should be fairly robust.<\/span><\/div><\/div>","created_on":0,"changed_on":0,"creator":{"name":"","affiliation":null,"affiliations":[],"username":"","note":null,"link":null,"image":{"source":"","placeholder":""},"badges":[],"verified":0,"is_verified_user":false,"research_interests":null,"blocked_by_you":false,"blocked_you":false,"hide_following":false},"comments":[]}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#EA94FF","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1114234,"guid":"DA5879A060C411EB8373EBA4E97E3F13","previous_id":1114233,"previous_guid":"CD3D5F6060C411EB8373EBA4E97E3F13","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"AAE1094B8AB8494BB95D5CE963BA5CDA","order_id":1,"type_id":6,"title":"Section","source":{"title":"3.7 GARD"}},{"id":1054724,"guid":"744F2076A84749F5B296D559D9781F0D","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><br\/><br\/><\/div>"}},{"id":1054725,"guid":"1D2D6A634C0047D196949775C3FC048B","order_id":2,"type_id":26,"title":"notes","source":{"id":0,"parent_id":0,"uri":"","title":"","body":"<div class = \"text-blocks\"><div class = \"text-block\"><span style = \"font-weight:bold;\">Example Analysis 2<\/span><\/div><br\/><div class = \"text-block\"><span>The NEXUS file that GARD produced is a <\/span><span style = \"font-style:italic;\">partitioned dataset<\/span><span>, wherein different groups of sites are described by different trees. Most HyPhy selection analyses discussed here (<\/span><span style = \"font-style:italic;\">see<\/span><span> footnote 6), including MEME, FUBAR, FEL, SLAC, and BUSTED, are able to analyze partitioned data. To demonstrate the importance of screening for recombination, we will now compare results for a FEL analysis performed on the original alignment of 13 Cache Valley Virus glycoproteins, as well as on the GARD-inferred partitioned alignment. All steps here were carried out as described earlier in this chapter.<\/span><\/div><\/div>","created_on":0,"changed_on":0,"creator":{"name":"","affiliation":null,"affiliations":[],"username":"","note":null,"link":null,"image":{"source":"","placeholder":""},"badges":[],"verified":0,"is_verified_user":false,"research_interests":null,"blocked_by_you":false,"blocked_you":false,"hide_following":false},"comments":[]}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#EA94FF","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1114235,"guid":"EA7980E060C411EB8373EBA4E97E3F13","previous_id":1114234,"previous_guid":"DA5879A060C411EB8373EBA4E97E3F13","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"EEDE9BB3B4F04CC6839EF61269839828","order_id":1,"type_id":6,"title":"Section","source":{"title":"3.7 GARD"}},{"id":1054724,"guid":"DA07CBF506674CB5B1C098F9A4AF5DC1","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><br\/><br\/><\/div>"}},{"id":1054725,"guid":"AF53DECFA0B84A69A0253C16B5BC7454","order_id":2,"type_id":26,"title":"notes","source":{"id":0,"parent_id":0,"uri":"","title":"","body":"<div class = \"text-blocks\"><div class = \"text-block\"><span style = \"font-weight:bold;\">Interpreting Results<\/span><\/div><br\/><div class = \"text-block\"><span>FEL inference on the GARD-processed partitioned Cache Valley Virus data does not detect sites under selection at <\/span><span style = \"font-style:italic;\">P<\/span><span>\u2009\u2264\u20090.1. By contrast, FEL inference on the unpartitioned Cache Valley Virus data (i.e., not pre-screened for recombination) detects three positively selected sites at <\/span><span style = \"font-style:italic;\">P<\/span><span>\u2009\u2264\u20090.1 (212, 516, and 558 at <\/span><span style = \"font-style:italic;\">P<\/span><span>\u2009=\u20090.08, <\/span><span style = \"font-style:italic;\">P<\/span><span>\u2009=\u20090.03, and <\/span><span style = \"font-style:italic;\">P<\/span><span>\u2009=\u20090.09, respectively). From these results, we can clearly tell that not screening or recombination has the potential for adverse consequence including an increased false positive rate as seen here. As such, we strongly encourage users to screen alignments for recombination if such processes are suspected before proceeding to selection detection.<\/span><\/div><\/div>","created_on":0,"changed_on":0,"creator":{"name":"","affiliation":null,"affiliations":[],"username":"","note":null,"link":null,"image":{"source":"","placeholder":""},"badges":[],"verified":0,"is_verified_user":false,"research_interests":null,"blocked_by_you":false,"blocked_you":false,"hide_following":false},"comments":[]}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#EA94FF","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1114236,"guid":"008852D060C511EB8373EBA4E97E3F13","previous_id":1114235,"previous_guid":"EA7980E060C411EB8373EBA4E97E3F13","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"F6C8C7632BD242E3A57A8F9996448DE0","order_id":1,"type_id":6,"title":"Section","source":{"title":"3.8 Accounting for Synonymous Rate Variation"}},{"id":1054724,"guid":"9CB5F5619EB447FE96627763C906AE7D","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><br\/><br\/><\/div>"}},{"id":1054725,"guid":"D4D34C0081B842E99846AB2596C65AA3","order_id":2,"type_id":26,"title":"notes","source":{"id":0,"parent_id":0,"uri":"","title":"","body":"<div class = \"text-blocks\"><div class = \"text-block\"><span>A critical genomic process that one must consider when detecting selection is the phenomenon of <\/span><span style = \"font-style:italic;\">synonymous rate variation<\/span><span>, wherein the rate of synonymous codon evolution (represented by <\/span><span style = \"font-style:italic;\">dS <\/span><span>in the context of codon models and representing mutation rate) varies across species, genes, and even intragenic positions. In particular, intragenic synonymous rate variation has been identified across domains of life [11, 20, 30] and can arise from a variety of evolutionary processes, including selection on mRNA secondary structure [2], gene expression [4], GC-biased gene conversion [10], and other neutral mutation processes. For example, even the genomic context of a given nucleotide can influence its mutation rate; indeed, experimental work has shown that GC-neighboring sites can feature up to a 75-fold increase in mutation rate [20, 38]. In addition, the synonymous rate at certain sites may be elevated due to the mutational vulnerability of the non-template DNA strand during transcription [20]. These processes must be accounted for in order to ensure an appropriate baseline <\/span><span style = \"font-style:italic;\">dS <\/span><span>is used when testing for selection.<\/span><\/div><br\/><div class = \"text-block\">We demonstrate the importance of considering synonymous rate variation for selection inference using a dataset of 10 mammalian CD2 genes, which code for a specific T-cell surface adhesion molecule [21]. We use FEL to detect selection in this dataset under two specifications: with synonymous rate variation (\u201cyes\u201d in prompt 4 in the FEL analysis menu), and without synonymous rate variation (\u201cno\u201d in prompt 4 in the FEL analysis menu).<\/div><\/div>","created_on":0,"changed_on":0,"creator":{"name":"","affiliation":null,"affiliations":[],"username":"","note":null,"link":null,"image":{"source":"","placeholder":""},"badges":[],"verified":0,"is_verified_user":false,"research_interests":null,"blocked_by_you":false,"blocked_you":false,"hide_following":false},"comments":[]}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#A492FF","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1114237,"guid":"1C8F4FB060C511EB8373EBA4E97E3F13","previous_id":1114236,"previous_guid":"008852D060C511EB8373EBA4E97E3F13","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"3B67E7112DAC41C9850D5109D74A7E0D","order_id":1,"type_id":6,"title":"Section","source":{"title":"3.8 Accounting for Synonymous Rate Variation"}},{"id":1054724,"guid":"5B5A2FBA5983443AB42C5FAAF3DEA1B5","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><br\/><br\/><div style = \"text-align :; float : ;\"><img style = \"\" src = \"https:\/\/s3.amazonaws.com\/protocols-files\/files\/ebiiba7dp.jpg\" \/><\/div><br\/><br\/><\/div>"}},{"id":1054725,"guid":"8E1961A7610743158228B8702EE154E7","order_id":2,"type_id":26,"title":"notes","source":{"id":0,"parent_id":0,"uri":"","title":"","body":"<div class = \"text-blocks\"><div class = \"text-block\"><span style = \"font-weight:bold;\">Interpreting Results<\/span><\/div><br\/><div class = \"text-block\"><span>At <\/span><span style = \"font-style:italic;\">P<\/span><span>\u2009\u2264\u20090.1, analysis of CD2 <\/span><span style = \"font-style:italic;\">with <\/span><span>synonymous rate variation revealed a total of 14 sites under positive selection. By contrast, CD2 analysis with FEL without <\/span><span style = \"font-style:italic;\">dS <\/span><span>variation only detected four sites under positive selection (Fig. 5). Similarly, analysis with <\/span><span style = \"font-style:italic;\">dS <\/span><span>variation revealed 27 sites under purifying selection, but analysis without <\/span><span style = \"font-style:italic;\">dS <\/span><span>variation revealed only 15 sites under purifying selection. Most importantly, all sites detected when <\/span><span style = \"font-style:italic;\">dS <\/span><span>was fixed to 1 were a subset of the sites identified by the model with <\/span><span style = \"font-style:italic;\">dS <\/span><span>variation (Fig. 5). Together, these results demonstrate that ignoring <\/span><span style = \"font-style:italic;\">dS <\/span><span>variation can induce both an increased false negative rate regarding positive selection detection and an overall decrease in power to detect any selective regime. We acknowledge that it is possible that the opposite conclusion might be true, namely, that additional sites identified by FEL with <\/span><span style = \"font-style:italic;\">dS <\/span><span>variation might instead be false positives. However, in our experience, this is much less frequently the case [12].<\/span><\/div><\/div>","created_on":0,"changed_on":0,"creator":{"name":"","affiliation":null,"affiliations":[],"username":"","note":null,"link":null,"image":{"source":"","placeholder":""},"badges":[],"verified":0,"is_verified_user":false,"research_interests":null,"blocked_by_you":false,"blocked_you":false,"hide_following":false},"comments":[]}},{"id":1054726,"guid":"77047D9048274C14A41AF0DB1958CC54","order_id":3,"type_id":1,"title":"description","source":{"description":"<div style = \"text-align :; float : ;\"><img style = \"\" src = \"https:\/\/s3.amazonaws.com\/protocols-files\/files\/ebiiba7dp.jpg\" \/><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#A492FF","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1114239,"guid":"788B21E060C511EB8373EBA4E97E3F13","previous_id":1114237,"previous_guid":"1C8F4FB060C511EB8373EBA4E97E3F13","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"39C3D88BBB784173A81C62B99A0B1232","order_id":1,"type_id":6,"title":"Section","source":{"title":"4 Tips"}},{"id":1054724,"guid":"CF39AAE62B6D4059BCB2573BF2E6D79D","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><br\/><br\/><\/div>"}},{"id":1054725,"guid":"C43E244154D141D28D38521887695F9C","order_id":2,"type_id":26,"title":"notes","source":{"id":0,"parent_id":0,"uri":"","title":"","body":"<div class = \"text-blocks\"><div class = \"text-block\">Here we provide some helpful notes on HyPhy usage.<\/div><br\/><div class = \"text-block\"><ul style = \"list-style-type:disc;\"><li style = \"counter-reset:ol0;list-style-type:disc;\"><span>An actively maintained board for usage questions and filing bug reports is available at <\/span><span style = \"font-style:italic;\">https:\/\/github.com\/veg\/hyphy\/issues<\/span><span style = \"font-style:italic;\">.<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span>Each HyPhy analysis described here will export a JSON file. This file can either be uploaded to <\/span><span style = \"font-weight:bold;\">HyPhy-Vision <\/span><span>for visual examination, or it can be easily parsed using a standard scripting language using standard packages, for example, the <\/span><span style = \"font-style:italic;\">json <\/span><span>package in Python or the <\/span><span style = \"font-style:italic;\">jsonLite <\/span><span>package in R. All fields used in these output files are defined in <\/span><a href=\"http:\/\/hyphy.org\" style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;:UNDERLINE;\">http:\/\/hyphy.org<\/span><\/a><span style = \":;:UNDERLINE;\">.<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Mac OS(X) users may need to install a new set of compilers (i.e., gcc-6) that are compatible with openMP in order to have full functionality from the HYPHYMP executable, as is described on the HyPhy website.<\/li><\/ul><\/div><\/div>","created_on":0,"changed_on":0,"creator":{"name":"","affiliation":null,"affiliations":[],"username":"","note":null,"link":null,"image":{"source":"","placeholder":""},"badges":[],"verified":0,"is_verified_user":false,"research_interests":null,"blocked_by_you":false,"blocked_you":false,"hide_following":false},"comments":[]}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#94EBFF","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1114244,"guid":"B42AF4F060C511EB8373EBA4E97E3F13","previous_id":1114239,"previous_guid":"788B21E060C511EB8373EBA4E97E3F13","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"B33ADE9D6DE548E7AFEF894DBF6BF883","order_id":1,"type_id":6,"title":"Section","source":{"title":"5 Exercises"}},{"id":1054724,"guid":"1D61666D9B7D471589FA304150535303","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\"><span>Earlier, we performed a BUSTED analysis without designating a specific subset of test lineages. For this exercise, we will analyze the HIV-1 transmission dataset with BUSTED in two different ways: testing all branches, and testing only recipient-derived HIV-1 sequences. The input data for this exercise, with an appropriately labeled phylogeny, is available in<\/span><span style = \"font-style:italic;\"> exercises\/hiv1_transmission_exercise1.fna<\/span><span>. For select branches labeled <\/span><span style = \"font-style:italic;\">All <\/span><span>or <\/span><span style = \"font-style:italic;\">test<\/span><span> as the test lineages.<\/span><\/div><br\/><div class = \"text-block\"><ul style = \"list-style-type:disc;\"><li style = \"counter-reset:ol0;list-style-type:disc;\"><span>Is there evidence (compare model fits using the small sample AIC) that <\/span><span style = \"font-style:italic;\">test <\/span><span>branches have a different selective regime than the rest of the tree?<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">The entire dataset should provide evidence for episodic diversification, but the recipient only analysis should return a negative result. What does this mean biologically, i.e., where does the selection signal come from?<\/li><\/ul><\/div><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#84CE84","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1114245,"guid":"DC1612B060C511EB8373EBA4E97E3F13","previous_id":1114244,"previous_guid":"B42AF4F060C511EB8373EBA4E97E3F13","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"3919F283A60542239D950B9DDFEDAE63","order_id":1,"type_id":6,"title":"Section","source":{"title":"5 Exercises"}},{"id":1054724,"guid":"7A827B2982FF4A8491DE2AF29FF5E9B6","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\"><span>Investigate the effect of recombination of site-specific inference of episodic selection using MEME. Run MEME on <\/span><span style = \"font-style:italic;\">exercises\/cvf.fna <\/span><span>(single partition data, i.e., assuming no recombination), and then on the same dataset screened for recombination using GARD<\/span><span style = \"font-style:italic;\"> exercises\/cvf_gard.nexus<\/span><span>, testing for selection on <\/span><span style = \"font-style:italic;\">all <\/span><span>branches, with <\/span><span style = \"font-style:italic;\">P=0.1<\/span><span>. Compare the list of sites detected to be under selection by the two analyses.<\/span><\/div><br\/><div class = \"text-block\"><ul style = \"list-style-type:disc;\"><li style = \"counter-reset:ol0;list-style-type:disc;\">Which analysis generated more positive results?<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Do you think these results are true or false positives? How does this compare to the FEL analysis we described in the text?<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span>Compare site-wise estimates of substitution rates (e.g., <\/span><span style = \"font-style:italic;\">\u03b1<\/span><span>) between the two analyses. Is there a discernible bias introduced by not accounting for recombination?<\/span><\/li><\/ul><\/div><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#84CE84","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1114246,"guid":"00EDFD0060C611EB8373EBA4E97E3F13","previous_id":1114245,"previous_guid":"DC1612B060C511EB8373EBA4E97E3F13","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"4FFF511EB05D4663B841DDAF2BA7AFFA","order_id":1,"type_id":6,"title":"Section","source":{"title":"5 Exercises"}},{"id":1054724,"guid":"88CF72D11D764438891905F5EC78909E","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\"><span>When analyzing intraspecies or intrahost data, <\/span><span style = \"font-style:italic;\">dN<\/span><span style = \"font-style:italic;font-style:italic;\">\u2215<\/span><span style = \"font-style:italic;\">dS <\/span><span>estimates may be inflated due to the fact that not all observed sequence variation are due to substitutions, but some are simply mutations that have not yet been filtered by selection [17, 23, 31, 35]. In other words, <\/span><span style = \"font-style:italic;\">dN<\/span><span style = \"font-style:italic;font-style:italic;\">\u2215<\/span><span style = \"font-style:italic;\">dS <\/span><span>may be elevated by intraspecies\/intrahost polymorphism that should not necessarily be attributed to positive selection. One simple approach to mitigating this undesirable effect is to restrict site-specific analyses to <\/span><span style = \"font-style:italic;\">Internal <\/span><span>branches only. Internal branches are less likely to contain spurious polymorphic variants because they encompass at least one process on which selection can act (i.e., transmission and\/or multiple rounds of replication). Apply MEME and FEL to an intrahost sample of HIV-1 sequences, found in <\/span><span style = \"font-style:italic;\">exercises\/JS1774.nex<\/span><span>, from an infected individual analyzed in Lorenzo-Redondo et al. [19] first choosing to test <\/span><span style = \"font-style:italic;\">All <\/span><span>branches, and next choosing <\/span><span style = \"font-style:italic;\">Internal <\/span><span>branches.<\/span><\/div><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#84CE84","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1114248,"guid":"2657EE2060C611EB8373EBA4E97E3F13","previous_id":1114246,"previous_guid":"00EDFD0060C611EB8373EBA4E97E3F13","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"68CDF32836C340738EEF581C7D5E6AC3","order_id":1,"type_id":6,"title":"Section","source":{"title":"5 Exercises"}},{"id":1054724,"guid":"51837D58BC95486EB9421EB5E16A3A9B","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Compare the lists of selected sites between All\/Internal analyses. How different are they?<\/div><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#84CE84","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1114249,"guid":"2AD75BC060C611EB8373EBA4E97E3F13","previous_id":1114248,"previous_guid":"2657EE2060C611EB8373EBA4E97E3F13","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"AF9C8A3A7EDE4C8394010490BB317EBD","order_id":1,"type_id":6,"title":"Section","source":{"title":"5 Exercises"}},{"id":1054724,"guid":"3A9F6921738C450E99703644757E5031","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\"><span>Use RELAX to formally test whether or not selective regimes (<\/span><span style = \"font-style:italic;\">dN<\/span><span style = \"font-style:italic;font-style:italic;\">\u2215<\/span><span style = \"font-style:italic;\">dS <\/span><span>distributions) are different between terminal and internal branches in<\/span><span style = \"font-style:italic;\"> exercises\/JS1774.nex<\/span><span>.<\/span><\/div><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#84CE84","section_duration":0,"critical":null,"critical_id":null,"duration":0}],"document":"","materials":[],"description":"<div class = \"text-blocks\"><div class = \"text-block\">Natural selection is a fundamental force shaping organismal evolution, as it both maintains function and enables adaptation and innovation. Viruses, with their typically short and largely coding genomes, experience strong and diverse selective forces, sometimes acting on timescales that can be directly measured. These selection pressures emerge from an antagonistic interplay between rapidly changing fitness requirements (immune and antiviral responses from hosts, transmission between hosts, or colonization of new host species) and functional imperatives (the ability to infect hosts or host cells and replicate within hosts). Indeed, computational methods to quantify these evolutionary forces using molecular sequence data were initially, dating back to the 1980s, applied to the study of viral pathogens. This preference largely emerged because the strong selective forces are easiest to detect in viruses, and, of course, viruses have clear biomedical relevance. Recent commoditization of affordable high-throughput sequencing has made it possible to generate truly massive genomic data sets, on which powerful and accurate methods can yield a very detailed depiction of when, where, and (sometimes) how viral pathogens respond to various selective forces.<\/div><br\/><div class = \"text-block\">Here, we present recent statistical developments and state-of-the-art methods to identify and characterize these selection pressures from protein-coding sequence alignments and phylogenies. Methods described here can reveal critical information about various evolutionary regimes, including whole-gene selection, lineage-specific selection, and site-specific selection acting upon viral genomes, while accounting for confounding biological processes, such as recombination and variation in mutation rates.<\/div><\/div>","changed_on":1630617679}