{"id":45566,"title":"Plasmid Sequence Assembly from Long Reads","title_html":"<p>Plasmid Sequence Assembly from Long Reads<\/p>","image":{"source":"https:\/\/www.protocols.io\/img\/default_protocol.png","placeholder":"https:\/\/www.protocols.io\/img\/default_protocol.png"},"doi":"dx.doi.org\/10.17504\/protocols.io.bqq6mvze","doi_status":2,"uri":"plasmid-sequence-assembly-from-long-reads-bqq6mvze","type_id":1,"template_id":1,"published_on":1608004803,"parent_protocols":[],"parent_collections":[],"cited_protocols":[],"version_id":0,"version_data":{"id":"0","code":"bqq6mvze","parent_id":0,"parent_uri":null,"is_same_owner":false,"has_pending_merge_request":false,"has_approved_merge_request":false},"created_on":1607997520,"modified_on":null,"categories":null,"public":1,"is_unlisted":0,"creator":{"name":"David A. Eccles","affiliation":"Malaghan Institute of Medical Research (NZ)","affiliations":[{"affiliation":"Malaghan Institute of Medical Research (NZ)","url":"http:\/\/www.malaghan.org.nz\/","is_default":1}],"username":"david-eccles","note":null,"link":null,"image":{"source":"https:\/\/s3.amazonaws.com\/pr-journal\/vi7jpt6.jpg","placeholder":"https:\/\/s3.amazonaws.com\/pr-journal\/vi7jpt6.jpg"},"badges":[{"id":4,"image":{"source":"\/img\/badges\/gold.svg","placeholder":"\/img\/badges\/gold.svg"},"name":"Gold power author!"},{"id":6,"image":{"source":"\/img\/badges\/accelerator.svg","placeholder":"\/img\/badges\/accelerator.svg"},"name":"Science accelerator"}],"verified":0,"is_verified_user":false,"research_interests":null,"blocked_by_you":false,"blocked_you":false,"hide_following":false},"journal":null,"journal_name":null,"journal_link":null,"article_citation":null,"has_versions":0,"link":"","total_collections":0,"number_of_steps":7,"authors":[{"name":"David Eccles","affiliation":"Malaghan Institute of Medical Research (NZ)","affiliations":[],"username":"david-eccles","note":null,"link":null,"image":{"source":"https:\/\/s3.amazonaws.com\/pr-journal\/vi7jpt6.jpg","placeholder":"https:\/\/s3.amazonaws.com\/pr-journal\/vi7jpt6.jpg"},"badges":[],"verified":1,"is_verified_user":true,"research_interests":null,"blocked_by_you":false,"blocked_you":false,"hide_following":false}],"versions":[],"groups":[],"is_owner":1,"has_subprotocols":0,"is_subprotocol":0,"is_bookmarked":0,"can_claim_authorship":0,"can_accept_authorship":0,"can_be_copied":1,"can_remove_fork":1,"fork_id":null,"url":"https:\/\/www.protocols.io\/view\/plasmid-sequence-assembly-from-long-reads-bqq6mvze","forks_count":{"private":0,"public":0},"access":{"can_view":1,"can_remove":0,"can_add":0,"can_edit":0,"can_publish":0,"can_get_doi":0,"can_share":1,"can_move":1,"can_move_outside":1,"can_transfer":1,"can_download":1,"is_locked":0},"guid":"2D6C9F5704F44BD4ADE94450C0E73210","state_version_id":462,"steps":[{"id":1092926,"guid":"1FA068BD03A94A75BC3012657F94B67C","previous_id":null,"previous_guid":null,"modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"A3F50193B56847B8878B2534C95D1C53","order_id":1,"type_id":6,"title":"Section","source":{"title":"Read file preparation"}},{"id":1054724,"guid":"B6B8DB85E0984E738A80423848850E5D","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\"><span>This protocol assumes a base directory that includes the <\/span><span style = \"font-style:italic;\">fastq_pass<\/span><span> and <\/span><span style = \"font-style:italic;\">fastq_fail<\/span><span> folders, with barcode-split reads inside them.<\/span><\/div><div class = \"text-block\">If this has been done, then the following command should produce output without errors:<\/div><div class = \"text-block\"><pre><code><div class = \"text-blocks\"><div class = \"text-block\">ls -d fastq_pass\/barcode??<\/div><\/div><\/code><\/pre><\/div><div class = \"text-block\">Example output:<\/div><div class = \"text-block\"><pre><code><div class = \"text-blocks\"><div class = \"text-block\">fastq_pass\/barcode01  fastq_pass\/barcode03  fastq_pass\/barcode05<\/div><div class = \"text-block\">fastq_pass\/barcode07  fastq_pass\/barcode11  fastq_pass\/barcode02<\/div><div class = \"text-block\">fastq_pass\/barcode04  fastq_pass\/barcode06  fastq_pass\/barcode09<\/div><div class = \"text-block\">fastq_pass\/barcode12<\/div><\/div><\/code><\/pre><\/div><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#A492FF","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1092943,"guid":"9F8AFB703E7A11EBBFC439B6B84CAC5C","previous_id":1092945,"previous_guid":"B5714BE03E7C11EBBFC439B6B84CAC5C","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"7466B1A8BCA649AEA2E3109DA34AEC7C","order_id":1,"type_id":6,"title":"Section","source":{"title":"Read filitering"}},{"id":1054724,"guid":"079850F5CDFD4AE6B5E1F2051B3C62D1","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Filter out any reads that are less than half of the target read length, and determine the average quality of the remainder, keeping information on (at most) 200 of the highest-quality reads:<\/div><div class = \"text-block\"><pre><code><div class = \"text-blocks\"><div class = \"text-block\">cat results\/read_L50.txt | while read bc len;<\/div><div class = \"text-block\">  do echo ${bc} ${len};<\/div><div class = \"text-block\">  ~\/scripts\/fastx-compstats.pl fastq_pass\/${bc}\/*.fastq | sort -t ',' -k 16rn,16 | \\<\/div><div class = \"text-block\">    awk -F ',' -v \"len=${len}\" '{if($18 > (len * 500)){print}}' | \\<\/div><div class = \"text-block\">    head -n 200 | grep -v '^name' > results\/bestLong_200X_${bc}.csv;<\/div><div class = \"text-block\">done<\/div><\/div><\/code><\/pre><\/div><div class = \"text-block\">Check how successful the sequencer was at getting 200X coverage by counting lines:<\/div><div class = \"text-block\"><pre><code><div class = \"text-blocks\"><div class = \"text-block\">wc -l results\/bestLong_200X_*.csv<\/div><\/div><\/code><\/pre><\/div><div class = \"text-block\">Example output:<\/div><div class = \"text-block\"><pre><code><div class = \"text-blocks\"><div class = \"text-block\"> 146 results\/bestLong_200X_barcode03.csv<\/div><div class = \"text-block\"> 160 results\/bestLong_200X_barcode04.csv<\/div><div class = \"text-block\"> 124 results\/bestLong_200X_barcode05.csv<\/div><div class = \"text-block\"> 200 results\/bestLong_200X_barcode07.csv <\/div><div class = \"text-block\"> 200 results\/bestLong_200X_barcode09.csv<\/div><div class = \"text-block\"> 200 results\/bestLong_200X_unclassified.csv<\/div><div class = \"text-block\">1030 total<\/div><\/div><\/code><\/pre><\/div><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#94EBFF","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1092944,"guid":"C4EFBC703E7A11EBBFC439B6B84CAC5C","previous_id":1092926,"previous_guid":"1FA068BD03A94A75BC3012657F94B67C","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"9AA12C4D6C414EE39A6180FA16F0E0F4","order_id":1,"type_id":6,"title":"Section","source":{"title":"Read file preparation"}},{"id":1054724,"guid":"CDBD52D3BF394486B6B61A851F0D0597","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Create a directory to store results files<\/div><div class = \"text-block\"><pre><code><div class = \"text-blocks\"><div class = \"text-block\">mkdir results<\/div><\/div><\/code><\/pre><\/div><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#A492FF","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1092945,"guid":"B5714BE03E7C11EBBFC439B6B84CAC5C","previous_id":1092944,"previous_guid":"C4EFBC703E7A11EBBFC439B6B84CAC5C","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"BF9BE96AB58A4D459209B216F856A5AD","order_id":1,"type_id":6,"title":"Section","source":{"title":"Read file preparation"}},{"id":1054724,"guid":"9132F60DD1D8495FBFD3746103B31560","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Determine the N50\/L50 read length for each barcode. This will be used as the initial guess at the assembly size.<\/div><div class = \"text-block\"><pre><code><div class = \"text-blocks\"><div class = \"text-block\">(for bc in $(basename -a $(dirname $(ls fastq_pass\/*\/*)) | uniq);<\/div><div class = \"text-block\">    do echo -n ${bc};<\/div><div class = \"text-block\">    fastx-length.pl fastq_pass\/${bc}\/*.fastq 2>&1 > \/dev\/null | \\<\/div><div class = \"text-block\">      grep L50 | awk '{print \"\\t\"$5}';<\/div><div class = \"text-block\"> done) > results\/read_L50.txt<\/div><\/div><\/code><\/pre><\/div><div class = \"text-block\">This file can be viewed to confirm the assembly lengths:<\/div><div class = \"text-block\"><pre><code><div class = \"text-blocks\"><div class = \"text-block\">cat results\/read_L50.txt<\/div><\/div><\/code><\/pre><\/div><div class = \"text-block\">Example output:<\/div><div class = \"text-block\"><pre><code><div class = \"text-blocks\"><div class = \"text-block\">barcode03       8.875<\/div><div class = \"text-block\">barcode04       8.863<\/div><div class = \"text-block\">barcode05       10.218<\/div><div class = \"text-block\">barcode07       11.06<\/div><div class = \"text-block\">barcode09       11.069<\/div><div class = \"text-block\">unclassified    10.177<\/div><\/div><\/code><\/pre><\/div><div class = \"text-block\"><span style = \"font-style:italic;\">Note: this file will be used for subsequent downstream processing. If any of these barcodes shouldn't be processed further, feel free to remove the corresponding lines from this file<\/span><\/div><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#A492FF","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1092969,"guid":"46380FE03E7F11EBBFC439B6B84CAC5C","previous_id":1092970,"previous_guid":"DDB4BB703E7F11EBBFC439B6B84CAC5C","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"7D86B2BD41734A49B3F954A7B163C796","order_id":1,"type_id":6,"title":"Section","source":{"title":"Canu Assembly"}},{"id":1054724,"guid":"618566F5B4AB4AD08FE16FE301E6C4E2","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Run a Canu assembly on each read set, using default options:<\/div><div class = \"text-block\"><pre><code><div class = \"text-blocks\"><div class = \"text-block\">cat results\/read_L50.txt | while read bc len;<\/div><div class = \"text-block\">  do canu -nanopore results\/bestLong_200X_${bc}.fastq \\<\/div><div class = \"text-block\">    -p ${bc} -d results\/canu_${bc} genomeSize=${len}k;<\/div><div class = \"text-block\">done<\/div><\/div><\/code><\/pre><\/div><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#84CE84","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1092970,"guid":"DDB4BB703E7F11EBBFC439B6B84CAC5C","previous_id":1092943,"previous_guid":"9F8AFB703E7A11EBBFC439B6B84CAC5C","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"8E68C8FDF7474335862D55B17AFB532E","order_id":1,"type_id":6,"title":"Section","source":{"title":"Read filitering"}},{"id":1054724,"guid":"D23D221844F94E5D80E28A7FAB811E6C","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Subset the original read sets to only include the high-quality long reads:<\/div><div class = \"text-block\"><pre><code><div class = \"text-blocks\"><div class = \"text-block\">cat results\/read_L50.txt | while read bc len;<\/div><div class = \"text-block\">  do echo ${bc} ${len};<\/div><div class = \"text-block\">  ~\/scripts\/fastx-fetch.pl -i results\/bestLong_200X_${bc}.csv \\<\/div><div class = \"text-block\">    fastq_pass\/${bc}\/*.fastq > results\/bestLong_200X_${bc}.fastq; done<\/div><\/div><\/code><\/pre><\/div><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#94EBFF","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1092971,"guid":"D59870A03E8211EBBFC439B6B84CAC5C","previous_id":1092969,"previous_guid":"46380FE03E7F11EBBFC439B6B84CAC5C","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"8E384E3AB0794B828BEAE9EAE60E4653","order_id":1,"type_id":6,"title":"Section","source":{"title":"Canu Assembly"}},{"id":1054724,"guid":"F6870B1A9E6B4ADB8BB270ED9DA6B18E","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Trim the assembled contigs based on Canu's trim recommendations:<\/div><div class = \"text-block\"><pre><code><div class = \"text-blocks\"><div class = \"text-block\">cat results\/read_L50.txt | while read bc len;<\/div><div class = \"text-block\">  do echo ${bc} ${len};<\/div><div class = \"text-block\">  samtools faidx results\/canu_${bc}\/${bc}.contigs.fasta \\<\/div><div class = \"text-block\">    $(grep '^>' results\/canu_${bc}\/${bc}.contigs.fasta | \\<\/div><div class = \"text-block\">      perl -pe 's\/^>(.*?) .*trim=(.*)\/$1:$2\/') > results\/circTrimmed_${bc}.fasta;<\/div><div class = \"text-block\">done<\/div><\/div><\/code><\/pre><\/div><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#84CE84","section_duration":0,"critical":null,"critical_id":null,"duration":0}],"document":"","materials":[],"description":"<div class = \"text-blocks\"><div class = \"text-block\">This protocol demonstrates how to assemble reads from plasmid DNA, and generate a circularised and non-repetitive consensus sequence<\/div><div class = \"text-block\">At the moment, this protocol uses Canu to de-novo assemble high-quality single-cut reads.<\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">Input(s)<\/span><span>: <\/span><\/div><div class = \"text-block\"><ul style = \"list-style-type:disc;\"><li style = \"counter-reset:ol0;list-style-type:disc;\"><span>basecalled fastq files in <\/span><span style = \"font-style:italic;\">barcodeXX<\/span><span> directories, as produced from a rapid barcoding sequencing protocol (e.g. RBK-004 + MinKNOW)<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">Output(s):<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Consensus sequence per barcode as a fasta file<\/li><\/ul><\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">Output(s):<\/span><\/div><div class = \"text-block\"><ul style = \"list-style-type:disc;\"><\/ul><\/div><\/div>","changed_on":1608004803}