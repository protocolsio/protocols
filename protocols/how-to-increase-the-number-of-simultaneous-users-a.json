{"id":48855,"title":"How to increase the number of simultaneous users allowed in an R Shiny App","title_html":"<p>How to increase the number of simultaneous users allowed in an R Shiny App<\/p>","image":{"source":"https:\/\/www.protocols.io\/img\/default_protocol.png","placeholder":"https:\/\/www.protocols.io\/img\/default_protocol.png"},"doi":null,"doi_status":0,"uri":"how-to-increase-the-number-of-simultaneous-users-a-btxxnppn","type_id":1,"template_id":5,"published_on":1617637372,"parent_protocols":[],"parent_collections":[],"cited_protocols":[],"version_id":0,"version_data":{"id":"0","code":"btxxnppn","parent_id":0,"parent_uri":null,"is_same_owner":false,"has_pending_merge_request":false,"has_approved_merge_request":false},"created_on":1617627841,"modified_on":null,"categories":null,"public":1,"is_unlisted":0,"creator":{"name":"Sonia Garc\u00eda-Ruiz","affiliation":null,"affiliations":[],"username":"m4vle152t1u4tle1","note":null,"link":null,"image":{"source":"\/img\/avatars\/009.png","placeholder":"\/img\/avatars\/009.png"},"badges":[{"id":2,"image":{"source":"\/img\/badges\/bronze.svg","placeholder":"\/img\/badges\/bronze.svg"},"name":"Author"}],"verified":0,"is_verified_user":false,"research_interests":null,"blocked_by_you":false,"blocked_you":false,"hide_following":false},"journal":null,"journal_name":null,"journal_link":null,"article_citation":null,"has_versions":0,"link":null,"total_collections":0,"number_of_steps":6,"authors":[{"name":"Sonia Garc\u00eda-Ruiz","affiliation":"University College London, University of London","affiliations":[],"username":"m4vle152t1u4tle1","note":"","link":null,"image":{"source":"\/img\/avatars\/009.png","placeholder":"\/img\/avatars\/009.png"},"badges":[],"verified":1,"is_verified_user":true,"research_interests":null,"blocked_by_you":false,"blocked_you":false,"hide_following":false}],"versions":[],"groups":[{"id":22559,"uri":"ryten-laboratory","title":"Ryten Laboratory","image":{"source":"https:\/\/www.protocols.io\/img\/group_placeholder.png","placeholder":"https:\/\/www.protocols.io\/img\/group_placeholder.png"},"tech_support":{"email":null,"phone":null,"hide_contact":0,"use_email":0,"url":null},"is_member":1,"request":{"id":22559,"uri":"ryten-laboratory","title":"Ryten Laboratory","image":{"source":"https:\/\/www.protocols.io\/img\/group_placeholder.png","placeholder":"https:\/\/www.protocols.io\/img\/group_placeholder.png"},"tech_support":{"email":null,"phone":null,"hide_contact":0,"use_email":0,"url":null},"is_member":1,"description":null,"research_interests":null,"website":null,"location":null,"affiliation":null,"status":{"is_visible":true,"access_level":0},"stats":{"files":[],"total_members":0,"total_followers":0,"total_child_groups":0,"total_parent_groups":0,"has_collaborations":0},"user_status":{"is_member":true,"is_confirmed":true,"is_invited":false,"is_owner":true,"is_admin":false,"is_following":false},"join_link":null,"token":null,"owner":{"name":" ","affiliation":null,"affiliations":[],"username":null,"note":null,"link":null,"image":{"source":null,"placeholder":null},"badges":[],"verified":0,"is_verified_user":false,"research_interests":null,"blocked_by_you":false,"blocked_you":false,"hide_following":false},"is_protocol_requested":0,"is_group_requested":0,"is_my":false,"is_request":false,"is_confirmed":1,"is_declined":0,"requester":{"name":" ","affiliation":null,"affiliation_url":null,"username":null,"link":null},"protocol":{"id":0,"title":"How to increase the number of simultaneous users allowed in an R Shiny App","title_html":"How to increase the number of simultaneous users allowed in an R Shiny App","image":{"source":null,"placeholder":null},"doi":null,"doi_status":0,"uri":"how-to-increase-the-number-of-simultaneous-users-a-btxxnppn","type_id":1,"template_id":0,"published_on":null,"stats":{"number_of_views":0,"number_of_steps":0,"number_of_bookmarks":0,"number_of_comments":0,"number_of_exports":0,"number_of_runs":0,"number_of_votes":0,"is_voted":0},"parent_protocols":[],"parent_collections":[],"cited_protocols":[]},"created_on":1617637372,"resolve_on":0,"resolved_user":{"name":" ","affiliation":null,"affiliations":[],"username":null,"note":null,"link":null,"image":{"source":null,"placeholder":null},"badges":[],"verified":0,"is_verified_user":false,"research_interests":null,"blocked_by_you":false,"blocked_you":false,"hide_following":false},"shared":false}}],"is_owner":1,"has_subprotocols":0,"is_subprotocol":0,"is_bookmarked":0,"can_claim_authorship":0,"can_accept_authorship":0,"can_be_copied":1,"can_remove_fork":1,"fork_id":null,"url":"https:\/\/www.protocols.io\/view\/how-to-increase-the-number-of-simultaneous-users-a-btxxnppn","forks_count":{"private":0,"public":0},"access":{"can_view":1,"can_remove":1,"can_add":0,"can_edit":0,"can_publish":0,"can_get_doi":1,"can_share":1,"can_move":1,"can_move_outside":1,"can_transfer":1,"can_download":1,"is_locked":0},"guid":"5EC6E120960F11EBA780B95C462D2393","state_version_id":1264,"steps":[{"id":1156008,"guid":"69E7D1B0961211EBA780B95C462D2393","previous_id":null,"previous_guid":null,"modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"704EA05948404478AF19F92034904988","order_id":1,"type_id":6,"title":"Section","source":{"title":""}},{"id":1054724,"guid":"A21DB05223244C5EBF7B399C4875784D","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Install ShinyProxy.<\/div><div class = \"text-block\">ShinyProxy is a java-based open-source tool to deploy Shiny apps in a production or enterprise context <\/div><div class = \"text-block\"><a href=\"https:\/\/www.shinyproxy.io\" style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">https:\/\/www.shinyproxy.io\/<\/span><\/a><\/div><div class = \"text-block\">.<\/div><div class = \"text-block\">To install it on CentOS 7:<\/div><div class = \"text-block\"><pre><code><div class = \"text-blocks\"><div class = \"text-block\">sudo yum install shinyproxy_2.3.0_x86_64.rpm<\/div><\/div><\/code><\/pre><\/div><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1156012,"guid":"C459CF90961211EBA780B95C462D2393","previous_id":1156008,"previous_guid":"69E7D1B0961211EBA780B95C462D2393","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"482B64F1E71C4C8E910EEFA18319427D","order_id":1,"type_id":6,"title":"Section","source":{"title":""}},{"id":1054724,"guid":"492FB551C85B4EC598782B1136ADAD28","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Configure ShinyProxy.<\/div><div class = \"text-block\">Before executing any docker image, ShinyProxy first needs to be able to connect to the Docker daemon. By default, ShinyProxy will do so on port 2375. To allow for ShinyProxy connections on port 2375 of the Docker host, the docker startup file needs to be edited.<\/div><div class = \"text-block\"><ul style = \"list-style-type:disc;\"><li style = \"counter-reset:ol0;list-style-type:disc;\">Edit the Docker configuration file:<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><a href=\"#\" style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\"> <\/span><\/a><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Add the following lines at the end of the config file:<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><a href=\"#\" style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\"> <\/span><\/a><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Restart the Docker service:<\/li><\/ul><\/div><div class = \"text-block\"><pre><code><div class = \"text-blocks\"><div class = \"text-block\">sudo systemctl edit docker<\/div><\/div><\/code><\/pre><\/div><div class = \"text-block\"><ul style = \"list-style-type:disc;\"><li style = \"counter-reset:ol0;list-style-type:disc;\">Add the following lines at the end of the config file:<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><a href=\"#\" style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\"> <\/span><\/a><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Restart the Docker service:<\/li><\/ul><\/div><div class = \"text-block\"><pre><code><div class = \"text-blocks\"><div class = \"text-block\">[Service] <\/div><div class = \"text-block\">ExecStart= <\/div><div class = \"text-block\">ExecStart=\/usr\/bin\/dockerd -H unix:\/\/ -D -H tcp:\/\/127.0.0.1:2375<\/div><\/div><\/code><\/pre><\/div><div class = \"text-block\"><ul style = \"list-style-type:disc;\"><\/ul><\/div><div class = \"text-block\"><pre><code><div class = \"text-blocks\"><div class = \"text-block\">sudo systemctl daemon-reload <\/div><div class = \"text-block\">sudo systemctl restart docker<\/div><\/div><\/code><\/pre><\/div><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1156020,"guid":"6FA484D0961311EBA780B95C462D2393","previous_id":1156012,"previous_guid":"C459CF90961211EBA780B95C462D2393","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"612BBB2D142749418865BD349E9A99D3","order_id":1,"type_id":6,"title":"Section","source":{"title":""}},{"id":1054724,"guid":"5C196535C91542F3AF199674CCFCA376","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Generate a Dockerfile and build the Docker image.<\/div><div class = \"text-block\">This step has been previously detailed within the protocol <\/div><div class = \"text-block\"><a href=\"https:\/\/www.protocols.io\/view\/how-to-dockerize-an-r-shiny-app-btxvnpn6.html\" style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">https:\/\/www.protocols.io\/view\/how-to-dockerize-an-r-shiny-app-btxvnpn6.html<\/span><\/a><\/div><div class = \"text-block\">. Please, follow the link for more info about this step.<\/div><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1156030,"guid":"08DEBEE0961411EBA780B95C462D2393","previous_id":1156020,"previous_guid":"6FA484D0961311EBA780B95C462D2393","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"345D77E363BA47EAA7072B06BB6FB362","order_id":1,"type_id":6,"title":"Section","source":{"title":""}},{"id":1054724,"guid":"10AD7F85E660479EB53B011F1DF6DCCF","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\"><span>Generate an<\/span><span style = \"font-style:italic;\"> 'application.yml'<\/span><span> file.<\/span><\/div><div class = \"text-block\"><span>The application.yml<\/span><span style = \"font-style:italic;\"> <\/span><span>file describes the docker image and how ShinyProxy should execute it. In this step, we are specifying the details of the vizER docker image generated in Step 3 (more details also <\/span><\/div><div class = \"text-block\"><a href=\"https:\/\/www.protocols.io\/view\/how-to-dockerize-an-r-shiny-app-btxvnpn6.html\" style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">here<\/span><\/a><\/div><div class = \"text-block\">).<\/div><div class = \"text-block\"><span>In addition, the <\/span><span style = \"font-style:italic;\">'application.yml' <\/span><span>file below contains the following blocks of information:<\/span><\/div><div class = \"text-block\"><ul style = \"list-style-type:disc;\"><li style = \"counter-reset:ol0;list-style-type:disc;\">server: this block contains info about the server environment. In this case, it only specifies the URL path in which vizER should be executed.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">proxy: details about the ShinyProxy execution.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">docker: details about the docker engine execution.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">specs: details about the docker image to be executed. This block also specifies the path of the folder that will be mounted during the image execution (this is the folder containing the data dependencies detailed <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><a href=\"https:\/\/www.protocols.io\/view\/how-to-dockerize-an-r-shiny-app-btxvnpn6.html\" style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">here<\/span><\/a><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">).<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">logging: details about the log register.<\/li><\/ul><\/div><div class = \"text-block\">specs: details about the docker image to be executed. This block also specifies the path of the folder that will be mounted during the image execution (this is the folder containing the data dependencies detailed <\/div><div class = \"text-block\"><a href=\"https:\/\/www.protocols.io\/view\/how-to-dockerize-an-r-shiny-app-btxvnpn6.html\" style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">here<\/span><\/a><\/div><div class = \"text-block\">).<\/div><div class = \"text-block\"><ul style = \"list-style-type:disc;\"><\/ul><\/div><div class = \"text-block\"><pre><code><div class = \"text-blocks\"><div class = \"text-block\">server:<\/div><div class = \"text-block\">  servlet:<\/div><div class = \"text-block\">    context-path: \/browser\/<\/div><div class = \"text-block\">proxy:<\/div><div class = \"text-block\">  hide-navbar: true<\/div><div class = \"text-block\">  heartbeat-rate: 10000<\/div><div class = \"text-block\">  heartbeat-timeout: 60000<\/div><div class = \"text-block\">  container-wait-time: 100000<\/div><div class = \"text-block\">  authentication: none<\/div><div class = \"text-block\">  port: 2525<\/div><div class = \"text-block\">  docker:<\/div><div class = \"text-block\"><span>    url: <\/span><a href=\"http:\/\/localhost:2375\" style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">http:\/\/localhost:2375<\/span><\/a><\/div><div class = \"text-block\">    port-range-start: 20000<\/div><div class = \"text-block\">    port-range-max: 20020<\/div><div class = \"text-block\">  specs:<\/div><div class = \"text-block\">  - id: vizER<\/div><div class = \"text-block\">    display-name: vizER<\/div><div class = \"text-block\">    container-cmd: [\"R\", \"-e shiny::runApp('\/root\/vizER')\"]<\/div><div class = \"text-block\">    container-image: vizer<\/div><div class = \"text-block\">    container-volumes: [ \"\/home_2\/gsit\/vizER_data:\/root\/vizER\/vizER_data\" ]<\/div><div class = \"text-block\">logging:<\/div><div class = \"text-block\">  file:<\/div><div class = \"text-block\">    shinyproxy.log<\/div><\/div><\/code><\/pre><\/div><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1156038,"guid":"38466830961511EBA780B95C462D2393","previous_id":1156049,"previous_guid":"41A24C00961F11EB98C62FD50E377587","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"2C5633F4D96541089896F74FBBF58012","order_id":1,"type_id":6,"title":"Section","source":{"title":""}},{"id":1054724,"guid":"B5077A91901944A4947AF7F245EDC086","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Running the docker image.<\/div><div class = \"text-block\"><span>To run the Docker image of vizER through ShinyProxy, type the following command from within the same folder in which the <\/span><span style = \"font-style:italic;\">'application.yml'<\/span><span> file has been placed:<\/span><\/div><div class = \"text-block\"><pre><code><div class = \"text-blocks\"><div class = \"text-block\">java -jar shinyproxy-2.0.5.jar<\/div><\/div><\/code><\/pre><\/div><div class = \"text-block\">The command above will start the execution of ShinyProxy. Any HTTP request received on the URL:<\/div><div class = \"text-block\"><ul style = \"list-style-type:disc;\"><li style = \"counter-reset:ol0;list-style-type:disc;\">http:\/\/yourserverdomain\/browser\/ (in case you have configured APACHE).<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">http:\/\/localhost:2525\/browser\/ (in case you have not configured APACHE)<\/li><\/ul><\/div><div class = \"text-block\">will redirect the ShinyProxy output as a response to the beforementioned request.<\/div><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1156049,"guid":"41A24C00961F11EB98C62FD50E377587","previous_id":1156030,"previous_guid":"08DEBEE0961411EBA780B95C462D2393","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"F3793E0E94DA4AFF8D3A29C468198708","order_id":1,"type_id":6,"title":"Section","source":{"title":""}},{"id":1054724,"guid":"AA8C5737ABC5400BBAC971216A6C09A0","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Configuring the APACHE HTTP server.<\/div><div class = \"text-block\">(Please, skip this step in case you are not serving your Shiny app through the APACHE HTTP server).<\/div><div class = \"text-block\">To server the output of ShinyProxy execution through APACHE, we need to add the following lines into the Apache configuration file (this file is usually located on the path \/etc\/httpd\/conf.d\/):<\/div><div class = \"text-block\"><pre><code><div class = \"text-blocks\"><div class = \"text-block\"><Proxy *>      <\/div><div class = \"text-block\">Allow from localhost  <\/div><div class = \"text-block\"><\/Proxy>  <\/div><div class = \"text-block\">RedirectMatch permanent ^\/browser$ \/browser\/<\/div><div class = \"text-block\">RewriteEngine on  <\/div><div class = \"text-block\">RewriteCond %{HTTP:Upgrade} =websocket  <\/div><div class = \"text-block\">RewriteRule \/browser\/(.*) ws:\/\/0.0.0.0:2525\/browser\/$1 [P,L]  <\/div><div class = \"text-block\">RewriteCond %{HTTP:Upgrade} !=websocket  <\/div><div class = \"text-block\">RewriteRule \/browser\/(.*) http:\/\/0.0.0.0:2525\/browser\/$1 [P,L]  <\/div><div class = \"text-block\">ProxyPass \/browser\/ http:\/\/0.0.0.0:2525\/browser\/ connectiontimeout=3000 timeout=3000  ProxyPassReverse \/browser\/ http:\/\/0.0.0.0:2525\/browser\/  <\/div><div class = \"text-block\">Header edit Location ^\/ \/browser\/  <\/div><div class = \"text-block\">ProxyRequests Off<\/div><\/div><\/code><\/pre><\/div><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"","section_duration":0,"critical":null,"critical_id":null,"duration":0}],"document":"","materials":[],"description":"<div class = \"text-blocks\"><div class = \"text-block\">There are multiple ways of hosting a Shiny App in production. When it is required to do so over a specific URL domain, RStudio Server combined with APACHE HTTP server might be one of the most widely used solutions. However, the open-source edition of RStudio Server presents a drawback: it only allows one simultaneous user browsing your web app at the same time. This protocol presents an open-source solution to allow multiple users to browse your Shiny App in an enterprise context.<\/div><div class = \"text-block\"><span>vizER app was released as part of the publication <\/span><a href=\"https:\/\/advances.sciencemag.org\/content\/6\/24\/eaay8299.full\" style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">Incomplete annotation has a disproportionate impact on our understanding of Mendelian and complex neurogenetic disorders<\/span><\/a><\/div><\/div>","changed_on":1617637372}