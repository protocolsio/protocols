{"id":35776,"title":"Quality control for metagenomics data","title_html":"<p>Quality control for metagenomics data<\/p>","image":{"source":"https:\/\/www.protocols.io\/img\/default_protocol.png","placeholder":"https:\/\/www.protocols.io\/img\/default_protocol.png"},"doi":"dx.doi.org\/10.17504\/protocols.io.be68jhhw","doi_status":2,"uri":"quality-control-for-metagenomics-data-be68jhhw","type_id":1,"published_on":1587028223,"parent_protocols":[],"parent_collections":[],"cited_protocols":[],"version_id":0,"created_on":1587021076,"categories":null,"creator":{"name":"Qi Wang","affiliation":null,"affiliations":[],"username":"qi-wang","link":null,"image":{"source":"\/img\/avatars\/014.png","placeholder":"\/img\/avatars\/014.png"},"badges":[{"id":2,"image":{"source":"\/img\/badges\/bronze.svg","placeholder":"\/img\/badges\/bronze.svg"},"name":"Author"}],"research_interests":null,"blocked_by_you":false,"blocked_you":false,"hide_following":false},"journal":null,"journal_name":null,"journal_link":null,"article_citation":null,"public":1,"has_versions":0,"link":null,"total_collections":0,"number_of_steps":2,"authors":[{"name":"Qi Wang","affiliation":"BGI","affiliations":[],"username":"qi-wang","link":null,"image":{"source":"\/img\/avatars\/014.png","placeholder":"\/img\/avatars\/014.png"},"badges":[],"research_interests":null,"blocked_by_you":false,"blocked_you":false,"hide_following":false}],"versions":[],"groups":[],"is_owner":1,"has_subprotocols":0,"is_subprotocol":0,"is_bookmarked":0,"can_be_copied":1,"can_remove_fork":1,"fork_id":null,"url":"https:\/\/www.protocols.io\/view\/quality-control-for-metagenomics-data-be68jhhw","forks_count":{"private":0,"public":0},"access":{"can_view":1,"can_remove":0,"can_add":0,"can_edit":0,"can_publish":0,"can_get_doi":0,"can_share":1,"can_move":1,"can_move_outside":1,"can_transfer":1,"can_download":1,"is_locked":0},"guid":"5B9DAB207FB111EAB4E709AD68D158FB","state_version_id":144,"steps":[{"id":917842,"guid":"777A6E407FB211EAB4E709AD68D158FB","previous_id":null,"previous_guid":null,"modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"2FBA9620F6F244B599D6120C378A4977","order_id":1,"type_id":6,"title":"Section","source":{"title":""}},{"id":1054724,"guid":"39691227E9DE4AB6B5089D53861AB9FD","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Step1: remove low quality reads\uff1a<\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">We firstly calculate the accuracy probabilities of each base<\/span><\/div><div class = \"text-block\"><a href=\"\" style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\"> using the following equations:<\/span><\/a><\/div><div class = \"text-block\"><span>1)Q = -10 log<\/span><span style = \"vertical-align:sub;\">10<\/span><span style = \"vertical-align:sub;\">E<\/span><\/div><div class = \"text-block\">2)P = 1 - E<\/div><div class = \"text-block\"><span>Where<\/span><span style = \"font-style:italic;\">Q <\/span><span>is thePhred quality score of each base,<\/span><span style = \"font-style:italic;\">E<\/span><span>is the error probability of each base.<\/span><\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">Then we calculate the overall accuracy probability(OA)of each readusing the following equation:<\/span><\/div><div class = \"text-block\"><span>For each read, an initial 30-mer seed sequence is selected at the 5\u2019 end of the read and its overall accuracy, defined as OA<\/span><span style = \"vertical-align:sub;\">seed<\/span><span>, is calculated. To ensure high data quality, OA<\/span><span style = \"vertical-align:sub;\">seed<\/span><span>is defined as 0.9 using<\/span><\/div><div class = \"text-block\"><a href=\"\" style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">m equal to 0<\/span><\/a><\/div><div class = \"text-block\"><span>with zero\u00a0low quality bases allowed. Once the seed position of the read has been defined, the seed would extend to keep the longest contiguous read fragment in which the OA, defined as OA<\/span><span style = \"vertical-align:sub;\">fragment<\/span><span>, is above a defined accuracy threshold. In this study, weset OA<\/span><span style = \"vertical-align:sub;\">fragment<\/span><span>equal to or greater than 0.8 using<\/span><span style = \"font-style:italic;\">m<\/span><span>equal to 1.<\/span><\/div><div class = \"text-block\">And the Perl scripts for overall accuracy based QC pipeline are freely available for download and reuse from  Github (https:\/\/github.com\/Scelta\/OAFilter).<\/div><\/div>"}}],"cases":[],"data":null,"section":null,"section_color":"","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":917845,"guid":"0750F0C07FB311EAB4E709AD68D158FB","previous_id":917842,"previous_guid":"777A6E407FB211EAB4E709AD68D158FB","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"450E1FF7D1174748B277F6ED73BE2517","order_id":1,"type_id":6,"title":"Section","source":{"title":""}},{"id":1054724,"guid":"89B46E20B1F647EEA410ECAD6FEED35C","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Step2: remove host contamination reads by one command:<\/div><div class = \"text-block\">'bowtie2 --very-sensitive -p $thread -x $host_bowtie2_index -1 $sample_r2 -2 $sample_r1 2> 02.rmhost\/bowtie2.log | samtools view -h | samtools sort -n |samtools fastq -N -c 5 -f 12 -1 02.rmhost\/$name.rmhost.1.fq.gz -2 02.rmhost\/$name.rmhost.2.fq.gz'<\/div><\/div>"}}],"cases":[],"data":null,"section":null,"section_color":"","section_duration":0,"critical":null,"critical_id":null,"duration":0}],"document":null,"materials":[],"description":"<div class = \"text-blocks\"><div class = \"text-block\">Quality control for metagenomics data,including: remove low quality reads and host contamination reads.<\/div><\/div>","changed_on":1587028223}