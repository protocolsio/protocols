{"access":{"can_view":true,"can_edit":false,"can_remove":false,"can_add":false,"can_publish":false,"can_get_doi":false,"can_share":true,"can_move":true,"can_move_outside":true,"can_transfer":true,"can_download":true,"limited_run":false,"limited_private_links":false,"limited_blind_links":false,"is_locked":false},"authors":[{"name":"María José Pérez J.","affiliation":"German Center for Neurodegenerative Diseases (DZNE), Tübingen, 72076 Germany","affiliation_url":null,"username":"m4ule142w105sle1","link":null,"image":{"source":"https://lh3.googleusercontent.com/a-/AOh14GhUpz35rynbRjI8R1y2t-JnqN-i2kICdzidn-nT=s96-c","placeholder":"https://lh3.googleusercontent.com/a-/AOh14GhUpz35rynbRjI8R1y2t-JnqN-i2kICdzidn-nT=s96-c","webp_source":""},"note":"","is_verified_user":true},{"name":"michela.deleidi","affiliation":"German Center for Neurodegenerative Diseases (DZNE), Tübingen, 72076 Germany","affiliation_url":null,"username":"m4vle122q115ule1","link":null,"image":{"source":"/img/avatars/012.png","placeholder":"/img/avatars/012.png","webp_source":""},"note":"","is_verified_user":true}],"before_start":"","book_chapter":null,"can_accept_authorship":false,"can_be_copied":true,"can_claim_authorship":false,"can_manage_keywords":true,"can_remove_fork":false,"can_sign":false,"child_steps":{},"cited_protocols":[],"collection_items":[],"created_on":1679991631,"creator":{"name":"Federico   Bertoli","affiliation":"","affiliation_url":null,"username":"federico---bertoli","link":"","image":{"source":"/img/avatars/001.png","placeholder":"/img/avatars/001.png","webp_source":""},"badges":[{"id":4,"name":"Gold power author!","image":{"source":"/img/badges/gold.svg","placeholder":"/img/badges/gold.svg"}}],"affiliations":[]},"description":"{\"blocks\":[{\"key\":\"gc2f\",\"text\":\"The following script was used for analysis of gene corrected (GC) versus GBA1 mutant (MUT) midbrain organoids. The purpose was to combine, filter, integrate, and identify clusters and differentially expressed genes sets. \",\"type\":\"align-justify\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}}],\"entityMap\":{}}","disclaimer":"","document":"","documents":[{"id":0,"type_id":0,"filename":"","key":"","color":"","height":0,"width":0,"is_document":null,"original_file_id":null,"thumb_url":"https://www.protocols.io/img/extensions/docx.png","size":null,"is_private":0,"is_new":0,"ofn":"404-875.docx","url":"https://content.protocols.io/files/hd7dbn3x7.docx","bucket_name":null,"s3_webp_url":"","file_id":233379}],"doi":"dx.doi.org/10.17504/protocols.io.36wgqjk53vk5/v1","doi_status":1,"ethics_statement":null,"fork_id":null,"fork_info":null,"forks":[],"funders":[],"groups":[],"guid":"678E21D1CD4111EDAA100A58A9FEAC02","guidelines":"{\"blocks\":[{\"key\":\"akav2\",\"text\":\"This script is based on the Seurat tutorials\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}},{\"key\":\"861vu\",\"text\":\"https://satijalab.org/seurat/articles/integration_introduction.html\",\"type\":\"unordered-list-item\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[{\"key\":0,\"offset\":0,\"length\":67}],\"data\":{}},{\"key\":\"eivp4\",\"text\":\"https://ucdavis-bioinformatics-training.github.io/2019-single-cell-RNA-sequencing-Workshop-UCD_UCSF/scrnaseq_analysis/scRNA_Workshop-PART1.html\",\"type\":\"unordered-list-item\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[{\"key\":1,\"offset\":0,\"length\":143}],\"data\":{}}],\"entityMap\":{\"0\":{\"type\":\"link\",\"mutability\":\"MUTABLE\",\"data\":{\"guid\":\"B23B2AF2C60B11EC9FE10A58A9FEAC02\",\"url\":\"https://satijalab.org/seurat/articles/integration_introduction.html\"}},\"1\":{\"type\":\"link\",\"mutability\":\"MUTABLE\",\"data\":{\"guid\":\"B23B2B71C60B11EC9FE10A58A9FEAC02\",\"url\":\"https://ucdavis-bioinformatics-training.github.io/2019-single-cell-RNA-sequencing-Workshop-UCD_UCSF/scrnaseq_analysis/scRNA_Workshop-PART1.html\"}}}}","has_references":false,"has_step_reagents":false,"has_versions":false,"id":79542,"image":{"source":"https://www.protocols.io/img/default_protocol.png","webp_source":null,"placeholder":"https://www.protocols.io/img/default_protocol.png","webp_placeholder":null},"image_attribution":"","in_trash":false,"is_bookmarked":false,"is_contact_suspended":false,"is_content_confidential":false,"is_content_warning":false,"is_doi_reserved":false,"is_in_pending_publishing":false,"is_in_transfer":false,"is_owner":true,"is_research":true,"is_retracted":false,"is_shared_directly":false,"is_subprotocol":null,"is_unlisted":false,"item_id":1100009,"journal":null,"journals":[],"keywords":"Data preparation, Quality control, Data normalization, Data integration ","last_modified":1680202309,"link":"","location":null,"manuscript_citation":"","materials":[],"materials_text":"","ownership_history":null,"parent_collections":[{"id":79782,"title":"Protocol collection - \u0026#34;Glucocerebrosidase is imported into mitochondria and preserves complex I integrity and energy metabolism\u0026#34;","title_html":null,"image":{"source":"https://www.protocols.io/img/default_protocol.png","webp_source":null,"placeholder":"https://www.protocols.io/img/default_protocol.png","webp_placeholder":null},"doi":"dx.doi.org/10.17504/protocols.io.6qpvr4zr3gmk/v1","uri":"protocol-collection-34-glucocerebrosidase-is-impor-cr6ev9be","published_on":1680203184,"modified_on":0,"version_class":0,"version_id":0,"version_code":"","version_uri":"","created_on":1680202783,"categories":null,"creator":{"name":"Federico   Bertoli","affiliation":null,"affiliation_url":null,"username":"federico---bertoli","link":"","image":{"source":"/img/avatars/001.png","placeholder":"/img/avatars/001.png","webp_source":""}},"stats":null}],"parent_protocols":[],"peer_reviewed":false,"protocol_references":"","public":true,"public_fork_note":"","published_on":1680202309,"references":[],"related_equipments":[],"related_materials":[],"reserved_doi":"","retraction_reason":null,"samples":{},"shared_access_id":16,"show_comparison":false,"sign_info":null,"state_version_id":0,"stats":{"is_voted":false,"number_of_views":63,"number_of_steps":9,"number_of_bookmarks":0,"number_of_comments":0,"number_of_bookmarked_comments":0,"number_of_steps_comments":0,"number_of_protocol_comments":0,"number_of_exports":0,"number_of_runs":0,"number_of_votes":0,"number_of_reagents":0,"number_of_equipments":0,"number_of_collections":1,"number_of_forks":{"private":0,"public":0},"number_of_accessible_forks":0},"status":{"id":1,"info":"We use this protocol and it's working"},"steps":[{"id":1639561,"guid":"6798F110CD4111EDAA100A58A9FEAC02","previous_id":null,"previous_guid":null,"section":"\u003cp\u003e\u003cstrong\u003ePart 1. Data preparation\u003c/strong\u003e\u003c/p\u003e","section_color":"#A492FF","section_duration":0,"is_substep":false,"step":"{\"blocks\":[{\"key\":\"3qvgg\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}},{\"key\":\"2p2a\",\"text\":\" \",\"type\":\"atomic\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[{\"key\":0,\"offset\":0,\"length\":1}],\"data\":{}},{\"key\":\"2pm3m\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}}],\"entityMap\":{\"0\":{\"type\":\"code_insert\",\"mutability\":\"IMMUTABLE\",\"data\":{\"blocks\":[{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"1k130\",\"text\":\"# Install and load the libraries\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"8tmik\",\"text\":\"library(Seurat)\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"9g0nk\",\"text\":\"library(patchwork)\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"5k0v7\",\"text\":\"library(ggplot2)\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"9i798\",\"text\":\"library(cowplot)\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"5dca7\",\"text\":\"library(magrittr)\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"c4cc4\",\"text\":\"library(tidyverse)\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"7fp82\",\"text\":\"\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"80daq\",\"text\":\"# Load and combine 10x Runs\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"ctgd\",\"text\":\"setwd(\\\"D:.../analysis_results\\\")\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"8fulp\",\"text\":\"\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"4l4qd\",\"text\":\"GC1.data \\u003c-Read10X_h5(\\\"1GC_filtered_feature_bc_matrix.h5\\\")\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"annfg\",\"text\":\"GC1 \\u003c-CreateSeuratObject(counts = GC1.data)\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"a45mg\",\"text\":\"GC1\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"252t0\",\"text\":\"\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"cmifo\",\"text\":\"MUT1.data \\u003c-Read10X_h5(\\\"1MUT_filtered_feature_bc_matrix.h5\\\")\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"5p98r\",\"text\":\"MUT1 \\u003c-CreateSeuratObject(counts = MUT1.data)\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"11mtj\",\"text\":\"MUT1\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"9oq63\",\"text\":\"\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"b0qic\",\"text\":\"GC2.data \\u003c-Read10X_h5(\\\"2GC_filtered_feature_bc_matrix.h5\\\")\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"27eqq\",\"text\":\"GC2 \\u003c-CreateSeuratObject(counts = GC2.data)\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"803vc\",\"text\":\"GC2\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"f432q\",\"text\":\"\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"5b4r4\",\"text\":\"MUT2.data \\u003c-Read10X_h5(\\\"2MUT_filtered_feature_bc_matrix.h5\\\")\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"e7gkq\",\"text\":\"MUT2 \\u003c-CreateSeuratObject(counts = MUT2.data)\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"2cg4v\",\"text\":\"MUT2\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"283b1\",\"text\":\"\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"4kmss\",\"text\":\"GC3.data \\u003c-Read10X_h5(\\\"3GC_filtered_feature_bc_matrix.h5\\\")\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"3bss6\",\"text\":\"GC3 \\u003c-CreateSeuratObject(counts = GC3.data)\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"ekoq5\",\"text\":\"GC3\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"7ovfj\",\"text\":\"\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"6fqb3\",\"text\":\"MUT3.data \\u003c-Read10X_h5(\\\"3MUT_filtered_feature_bc_matrix.h5\\\")\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"bagtd\",\"text\":\"MUT3 \\u003c-CreateSeuratObject(counts = MUT3.data)\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"7dr8d\",\"text\":\"MUT3\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"5buad\",\"text\":\"\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"5otf0\",\"text\":\"# Merge more than two objects\\nMUT.combined \\u003c-Reduce(function(x,y) merge (x,y, all=T), list (GC1, MUT1, GC2, MUT2, GC3, MUT3))\",\"type\":\"unstyled\"}],\"entityMap\":{}}}}}","data":null,"protocol_id":79542,"case_id":0,"critical_ids":"","duration":0,"original_id":1639472,"number":"1","cases":[],"critical":null},{"id":1639562,"guid":"6799264DCD4111EDAA100A58A9FEAC02","previous_id":1639561,"previous_guid":"6798F110CD4111EDAA100A58A9FEAC02","section":"\u003cp\u003e\u003cstrong\u003ePart 2. Quality control\u003c/strong\u003e\u003c/p\u003e","section_color":"#94EBFF","section_duration":0,"is_substep":false,"step":"{\"blocks\":[{\"key\":\"fdskp\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}},{\"key\":\"9u0jd\",\"text\":\" \",\"type\":\"atomic\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[{\"key\":0,\"offset\":0,\"length\":1}],\"data\":{}},{\"key\":\"7pa4p\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}}],\"entityMap\":{\"0\":{\"type\":\"code_insert\",\"mutability\":\"IMMUTABLE\",\"data\":{\"blocks\":[{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"3bvj6\",\"text\":\"# Add number of genes per UMI for each cell to metadata\\nMUT.combined$log10GenesPerUMI \\u003c-log10(MUT.combined$nFeature_RNA) /log10(MUT.combined$nCount_RNA)\\n\\n# Compute percent mito ratio\\nMUT.combined$mitoRatio \\u003c-PercentageFeatureSet(object = MUT.combined, pattern =\\\"^MT-\\\")\\nMUT.combined$mitoRatio \\u003c- MUT.combined@meta.data$mitoRatio /100\\n\\n# Create .RData object \\nsave(MUT.combined, file =\\\"Seurat_Object.RData\\\")\\n\\n# Filter out low quality reads using selected thresholds \\nfiltered_seurat \\u003c-subset(x =MUT.combined,subset= (nCount_RNA \\u003e=500) \\u0026(nFeature_RNA \\u003e=250) \\u0026(log10GenesPerUMI \\u003e0.80) \\u0026 (mitoRatio \\u003c0.20))\\n\\n# Extract counts\\ncounts \\u003c-GetAssayData(object =filtered_seurat, slot =\\\"counts\\\")\\n\\n# Output a logical vector for every gene on whether the more than zero counts per cell\\nnonzero \\u003c- counts \\u003e0\\n\\n# Sums all TRUE values and returns TRUE if more than 10 TRUE values per gene\\nkeep_genes \\u003c- Matrix::rowSums(nonzero) \\u003e=10\\n\\n# Only keeping those genes expressed in more than 10 cells\\nfiltered_counts \\u003c-counts[keep_genes, ]\\n\\n# Reassign to filtered Seurat object\\nfiltered_seurat \\u003c-CreateSeuratObject(filtered_counts, meta.data =filtered_seurat@meta.data)\\n\\n# Save.RData object\\nsave(filtered_seurat, file=\\\"seurat_filtered.RData\\\")\",\"type\":\"unstyled\"}],\"entityMap\":{}}}}}","data":null,"protocol_id":79542,"case_id":0,"critical_ids":"","duration":0,"original_id":1639473,"number":"2","cases":[],"critical":null},{"id":1639563,"guid":"67996150CD4111EDAA100A58A9FEAC02","previous_id":1639562,"previous_guid":"6799264DCD4111EDAA100A58A9FEAC02","section":"\u003cp\u003e\u003cstrong\u003ePart 3. Data preparation and normalization\u003c/strong\u003e\u003c/p\u003e","section_color":"#84CE84","section_duration":0,"is_substep":false,"step":"{\"blocks\":[{\"key\":\"afvkk\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}},{\"key\":\"417of\",\"text\":\" \",\"type\":\"atomic\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[{\"key\":0,\"offset\":0,\"length\":1}],\"data\":{}},{\"key\":\"ej0se\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}}],\"entityMap\":{\"0\":{\"type\":\"code_insert\",\"mutability\":\"IMMUTABLE\",\"data\":{\"blocks\":[{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"41k53\",\"text\":\"#Cell cycle scoring. Normalize the counts\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"edfvp\",\"text\":\"seurat_phase \\u003c-NormalizeData(filtered_seurat)\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"fr825\",\"text\":\"\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"36esq\",\"text\":\"# Load cell cycle markers\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"sqlp\",\"text\":\"load(\\\"cycle.rda\\\")\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"3lhsu\",\"text\":\"\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"9n8up\",\"text\":\"# Score cells for cell cycle\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"a0clr\",\"text\":\"seurat_phase \\u003c-CellCycleScoring(seurat_phase,g2m.features = g2m_genes,s.features =s_genes)\\n\\n# View cell cycle scores and phases assigned to cells\\nView(seurat_phase@meta.data)\\n\\n# Identify the most variable genes\\nseurat_phase \\u003c-FindVariableFeatures(seurat_phase,selection.method =\\\"vst\\\",nfeatures =2000, verbose =FALSE)\\n\\n# Scale the counts\\nseurat_phase \\u003c-ScaleData(seurat_phase)\\n\\n# Perform PCA\\nseurat_phase \\u003c-RunPCA(seurat_phase)\\n\\n# Plot the PCA colored by cell cycle phase\\nDimPlot(seurat_phase,reduction =\\\"pca\\\", group.by=\\\"Phase\\\", split.by =\\\"Phase\\\")\\n\\n# Split seurat object by condition to perform cell cycle scoring and SCT on all samples\\nsplit_seurat \\u003c-SplitObject(filtered_seurat, split.by =\\\"orig.ident\\\")\\n\\nfor (i in1:length(split_seurat)) { split_seurat[[i]] \\u003c-NormalizeData(split_seurat[[i]], verbose =TRUE)\\nsplit_seurat[[i]] \\u003c-CellCycleScoring(split_seurat[[i]], g2m.features=g2m_genes, s.features=s_genes)\\nsplit_seurat[[i]] \\u003c-SCTransform(split_seurat[[i]], vars.to.regress =c(\\\"mitoRatio\\\", \\\"S.Score\\\", \\\"G2M.Score\\\")) }\",\"type\":\"unstyled\"}],\"entityMap\":{}}}}}","data":null,"protocol_id":79542,"case_id":0,"critical_ids":"","duration":0,"original_id":1639474,"number":"3","cases":[],"critical":null},{"id":1639564,"guid":"67999E71CD4111EDAA100A58A9FEAC02","previous_id":1639563,"previous_guid":"67996150CD4111EDAA100A58A9FEAC02","section":"\u003cp\u003e\u003cstrong\u003ePart 4. Data integration and visualization (directly after Part 3)\u003c/strong\u003e\u003c/p\u003e","section_color":"#FFED92","section_duration":0,"is_substep":false,"step":"{\"blocks\":[{\"key\":\"c9kkl\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}},{\"key\":\"1flsc\",\"text\":\" \",\"type\":\"atomic\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[{\"key\":0,\"offset\":0,\"length\":1}],\"data\":{}},{\"key\":\"d1l11\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}}],\"entityMap\":{\"0\":{\"type\":\"code_insert\",\"mutability\":\"IMMUTABLE\",\"data\":{\"blocks\":[{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"en6c6\",\"text\":\"# Select the most variable features to use for integration\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"ca9bu\",\"text\":\"integ_features \\u003c-SelectIntegrationFeatures(object.list =split_seurat,nfeatures =3000) \",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"3jbd6\",\"text\":\"\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"fh0ri\",\"text\":\"# Prepare the SCT list object for integration\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"93g36\",\"text\":\"split_seurat \\u003c-PrepSCTIntegration(object.list =split_seurat,anchor.features =integ_features)\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"ca3t1\",\"text\":\"\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"f6931\",\"text\":\"# Find anchors\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"blukl\",\"text\":\"integ_anchors \\u003c-FindIntegrationAnchors(object.list =split_seurat,normalization.method =\\\"SCT\\\", anchor.features =integ_features)\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"c83r5\",\"text\":\"\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"65q2a\",\"text\":\"# Integrate across conditions\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"4ojqn\",\"text\":\"organoids.combined.sct \\u003c-IntegrateData(anchorset =integ_anchors,normalization.method =\\\"SCT\\\")\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"cpfj5\",\"text\":\"\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"dajjc\",\"text\":\"# Save integrated seurat object\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"8rnkh\",\"text\":\"saveRDS(organoids.combined.sct, \\\"integrated_seurat.rds\\\")\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"88pnj\",\"text\":\"\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"flnul\",\"text\":\"## Run the standard workflow for visualization and clustering\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"f14lt\",\"text\":\"DefaultAssay(organoids.combined.sct) \\u003c-\\\"integrated\\\"\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"fujml\",\"text\":\"\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"5djkn\",\"text\":\"organoids.combined.sct \\u003c-RunPCA(organoids.combined.sct, verbose =FALSE)\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"3008b\",\"text\":\"PCAPlot(organoids.combined.sct,split.by =\\\"orig.ident\\\")\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"2nu0d\",\"text\":\"organoids.combined.sct \\u003c-RunUMAP(organoids.combined.sct, reduction =\\\"pca\\\", dims =1:40)\\n\\n# Plot UMAP\\nDimPlot(organoids.combined.sct, split.by =\\\"orig.ident\\\")\\n\\nDimPlot(organoids.combined.sct, group.by =\\\"orig.ident\\\")\\n\\n# Elbow plot\\nElbowPlot(object =organoids.combined.sct,ndims =40)\\n\\n#Find neighbors for cluster analysis\\norganoids.combined.sct \\u003c-FindNeighbors(organoids.combined.sct, reduction =\\\"pca\\\", dims =1:40)\\norganoids.combined.sct \\u003c-FindClusters(organoids.combined.sct, resolution =c(0.6))\\n\\n# Assign identity of clusters\\nIdents(object =organoids.combined.sct) \\u003c-\\\"integrated_snn_res.0.6\\\"\\n\\n# Visualization\\nall.genes \\u003c-rownames(organoids.combined.sct)\\norganoids.combined.sct \\u003c-ScaleData(organoids.combined.sct, features =all.genes)\\n\\nDimPlot(organoids.combined.sct, reduction =\\\"umap\\\", group.by =\\\"seurat_clusters\\\", label =TRUE,repel =TRUE)\\n\\nDimPlot(organoids.combined.sct, reduction =\\\"umap\\\", split.by =\\\"orig.ident\\\")\",\"type\":\"unstyled\"}],\"entityMap\":{}}}}}","data":null,"protocol_id":79542,"case_id":0,"critical_ids":"","duration":0,"original_id":1639475,"number":"4","cases":[],"critical":null},{"id":1639565,"guid":"6799DA82CD4111EDAA100A58A9FEAC02","previous_id":1639564,"previous_guid":"67999E71CD4111EDAA100A58A9FEAC02","section":"\u003cp\u003e\u003cstrong\u003ePart 5. Obtain information from the datasets\u003c/strong\u003e\u003c/p\u003e","section_color":"#EA9F6C","section_duration":0,"is_substep":false,"step":"{\"blocks\":[{\"key\":\"617m9\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}},{\"key\":\"v3i7\",\"text\":\" \",\"type\":\"atomic\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[{\"key\":0,\"offset\":0,\"length\":1}],\"data\":{}},{\"key\":\"b6hl8\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}}],\"entityMap\":{\"0\":{\"type\":\"code_insert\",\"mutability\":\"IMMUTABLE\",\"data\":{\"blocks\":[{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"29at2\",\"text\":\"#Extract identity and sample information from seurat object to determine the number of cells per cluster per sample\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"ab120\",\"text\":\"n_cells \\u003c-FetchData(organoids.combined.sct,vars =c(\\\"ident\\\", \\\"orig.ident\\\")) %\\u003e% dplyr::count(ident, orig.ident) %\\u003e% tidyr::spread(ident, n)\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"155go\",\"text\":\"\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"h1dl\",\"text\":\"write.csv(n_cells, \\\"n_cells.csv\\\")\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"94ib7\",\"text\":\"\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[{\"length\":39,\"offset\":0,\"style\":\"bold\"}],\"key\":\"17ue9\",\"text\":\"## Identify conserved cell type markers\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"5gbbh\",\"text\":\"# Switch back to the original data\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"fbgbd\",\"text\":\"DefaultAssay(organoids.combined.sct) \\u003c-\\\"RNA\\\"\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"5d5c9\",\"text\":\"annotations \\u003c-read.csv(\\\"annotation.txt\\\")\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"en7rq\",\"text\":\"\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"cjnpo\",\"text\":\"# conserved markers to any cluster\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"1ulbk\",\"text\":\"get_conserved \\u003c-function(cluster){FindConservedMarkers(organoids.combined.sct, ident.1 =cluster, grouping.var =\\\"orig.ident\\\", only.pos =TRUE) %\\u003e%rownames_to_column(var =\\\"gene\\\") %\\u003e%left_join(y =unique(annotations[, c(\\\"gene_name\\\", \\\"description\\\")]),by =c(\\\"gene\\\"=\\\"gene_name\\\")) %\\u003e%cbind(cluster_id =cluster, .)}\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"43qgf\",\"text\":\"\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"32uss\",\"text\":\"# Iterate function across desired clusters. \",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"c4jcl\",\"text\":\"conserved_markers \\u003c-map_dfr(0:20, get_conserved)\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"9953g\",\"text\":\"\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"2j99s\",\"text\":\"# Extract top 100 markers per cluster\\ntop100 \\u003c-conserved_markers %\\u003e%mutate(avg_fc =(GC1_avg_log2FC +GC2_avg_log2FC +GC3_avg_log2FC + MUT1_avg_log2FC +MUT2_avg_log2FC +MUT3_avg_log2FC) /6) %\\u003e%group_by(cluster_id) %\\u003e%top_n(n =100,wt = avg_fc)\\n\\nwrite.csv(top100, \\\"Clusters_top100.csv\\\")\\n\\n## Identifying gene markers for each cluster\\n\\nGenes \\u003c-c (\\\"SOX2\\\", \\\"DCX\\\", \\\"TH\\\", \\\"NEUROD4\\\") # Change target genes depending on the cell type\\n\\n# UMAP plot\\nFeaturePlot(organoids.combined.sct,reduction =\\\"umap\\\",features = Genes, sort.cell =TRUE, min.cutoff ='q10', max.cutoff =5,label = T, pt.size =0.5)\\n\\n# Violin plot\\nplots \\u003c-VlnPlot(organoids.combined.sct, features =Genes, split.by =\\\"orig.ident\\\", pt.size =0, combine =FALSE)\\nwrap_plots(plots = plots, ncol =1)\\n\\n# Dot plot\\nDotPlot(organoids.combined.sct, features =Genes) +RotatedAxis()\",\"type\":\"unstyled\"}],\"entityMap\":{}}}}}","data":null,"protocol_id":79542,"case_id":0,"critical_ids":"","duration":0,"original_id":1639476,"number":"5","cases":[],"critical":null},{"id":1639566,"guid":"679A1704CD4111EDAA100A58A9FEAC02","previous_id":1639565,"previous_guid":"6799DA82CD4111EDAA100A58A9FEAC02","section":"\u003cp\u003e\u003cstrong\u003ePart 6. Merge and analyse subclusters\u003c/strong\u003e\u003c/p\u003e","section_color":"#E57785","section_duration":0,"is_substep":false,"step":"{\"blocks\":[{\"key\":\"4gei7\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}},{\"key\":\"8jgjn\",\"text\":\" \",\"type\":\"atomic\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[{\"key\":0,\"offset\":0,\"length\":1}],\"data\":{}},{\"key\":\"39tds\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}}],\"entityMap\":{\"0\":{\"type\":\"code_insert\",\"mutability\":\"IMMUTABLE\",\"data\":{\"blocks\":[{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"fmrut\",\"text\":\"## Combine the clusters according to the identity\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"2b9o2\",\"text\":\"new.cluster.ids \\u003c-c(1=\\\"Radial Glia\\\", \",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"3hemn\",\"text\":\"2=\\\"Neurons\\\", \",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"3arc\",\"text\":\"3=\\\"NPC\\\",\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"86m21\",\"text\":\"4=\\\"Oligodendrocytes\\\", \",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"acrtg\",\"text\":\"5=\\\"Astrocytes\\\", \\\"...\\\")\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"66fic\",\"text\":\"\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"3qtjp\",\"text\":\"names(new.cluster.ids) \\u003c-levels(organoids.combined.sct)\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"4g588\",\"text\":\"\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"5ria0\",\"text\":\"organoids.combined.newnames \\u003c-RenameIdents(organoids.combined.sct, new.cluster.ids)\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"6vq0i\",\"text\":\"\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"aik5p\",\"text\":\"DimPlot(organoids.combined.newnames, reduction =\\\"umap\\\", label =TRUE, pt.size =0.5) +NoLegend()\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"ephug\",\"text\":\"\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"e9gtv\",\"text\":\"#Using DE analysis in specific clusters (after merging) MAST\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"dho9r\",\"text\":\"\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"4h9d8\",\"text\":\"annotations \\u003c-read.csv(\\\"annotation.txt\\\")\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"e4lii\",\"text\":\"\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"7esqd\",\"text\":\"Markers \\u003c-FindMarkers(organoids.combined.newnames, ident.1 =\\\"GC1\\\", ident.2 =\\\"MUT1\\\", group.by =\\\"orig.ident\\\", subset.ident =\\\"Radial Glia\\\", min.pct =0.1, test.use =\\\"MAST\\\")%\\u003e%rownames_to_column(var =\\\"gene\\\") %\\u003e%left_join(y =unique(annotations[, c(\\\"gene_name\\\", \\\"description\\\")]),by =c(\\\"gene\\\"=\\\"gene_name\\\")) \",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"1i1r3\",\"text\":\"\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"6tn66\",\"text\":\"#Save\\nwrite.csv(Markers, \\\"DEgenes_cRadial Glia_1couple.csv\\\")\",\"type\":\"unstyled\"}],\"entityMap\":{}}}}}","data":null,"protocol_id":79542,"case_id":0,"critical_ids":"","duration":0,"original_id":1639477,"number":"6","cases":[],"critical":null},{"id":1639567,"guid":"679A587FCD4111EDAA100A58A9FEAC02","previous_id":1639566,"previous_guid":"679A1704CD4111EDAA100A58A9FEAC02","section":"\u003cp\u003e\u003cstrong\u003ePart 7. Create a subset of cells from a selected cluster to reanalyze\u003c/strong\u003e\u003c/p\u003e","section_color":"#EA94FF","section_duration":0,"is_substep":false,"step":"{\"blocks\":[{\"key\":\"d8jc9\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}},{\"key\":\"11bbr\",\"text\":\" \",\"type\":\"atomic\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[{\"key\":0,\"offset\":0,\"length\":1}],\"data\":{}},{\"key\":\"7tmgn\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}}],\"entityMap\":{\"0\":{\"type\":\"code_insert\",\"mutability\":\"IMMUTABLE\",\"data\":{\"blocks\":[{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"3299b\",\"text\":\"Neurons_subset \\u003c-subset(organoids.combined.newnames, idents =\\\"Neurons\\\")\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"58e0d\",\"text\":\"Neurons_subset\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"684ar\",\"text\":\"\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"edlvb\",\"text\":\"DefaultAssay(Neurons_subset) \\u003c-\\\"integrated\\\"\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"dvgjm\",\"text\":\"\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"9c5m7\",\"text\":\"# Run the standard workflow for visualization and clustering\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"69ha6\",\"text\":\"Neurons_subset \\u003c-RunPCA(Neurons_subset, verbose =FALSE)\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"f578o\",\"text\":\"\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"77oun\",\"text\":\"# Plot PCA\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"3jiod\",\"text\":\"PCAPlot(Neurons_subset,\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"6afm\",\"text\":\"split.by =\\\"orig.ident\\\")\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"dae3n\",\"text\":\"\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"arlb0\",\"text\":\"#Run variable features\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"974a1\",\"text\":\"Neurons_subset \\u003c-FindVariableFeatures(Neurons_subset,selection.method =\\\"vst\\\", nfeatures =2000, verbose =FALSE)\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"d7rhv\",\"text\":\"\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"csg1j\",\"text\":\"# Scale the counts\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"3jo50\",\"text\":\"Neurons_subset \\u003c-ScaleData(Neurons_subset)\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"56s4h\",\"text\":\"\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"3he4q\",\"text\":\"#Find neighbors for cluster analysis\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"ae3mb\",\"text\":\"Neurons_subset \\u003c-FindNeighbors(Neurons_subset, reduction =\\\"pca\\\", dims =1:40)\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"10mav\",\"text\":\"\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"c2ruq\",\"text\":\"Neurons_subset \\u003c-FindClusters(Neurons_subset, resolution =0.4)\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"cig2k\",\"text\":\"\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"40vai\",\"text\":\"# Assign identity of clusters\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"eive2\",\"text\":\"Idents(object =Neurons_subset) \\u003c-\\\"integrated_snn_res.0.4\\\"\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"f1nsu\",\"text\":\"\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"24oiu\",\"text\":\"# Visualization\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"el8ci\",\"text\":\"all.genes \\u003c-rownames(Neurons_subset)\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"dpkro\",\"text\":\"Neurons_subset \\u003c-ScaleData(Neurons_subset, features =all.genes)\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"1sef0\",\"text\":\"\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"b6ve6\",\"text\":\"DimPlot(Neurons_subset, reduction =\\\"umap\\\", group.by =\\\"orig.ident\\\")\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"3qp9\",\"text\":\"DimPlot(Neurons_subset, reduction =\\\"umap\\\")\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"36ca9\",\"text\":\"\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"g8do\",\"text\":\"# to remove a non-specific cluster\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"9paq\",\"text\":\"Finalcluster \\u003c-subset(Neurons_subset, idents =5, invert = T)\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"57vd2\",\"text\":\"DimPlot(Finalcluster, reduction =\\\"umap\\\")\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"dn661\",\"text\":\"\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"2k7dj\",\"text\":\"# To visualize the two conditions side-by-side\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"e6stu\",\"text\":\"DimPlot(Neurons_subset, reduction =\\\"umap\\\", split.by =\\\"orig.ident\\\")\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"9776b\",\"text\":\"\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"30iu0\",\"text\":\"## Cluster identification. Find conserved markers to any cluster\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"2gajd\",\"text\":\"DefaultAssay(organoids.combined.sct) \\u003c-\\\"RNA\\\"\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"8isft\",\"text\":\"\",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"esifq\",\"text\":\"get_conserved \\u003c-function(cluster){FindConservedMarkers(Neurons_subset,ident.1 = cluster, grouping.var =\\\"orig.ident\\\",only.pos =TRUE) %\\u003e%rownames_to_column(var =\\\"gene\\\") %\\u003e%left_join(y =unique(annotations[, c(\\\"gene_name\\\", \\\"description\\\")]), by =c(\\\"gene\\\"=\\\"gene_name\\\")) %\\u003e%cbind(cluster_id = cluster, .)}\\n\\n# Iterate function across desired clusters. \\nconserved_markers \\u003c-map_dfr(0:8, get_conserved)\\n\\n# Extract top 100 markers per cluster\\ntop100 \\u003c-conserved_markers %\\u003e%\\nmutate(avg_fc =(GC1_avg_log2FC +GC2_avg_log2FC +GC3_avg_log2FC + MUT1_avg_log2FC +MUT2_avg_log2FC +MUT3_avg_log2FC) /6) %\\u003e%\\ngroup_by(cluster_id) %\\u003e%\\ntop_n(n =100, \\nwt = avg_fc)\\n\\n#OR save\\nwrite.csv(top100, \\\"Clusters_top100_Neuronsubset.csv\\\")\",\"type\":\"unstyled\"}],\"entityMap\":{}}}}}","data":null,"protocol_id":79542,"case_id":0,"critical_ids":"","duration":0,"original_id":1639478,"number":"7","cases":[],"critical":null},{"id":1639568,"guid":"679A97D9CD4111EDAA100A58A9FEAC02","previous_id":1639567,"previous_guid":"679A587FCD4111EDAA100A58A9FEAC02","section":"\u003cp\u003e\u003cstrong\u003ePart 8. Differential expressed genes using FIndMarkers with MAST\u003c/strong\u003e\u003c/p\u003e","section_color":"#A492FF","section_duration":0,"is_substep":false,"step":"{\"blocks\":[{\"key\":\"9n10h\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}},{\"key\":\"7tfse\",\"text\":\" \",\"type\":\"atomic\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[{\"key\":0,\"offset\":0,\"length\":1}],\"data\":{}},{\"key\":\"3a6al\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}}],\"entityMap\":{\"0\":{\"type\":\"code_insert\",\"mutability\":\"IMMUTABLE\",\"data\":{\"blocks\":[{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"4vtu5\",\"text\":\"annotations \\u003c-read.csv(\\\"annotation.txt\\\")\\n\\n# couple 1\\nMarkers \\u003c-FindMarkers(Neurons_subset, ident.1 =\\\"GC1\\\", ident.2 =\\\"MUT1\\\", group.by =\\\"orig.ident\\\", subset.ident =\\\"11\\\", min.pct =0.1, test.use =\\\"MAST\\\")%\\u003e%\\nrownames_to_column(var =\\\"gene\\\") %\\u003e%left_join(y =unique(annotations[, c(\\\"gene_name\\\", \\\"description\\\")]), by =c(\\\"gene\\\"=\\\"gene_name\\\")) \",\"type\":\"unstyled\"},{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"fflmi\",\"text\":\"\\nwrite.csv(Markers, \\\"DEgenes_C11Neuron_1couple.csv\\\")\\n\\n# couple 2\\nMarkers \\u003c-FindMarkers(Neurons_subset, ident.1 =\\\"GC2\\\", ident.2 =\\\"MUT2\\\", group.by =\\\"orig.ident\\\", subset.ident =\\\"11\\\", min.pct =0.1, test.use =\\\"MAST\\\")%\\u003e%rownames_to_column(var =\\\"gene\\\") %\\u003e%left_join(y =unique(annotations[, c(\\\"gene_name\\\", \\\"description\\\")]),by =c(\\\"gene\\\"=\\\"gene_name\\\")) \\n\\nwrite.csv(Markers, \\\"DEgenes_C11Neuron_2couple.csv\\\")\\n\\n# couple 3\\n\\nMarkers \\u003c-FindMarkers(Neurons_subset, ident.1 =\\\"GC3\\\", ident.2 =\\\"MUT3\\\", group.by =\\\"orig.ident\\\", subset.ident =\\\"11\\\", min.pct =0.1, test.use =\\\"MAST\\\")%\\u003e%\\nrownames_to_column(var =\\\"gene\\\") %\\u003e%left_join(y =unique(annotations[, c(\\\"gene_name\\\", \\\"description\\\")]), by =c(\\\"gene\\\"=\\\"gene_name\\\")) \\n\\nwrite.csv(Markers, \\\"DEgenes_C11Neuron_3couple.csv\\\")\",\"type\":\"unstyled\"}],\"entityMap\":{}}}}}","data":null,"protocol_id":79542,"case_id":0,"critical_ids":"","duration":0,"original_id":1639479,"number":"8","cases":[],"critical":null},{"id":1639569,"guid":"679AD2BCCD4111EDAA100A58A9FEAC02","previous_id":1639568,"previous_guid":"679A97D9CD4111EDAA100A58A9FEAC02","section":"\u003cp\u003e\u003cstrong\u003ePart 9. Analysis of differential expressed genes using FIndMarkers with MAST in non-integrated samples (directly after Part 3)samples (directly after Part 3)\u003c/strong\u003e\u003c/p\u003e","section_color":"#94EBFF","section_duration":0,"is_substep":false,"step":"{\"blocks\":[{\"key\":\"bekmr\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}},{\"key\":\"cvmas\",\"text\":\" \",\"type\":\"atomic\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[{\"key\":0,\"offset\":0,\"length\":1}],\"data\":{}},{\"key\":\"3qo65\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}}],\"entityMap\":{\"0\":{\"type\":\"code_insert\",\"mutability\":\"IMMUTABLE\",\"data\":{\"blocks\":[{\"data\":{},\"depth\":0,\"entityRanges\":[],\"inlineStyleRanges\":[],\"key\":\"bkl9\",\"text\":\"# Merge datasets, example analysis for couple 1\\n\\norganoids.combined.sct \\u003c-Reduce(function(x,y) merge(x,y, all=T), list (split_seurat$GC1, split_seurat$MUT1))\\ninteg_features \\u003c-SelectIntegrationFeatures(object.list =split_seurat, nfeatures =3000)\\nVariableFeatures(organoids.combined.sct[[\\\"SCT\\\"]]) \\u003c-integ_features\\n\\n## Run the standard workflow for visualization and clustering\\nDefaultAssay(organoids.combined.sct) \\u003c-\\\"integrated\\\"\\n\\norganoids.combined.sct \\u003c-RunPCA(organoids.combined.sct, verbose =FALSE)\\nPCAPlot(organoids.combined.sct,split.by =\\\"orig.ident\\\")\\n\\norganoids.combined.sct \\u003c-RunUMAP(organoids.combined.sct, reduction =\\\"pca\\\", dims =1:40)\\n\\n# Plot UMAP\\nDimPlot(organoids.combined.sct, split.by =\\\"orig.ident\\\")\\n\\nDimPlot(organoids.combined.sct, group.by =\\\"orig.ident\\\")\\n\\n# Elbow plot\\nElbowPlot(object =organoids.combined.sct,ndims =40)\\n\\n#Find neighbors for cluster analysis\\norganoids.combined.sct \\u003c-FindNeighbors(organoids.combined.sct, reduction =\\\"pca\\\", dims =1:40)\\norganoids.combined.sct \\u003c-FindClusters(organoids.combined.sct, resolution =c(0.6))\\n\\n# Assign identity of clusters\\nIdents(object =organoids.combined.sct) \\u003c-\\\"integrated_snn_res.0.6\\\"\\n\\n# Visualization\\nall.genes \\u003c-rownames(organoids.combined.sct)\\norganoids.combined.sct \\u003c-ScaleData(organoids.combined.sct, features =all.genes)\\n\\nDimPlot(organoids.combined.sct, reduction =\\\"umap\\\", group.by =\\\"seurat_clusters\\\", label =TRUE,repel =TRUE)\\n\\nDimPlot(organoids.combined.sct, reduction =\\\"umap\\\", split.by =\\\"orig.ident\\\")\\n\\n## Continue withPart 5 and/or 6 if needed\\n\\n## To analyze the clusters with resolution of 0.6\\nannotations \\u003c-read.csv(\\\"annotation.txt\\\")\\n\\n# Change the cluster as needed\\nMarkers \\u003c-FindMarkers(organoids.combined.sct, ident.1 =\\\"GC1\\\", ident.2 =\\\"MUT1\\\", group.by =\\\"orig.ident\\\", subset.ident =\\\"20\\\", min.pct =0.1, test.use =\\\"MAST\\\")%\\u003e%rownames_to_column(var =\\\"gene\\\") %\\u003e%left_join(y =unique(annotations[, c(\\\"gene_name\\\", \\\"description\\\")]), by =c(\\\"gene\\\"=\\\"gene_name\\\")) \\n\\n#save\\nwrite.csv(Markers, \\\"DEgenes_Cluster20_couple1.csv\\\")\",\"type\":\"unstyled\"}],\"entityMap\":{}}}}}","data":null,"protocol_id":79542,"case_id":0,"critical_ids":"","duration":0,"original_id":1639480,"number":"9","cases":[],"critical":null}],"template_id":4,"title":"Single cell analysis of iPSC-derived midbrain organoids","title_html":"Single cell analysis of iPSC-derived midbrain organoids","type_id":1,"units":[{"id":1,"type_id":3,"name":"µL","can_manage":0,"read_only":0},{"id":2,"type_id":3,"name":"mL","can_manage":0,"read_only":0},{"id":3,"type_id":3,"name":"L","can_manage":0,"read_only":0},{"id":4,"type_id":3,"name":"µg","can_manage":0,"read_only":0},{"id":5,"type_id":3,"name":"mg","can_manage":0,"read_only":0},{"id":6,"type_id":3,"name":"g","can_manage":0,"read_only":0},{"id":7,"type_id":3,"name":"kg","can_manage":0,"read_only":0},{"id":8,"type_id":3,"name":"ng","can_manage":0,"read_only":0},{"id":9,"type_id":3,"name":"Hz","can_manage":0,"read_only":0},{"id":10,"type_id":24,"name":"°C","can_manage":0,"read_only":0},{"id":11,"type_id":24,"name":"°К","can_manage":0,"read_only":0},{"id":12,"type_id":24,"name":"°F","can_manage":0,"read_only":0},{"id":13,"type_id":25,"name":"Mass Percent","can_manage":0,"read_only":0},{"id":14,"type_id":25,"name":"% volume","can_manage":0,"read_only":0},{"id":15,"type_id":25,"name":"Mass / % volume","can_manage":0,"read_only":0},{"id":16,"type_id":25,"name":"Parts per Million (PPM)","can_manage":0,"read_only":0},{"id":17,"type_id":25,"name":"Parts per Billion (PPB)","can_manage":0,"read_only":0},{"id":18,"type_id":25,"name":"Parts per Trillion (PPT)","can_manage":0,"read_only":0},{"id":19,"type_id":25,"name":"Mole Fraction","can_manage":0,"read_only":0},{"id":20,"type_id":25,"name":"Mole Percent","can_manage":0,"read_only":0},{"id":21,"type_id":25,"name":"Molarity (M)","can_manage":0,"read_only":1},{"id":22,"type_id":25,"name":"Molarity (m)","can_manage":0,"read_only":0},{"id":23,"type_id":25,"name":"Genome copies per ml","can_manage":0,"read_only":0},{"id":24,"type_id":3,"name":"μV","can_manage":0,"read_only":0},{"id":25,"type_id":3,"name":"ms","can_manage":0,"read_only":0},{"id":26,"type_id":3,"name":"pg","can_manage":0,"read_only":0},{"id":27,"type_id":25,"name":"Molarity dilutions","can_manage":0,"read_only":0},{"id":28,"type_id":25,"name":"millimolar (mM)","can_manage":0,"read_only":0},{"id":29,"type_id":25,"name":"micromolar (µM)","can_manage":0,"read_only":0},{"id":30,"type_id":25,"name":"nanomolar (nM)","can_manage":0,"read_only":0},{"id":31,"type_id":25,"name":"picomolar (pM)","can_manage":0,"read_only":0},{"id":32,"type_id":24,"name":"Room temperature","can_manage":0,"read_only":0},{"id":33,"type_id":30,"name":"rpm","can_manage":0,"read_only":0},{"id":34,"type_id":30,"name":"x g","can_manage":0,"read_only":0},{"id":165,"type_id":24,"name":"On ice","can_manage":0,"read_only":0},{"id":200,"type_id":32,"name":"cm","can_manage":0,"read_only":0},{"id":201,"type_id":32,"name":"mm","can_manage":0,"read_only":0},{"id":202,"type_id":32,"name":"µm","can_manage":0,"read_only":0},{"id":203,"type_id":32,"name":"nm","can_manage":0,"read_only":0},{"id":204,"type_id":25,"name":"mg/mL","can_manage":0,"read_only":0},{"id":205,"type_id":25,"name":"µg/µL","can_manage":0,"read_only":0},{"id":206,"type_id":25,"name":"% (v/v)","can_manage":0,"read_only":0},{"id":1324,"type_id":30,"name":"rcf","can_manage":0,"read_only":0},{"id":1359,"type_id":35,"name":"Bar","can_manage":0,"read_only":0},{"id":1360,"type_id":35,"name":"Pa","can_manage":0,"read_only":0}],"uri":"single-cell-analysis-of-ipsc-derived-midbrain-orga-crwwv7fe","url":"https://www.protocols.io/view/single-cell-analysis-of-ipsc-derived-midbrain-orga-crwwv7fe","version_class":79542,"version_data":{"id":0,"code":"crwwv7fe","version_class":79542,"parent_id":null,"parent_uri":null,"is_same_owner":false,"is_parent_public":false,"has_pending_merge_request":false,"has_approved_merge_request":false,"merge_request":null},"version_id":0,"version_uri":"single-cell-analysis-of-ipsc-derived-midbrain-orga-36wgqjk53vk5/v1","versions":[{"id":79542,"title":"Single cell analysis of iPSC-derived midbrain organoids","title_html":"Single cell analysis of iPSC-derived midbrain organoids","image":{"source":"https://www.protocols.io/img/default_protocol.png","webp_source":null,"placeholder":"https://www.protocols.io/img/default_protocol.png","webp_placeholder":null},"doi":"dx.doi.org/10.17504/protocols.io.36wgqjk53vk5/v1","uri":"single-cell-analysis-of-ipsc-derived-midbrain-orga-crwwv7fe","published_on":1680202309,"modified_on":1680202309,"version_class":79542,"version_id":0,"version_code":"crwwv7fe","version_uri":"single-cell-analysis-of-ipsc-derived-midbrain-orga-36wgqjk53vk5/v1","created_on":1679991631,"categories":null,"creator":{"name":"Federico   Bertoli","affiliation":null,"affiliation_url":null,"username":"federico---bertoli","link":"","image":{"source":"/img/avatars/001.png","placeholder":"/img/avatars/001.png","webp_source":""}},"stats":{"number_of_comments":0,"last_comment_time":0}}],"warning":""}