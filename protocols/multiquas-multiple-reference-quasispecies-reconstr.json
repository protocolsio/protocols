{"id":52693,"title":"MultiQuas (Multiple reference quasispecies reconstruction protocol)","title_html":"<p><em><strong>MultiQuas<\/strong><\/em> (<em>Multi<\/em>ple reference <em>quas<\/em>ispecies reconstruction protocol)<\/p>","image":{"source":"https:\/\/www.protocols.io\/img\/default_protocol.png","placeholder":"https:\/\/www.protocols.io\/img\/default_protocol.png"},"doi":null,"doi_status":0,"uri":"multiquas-multiple-reference-quasispecies-reconstr-bxpvpmn6","type_id":1,"template_id":5,"published_on":1629860337,"parent_protocols":[],"parent_collections":[],"cited_protocols":[],"version_id":2,"version_data":{"id":2,"code":"bxpvpmn6","parent_id":52265,"parent_uri":"multiquas-multiple-reference-quasispecies-reconstr-bxahpib6","has_pending_merge_request":0,"has_approved_merge_request":1},"created_on":1629856788,"modified_on":null,"categories":null,"public":1,"is_unlisted":0,"creator":{"name":" ","affiliation":null,"affiliations":[],"username":null,"note":null,"link":null,"image":{"source":null,"placeholder":null},"badges":[],"verified":0,"is_verified_user":false,"research_interests":null,"blocked_by_you":false,"blocked_you":false,"hide_following":false},"journal":null,"journal_name":null,"journal_link":null,"article_citation":null,"has_versions":0,"link":null,"total_collections":0,"number_of_steps":23,"authors":[{"name":"Marco  Cacciabue","affiliation":"Instituto de Agrobiotecnolog\u00eda y Biolog\u00eda Molecular (IABIMO, INTA-CONICET)","affiliations":[],"username":"marco--cacciabue","note":null,"link":null,"image":{"source":"\/img\/avatars\/007.png","placeholder":"\/img\/avatars\/007.png"},"badges":[],"verified":1,"is_verified_user":true,"research_interests":null,"blocked_by_you":false,"blocked_you":false,"hide_following":false}],"versions":[],"groups":[{"id":30767,"uri":"fmdvarglab","title":"FMDV_ARG_Lab","image":{"source":"https:\/\/www.protocols.io\/img\/group_placeholder.png","placeholder":"https:\/\/www.protocols.io\/img\/group_placeholder.png"},"tech_support":{"email":null,"phone":null,"hide_contact":0,"use_email":0,"url":null},"is_member":1,"request":{"id":30767,"uri":"fmdvarglab","title":"FMDV_ARG_Lab","image":{"source":"https:\/\/www.protocols.io\/img\/group_placeholder.png","placeholder":"https:\/\/www.protocols.io\/img\/group_placeholder.png"},"tech_support":{"email":null,"phone":null,"hide_contact":0,"use_email":0,"url":null},"is_member":1,"description":null,"research_interests":null,"website":null,"location":null,"affiliation":null,"status":{"is_visible":true,"access_level":0},"stats":{"files":[],"total_members":0,"total_followers":0,"total_child_groups":0,"total_parent_groups":0,"has_collaborations":0},"user_status":{"is_member":true,"is_confirmed":true,"is_invited":false,"is_owner":true,"is_admin":false,"is_following":false},"join_link":null,"token":null,"owner":{"name":" ","affiliation":null,"affiliations":[],"username":null,"note":null,"link":null,"image":{"source":null,"placeholder":null},"badges":[],"verified":0,"is_verified_user":false,"research_interests":null,"blocked_by_you":false,"blocked_you":false,"hide_following":false},"is_protocol_requested":0,"is_group_requested":0,"is_my":false,"is_request":false,"is_confirmed":1,"is_declined":0,"requester":{"name":" ","affiliation":null,"affiliation_url":null,"username":null,"link":null},"protocol":{"id":0,"title":"MultiQuas (Multiple reference quasispecies reconstruction protocol)","title_html":"MultiQuas (Multiple reference quasispecies reconstruction protocol)","image":{"source":null,"placeholder":null},"doi":null,"doi_status":0,"uri":"multiquas-multiple-reference-quasispecies-reconstr-bxpvpmn6","type_id":1,"template_id":0,"published_on":null,"stats":{"number_of_views":0,"number_of_steps":0,"number_of_bookmarks":0,"number_of_comments":0,"number_of_exports":0,"number_of_runs":0,"number_of_votes":0,"is_voted":0},"parent_protocols":[],"parent_collections":[],"cited_protocols":[]},"created_on":1629846904,"resolve_on":0,"resolved_user":{"name":" ","affiliation":null,"affiliations":[],"username":null,"note":null,"link":null,"image":{"source":null,"placeholder":null},"badges":[],"verified":0,"is_verified_user":false,"research_interests":null,"blocked_by_you":false,"blocked_you":false,"hide_following":false},"shared":false}}],"is_owner":1,"has_subprotocols":0,"is_subprotocol":0,"is_bookmarked":0,"can_claim_authorship":0,"can_accept_authorship":0,"can_be_copied":1,"can_remove_fork":1,"fork_id":null,"url":"https:\/\/www.protocols.io\/view\/multiquas-multiple-reference-quasispecies-reconstr-bxpvpmn6","forks_count":{"private":0,"public":0},"access":{"can_view":1,"can_remove":1,"can_add":0,"can_edit":0,"can_publish":0,"can_get_doi":1,"can_share":1,"can_move":1,"can_move_outside":1,"can_transfer":1,"can_download":1,"is_locked":0},"guid":"1544FE1C7D5E4FA8A7D0D3A5BB9AAFE3","state_version_id":1018,"steps":[{"id":1239786,"guid":"A8519A3028144DC981938A931154D1B4","previous_id":null,"previous_guid":null,"modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"EBD78A1623C94AD6BEF64FD04A9D4FD4","order_id":1,"type_id":6,"title":"Section","source":{"title":"Brief pipeline description"}},{"id":1054724,"guid":"6C603F6DFB69458C891C126B80CCE699","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><br\/><div class = \"text-block\">Reads are trimmed and filtered using <\/div><br\/><br\/><\/div>"}},{"id":1054725,"guid":"311D2B50047611EC92DB73C81E1F87F6","order_id":2,"type_id":8,"title":"software","source":{"name":"bbduk","developer":"Brian Bushnell","repository":"https:\/\/sourceforge.net\/projects\/bbmap\/","link":"https:\/\/sourceforge.net\/projects\/bbmap\/","os_name":null,"os_version":null}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#A492FF","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1239787,"guid":"D56014A6CDE547C481F8ADB1E10EBB93","previous_id":1239786,"previous_guid":"A8519A3028144DC981938A931154D1B4","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"3721118F169D42EE9E2CF26E1D113161","order_id":1,"type_id":6,"title":"Section","source":{"title":"Brief pipeline description"}},{"id":1054724,"guid":"B7E20F97BDF642488BDCF806720B50B0","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Filtered and trimmed reads are aligned to a set of user-defined references (multifasta format) with <\/div><br\/><br\/><br\/><\/div>"}},{"id":1054725,"guid":"707683F0047611EC92DB73C81E1F87F6","order_id":2,"type_id":8,"title":"software","source":{"name":"Bowtie2","developer":null,"repository":"http:\/\/bowtie-bio.sourceforge.net\/bowtie2\/index.shtml","link":"http:\/\/bowtie-bio.sourceforge.net\/bowtie2\/index.shtml","os_name":null,"os_version":null}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#A492FF","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1239788,"guid":"66D44B9EB5BE45DA98B8AFAB10441E4A","previous_id":1239787,"previous_guid":"D56014A6CDE547C481F8ADB1E10EBB93","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"77C8465D1B8B4CB5A75BC52F4039FCF3","order_id":1,"type_id":6,"title":"Section","source":{"title":"Brief pipeline description"}},{"id":1054724,"guid":"46E30D278C0D4197A34FDC07E3154185","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Reads are then split into different classes (one for each reference and one for the unmapped reads) using <\/div><br\/><br\/><\/div>"}},{"id":1054725,"guid":"A9021220047611EC92DB73C81E1F87F6","order_id":2,"type_id":8,"title":"software","source":{"name":"SAMtools","developer":"Wellcome Trust Sanger Institute","repository":"https:\/\/github.com\/samtools\/samtools","link":"http:\/\/www.htslib.org\/download\/","os_name":"Linux","os_version":""}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#A492FF","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1239789,"guid":"032AF1C8C824432C80D2A443481E6799","previous_id":1239788,"previous_guid":"66D44B9EB5BE45DA98B8AFAB10441E4A","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"E16EFDF1351548898F7811BD89E8F4C2","order_id":1,"type_id":6,"title":"Section","source":{"title":"Brief pipeline description"}},{"id":1054724,"guid":"140433B7719242A58AF966795BAB0D29","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">For each class,  reads are merged using<\/div><br\/><br\/><div class = \"text-block\">and then haplotypes are reconstructed with<\/div><br\/><div class = \"text-block\">Important note: If the time limit is reached this step is repeated with a subset of the reads in order to reduce computation time and resources required by QuRe. Steps include 0.99, 0.9, 0.8, 0.7, 0.6 and 0.5 proportions of the toal reads for each class in that order.  <\/div><\/div>"}},{"id":1054725,"guid":"F390BBC0047B11EC92DB73C81E1F87F6","order_id":2,"type_id":8,"title":"software","source":{"name":"PEAR - Paired-End reAd mergeR","developer":"Alexandros Stamatakis","repository":"https:\/\/cme.h-its.org\/exelixis\/web\/software\/pear\/doc.html","link":null,"os_name":null,"os_version":null}},{"id":1054726,"guid":"0F58D7B0047811EC92DB73C81E1F87F6","order_id":3,"type_id":8,"title":"software","source":{"name":"QuRe","developer":"Mattia C. F. Prosperi","repository":"https:\/\/doi.org\/10.1093\/bioinformatics\/btr627","link":"https:\/\/doi.org\/10.1093\/bioinformatics\/btr627","os_name":null,"os_version":null}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#A492FF","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1239790,"guid":"013490E9679947558904BC8C2410D24C","previous_id":1239789,"previous_guid":"032AF1C8C824432C80D2A443481E6799","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"60F54C019E51499FAF5C1F1718D8E5CE","order_id":1,"type_id":6,"title":"Section","source":{"title":"Brief pipeline description"}},{"id":1054724,"guid":"7AEDCA65B2BE4C26B8C4E712AA3B3A67","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Next, the proportions of each haplotype class (predicted by QuRe) are adjusted to reflect the number of reads of the corresponding class.<\/div><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#A492FF","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1239791,"guid":"9B1FD53584CB4CAE9E767FA1618DB03A","previous_id":1239790,"previous_guid":"013490E9679947558904BC8C2410D24C","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"5D0E6F4CE0A84ECDABC06CB2305BECB1","order_id":1,"type_id":6,"title":"Section","source":{"title":"Brief pipeline description"}},{"id":1054724,"guid":"8A2F232ECD4E4054B6C5749002EC7AD1","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">All reconstructed haplotypes are aligned to the first reference in the multifasta file using<\/div><br\/><br\/><\/div>"}},{"id":1054725,"guid":"BEDED030047911EC92DB73C81E1F87F6","order_id":2,"type_id":8,"title":"software","source":{"name":"mafft","developer":"Kazutaka Katoh","repository":"https:\/\/mafft.cbrc.jp\/alignment\/software\/","link":"https:\/\/mafft.cbrc.jp\/alignment\/software\/","os_name":null,"os_version":null}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#A492FF","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1239792,"guid":"95503B1924524B3689ADA179339BEF42","previous_id":1239791,"previous_guid":"9B1FD53584CB4CAE9E767FA1618DB03A","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"BEA141A2D1404096A212736830E6A994","order_id":1,"type_id":6,"title":"Section","source":{"title":"Brief pipeline description"}},{"id":1054724,"guid":"12AD625843004FA5ADA889672D84C4E5","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Additionally, reads are then aligned to the first reference in the multifasta file. Single Nucleotide Variants (SNVs) are called using<\/div><br\/><br\/><\/div>"}},{"id":1054725,"guid":"1FCAA190047911EC92DB73C81E1F87F6","order_id":2,"type_id":8,"title":"software","source":{"name":"Lofreq","developer":"Andreas Wilm","repository":"https:\/\/csb5.github.io\/lofreq\/","link":"https:\/\/csb5.github.io\/lofreq\/","os_name":null,"os_version":null}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#A492FF","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1239793,"guid":"456230549406487BB33F8819928EB5B4","previous_id":1239792,"previous_guid":"95503B1924524B3689ADA179339BEF42","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"BD4352ED630B4951A9B2E9232FD89072","order_id":1,"type_id":6,"title":"Section","source":{"title":"Brief pipeline description"}},{"id":1054724,"guid":"AC8FA4F56C114DBBB4B63E709D3FDA15","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Finally, concordance between the SNVs (expected minor allele frequency) from the predicted quasispecies and the Lofreq variants using an in-house R script. Higher value of R-squared indicates a better quasispecies reconstruction. Important: this step does not meant as a validation of the obtained results, but it allows the user to choose between different haplotypes reconstructions.<\/div><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#A492FF","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1239794,"guid":"63474087EB41451DBEDDA095872CD04D","previous_id":1239793,"previous_guid":"456230549406487BB33F8819928EB5B4","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"0FD847C6A0124CC8895299275C807FEC","order_id":1,"type_id":6,"title":"Section","source":{"title":"Installing docker"}},{"id":1054724,"guid":"55B55E071E144E2A86D0399F3E83F655","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">In order to run the pipeline, a wrapper file is available (bash) which automatically perfoms all the above numbered steps. A docker image is available that includes all the necessary dependencies. If you do not yet have docker installed, do so at this time, and ensure that is in your PATH. For more information please visit <\/div><div class = \"text-block\"><a href=\"https:\/\/www.docker.com\/get-started\" style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">https:\/\/www.docker.com\/get-started<\/span><\/a><\/div><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#94EBFF","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1239795,"guid":"10ABDAA2B75F45829AA3599E59A42037","previous_id":1239794,"previous_guid":"63474087EB41451DBEDDA095872CD04D","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"C5330B5A4AAB4113A287EFD710D1E44C","order_id":1,"type_id":6,"title":"Section","source":{"title":"Installing docker"}},{"id":1054724,"guid":"4B9A4E90BDFF49A882F563FF4F646FE8","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">The docker image (\"multiquas\") is available at Docker hub <\/div><div class = \"text-block\">To pull the image, use the command below:<\/div><br\/><div class = \"text-block\">This will download and install the corresponding docker image. Only has to be run the first time (it may take several minutes depending on your internet connection)<\/div><br\/><br\/><\/div>"}},{"id":1054725,"guid":"D4E59990047E11EC92DB73C81E1F87F6","order_id":2,"type_id":15,"title":"command","source":{"id":9274,"name":"docker pull cacciabue\/multiquas:latest","command_name":"docker pull","command":null,"os_name":"","os_version":null}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#94EBFF","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1239796,"guid":"A1EB427597B04D4BA15342BE1BF7467B","previous_id":1239795,"previous_guid":"10ABDAA2B75F45829AA3599E59A42037","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"E145048F11034BC9A1FF6FD91A62A7D6","order_id":1,"type_id":6,"title":"Section","source":{"title":"Installing docker"}},{"id":1054724,"guid":"6CF152E45AD042F98925D89F6A52FEBD","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Alternatively, If you don't want to use Docker, you can install all dependencies by yourself (only for linux users). The dependencies are:<\/div><div class = \"text-block\">BCFtools v1.8 (or later version) <\/div><div class = \"text-block\"><a href=\"http:\/\/www.htslib.org\/download\" style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">http:\/\/www.htslib.org\/download\/<\/span><\/a><\/div><div class = \"text-block\">Samtools v1.8 (or later version) <\/div><div class = \"text-block\"><a href=\"http:\/\/www.htslib.org\/download\" style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">http:\/\/www.htslib.org\/download\/<\/span><\/a><\/div><div class = \"text-block\">Bowtie2 v2.2.4 <\/div><div class = \"text-block\"><a href=\"http:\/\/bowtie-bio.sourceforge.net\/bowtie2\/index.shtml\" style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">http:\/\/bowtie-bio.sourceforge.net\/bowtie2\/index.shtml<\/span><\/a><\/div><div class = \"text-block\">PEAR <\/div><div class = \"text-block\"><a href=\"https:\/\/cme.h-its.org\/exelixis\/web\/software\/pear\/doc.html\" style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">https:\/\/cme.h-its.org\/exelixis\/web\/software\/pear\/doc.html<\/span><\/a><\/div><div class = \"text-block\">seqtk <\/div><div class = \"text-block\"><a href=\"https:\/\/github.com\/lh3\/seqtk\" style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">https:\/\/github.com\/lh3\/seqtk<\/span><\/a><\/div><div class = \"text-block\">bbmap <\/div><div class = \"text-block\"><a href=\"https:\/\/jgi.doe.gov\/data-and-tools\/bbtools\/bb-tools-user-guide\/bbduk-guide\" style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">https:\/\/jgi.doe.gov\/data-and-tools\/bbtools\/bb-tools-user-guide\/bbduk-guide\/<\/span><\/a><\/div><div class = \"text-block\">Lofreq v2 <\/div><div class = \"text-block\"><a href=\"https:\/\/csb5.github.io\/lofreq\" style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">https:\/\/csb5.github.io\/lofreq\/<\/span><\/a><\/div><div class = \"text-block\">mafft <\/div><div class = \"text-block\"><a href=\"https:\/\/mafft.cbrc.jp\/alignment\/software\" style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">https:\/\/mafft.cbrc.jp\/alignment\/software\/<\/span><\/a><\/div><div class = \"text-block\">R v4.1 (or later version) <\/div><div class = \"text-block\"><a href=\"https:\/\/www.r-project.org\" style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">https:\/\/www.r-project.org\/<\/span><\/a><\/div><div class = \"text-block\">R package seqinr <\/div><div class = \"text-block\"><a href=\"https:\/\/cran.r-project.org\/web\/packages\/seqinr\/index.html\" style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">https:\/\/cran.r-project.org\/web\/packages\/seqinr\/index.html<\/span><\/a><\/div><div class = \"text-block\">R package ape <\/div><div class = \"text-block\"><a href=\"https:\/\/cran.r-project.org\/web\/packages\/ape\" style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">https:\/\/cran.r-project.org\/web\/packages\/ape\/<\/span><\/a><\/div><div class = \"text-block\">R package VariantAnnotation <\/div><div class = \"text-block\"><a href=\"https:\/\/bioconductor.org\/packages\/release\/bioc\/html\/VariantAnnotation.html\" style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">https:\/\/bioconductor.org\/packages\/release\/bioc\/html\/VariantAnnotation.html<\/span><\/a><\/div><div class = \"text-block\">R package Biostrings <\/div><div class = \"text-block\"><a href=\"https:\/\/bioconductor.org\/packages\/release\/bioc\/html\/Biostrings.html\" style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">https:\/\/bioconductor.org\/packages\/release\/bioc\/html\/Biostrings.html<\/span><\/a><\/div><div class = \"text-block\">R package ggplot2 <\/div><div class = \"text-block\"><a href=\"https:\/\/ggplot2.tidyverse.org\" style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">https:\/\/ggplot2.tidyverse.org\/<\/span><\/a><\/div><div class = \"text-block\">R package ggrepel <\/div><div class = \"text-block\"><a href=\"https:\/\/cran.r-project.org\/web\/packages\/ggrepel\/vignettes\/ggrepel.html\" style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">https:\/\/cran.r-project.org\/web\/packages\/ggrepel\/vignettes\/ggrepel.html<\/span><\/a><\/div><div class = \"text-block\">and contact the author for the most up-to-date wrapper scripts.<\/div><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#94EBFF","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1239797,"guid":"72086DB45D91491E8351F9D03926106A","previous_id":1239796,"previous_guid":"A1EB427597B04D4BA15342BE1BF7467B","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"D50C35C65F6A4723B9D44021A9B96DD5","order_id":1,"type_id":6,"title":"Section","source":{"title":"Preparing analysis"}},{"id":1054724,"guid":"446E853233E34FB6AB8DD8DDEFCFB241","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Depending on your operating system follow these steps<\/div><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#84CE84","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1239798,"guid":"D2D3E9ECDD984C37832C7B9FA6FE08D9","previous_id":1239797,"previous_guid":"72086DB45D91491E8351F9D03926106A","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"0FC30F529A0945CABB8AEAC98A768AC4","order_id":1,"type_id":6,"title":"Section","source":{"title":"Preparing analysis"}},{"id":1054724,"guid":"98DE300DE1CC44929B4E94C334353F05","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">On windows: open a windows terminal (WIN + R), type \"cmd\" and press enter. A Windows terminal should be up and running.<\/div><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#84CE84","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1239799,"guid":"868BC4A524C4471096CC1BC752E8A776","previous_id":1239798,"previous_guid":"D2D3E9ECDD984C37832C7B9FA6FE08D9","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"408FE78BEE974AC0970DD6225A015D7E","order_id":1,"type_id":6,"title":"Section","source":{"title":"Preparing analysis"}},{"id":1054724,"guid":"4F629ECB53064322A6D8D72759E8D370","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\"><span>Create a folder to work with and <\/span><span style = \"font-style:italic;\">navigate<\/span><span> to the location for your new <\/span><span style = \"font-style:italic;\">folder<\/span><span>. For example:<\/span><\/div><br\/><br\/><br\/><\/div>"}},{"id":1054725,"guid":"9A343660054811EC81B75F4B2CA3F638","order_id":2,"type_id":15,"title":"command","source":{"id":9275,"name":"mkdir test_dir\ncd test_dir","command_name":"mkdir","command":null,"os_name":"linux","os_version":null}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#84CE84","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1239800,"guid":"DE33BE80054811EC81B75F4B2CA3F638","previous_id":1239802,"previous_guid":"2A9322C0054911ECADA699358754C2F5","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"985E074F38114EB78162EAEA087EF181","order_id":1,"type_id":6,"title":"Section","source":{"title":"Preparing analysis"}},{"id":1054724,"guid":"D6EC041DEC76472DA3EAACB1934830D8","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">On linux the steps are similar.  <\/div><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#84CE84","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1239802,"guid":"2A9322C0054911ECADA699358754C2F5","previous_id":1239799,"previous_guid":"868BC4A524C4471096CC1BC752E8A776","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"9E992EE9CC514071BC58F00777381FDB","order_id":1,"type_id":6,"title":"Section","source":{"title":"Preparing analysis"}},{"id":1054724,"guid":"03AD873E62AE45D3B6E0A5CCCFE3ACA8","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Copy the fastq files and the reference file (1 or more sequences to use as references in multifasta format) to the test_dir folder.<\/div><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#84CE84","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1239803,"guid":"7623C550054911ECADA699358754C2F5","previous_id":1239804,"previous_guid":"A9DD0AF0054911ECADA699358754C2F5","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"05F4D327402E4692B795BE8E5CC18723","order_id":1,"type_id":6,"title":"Section","source":{"title":"Preparing analysis"}},{"id":1054724,"guid":"3BA8FE4C56264EB2AD8F2E6D53AB14AB","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\"><span>Create a folder to work with and <\/span><span style = \"font-style:italic;\">navigate<\/span><span> to the location for your new <\/span><span style = \"font-style:italic;\">folder<\/span><span>. For example:<\/span><\/div><br\/><\/div>"}},{"id":1054725,"guid":"9A15D14B054911ECA9830A58A9FEAC02","order_id":2,"type_id":15,"title":"command","source":{"id":9275,"name":"mkdir test_dir\ncd test_dir","command_name":"mkdir","command":null,"os_name":"linux","os_version":null}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#84CE84","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1239804,"guid":"A9DD0AF0054911ECADA699358754C2F5","previous_id":1239800,"previous_guid":"DE33BE80054811EC81B75F4B2CA3F638","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"9EB02F2236114BA484412F96A647BA55","order_id":1,"type_id":6,"title":"Section","source":{"title":"Preparing analysis"}},{"id":1054724,"guid":"E318D5A30C004BCDA6B3BEF51786F062","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Open a terminal (ctrl + alt + T), A bash terminal should be up and running.<\/div><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#84CE84","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1239805,"guid":"B0D47D70054911ECADA699358754C2F5","previous_id":1239803,"previous_guid":"7623C550054911ECADA699358754C2F5","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"F195BD71BFA144A79E6CD35A8AD0CFBD","order_id":1,"type_id":6,"title":"Section","source":{"title":"Preparing analysis"}},{"id":1054724,"guid":"E681594B3CAB47CFB8C03652D77D79FD","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Copy the fastq files and the reference file (1 or more sequences to use as references in multifasta format) to the test_dir folder.<\/div><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#84CE84","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1239807,"guid":"E3BE3E10054911ECADA699358754C2F5","previous_id":1239805,"previous_guid":"B0D47D70054911ECADA699358754C2F5","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"8CCE9EC7D6124A2E9495F1A01915CB4D","order_id":1,"type_id":6,"title":"Section","source":{"title":"Running MultiQuas workflow"}},{"id":1054724,"guid":"A3F34FD1D6BC4B9081EAA9A8B3EA9382","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">The following command will create a docker container, mount the test_dir folder into the container and perform all the necessary step of the MultiQuas workflow.<\/div><br\/><\/div>"}},{"id":1054725,"guid":"2159262324BA48748A210FE70FBB29EF","order_id":2,"type_id":19,"title":"safety","source":{"body":"<div class = \"text-blocks\"><div class = \"text-block\">Backups files of the fastq reads and reference should be made and store in a different location before running the following command in order to prevent loss of data.<\/div><\/div>","link":""}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#FFED92","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1239808,"guid":"1A51A5C0054A11ECADA699358754C2F5","previous_id":1239807,"previous_guid":"E3BE3E10054911ECADA699358754C2F5","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"BF1542EA9E214010AD5AAB795879B483","order_id":1,"type_id":6,"title":"Section","source":{"title":"Running MultiQuas workflow"}},{"id":1054724,"guid":"0DA7473069E247DC9C03C0BCA05B35C6","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">For Windows:<\/div><br\/><div class = \"text-block\">The user should replace each of the following: <\/div><div class = \"text-block\"><ul style = \"list-style-type:disc;\"><li style = \"counter-reset:ol0;list-style-type:disc;\">OUTPUT_FOLDER: folder name inside test_dir to automatically save all files.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">R1.fq and R2.fq: corresponding names of the paired-end reads (use the correct extension in case you have .fastq)<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">REFERENCE.fasta: name of the fasta file to use.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Optional paramenters can be set:<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">-l: use to indicate a specific label (default: SAMPLE)<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">-p\/--proc: Number of threads to use (default=2)<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">-m\/--mem: ram memmory available to use by the java machine (default=4).<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">--min_quality: Phred value cutoff for filtering the reads (default=25)<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">--timeout: seconds (per reference) before shutting down QuRe in case it freezes (default=600). Each time, the reads are downsampled and the step is repeated (6 times per reference)<\/li><\/ul><\/div><br\/><div class = \"text-block\">Optional paramenters can be set:<\/div><br\/><div class = \"text-block\"><ul style = \"list-style-type:disc;\"><li style = \"counter-reset:ol0;list-style-type:disc;\">-l: use to indicate a specific label (default: SAMPLE)<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">-p\/--proc: Number of threads to use (default=2)<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">-m\/--mem: ram memmory available to use by the java machine (default=4).<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">--min_quality: Phred value cutoff for filtering the reads (default=25)<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">--timeout: seconds (per reference) before shutting down QuRe in case it freezes (default=600). Each time, the reads are downsampled and the step is repeated (6 times per reference)<\/li><\/ul><\/div><br\/><br\/><\/div>"}},{"id":1054725,"guid":"736F5E40054A11ECADA699358754C2F5","order_id":2,"type_id":15,"title":"command","source":{"id":9276,"name":"docker run -it --volume $(pwd):\/nexus cacciabue\/multiquas:latest reconstruction.sh complete -o OUTPUT_FOLDER -1 R1.fq -2 R2.fq  -r REFERENCE.fasta","command_name":"run reconstruction","command":null,"os_name":null,"os_version":null}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#FFED92","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1239811,"guid":"56647400054C11ECADA699358754C2F5","previous_id":1239808,"previous_guid":"1A51A5C0054A11ECADA699358754C2F5","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"13DEAB83588747BAA0C55A9DE396AE95","order_id":1,"type_id":6,"title":"Section","source":{"title":"Running MultiQuas workflow"}},{"id":1054724,"guid":"D478D8DC614E4F7A8CCF37EEC7D0EDFE","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">For linux:<\/div><br\/><div class = \"text-block\">The user should replace each of the following: <\/div><div class = \"text-block\"><ul style = \"list-style-type:disc;\"><li style = \"counter-reset:ol0;list-style-type:disc;\">OUTPUT_FOLDER: folder name inside test_dir to automatically save all files.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">R1.fq and R2.fq: corresponding names of the paired-end reads.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">REFERENCE.fasta: name of the fasta file to use.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Optional paramenters can be set:<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">-l: use to indicate a specific label (default: SAMPLE)<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">-p\/--proc: Number of threads to use (default=2)<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">-m\/--mem: ram memmory available to use by the java machine (default=4).<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">--min_quality: Phred value cutoff for filtering the reads (default=25)<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">--timeout: seconds (per reference) before shutting down QuRe in case it freezes (default=600). Each time, the reads are downsampled and the step is repeated (6 times per reference)<\/li><\/ul><\/div><br\/><div class = \"text-block\">Optional paramenters can be set:<\/div><br\/><div class = \"text-block\"><ul style = \"list-style-type:disc;\"><li style = \"counter-reset:ol0;list-style-type:disc;\">-l: use to indicate a specific label (default: SAMPLE)<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">-p\/--proc: Number of threads to use (default=2)<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">-m\/--mem: ram memmory available to use by the java machine (default=4).<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">--min_quality: Phred value cutoff for filtering the reads (default=25)<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">--timeout: seconds (per reference) before shutting down QuRe in case it freezes (default=600). Each time, the reads are downsampled and the step is repeated (6 times per reference)<\/li><\/ul><\/div><br\/><br\/><br\/><\/div>"}},{"id":1054725,"guid":"574ACB87054C11ECA9830A58A9FEAC02","order_id":2,"type_id":15,"title":"command","source":{"id":9276,"name":"docker run -it --volume $(pwd):\/nexus cacciabue\/multiquas:latest reconstruction.sh complete -o OUTPUT_FOLDER -1 R1.fq -2 R2.fq  -r REFERENCE.fasta","command_name":"run reconstruction","command":null,"os_name":null,"os_version":null}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#FFED92","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":1239812,"guid":"96661A90054C11ECADA699358754C2F5","previous_id":1239811,"previous_guid":"56647400054C11ECADA699358754C2F5","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"C1D9A4F673664C8F8A7D93F726C6E687","order_id":1,"type_id":6,"title":"Section","source":{"title":"Output files"}},{"id":1054724,"guid":"3542F89EFA9548039578DD3DE3005662","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Regardless of the operating system a set of folders should be created:<\/div><br\/><div class = \"text-block\"><ul style = \"list-style-type:disc;\"><li style = \"counter-reset:ol0;list-style-type:disc;\">Filtering: Filtered and trimmed reads are stored here.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Multiple_Aligning: Alignment files are stored here.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">unmapped: reads extracted from the alignment are stored here.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Additionally, for each reference a corresponding folder will be created.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">lofreq: the alignment to the first reference is store here. Also you will find the variant.vcf file here.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">A set of output files will also be saved in test_dir\/OUTPUT_FOLDER. Most relevant are:<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">SAMPLE_haplotypes.fasta (and SAMPLE_haplotypes_aligned.fasta): the reconstructed haplotypes (first sequence is always the first sequence in the REFERENCE.fasta file and should NOT be considered an haplotype).<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">SAMPLE_adjusted_proportions.txt: proportions of each reconstructed haplotype.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">SAMPLE_graphs.png: Concordance graph between lofreq and the reconstructed haplotypes. It should include a linear regression equation (the higher R-squared the better)<\/li><\/ul><\/div><br\/><div class = \"text-block\">A set of output files will also be saved in test_dir\/OUTPUT_FOLDER. Most relevant are:<\/div><div class = \"text-block\"><ul style = \"list-style-type:disc;\"><li style = \"counter-reset:ol0;list-style-type:disc;\">SAMPLE_haplotypes.fasta (and SAMPLE_haplotypes_aligned.fasta): the reconstructed haplotypes (first sequence is always the first sequence in the REFERENCE.fasta file and should NOT be considered an haplotype).<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">SAMPLE_adjusted_proportions.txt: proportions of each reconstructed haplotype.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">SAMPLE_graphs.png: Concordance graph between lofreq and the reconstructed haplotypes. It should include a linear regression equation (the higher R-squared the better)<\/li><\/ul><\/div><\/div>"}}],"cases":[],"data":null,"html":null,"section":null,"section_color":"#EA9F6C","section_duration":0,"critical":null,"critical_id":null,"duration":0}],"document":"","materials":[],"description":"<div class = \"text-blocks\"><div class = \"text-block\">The following protocol summarizes the major steps to run the MultiQuas pipeline to evaluate viral variability and reconstruct the viral quasispecies from NGS data (particularly Miseq reads). It is based on the assumption that 1 o more known references are available. These references could be obtained using other haplotype reconstruction softwares. Nonetheless, it is recommended that only a few trusted references are used. <\/div><br\/><br\/><\/div>","changed_on":1629860337}